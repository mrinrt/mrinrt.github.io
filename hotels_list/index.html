<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0cb2b52e3222c6d83f4463dd7bd4dba254ffa9191fee8524049d1a3676e710502342b7a0f31b7f104d178f2f6920fb9fae829c302eeffb64920da8f874b44c3759635777d70ff68367c0dde300e6df3acf348999bcc1fb16bb59230fdeb6728e3f1195d02368af1eb3c797d3e512b8da5aff9d2ca17de1c790e081f4b6481cca8e697d13e5488084b2aa76faa3af415c36b3c3866f77deb5ce78f07364da029175f824b04b02ec87a907fce977726d7533d847212dbb2708b182ebdf4425cfab4eee4a9a1803effe00315fea0df0321b2d1dbaf4961ac26d1ffb52b0d0c28442e6d4ad981285885f90a202857a74001ae5138bb78634b0c8b84aa9bf409748cf26fbb72644a29d17c1e627ed7d3ef28022d0f4614d021dc525740f0ddc6c43c2b58d3c622df72e9634b2533ce94987ff7b910422c16bddefc2233fc5547c0e7f12002336b6e6624d510b9866ddbe61de859d16a60d3b5aa9c41dc2e3e07cc0254d5ac22fd46efcdd2787f270e19472f953eee55ce9d74c3ebcdc2ebf53c451ee724b8f78b6ec4c6b4d33b0339e3a2f2cd933a5ba4d1fe468f2e2b0c61d5ac2cb2290dc867c831a8fc06fe02a7e9d786194401aaba98a99030d61a7003987bcd9a06711f93aacb089945b9920452f5ffa35b602ea6887f0a65da89cdd9d6e8506e69e7ce01f946b461398eeb6c52d455d9f2e31023a0e5394ab56d1e63a7d307da1c700838cb6972c75b461cdc17e4cd2cd6f3e2f62ee35b4e2480553a948134a57316157afcf4bc1abea950b47eab91ca23eb565da12d9b0c5540662afe0f2f7e1a6b952b0e92dc6710e666237281486fe1c26c5eafcc06f46e81e19f5f47cf1f4b9e83ba56f418b3def084159c8b29b0125ee9d8e0d8402fb76a472bdfb781a7ef728489c119c3cfc1895231d59bae1d77de0c86143265db018de543b9c626d72bee7f8b6e22fb2511fc58b7d8bdf1016db155163255903aaa621dea8edaf8618077fa12e5f328b72e464701af7d9549b5e963d3061ae873c954a24b10b71344d2e1d942c085056782c8d116f052ef4b66706e2ee15e17667f053f08fc62ead6305bc9681397948c1d56f5628fc0d5288ec87fa8ae5a554a7f99272200ea4ecab75f47963b40202bf50ddd21827a98a41e70ad264f4ddd56a1769615c17cafd6fa37fcaa3f3e6daa4b48dc0c33063a49b3f97fa017fbbd9dcd7e1316917e5ee9e36b1087a1ccdeaab7a944e48cc032fb2bd2a5207104e96c2ec9d93016af64fb4ddab546189696f5153d647e122b69746b276992e92d4e946b2bd6a28f54f40aa069b66a560b71792d0e7d6f12dc7dc4d1582777e33f5d6d9790de0d13cc4aefe0ed4553fc46119055feb16f757a448577cda3e56a6228e4136793aaccae1b1644c9550d386273852e8bc668f257c86ab4e8a4004e4ca51ea2869087fbf26050f1caa0fa80c8f81ee5dd725638e2cbca83816299c64a53822dce5d58a1e556250c9f552c4a29968167e53640b6952065cbcc2584496ef3586d19f19348308fa95afca7b677e236f766f7fbda55f1b4210b4f978fb533fd93f56cb9446c3dbd07d7df199e5365c73bf5d2fd17937aefa67415da75a5850832ce826b6387c5b919a5c987c20baf928d09441b36cda6cac9709e3cc31cc77cd3a56b83d0f5c573a220293c84ae77fea7b26ea8686790e48575eac42217479b6a68c0b1d2e9f6d915dd372101bb3804471d6ebd264ee14ee329c10973371314260b834034c6c10a4ebae3d3cf87201f6ca91bacf251b6d39b0d6a67de5980ba6def8b9943ebced88f6e5869900c71fd2db7371b0add3261dbed9245978f394554814383b8fb4a0a606921211f7a68c3e08535f593f052a990630d74d0c64ffec873b06d6e0b2323b560bf2b011fdb4de946551abc5fbfc75a6dab4ba5f19706a4ca97c011641da7a78362000a044f3b9668736fb789ebcbd3ebc6fd6fd37a9f173399771b7583d3a4a44fd22a92c48ff8b7d95730d7892fc4bd05a5f327a0ae6b8e65406d4f3e96de409fe089bd3bcd416d9ef043a9abf784587638bdfaec5bd6a597ff03b504a1b9326ef9a1ef437642cc65cb8faec1536f0abc084c9ea541f105129eb49682abd2da3a253d58d7aff478dbf1c11d4d73cd46878861dca2fb92f3131ff7daf724638ca65be2f3bbefb3b5ef56bb97778a61f735c544cf557df7e07364a9f5d27a5144af6e12ca36b76e40ac4a5c24296d2dc54977fd8ba5c943061e2bac8233a98d21bda28330b38622107db52c9f446a3d47e16f3e3dfe44a748aeaf5169943dd53a35b91a19b7c95ef0082db0b758d908dd02e6bd6e65a5916defff89338447f442f4ebdbdbef9220d9c4f8a5438214b2f99c577def0594e5c7a6c2694a578eda4f4bbc84e5be477f699afc7f6fe2b62a4f4bcab8b9bbdced19ec253a2f997553726e95c5fe224fe6e02f2833e2dfce50e4580086d65f4f170de7afb6013c898e314a8d5e5d7f7a5f11ee0fb4c8a82b6fca13af63be2ad51475c34486da7b809eee35de294061e878947583c70f95b7864277a9b04a7853bdf5844557d7074bfed4261b3d676c3257a0621aeed5572da3f9ef83eba3ef838b424043491efdc92c84bb3bf9d72edb3f5674462c56730b91bc06a8908433fff63eb9f019143d88aed498db80bfaf3f5eb0503723b52e858e81dc29819e53d15ab6b966499555387b53f693a54d4ce6c94cce8922f648aa259f23c202357f75e0eb02221b4d3ab7052f956bfeff002e1285c42af40dff2176a26a07c9737b21fe141782d7f82118287c23f9ff2e3d80e0a11f879d5480244f8e597dd8fef9f85d9b9b70d1b3f09770a63679a171fedfb9dec42998bf7752b6c9e7601938d4bb7ac6d51fd8963fd10b21efd3093a950293780b616317a442a3b60063011619c3e8ad180fe9d595ca926afd8376eccbeb3fb78b3dc82c99bb9a451e4e1f3f4fd836146c834e819ea0f2099122bc6cce2917570baf5767aa1177bf45ec9e3dfe7ade12c5cb38a662f7c0b762457d6cf6ff21aa4d279822968965b6bc066f675d574fd8bae356ccca12b0874792866de75d126924058b743eb26f4d6875a65b0d8c094c7bea89737538bec10bf5e94d144b92bbd33bc870c0a581150a9064a3f3745cf015c44c8434dcfe867cd5dc52e902bb711bc822d0fe507d2754bab41f55cd02689b293f8a5aecb6c5732ebdb3b39c72d3c3701e179d1e2f01bbc6f40adf9d86f941b55daf65fd890fde653d6d3fe4d91f2dbab58e50ca3ef0decaee50f05054b9ab65b3c2513225b6c7c022df9ec88affeb87d16b74d379d98e0941dd8c43de4519fa64e744c19888d89f04f909be5b882ea9dcec9d44507eb7deb7d11780eef28c8128dac199864bb4adb4cba553bb9c16c0bdaac56ec9bded3125d48aa8b2be6a2976e8be8ffe2d4a4874bc88f4a204cada57bff38fb01df7af7fced0c315227cd6c2baf8eb5b1fa5ad1f877ad3f73d18351cfef4f1ac2e747c027e93d8e1fb8afc634bd3194b92c075bbd8a3a83adb7c0c06b3951f91322cd7c8fee14b4daf7dd21ad93a0ad1a0428e8609db774d6bb64f807db051fa96629c27100877b1003d73297f3880702b768acf72a5ddc0624da8b8f7df7463ceed70ec4c8f5ad97ada50c85ea6d83a4e1b6d94c42a21e4db89264e1a49bfa0ba846a25846676b9bf4b5bb09676b3e30f8c6f62283b630bc854e254b671c3b3624057cfd347e18e7755afb75aa42a50cbd560d92c88c49465211ca865ae50b78b27dac7ad2245249397b5dca684bda672221b80993f16f68f35e965442e28188494b73102b915f11c27046688be3f0226e2ce41549fbb869d0a111b2e4281e291dce7686696eae1f508de7d203acd985586f9e957e2dc03a9ba2caa95ea9a61a59fb4f6ac0c686c2b8f203611ef75872da7e80f57ccae9107136ec7667c81a550bd1118febaa65b303a5c9c30ecdc036d87f4c8dc2f27a7913af79e6de3f5dd0f846399c41c241f205eace4d8a6bb0339eb3c03e2735ea879c07476e38d619ec27a943960fee603859f7cd8468a1eb468a31987f2ef5d69da20a4d6443045250410367e759cbbdb65d0d64abec3d4bb2b515dcb19582721a67777f06aa566cf8699f6595aab307bb1e6df425a846dd298a8e505f39d8d85c7d4723192e292e9a7bdc78d029f13192122641dbc2148f6b1cf60ac6ed40e191fdad1259dcbd529e94b5a2a94b274d1a5975e706ad47fc4ccc0b8c6bf5f0de978bb68fcd9ca82d7acc0efbff6835fc65cd1b6d5f7a536cb78d121c223a60df8c0b860b97ae8ccc0d187a0fa156e0154582692c15286bfffc6bf8a90719805a4098b8cb5326dba5f62e8f4190373117259b7aca2ee2c824229f97e9c78799771950f372f05685e75b813d6cb7ce2eb0c95da1267468e8ff765f6daee6c4d63be2c3477d8a278d8e35bbc79939b09c2e3a87e1471b7958bf08e3064628dc0103f2725b96de8aee9abc26d61cf5451058b07ce3c92f864f89ff1634ffb2785c640c25f3182102e7d5b7977b9723e527aeccbb9638e041cef72c1ab448bcd438b8f1492b9e5c919d7c0b67b618907aacce2cedff4008cc6ef39a8f96bf3899b85aa24b82a0e78f125c087ae5e0fd6ccb44639079272501756f02eee56986ef6ec352ca1b4e30ba7e4ee77841452131d5b1943e7bd8789053392044cd2b6784836b6e04b3da02d584e5a658a015c2b0350d6bc92fae898d1fcd12b4b9f973d111f702515e91d49235cd7517fe3819f325bfb76de53316e1ac39f676bee6b6887a8edc8571655bfa8190918e93de57ac87036f79f2092bfb3de005b521bbc3fc4c9d9b3acecc5a668e65efe7229ab7ba8f3333ba43343058948042e7ce9e0e1c8d00d7cb81032bcad42e94a6a9d6f47eef5eadb0bd4a401658708026d03984f39c69bfd948ce6871bf88d0991ce0f902ffcf959baeceda4ff87c42d1a0715f9cb25b1d6dde049f490cd6f2d5d0b98c0a8e9d0a50503115135e16a89bf1ea34106ef42e60f61d4c7578a9af9b1e28c7b6a99c9ae0ab9f756ca47f8dee3411983479ca5aab84d9ccefc7982e327eecb23126f95e147f6a78c1c1b8fd6908a951909b53d7739419ea5fec0aa60345477191518a587a72dadd7d6f3a48ae7aefb9cbb7969ef658dc4e4be43a5b762cd0f2f5b2b326e9c025d04f67ba24ea0ffd74f2591b88fbf89983d16b022604ca39495817b9597396035b0f12c8ee5e1e6831069d49196af5dc098a5bf6f1d81574e622fca9eb393c2a98f40991dd686d00533bdc058111875a2aaa7551e3ff49a4abdb26f547722f934635bcd42c7297e2b1507bf16da60241f6eb51fe289d25fb613d56bc82f4df1f28d12d02ed64791ceb0fcafa5431e35e5921500c977690463332684e9c8cbbd3cd7c7d3206120227819167eee511336673c5bc81acbec8af71056e4b678e160cfc850e2a3c88a0bd45242fb7f2ff9d512c86c8907f8afce4c98ff8a751684ab6b269d5250a9226ca76cd47444565e25919143f24b611409598067408f5d53b5c2b5b5d331761c1a6d52572728dcac2e165a9c8f3c919c24867134b7c4f7695c869af3e838dcaf870f47e570d7770cd9af5e460843f91ca386096f146dc2919930bea870d56b6c7e5da382982f59d6295c3044ac8bb83bb43ed0c61d222ab530585e1a61cf10619aaf986252f4790edafc37b53296b67d8b78bce42a4bc42d451c758c75fe736c620039a5fd459ad03789d587e7db889f008fa53fb7c931907e45d2e4f9d4821da1d4ee50a75ee4233792bd36d0af14dbdb17b2fc2429eec83db6bd74570de2b92ed70f55335e69694d3c808eecb670295f2690862b51f852281fb7f2d4a5c12dd8c532d948cb519212bf89ffee3094244816ebfe3a5e09f56d1fdca0f810b50cff24b75d1df6bd6ad7f960a733ba0837cac0adec687cfcbc6b689a6041dc64db9a4fa4fcc581deeb0d3207c1bdc24bbfd8a8796028a371903477f51060bc3045bac2e6fcbdfc7837fcaeb05ba0468524d0ca25b8c99da574eee6a15abc0a4c6991f642ae0a4c8b7b7683d75372fe90d1cbfe9b2287779e8603c67edcbcf84fb4b00a71087157be2edd2e2881eeba7353010bbaaa77927b63928c65136037f54c081b4ce3f74e118bb644041529e3859d3a9042c8cc326f3b87fe541096a7ca04887868d757ab1ad66d4009ea19c990ff5128f0a9e8af5783c5e4a15dc616c0519d82876828f0598aaea1b46c612bd1d6acedd45f918b7eb2eb534559c772f1954699253b21a6d3259d551b931b23463ea951784c0f565ce18e277b26547505a437b92dca09b6db2daa25826d7895f700d9f2c7e85e22f612691c0895bbf92689057f84a9d2c98881b9eebbdbe28b1797c4e56d21e16dfa025c3a50cae23a7f35e86d0b87a32f063987ec573680ab2f4a74d1898a52cf586cdf28bb6f151c70ca02b09b247799e18fd88e75601b5539839dbc758cd23b2a78793993799a664be2f0279ce022cab0c0473f3dfc82992169cabc4875cf18f614388342355e95140d44242f342865ec77e2e079ea01bfae548e80b52c74bf5c1315b95a9396f02a2b901df2c9f7c2cbf0930560f6ba042b8ee59a21dc4a4e84e66e4b58cc1030914adc1aeab3f5f76a33bd4d182d21dc56846eae57cd41c278fdab4de1fe59bdf1d2cb67b98b36406dad562190b1d67ccbdcb96734f4a76ecf42bc4d852c50fc99edb5e375d477c2fc7c3b66b99fec5f14613cad18a31b503f7793d8f89c82203f0a7970dec929feec3a379add22feeecbc7f60f74a12df5aa081fcb9303185bfa452976ab4690d59a5404cbd802a4d15360a5a6a84d7e94d58ec483700f5ca2d16bc42288754f430c36a49cfbfe49049b5000a95a2d9965582c9c75940104b2e6249d6525127f9468daa88d752b99ffff8a474243be9140804d7fd523f2139b759622ccfa269e3d98123c46c226d7d8015d4c319d4f43fc96550b669a68607a9dd139ec7781d6d9aed1aa796e7b229782315f2a92d926943dee32f6e0c806de5c03190a1abef889353ae76f2ffc590b39e4ddeb6a940742a78b7b8af25ca606a646aea2f57b48443cc1c915931ab1cb83a2b36e5e0c8d3110f5cf793bed23976529ed77db63e4a9119cccf9b1984bc0349fbcc99f1d136c1910959893f168896c2f42e78271eeedd3f2356ddbd967139ff625e451dc6de832095e0490962df07aaaad8296e2545828f9e0e4250dba788335b05d257a230bab540a494febcc3d65da8fce7ca40047c15988a782ca210c40778b4a6123ab87c4cd2a75f11a485a13d13b8629e9c73b382cfd6945cc68bf537e3f1f5d7e19804053ac761dd7f9bd8e3809218271b8148a69b7b1eab3481cbee7050b652b023d4feb67f053356776c72bd90e3ff683c070b46b2919a0e875d17c879c6a06cf70b3451613d4116c0329f2a5491b2d8cf15a5c7db3bc5f51b32614683870d6d1135a9b1b72d758f8207861811d6cdbd959fd01b57153d9e44699c844bc80abe424e372a483a93e0b2758d6bb520433de818024e972c77e5d6918b7883448a83e7b2ea9601020efcfe17db0113e92388f29db6e986cdd2c5fbbc04d7b40f815f65d38c7edc92965422fe1ec9103bb407f5534658529a4045e6db0db226ac5ce3402365edcda7ff774e6aaae84527cb3413bc9a14522fd2e2775c94b69f01e7102df8623330508a99d356b19a6b5a62c7f0a3bc67f379fe24443e73d9948d637f7ee9f3233661d9d802f542dffa415f80124b45a6955daed3c7606c62c023f259a81721eed45a41b7d331805ef80379a3a81cfded8002f8d8b9e377eb172433f49e58e9cc0a06cbfb0abe52ddb824f34a2229e8f661a5b35db7444638fd3d1cdf6514f8098c1356a87ee4860160e60175aaa1cef77f975c1fc8b8f37b414903a21f9434186fe2fb5a0dd3aabb1a4009b619d12702a291e85ccd1c434377b45341ecf534ac6cdf679871204eb2755dc6b96557fd0a0d2f5771907f14822ea08ce231f16b5a886beb560c38b8f10e436da359a397288ff82736d046c5c7a04e36b6a6332c45e5167dbbf3e983b66307636e6336c9e3c6d259d982fd6e1a19062d6d434d3700448a48aa2769d91435af55823cb42a13965a449acd61999c0315a1e963791925b2ab2ba8ce7dc01bcac953afbaecdae3c21645c63381da74ba4b45cfb50f7f616b6c3c80047210077207679eb43fe99ec02b5dd9f371a5557ad91b24d02b4da45c0f7950cc2ea17f5f407805a36ca9228ed8dc91d48e2d9337a6a1ba9596290531b4d3d4237a2f36ea9118fc7f6e0d48c3e21852122279fbf1e11e10824bc020f07e2f0761ffee6558dd90d9c6f1cf19e3212551c01c7772e0ce0e4e741afe574d0b9acf34c5cc38a3dd273eb96222adfc324d1052c3e4f9fc38007758433e68476e681fc4d4d108c6bfae3132dbef0f04962f31d25af49591d34c3e9c017cec04a3e265a1c10ac3072fbdf8223cd4a38247effd06f34169f3a729e462062838527e350f0225da7ee327b4050538f5495a564fd513545abeee0632edad1abaf507ba6ae4819cab5bb288f8a49dd88760d6e0bd2b6098de3e9640a958a4b72a7acd2609b660e2d7ea48cf45d08326fd490172f26b48dbe14bfa41f55dbf1f0ada81e3638ed543501e0fb1af34d4ff30fd376ec718033d0d878575bd31377505e3c1d3e689c71ee9e68c29877c18c63d55e8c54c7648c8dc94fe925b547f87d6e734cbb9ab8149b50ea387faaefe4c18cbb37bae9c1245e038e49120eccee4d1e926da89835cf454352e34311c56a6dd363df64032b374f881b607002ec39136875f28c118ad0a36baf1f78c46b98d76b6b75840df90f7977c67b48c5dac9d142acffd9ffd979b70044529ce4325b742dd8e501a06e320d7d3d2f0366f2106fdabe5232510993b1fd9e65bbadcecba1b799aeaef8bdf7f440c248ced6dc476d009b63496d16cd75385337fc541b8215d3be1e241515dc39bf0d10c1679031a325bb0ac1676b6c11d440e412d31848ce9cc04c62654a48d1e65a4aefb485b0e3958b5e75a888d27fb67f7642f34a1b622e76a7e4f434b70b27de29252a2a64e1e30bd6f0a08180617479e7a30aaa879ec4dbcc13a8c4ae4fd2666b906d6668522e420c2da6e35fbaed5993c172dc73623b85609dc6613db6e88edcf126a31cd4249f07bf97bbbfe0695cc8c9bd592bb0a267bb767a9b4f81ecde46d235cc59ca9c033b5208f4bb8c240c37fee30e248e5b95e9aa6eb5af28450a94d58316012346e75de5dcb6572132b5b37a7639e2559c7530c003e320301ca20880313833dca94343a265ca647ef52d46a294d6927777a6ab215d91b7efabb82ad0b11321b276077e00e5bba29c508edc2faca40589213062252fb8e5f6055a3fc989454be23292d6ad6cbf46a4ce7afebf25eb15945a6a040dff0e25da5f02ecf09f35e7356cda44c11df144792de5f3024a98e9e010301a549e4c0e869e4bcafcd9612554f82922062cfafb26d73c823ee4d70a7668d00b87e8db2bc76355088c00efe2f518994fe4ec363fb053b06f1fc110250584dc5d7b40790b6c0ba4633e761e7e273c6a6cde37db251916f695e0003a246c53091ae2aea863afa6b8ccf04b91f9dc50cffa97f0dd63467a81474e85d8394769ea2a51d1be8d0535d1b05c1a63681b94e626f9004df7abe6038563403a12dd0b1eaffdfd7fdd5789293ab7d1d8ea82a0056fd8635dbe82f5dea0ed0ab924c62693bea67f843afb7cb75fcda0be8f345bd6342807edffe2836b8ff92c0280c91ed092401b7dfd52d7aba521a88d3a68ac88ee675bb7030e448184e0bc2db482c56066a0c27c09fcc7afedd7cef5be61b7bd2c916c99fe6c71cccf87c920e53f87e9bae70c646fbd652700ed22b8a004e8c1203bd32f4a1f8c1217648110b390c1fd4ae56eaad9063433d90a8e0d6507d0c0edb513b1f8dec8ecaf9e63b312c066dff99b077b0f34323c9ba2c335ff0a5631ea22dabe8a15611c50eff3e61649c5fd66dc72e972e7327c7f431485655cf45608bdf972514ef9a212a9e8089343cc2dd2508eb28b3d1cf36b17c1933d26ead0764f1eee7efc3d9a68cfb642975f6dbe7cfa98823d172306ba20ef81316e7486d8049c94447fb84d625540e335f70c8773005f62755f090a916b94ced4571b6e232eb31fc4e40d6d83d18632e5fa60e81be0547924e1d43da38d24053c9d36e80973cc00e68f86fbc71640b5df765c84e8f83ea4851a7a63d949163da31df2f52d0c5a495f8e56f123594eca555e1a591d0891d3ffa3622d5601389c51d7ce1326b9d80176afec2981950bc727972e7711298b7009dd694b33a7690a9107baf0c9761d4bb6fbf7ccb3bb8137d76d585fa27c77aca5c8c6721f0631a562b2d37cfad6c322a20711238326bfc5bec04f0e29c760519ba0162ee5c758a964299287070f74d3c012aca6ae8b8b12b9690f27d124e87d6ec1a6bd367760473345d638dc19aaea8303f63149cc5b00211c7ecc6e5cbf1665f6c82b4cad3edd1eef1eedfe22242c20a0f029e561ff487b43c33f05f23598f22f631461a0adcb46d752a06489e7493e2a925e93153d168647bc87c4d7d8cda45fafda553db69a992fa841cdc0a8a8723ff0da9430c205352be5367e86e4a6516aa85f9cc4e0163e1a84dcb1b8bc5f9dc2e6337018261f08f1320f84e9fd03109c8f26765538e7207de3a884144a960468cffaa2e436f06be9a08914f5fbd9205cdde5324d386d7d956888a4d31b9d39ce1ff84d74e1e5a8b778cab725a9f9aa8a40296feac446dcb1acff9f41e46a18aa3b6aec2bc413f7727abb1fd0f8c0c58e3f0683b9ea9b51a403e2b7441d78e5b59a4c64c121aa2b27e73722f55ddce05f1472c3c3e4e741349fa3023549c9279b04df123163e071bce0dbf2f702305bcbc14c941d30f072dce7f0d9380b99843726bbdd58e635d318089ea9dcb444c0452239161ab918245440950922ce6940b1e4d26eeedcbcbcba73787de3b408f174a2bd2ddc5779fb32f453ed32ef95cf7be65b790a513540d20aa0e5647a85b9900658b5f31b4a306cb4ce15606c8b265295274fffd68a5a07843e9db7bc736bc66c61e888c1a9e7eadb3c4fa7c62b5274a289755212a03e5c12245e6c70efb53033851d7952d5344212b2c958b5721606505303b3fede949073f8ac1785ec4301580e78f85187f8f36f71fbe8771c567c152b3829459d8796243d876a0e3c7fd39c2e746756aaee3a1b86b414cd1fb8156ab3cf87c935916cfe47f6f3684c0b35c7d4b5671ac7800e1a8a9bb9509fab313a15cc698b2bd4e9748de3e79d9c43ee64056dde6dd663c2c92633d0591c12202575436e12a7046ccf06f24919244e64ec886a0bbde1afcbc0b689726ed03920e4be66e980d5916972846a0cb8337fd87ae4ce84aac2177aed986e1d7d8bd1bea457e67aa5bc68ebc83472fe1dcba7374013703d7c28341d5e663e9a275a44257b9d3461d8b874ddd63ed0802be9e9c0b1878fbe23a8155d1205d376cc77d7fe8a29cc6b1ef5165b07b4dad37b2b19b528b36f4bb349e28e45e2bea634cf5e6033e6499f846f77765812cb5718f1a9723419a5ffce94f220b862814173595fabd50f72d897181a7972bf15f1d05c33d3b5783e062918d50250bf2098adddded5399e65632d690cd36f87121cd4707e1b79d49219d7edce953ba9a176b1c84cbe8865d4187c97ab6eb8ea8debfeaa5556660a439559465d35b400a2c915c7ded60e70e86087fe5b12a2208d24c8cd0dd624df56cb51ea43a256d8cafcd5c4fcadaa9465946bf32e931c7a4cc909d43268dc061681e48da3ff9dd8e6f06f444cd4004cce21e305aa0d1eadcc6eefc2f3d9e4033d5899202c86c34380e745a17bda1c97121a0a165e670c36f1bba1a09e3943093f1e7dc96dead86674c87a9d7d9bb3bccda9517670c3afd6ad98842a80342f378d3db16d796a1801691b98afff4bd7bc562cbdc94d6b1db28497acf039ec06d511fe203338b72302d28f40569ddbc83bc8ea8399eb2e5fdc8619eea2244b165fe45147b4d05e68b7cf61d2c11e298c8c7e339d8770c952a7e355d7a763ed1c905101b7346cb819d94a54c825e34b3f8bccd60fbcebf505ed7b443c18b15ce773c3a90a6ac6d8f78edf456b5278ac78d4551497b5662d7ec8ed40405f8ca5c2803d55fa4bdecf25e891d7fe2c1d353e698f71928439f249be48c2d11d2e98d0506f8c0cf5935fd1cbc2213e37c53b4437623c1a7893b5117aa427e9842278a6ebf32feed93fef297cf357a335f3ea2add2f5cbcb95b81fe3c361075918826fa4411a9d678e2b0d1201a8b020311b68acd37a9b9e96372a5d536725072a2714ef9236cbddf70c59666c4a17a30aa004137e7cebae9e2773dcb11a557f56c8db5ee467e370285076a2d2da39132f74a395466a9fedf8bb37ca59185195720dcf3e2f9cf4f6a81c146f641c80b34e178f41c60ccd5cfc96a1dc569221fcdc74c65c3d5c4755c5672994db7778cac2ccfff3282783e99c9d330a330e90a9789d81bca7b81e537af1d36151ea1932f17f007fef1bcd56e96ee241e26d559c681e1eff94b62a110b83294d72dc7279438c12f5fca5727aba1815d0059d69fbf8432edc8ad47f196036dfa1597d694be8a8571ef8841b2ec082a616258778608c52fb125611fac53dc68e609591c597ba20de07902e4fb16feaa6cc5d7d17283e68b2d42df70cd40c3e749d5c5daf27a1b89515feb737a1d028688eee0d204847a3298dc1cffd1694b554e66f32f63acaaea12381372c1c568c10b0d1943327fb8fb992d6ab0a45a2ca67cfc555671dc107f94d5624c4cac26e3f2737a51a46af129809582eceec78ab73f5e3a52bb306073c524a602c5e1fe6dd1686b16693ea18509c950287b8bfa5a24453752cdee4632cbfa7bcff7e1ba9921c907c5f7f2b20b519015ef7bfd5f6df675b35a366e767158b7baf64a62f04a173c0a98278b2c64cb84a2badcf4eb0b046458f55a6bc0615c7bc47f18a80126fe272480a609a4bfbaf1b48a968d2ba03532b4ea59d4834ab3f3b536276166b3e2826d9c2ac195826810c19fd4051fc4d2f54bc48db473eb39c900c97d1aec6969875d650a41d409addd951ab383eb763b623d957f7ed3cd38504c77a7ece478a60f0a36b62ca6e4f35925f288ddb20ace6833657058b55bfb48a05d19f4664e1b05356c15ca42a5553e7fb1aa02d9073bb02567a2fbbd5e2e4ec0bab187ee0f80f81ea5f7a334be8ede23f184b31e3c6c6d090a310bd43b966691d26bc716b1d976fa5e8cc4d76b4f19d1c4a496d32142e36b592374e676ba9d72d5e946ceaf609ca7a554a35a4475e8522b2670ee9bb298f5c838027759909ff2fcaf82d6b626f6da2f0be85361e798b1e3d0c526c42aae76bd519816839889fea55b98d88a38e21e0a4de95524d2643c87f54a234e10ff86c6dc7b2c67abc418484b3cf9d58e66a220989f1d1677946b773de3e2a9460f80b3d3bdaee25a0dcd3d314783cef9ab78ed479c197af4ede2c81be7bd277a853ea4a192456fbaf644c84b7aa3640bef75a7643dd7d9f85a59be59e2c157dc83a198e718f0fd4d4446332b79189304a93958611b0c7fa2b8b6589872027a87d2c8e10533970ee46c43830d90084f745a5c6cbed00b59bc36b0f68869f3c162cfe13746937be7db06dc61169143c588cfa10220e07d5f4d82e7249dfe9ca45ad4f9dad729544050c2cb4a483ae267a65dd972fbe954c7427ebb6e419d754a67311dc4e99f16436fb766fb5a137b4548ea3cc89223c16399143890b1c0e187476b5da4db40665c0f87beed99d57e10928e5bc867c9cbc2b0c0bc52fc2499bdc741b23dcb24b87e4a7db61d600110273acbebc8ef9f23691ae1f7470b1f84e7d0db80c402c540c88e8e55918d047eb83ef1bcc6e3f29e88b01480aa8d6f84c13443d995e936c6800051ca0d4b93b198f2cf402c769d588d62e07b777f5e0b033454b6e768cb0f119e6f58f643c33914598fabe67ecc3935d939baa1f4f6917341a7c97bf10c8f378f1e2a13c9bcc5fd6aefb8dd9165638462faa04c9805c52e597c524a8fc684ba897e4cc5b43fe9f1a195a827f366d797605889194568b85d837a8af934e9b90f813a9ef6cc123bb1559c62d93f48730c8d9a59387180d6349153297700aeb785f58fada38b90eba51f166a8cde380f625eac7bdd8415aad553cbec5ece39b6aefcc84f6b7866ae62b2c698b1bb115b81a7dab297cdb2ef9b11307841e21a753c0fee3969b541dff345c0791084a5c1f484308f347f5f1b49739e0fb624844b89da7e5d457fe3f8df02929512b319fa01049b33551bae0d058ebeddbe9d49958de330b0a3aed418080a029b3c958559f7d659b9b949bb6290b44bc6138eac94c7062a39cfef17192a3a930f57bb81a126465f93590c73dc84f8f43b246acd6522d319805700a9c952766b263c491470af05b60b6ff2a7df4fad4f2dfce8b462b45b3e8c76d5243f46f306009c3234e67dc5201b41c62bb97545648ce27a2a2051bd93741f24c4f119656029e6e879f7df5e0772cf52de66cf5379bdd804f0da43406a4b6e6c4024a7d65f7e4bdc33dabf13eddd6e6a828779a8b664807ceb9839ed88b2965cfb852198aa9d2c26b4168f6620794ce07c14852018e1fd9982fc663726958cca8fa3d18ad14379145c276918e741a0ef5acc8c382b4835b68a7578d36c18ec70c5447a9228726c9d46b86e4f177189aeacc944cadc28b65a538eed179513133883f38e1997155aac96d2d3d524328c1a411f514dde41befc5b560361a53192b22206230f16a47be6d86124b05aeb0ff293e377713a453dbf46880ebd12070a92ae2ebcda10c7b44cb73e7eddb37bba38f82761f4c0e864dbf760382732de6d42d395ad46c8ad274f31a9c5d1cf60b7cb94a2930d19d25c5e04fb4191625fdfd0d8b4914e2407a21941086c584fe7e935be287a133dd8cbd4aeaf3b5b6bd6a4c81a35214b9c61eb6f14154a9454948e487ae3da353930dbe038e3e9706effbfc59c069ba6311a304dbce6896a0af81650ca68e2e4fce30ca23410cb0822655755704a0bb000c89c7926474238149076e474b3ccb7270832cb3f924a955440c09f06042822a3fa73cf606148dcd415863e99a301216b49e49d81ac125985bbf3fca8fbb67dfa5b91abbacce2b41bb877db0b7d25b7002bce02a77b4b00ce67346f855f974ce12fcc14fc5cf99a4349d2d2dda6813847c8de91257f7dfa9e9b0480e31c8c5bbbb72993a902901f4f6587fedb1d9f553a247ec6e694457da29e5ee5d4e792f6f4ff1a0f0f6d37214fabfa7159f176213b511da7922d9a7fcf65e200f432175d14856ff78a273e0192ee1f449e02e53ed32473efd75bd7a9c064288d3190dbdd96d64e985457f820e75ba818fd36a89960037703e684d449fbe9bc7aecb1861f8c4692f496fc5cac10f21cbd4b2c0fc950696c7163fee8fcde2dee9896ce1a3479ede59d649a41f999b6fe4ce05c41692e31d8d2fb6f094aaa3825f2f3ab2f265725a05382742798586a22f362fa87a424dd2fe3c8a7e9f95e2b33d76e15a82c69282e658efc21fac5fd5f2ea1e94915efefeb04d31fe913fffab9de0c5614741054bfd26c5d41a55554098a0a258b66e8ad7787ea2425e1b83db96cc8aa4721d1ae00b90c87668e080588c866cdd1af4406af248dd691a6dd23e8b5a8d616ca3d59dcb2a4c54ed2510928c3e53ef72747e8905b54b6a91517ce3d55c7ca778a6c407d6d8cce718025b37ceb045789f5b7f0c95870757ef231d9b85a04b023094b753695820541e5493e83f169b802e3f68fa0b15570a5fb3708f7941bfbb3ab00e8b302620ff060ae07f63eb345001b52691cb6b90893942b4f50b93141ecb5058097ff4f4fcc39422b5fadb62b7b51d1b8923344736d40191d5e06ec5b0ca7afbe51664c89e8ac462d9a4a8843c1d9c53fa039c26","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
