<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"5301f987408802adde1f997cab9d3bdc653901381965f2b166b8350bb0c02812ba3fed45663df7d495df03417e3b890824d3aac9b4400d1fbecfcdd5433c77611989c0dcae311adf9f85821a70d2c380d283a1ca0d8ba26d14b64bbb9e15f20133d1ea777e14b51de843cba4816b95096e7ad03f2b2840d359bdd805310eaa51fe3f68ade8450987d6d2094bddca23d97522732dceec33f4c3ee82de5ec4a15894142841cc3268bf91494a64f156c0b8ec64e4c9d4efee567d5916a3e853c981bbce869d337ecf9e4290b0164b161741f92697f5c816ae0b63ebaad7073e2553b27db2d994679e699bb4b5c42f4eba346ceebdd0c9b2b4c83baa40c91628322e9902bc1df4d7323353746017ef27d8cd9f07784a00e64d43c7665c37c4e96fb1ceaea12e09914f766d816a5dede8da9ba943b0953850d93b8bdf7ab633fe147fd0f23c9171e240e4dcb56886e8573de6b3f2ea8d6ffc9db9acab84c4dbca8b90af01b80c120ed1de0b71ed006fd643714f7b03d98c36837cdee00c920b30aab06e269d06356ca3c4dcd3243da2f52d9daee44b876e657bcc6432bc9b619e7fb14074e962e4c254821cf83e2d3e249482c4fde9ac33784ce2ad0e0157c0df16c56627d03df241b25e17aa92a9bddcb936e29429e83044170e43be8a39c033a0a949bbacba0709fd48b13b14235571ec5ffaab94d03727e03a2e9d9c140220c10cb8d4e3efa5c3d7667763f2150641a7fce5f05ac4330f143191a83d862b5a89eca33539c0f97eb7821962bd677c5740c93760456ffe6b0b54f7eb128cdd75f717db92d2faac1c6508fd984dbab43e19445388c19076b9ed2097019aa4f382dfbe738ba79c5330282b2112d78eb7d94ff6f41db352e6c7499ed4c0ba1153f4e32c896ab5c7716994a0e0b3337cc75eb12d329669a9f4ea57129d3995c98d2a1be7c02a7571b78725538f392d124b7123c30aee6f7a71de3744f24e640b696c22bfbbc5477ce86b929ecd1c1c102048465abd7c29b8d1a5006e80ea05a04f41d1c058f80576e681901edfece48a2e6c1b4acf5f57b57030f67655298b89009cc008301ca923728d523d5cffbf38c1749bf70c610fd9e92aa696b5b9f16a6b86935aa1fd57d06a4cb6d114ee762a2370c0ae8b07ea2f00bd98d8ab1cfac38b23a92c9425494bb0f4842d52b2794883ffd52a816ee43322538e5578ea71ec6afd03fdc84d8e9b0d2e193dde6fe6d07f6bf0ee20928a25ddb8819bebc8622f70106546076b0cd77badc876776f1d23cbea8262c2881def581dc5277ca3f4063c424d995575f8e6d5822d51bd6bcc830bbee7bc6dd96a4d6cebb8c19cd13422323802d9d649434d7cdb1ddbf8aef34b504cc3938677155e18dd1d00f9a4e6d309d06a14097b24d5da8c37f4f0f545dd6f20394ea3254c66a1324fe56b19d68a657e8c6c88f42e90a05b886f6c2ae3d3b37adaca6d452209abeab73b2e442933e162fed015019541321045489de34674393696e4ccf8488e66792ab1a011e154e2a386e76bd9a7d8e6500036bd0629b04c39bd1e1637079b6d05fcefedd7fddf0f6b3462954d00f945bd9a780ddfb62d37241d85c10784718a67b6a414ec3e3812705c43ca530b97b1efffc204f4661f1768457beb5d8ed4b1557ecae8cc0d050e2aef91464e0913961034ddee9b7d6c90729d8aacfcd71e735b8f81d13d491c80cd8df739bc0ca97763b88e683509b36b6f0fe2552b9974e5278dde7f3e3ab508422cb9f74df1bdec05cc333b56bc8084b3f3c2c9a9b25119852b3081260bfdc9a2dfee187f09f34209bdd67373570b31dfbde37032d38777e221f19810ee3f09a318fb415f9b26454bf5068967c44593a4e5cdea84ba9e802271aa10d2139699afab450155046ec367d31e187e7ec969e524ce9c03d5ad7e3f09d0ed17f70e0563ea57eca839bd7e9f7a0cf5892f8d1c2907a99e23c3ac8e89f7a9545981d21cba69a00d26a03896eab11ac39a266e57f114cf535879b4b87a37a21ad217af69ed82c2b9deb2615bd6e0538bd5e77480e7965ecb055b4a90cb7faa949b5eb2fe5f86800b2eab9d0632a7fa23c2c0de778d8ffecea497829bc6305210c98db48a1465c5519b4a8bec66ea7507582c8d90ce2b69a92db6d54e0c91f30bc1280398315d4971108b4e81e6d3025a03d79a39c21f418fa2e8c1158e1796ca1e9874759ba2138629f4a0f4031e80108e114519dd474187c982c0138d89bc7afbe7ae879a8aef0ddbaf67cd86745441370347990c36cb773b47cce37e874eb37083a581c763613d0d3e84b7f699eff795423a94627dc70aaf3ac910c9e05e923d460e9a05a5d03a170b448976b03815d2e520064e6735137c1ddd666aa502d1142e378090b63201ff71c1c86f7eeb522f1b397783c8d8ee339cd15a528f5bba4028fd15d1094b1c2f5771a458679d0428711c07e86d11d2e6c6705379c168a729f17e380e3e3422c983f879d3ca95671a99f84280074f16a9cb5e8710b3ef978f248b6b5566a565ce56b8bb5c657429265cfd3846e44e7d9886bccf490b46f7726b50fc75d9a08615fdc461482c7d03843615c0b454183aa9f60791fd78d937d2578fb2a060e9e9570c5cc7ea455fb2f6fe94ddce94b83276442a0badd1273bbc3c4cc383fd18c9d681226c21ee4e31796c03aadbf73811fbfbc94a1250b54ac6034c55b1946ae6c58d18157f63783de0ec385dc949bf38c4723a722beb1977825613ab51dbb51c042a5daf0a2d0e3fb737449b5df4895a2e615f89758466b18e66a620f13f75e30addabc4b5631e7375ab69bdd60300666a0d02b47052c60c8455cff8be6472e7ac36000943c358e349c533dd29790be134f4508fa2b49bfecda650e093ceb06e69519e6160976e9984decbdfaeb2b2f98f03402fb34c873a6ae7577119742d91f9edc06b32de59413cb80707a90d3103a959473863aa316ab97835582e37bd13d6d7fff965f01c00f6bc296a4c1ceb7e53bd6adb955fdab17ee7dcb6c061fe544dcef03098c24ef049cb96e4d9cc9a42f19dbb8dee7e9986b00d94f2c26960c9e9f158379bf6b8b8b4556e9472b769ae381dc78551f31ffe444379efe80a057a24f66cbd16e36ef7cce554572e4e56ad74089a654f9ac8383f3322ed5428d7f5a14057dad6e6938075fb0dd43ae95cc7a591ee2fe03e350a35b1d3c6d8be7037cae2056a2d271ab94035aafc110e1ac2bc500fd20925508cbbad4a8d78ae49f4d6f0b951ed5d5655457ae549ab081c59e7a6f6324d4a920c1d0622e82098accd31ddf1b30c050cfe51cd5fcbc7279038d265c3ca805b03d61d0f71b983e3ee44613edae86e27dde413806c89fbf7cba464b69d244e29cd9231220b6d62b3fc6040857000d2a15e02bd28a4a6ec534f619550749ca17e0c5befeaed84cce3f0f49f6c195adb54336782cfcc064ee36e7bccbca508f3426679512019ca9af0f8e3f126cdc57355792948bff6c105d9d89476b8301860a4de40449c795114fa7b2ffa161b9e5f025570354f6990e977845222b7ef649bd6a3b316dbae74a18926546e58c073e0a864f5cee7e0a6efcf4a59cf549a3401c3b064aed7443d3ba79a62549e165c0e293449930240eade4d48684c0cbb95b6c11c1627a0feeeb3f1c38b25ccfc33466d4836e09e2f3a99287eae5e9d8733abeb54cb0f78c8afce1e94e163fb620914a12ddfe65f65b30f94705592afb76cda4bf1dd9f0a2f14e53a2a0f582781a82d38406af7f1566b35f18045cbb1bbd3e4550c698a2e8132fabd83ee238ec2b78d17108ce7db4dcac914fd3af8eefa12aed3cac80efdd5b1b068303537df05692ac83b73aae8534a590fd25439bf5a702964f31b99ad847765f9638da49ed347a1349f6dd54e5bf220fd50ec455cf602d6b2ae358b761b325e09a6daa0f70cf30f1ac5eff7ac75713c370da4eff19cff1f182b7819f7794dafb8c7a4ff7cbe486c80594e91a4b9585a499755e76f901be45a1889194bd6af362e5f7fbb288cd3708bdb1098ff86bb9a3a592fcd8150f8cdc3fca0fc93f8aba2853ab602639de6b05f03f2107ce5fc5a5d6f72f578b443c71a7df67831fdc10ea9ce4425f3bbfcf9e2d76c192391fcd27ed77d5a35719a5d554db546c4cc0cb77d065e3aa5d22e1521b302b949da46498111885de197fcd7ea30e54615aeb410e531c6bb3735ed05b25b383abae3dabb870ab9ee8f1f91c5b0e4dbd96764da84fbf41976e5a1c317d28329906d65f267019462a90f1960d2ba3e6958446cdb677000d52e7c1ae255c69504f90a575ea439cd9d0f6835730f9d62b10ce4900f19a4064ad93d8225e2ead7c2f7a7ac378b33ca289b8a5250ec1d7c133919459750f6445179418290494489ff95dbcd9138867ce068b412009be9848c9fb4b4fe2c95eabbfbd1679a278c5629f85892960fe0bcb1fe8445b367161becdb8713ac34eb6913fba080cdf00cbd2f14fcbd791b1d67b5e1198281ba720046a6b2838fc915c187a578a96c55f75b74b39b8f7b619471b9afc925e4737d9a97ecfd4318ce8d9146394e1f0d13a7ba43a2634e0d1427873a98b6c4ba8cb33c5dba6de7abaaccb719ba1c39a785a6285395aa3d352c596e4310561fbe924a42e774ff05117e031ecbe08a4c5b5565344f5064d4bc7ea59313a34c28b2e4587047097ddff168e9c02ba6de36c2e34906296e03b3006acc7741aaa01995b443aa9a44df832642a4f5dbd7ba4a2f0e23e7699dbff69885fe8f2b216d7729ca496e628b8cb4582a675bcfb9abb80648767d25e0b8b0a304a1c34cfa00f264a2a6f4116937cce86d2609ea88c94fcc78961b63fa6b0e14cbf981cc5099a3622afab659a59d82ec059327053cc59be1594ce783def39684791dca27b6f4b609d39fa7f91993502d31d962225be8654137b0f2a9e4e768632fc50750026ec95acfacbcf13c3b6a85f14c24c7cee06c5aaee0f9b507055d3cf956be3c0d4253637ed1727907b16ef32e55f2b30fc42dab874446aa43034f2f685ae7ee0dba0dbc21a76d3889e63348235b64a763b10ae4e9ea3e0bbc7c7c4d12cc6d6e6afbfb69ec4c26ed5577e5e1e756ff0c2fa921823c33a232eda2411e61e8cd06e83ffdf6e2e97685180a9fff250db7765638a338c6d362b156ded5915e0ff8a9a95824a35be3144ed1589795f3997de1dd75ef0f2f63b4458185efd163a42388e0f5f07a07dc365ef8f8300a8394b86c140df702a064fcdd1f16845394bda1457550ad8ffad2b23e6f3040aefa12d5b07a204ed9ec95be98dd442d7453a81cbf7304fcb84dc7427a6047e67f28dd1da9324f3af2a4c19ab76c08705b4f7bb329bb1076cc7bd51cffb94ad540c205e31635063240d928261e7e51ca8cb51e39c5dbbe19ffbd6adddeb70933fe0b370d53847affc3ea5cc27c8bd7aabef685f4ae73056a5738e7c18d84f8644f9ff8ec91f98416117a57a5e95be8d1efe92cba1ff8eeb9bbe5886b2295c004bd85a58b7ac11d895df811db036b6f4f08e40833d12a5fa0dc36fa9216956c2d2640484cbd0e5a5b296d6cdf013b0a185a61e703224ea9009e8f3d5c3a361d1e331802c5fcdd3ae170712501d05a27378d266a46776621adf189be88867916785e70d5f34136f301a94afb795e49979f289b407d924b3fd38d88c4823a0988d30aacc7949287d2d81acb22f1598f4bebd8b4ba7bf2115dfa0e807f5f493d061df33a7415cc64cbd8bd32edb439719fcded724194f87f4db29a615bd5fd5f883275e4244eee9b1c21374faa54021d4b368e8cfe810986f16336b22a0dc7191b990baf8c36a8ef04bf962f2ef390f592bdd8142fee4442ba9bb67ccb5e426aceccfe90c0b8723365515b815bbdf018113117b8973d7c03b3aab4a0c74f2f5ba44543a0aefe174fd923779a738de00012164e954e6e3fb19de311fc53398d3274a4d945eb62ac6e15add1d8bcd536db9ac2900f0ad5f87594b87445fb2522df223848bed8977bd8da84d140100804599b37a62487f8c2f4357204357ffd28e08206149455986d66e8b3821f17d82c8699035b6390eed446527c9df27c109a062b5d1ea9830577c393c68b78ed13e1ff8f82c37428c7b87412a0e5ea36fe1e3a91655cd7e8d6602957c0cb6af5c87e7cdc6560649c108a8811ec9fd8e86fa4bd35b009038e5c573fdece92e0939d25ffa7663ce783011b62dd52ec1ab436a1e9fe0a1fd5548082ea6718a29b16d2875d9600c5a5324a5ce901429a8db6e09aaeacaf432edb8d0aa9c0bf152103dae8bb07e457f9cd8c6b4a465231031da9b35d7aeead1aea017198403fbeeee458f4485c0c3f6dc25dfbe049fd30a5436f1494de1ccdd1ecd71f69864983cd3caec4cbd6ec44387d90b5e5d459bb2c6a7f0ae42f5f4defda6e68dc5271486d270729862d14fe4c84e391a2210a706ff4351c69104f8cc59a6b00f67ab4ad4f56ce187e86481c358ee9235a08e338e92846590e3b62c15e299f8236bdce7bfb79257b3d2fc1de19622f1063e4e3d39a2526afebf49b2d3c06622f3899129cb8b6b750a3d52f2c88ecd33ecdfc9d39f90fa749628fe5b5f6d11a5d4feaca637e92cd43397bfe9415563a19d3146449633887b6eefdaed2f4dc3c5e3056b20294d402d55c81af22c3bc975f7aca295c7303a93cbdea9fed059c44e1d9f057cd9599564bdf9a1a39b9644a421f65ccb10fe7492b11eb0dcdc556a83853f0fcb6c7ed663d2efc4cd87cd08f4679056585e0e094a936a8df9910e7a4997ed771c858496aa88553795422945c9600f27485c9baf46cdaacacda3bf4c58e81b4d840ee9c72a9601576af00838d9b9d658c6961363c1b078fef45299fec38fe4db844663bb26211fc883e60edbc5766f631a95b10718d7a5e756fa7f6178c5e6a40a4dce3d50dc5a622c1c3a931609fd2ac29c2ea8fffee529c4b7a89b9a27e6f87928e70137ca623dd9ecf3febb7f28ea971c216283a243b82c058d0570f948785d008e58fb85d1e56faf11a838c8fab368a4fe6e43474f3af53e89a3cf3ad1b55b281d1f88ae02878b9cd44d7fde1c4968edf8daeb79dfa6c9a8e9f49bb3dd65d3043079ceb6ecc1c93b61c6b19fbeafe93abec2ee89d4722cbecbcadd19bb52d0bbe28c074f0022c68f4ed32c6f0ce5d63a4c4fdea7102f81a17d1788de4a78be68cd0af73bd2144fd497748dc3131832e1ceb49651c8fb8967745d20c6194099a20661be6ea7123d26543eb6bee9349635ece77476bb2a5e1685d042cfb24740637e62a822f74e4bb27a579c738ce0603c5e1ee4ce0bb9f4c1f3103001183270d7bf4bf9bdf0131e06f3a83cf979867ca663ee55b71916749bd8d8f5c49038d56b5b119f20332f423cd3991172ea5d1ea34732b1e256ac255de61c9f5702dadf3d6ab7913843117003a42e2971c96b7f526b7dcb1fe1575fd724df71d62ab69c8256db4b7b76bc3bd2894e94289f7ed974dd88855abdc6a58db8939e1b3870b7e9bc5e5bb377be649859be263cca46d37e2b2492c8cccc59c924128293bd806f13b5466933dc120eacb5b23e1b2cd3dae2011b238470103920178ff6447a5f683845eabd8960cb022b60e4f80666c837828e246ca8678d1a3fd1a2a25e2f32980f29f9948e71e97bf233dd10f84ba5daff50fa96f5a427e0bdcd6e5d9c0546b99677a5eb54b21576854dbfcbdd5b6f0dcafbb7e6320584ace36cb185d6e45551e1046f63a28e4fcc79a05047527dda28fcdf1ea4eaa423e35ae8e314d15a5caeccac6cad9cf77b276e598048c3732135a0133ebfa4e8222e499f83a63ef6ba36b91f39981d0b206dd360b7d84ead7872c836365c29ae0cfcc961606ceed5fa60a78ba2703492154f9b202b1ff93ae560145a5d24b2d49095700372851e8003bc24fe6f96ac6fd3613727a4bbd47b15feadc9adba8fbcf9f9cb13edf759e78458e221b35459034b0cb6ce2980a2f77ae7e964925a0cb53b72379543ec896d4d17a3d02135f193aa11bf6ba0bd4b235320a4fb510e79f3a0b407f9561dee4d97fcd1cc4f117473d804ae1f3f4973a0bc00584cb7755f32dc6419cfb1e95ac6013ca1d87de75777de8827a7e79802f3d2c282f445ea36c9a3a39ef415bd58502698b1ead408afdd7af3c05b935387dbd11120019dc3b2cc8d82b6ab66d4a608f16b1ffe154002d919638345127e42c26ca8b6f6ed2a33e3731f3a8cd691e4d86137bc2e5e9e027c841344470941d598ba479b1e7d8e4553e3f145b4a6e9faa345c1f37adcab8b918a82c4ced3422b16af578ab31047a16df3e640e1a0aff7dc6880681bb1652ff6ff78dabff7eb59b3f5a9ba8403efedbdb6859d6c60dfb12de7f1141f87f33ae52d38eee8d57cd28cf4df781604f58d08a5c32a5b9968c5fe58756ee8f7ffee50f8606580bb28453c78258581698431074047b6f8f2e7763f421e5d8031a9a99ade6d3a7a78f544631407b0e7b80bf557e76393dba733d030419109b6a83baf4959f5b15225701f4e80dc2a3eb63b268dc23bc195cbfd3e94a4d988bd0548367328ea70ac521d0bd5fea4159fe294990878851682c8a1711e3ac8232f997ca6a83876f4279f9d0804f72210cb052820693bee06b0b43f810c7caa702c71db799e43ce950613efd2dd1f220313100fff130b819a7ea614928f79ad576489cb1697523f69a239615dbc4999ae0d17a2b199b432aaa0e55bcf297482ba054a47f39cd9bb61ff2d7cee9fb0101d2e4331150f700b05a1cb2d871e0e85bdcf7074707f43bcf9a1f97fbdaea9bf08d16e9fd2faad63edc7a3318c62ed33563e47131e48a17dcf0788f0147beb31236f3b3c5e0ff6526f1f27853664c71fc0dee8b69116c1fc94aa9ddf7d2d370f89401f17a50b2ba83255478df743a4c7dfdab1c07b66bee139a97ebaf744602b26a52e7a9c510a94db2414ad1cf1dff5717035710106a09ef83681cf19ae912ad3e588e2fa99e657ee0ab818eb3b8e6f30941dea894bc78ec9205cdc5345e1f67751c3c4ef2741caf3665ad6518ea45898961ddd814088f1e3d2871f1e9631c6c8a1cafeb3f3f9dc2471e20274c40ba90e8435f77ddf6657249b772ff011a37c4bad5d73513a8900b02a527a80db8d9041cb96d0b284663ccadc9d4a1a2b5ce2eeb9d364aa4be0782f2ce0b37f70e8ccd11c028bdfb9ffaa0f17aa15d208ac83cbf9fc076a66c6ae0058dee7e55fd2933f4a766d707a3bdf58785dddb015e4f2b0fc014db6e05934329ffd290d388943d3fe78e19ea583db16456b0ab3246598428b4806d1139c6f2082df22adc6f230d7ea7cd5b0f0638df930c2d1d440d49072d9cb7b9843b01334baf9ddebc253cdb3b7148e721b823403dd5aec168e6419151051a248fc733dc30d0803b4b246e90f6ac40ecacd54c5bb930b063096c3d96ec88e655ee479a1ec8cc521a593775478e1a7d590f6883fed6ec3cbaaf3dfd49c7a360b380cffa24b4a1fb0051370025c520665509c1e9ada21f071537d64ebef6fd1c29d39b7b43c04688f44eabaf6f3e3c1e7920f67e6c3af8e4af45ff19b3732ffe6052f2c07880aef2176a73fa0ea696507e4b558ea098b8b9f532fc7475638a634322685c3e26bbcf9c5bad7b3d1089b47f41356f56bd017b89606988116962905629b6aa65300dfada96598072d4b2dd946a8ce5a919adeffd3f54e7206c4c9de5889ab79357f494d2f26f7864c26993c287497e0098aa8652197b8acd70eec449e9ca3556370c8721fa03b696259dc7a81723325a641dc1d159c47c07730fdf2628e181546da24b661ad8222537aa8d91f5bc70ae1b049b16e0ac96dc7f038fdfe06bdd2ba49545f696292b7ef7a7678feca4582c02f18c7cc93ecf419d526baac01eb7c5d0df8c8964e25886ddcb228d622a62464af8d50d8ebd0b720f9b9f4ec2e424f94a55f5c7be71a5d0f733bcf4ff4d920ee04407d2d6d66fe088d271c2112fb60d62dfb50fef3271b25a6b7d2bda9d77f824f2514b3500754a90663fc05ffc2e8229a885d3f73b677e900dfc85adb8b1106c825d7960f011a697c373050e425485fbb848b0c557d91b8c202b7d422d87743163f32d6d613ffbae800b8d4b310a577f82a5aa3f526ff9515286e32156366576619c51499c9ac5a3343f37039ac43666eff697fcd031694ec5e4607cbb12107b6d1a9441bb8137c8947dcbe91afa38291c39deec4c52234e5ffc605ad2149f02503a5642e002b6f46b477e8eca9c31b55e3949e82bcb64f6410e1347d7104911815d1e814db6b91da3fd6f8099bb1d091ba3b58fad303d77712239560d0eb91e0d5dd58b10c08bc702aaa607d53e82596ba742b1df59f97c3304cc730291d8c49948e377750fdcb758b54a4deaf897055154082fad97031d452b3534c93ded9ed2e85dac4edef7e83636fde8e267185a4a81aeb5d9a27635301f3e14153b86290f335f898ba7606502bdf9019e9d020710e7f3492489dcb1b44c1c2d1770fa62263be0cdc8bdb47835780606bc918c79280f903c69cce6e1a3638b5d05607c124af6c0f881fe54ab736e806d78b7b64c42923edcd46bb293f92dce65a3cdda08f4fb1a42b10bc3ace28896b47fe43592d67a10a609df7ace012fa89d95758af53d3ac8c438feb09abdf3245a08b2f142662e05b545c603593e95fa00f95c10268f1aff2af11eb9b5a791c2fd81eacb60653a6e742d29e9ed4292babadb0d862944c81a781a03d8f350c64f4fbba85ac0296252a031da540e91a16ae615b71de7bcd7b8b2e7614153a53e542ce48776e9b9d078704e41b6f87f9e6234494bd3b41f43dfcd4294e9eab3750adf0aa5971ed3fbeaf6149b76eb144fe9ab3382feb8925ea32bdfb486ab7599901c59ab18adb318c629bb032b6fd49a8bf154c44fd378763402b3119e135c1a2d0653823777bb3089cc9053dda0c6f816bf870ade44a6119d91ea69a21adb96fcac962a5acd3782f102eec8807c27627db1dd3f9bf1c36003a3fae3ded3992d30b3c303122588984dbd646b357723b35ba653e524c3a8a7c142e1eee54c07387c13baae1e1bfd5aaf23d381d309207be31dc618e3dfd13232999f8be0927778e8d3b86d6642d34f6d86ab44880d3fa4bd0893d3ccd3429fd7c350b7cc3454fc6f3cbfd8ff5859578fa0de4ce8a683f43f8499a23105878c4fc41c352456c80a7d612aaf9b19876de629006b40dcf7d0110d2885ca7bb00b15fb69272435c14b69b0cd3d8d92795e163984180696b34422dcbf7aef1261476846bb78a850f9a8711ee867fb68d119dec131a5c90b2d9624525a90df30d77fcdc6e41feeefa290c325c87291d82c53a160d489cad6a335330285444b5945ee31c054d0624b7d8b407ea31194e372550e12fcd009ec0ba2b1542f5be6dbc7c309bcce7dbe3989d5a3464a75324eaafe39285a1867fd00717e878e9c668fba087984cba032c391f81499c1bcd980828ad4858b7abfc1aafa431b9193d3f6095d4640199dd247db4598b5e144542aba89c16dc890fae663f6a8ae58ab7a9c642753bc76db4f8d60922ddf918d79e04b183694d1747502c5d7cd1bf1ef18b89e6edcabfc5dd4ec3dd95b7b7b0eecd149c4b065a85505ed1a969b788eeb0f7ce756e58634fe8dcf4d508c4630718a8841f3c61ccf5537a6e98a82f2890e744978c7882ed5ca4829bc18ed4ed2f07359e16585ac650a1cb9dec174a6be2948702c36b17427ac241ffbc0d7e39ead9b413f3e7c3c0c823e576e781d3a0c67944236e701078deae2bf6787f672e7053be95ad27bf4f81c194aa0fa1f4ca822ad01af763d920bdacc4e4bb51e0237af3c776a6babfbf6977e56ed9fe8ed6aafb317b9cc3a3b01cf423bd8a2716ec6572fc8b495b133e671e62083e14bde02bac53c5c55649b623485fb369400b1aea485c62d4d6b3118c0167340dcfafdca4001f1ffff2ea38f16d68dc175bed4aaa50452314e22fc0a9abecb755d6b40193ad8db46348c161cbfb062c5f2ffde97eb22134db6dc6973809c1ba6a66cb6d14d7b55940577fe4f66d4a90055bd86d97e3f9601eb0d13edd88651362a4834e6db7696943652a23bb069b7afee6ce5b10328ea1565725d032df676e2c018006af5ebf763c0c7dbfc2850da3adf4b5573c6d9293c233d13662fdd87e3dd6277c2afb9f31682b8dca83bed91232cb617fc5ff57a169c0b767df4d68536b77069906db0fd5aac3f20482927173246132e8d09c92e7803d307d37fd60df499f840e15e33041005d33c10c51912e0d2f52583d4787fe69eb5cc6dfca4c3228a26f7b6129cc8aed6c8a35625cf7878dc97792a2baf4a6404c97477215419f8aa74cbff2a4309e225ac340f1787ef5e5d20c1b72c9ad3a5ebed335b99db5d872a4c11cfcbdb5c2d2906f7b0293e3030c2a960c25d4fa0ed498ac4e2caed9231d3930ec334b2867eab54aaf1c9d62154e997867207b14694f134dcfc53011a91d7368f97079e399c842f9591b4e1a8a71e5a758ecfaeaf5c61d4cedcd4588104f3997a01cd9c5af477a8cb52349ecf487275b620140ced3d6fe38afb0948424e642788131a380c728e141253593443e8dd411eac65aedeec7ce063e0e0a11991818a0150e2faa266fe5532b4568cfd1468c659208811b0b6300bd277fbfd47273490c1d7d5345e4313e65b7d8d3104c27574b5564e2a8131381cce12a341b3745cbe7aed8f04f56e3071f48cdc5c86b5da206f72010fb4662003389edff9841a872a7f5d2566a73c4118c60a4e860211583ea46988e86a495ebd72f2ab9a55ca9abdfbc2f4a8d724918d3c624c1f2aff67cc339de07e405f31ed4bd2720732211ca0c07bf09f85b877cf48b51a2b547e2e143fac7d6c91242f297658b072fef8d049739cd7713f336ee9fb82100ec89b6de620b06bb008ea5684352383b409fc4c110fb374851de7274a43dac86141c5f220dc1fa717469e2851a0933f6d040e477bcfb90e343512908459244f9a8a0df1c3fefe086b2801a202156ad6fb24d3801fe308ff3ab778555b7a31e22401c0761c59621c4d166d57b09f938bbeb28b64974d6fae615a3cc080de071c4db7bb5bb100a127200779c5c7ca304c14a92d1989490dff93f45094f0a7d58e932e14c6c21fd30dfe666a672bfe6f393507d38b55050007a703b59a38799645d49b0070b76b2309356040af1d2b3e0a40bd1a63866bed36e61c8f7d182cc86074cc9e6ec929e6cc3aebbea932cf4f60dbf699046c089c6f0f77a32849a80430bf38e4de70a4897f0612df931e0fd3589f1e33d7e98d29cb2ccaa1add2abf3cc48ed7e03bdd40dce5b7c4200e30c17fd3c0e41777ed0ad8f3b431e5b1504094f44bfc2e21ce674bbcafbb7d8a83e7a4ab4c883b2de2359ecfcacc2e20742be01173bbfad6173abc854dcfc41ed392dc938a4767e28eb22e31c4abebe37d6f66d683bafbb658911a106014b2dc7d01170d9ba0b70fd8849396886b6587339ea5c1801c4faa05cc1866eb4a42cdca49073674b6741df0d32187fe4daf2d815bfd9039e699661f0effe86e5b2f0fd876a9c5ac8d933f5ecbdb914ff3efc7bff94669a5169836d368c256dd84147b01c44f66c5cdcf75197220a5f745106c090d2f22276ca8eaa8e1cdb3722db459163b04825e43f0fc1c4d058211a1b037b1e779268daa7dd7f7d42a20b2e319e02eff7d5e163bf15e44ab3e0b60d2376bcfa3c7160ee5544a386e6354eaae6b4e55e6bca34cfc61c6bdd931f64dc30fc9aa41f85f926c9af88047b1a2e838b78e54532cfbfc5368d5dc5874bc22bafaf5c083820b1971f0833a9655459aff12857f89c2f3956f873381fc3af4603b24c2dfd9b2c55d17171ace1bac54065797fcb0f88b20b5dbffe46ab273b5b0493048368e6f62af4ddbf288f98a643870fd1b040d12aa33c4abc79975518c0aebded8d1a287768b859cbd78d3ba86d7335e4770b2533e1ae01a9a44aaf7fee50ba30b1577db206da256cff6d62e0ee06f4e82fcc598dc7e0bb44441ddfb5520adf5f7feb82d50f93b8ad5543c00f38a12beca7016da96c34b0444374ab88419950c0927a258f0b398a76bebec123faa1377d486e630eddc57b252881918fc55fb33153a733fc62c6f7f61a66f1fd2cd5cf539b2988756d016569f00d3841fd003c3a2cb35961f875a201d9c4b534ac7ee1e763a0773c9355f98359270d95a1722726ecbaecaac5eba211c59b4917411fa13009ffff8448d11f323c83ca96273cb3db6e2eec8e77404d65fbdd553d37f4a65576e15748e70e18bb1f4db79c638c727137213e313bdc2b56909bba1de02e911f245574a75b22411dc00eff49cbb8f4da4821d6376da6de4077df78ad646773f9945a0d1929788d12b8bd2ee1f9bc912ec08e3f4e3aa6acee41457c49cb0d1fb03b412b5cc6e376909c68c0459041bffb2abe58eee1078b5f9b96a8a82cdc8864c4430312cf43542a796ff91d89ce9c5831ced6a1fe410f6fe8ab8986d74e9ab5d995178ce781f82be527225121d355d27653d6ff493da35bc5047abf0315814865b8ae7947a21c477cf09c66d605527f335c0d57f6b4ec2a7edd8cc0b14ca3315a522bf8e7b6ad4f7cecbf4d1d693c0424f4c214e5463b072879b80c7b59e8405eb96f7ad3f366108019cf601585d41245bf5f5b2db208b02d5d6853af7c31b4d31f7055a00b90543179fa9c0ae069b84beaa32e1f0644fcb06717a00de69d28fcc662a9a9cf37db329cf70a6022693697ef57d75cf9f866808834c366a45df51bc872aa4a138a8220a0a3b724470b7960149012b93143b97d5f0d985b6be78d70aa8fcef13757f2b690bfd2d630e33ed09533623f7e9d5172343d9c81aea73230a12974c9f50058efbe5f384dec8e4b7d084eb906deaf4b26393b1c6d9d4870ae180cbd259b9dbbc43842d8335c920d204ed02964bc90a9021e65af69dc20fb22c5c303cc01f1c952847f5a929401bd6321033aeca260833faf5fc7541645e5cdfa4a5fc1b61d22864dc5552b94b1b902c3df8ccbf3c78fc559fd434003624f9313bd7454e03f5bc1db6ab05d36235e628f28376b6e6b463a9fa1a2ad4a0af5dbae1967542bd43e7f26560900328608b15c9c3a60d142da68889da1cc1519fd17040f71e7dbb0374056fd8eed025a1046074972eafb312ad73ee4054a83089fba432f22e51e431d649b0e8cf7969632c66c26707219239343e6771f540c97927a725e6c035d325bc980aa72c4d5e07ac054e25b9b0bc8f15b4c82d74e211ab7aae1b761b9b8c92b316c6a8a3e693a375fe49c830f994cddf9894f74d998feb2","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
