<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f0b50fb4f53e42f504afde87a0baf11e6b2ca483d16091e884aec5a40290d60daf6f082dca598920a88a140dc5436a92923ee69dc8da3fde2d152df8d43a24093428e30fc060b2bca8c8b59079be1d6a4000ae8e5eddb980e98ce240b8456cf2bb2d4220141f2b5d5ae9975e3d7a5c7b796001f190affba16beb8dd8d393600b39e651646a2b8ffaf18b20e907a3145e36904d40f52100b3dc49af6f3f2b6d76e82490270174ed8561a7028ffe514dcf8ba208309412fdf429ac98b20c259048b1a16ae6609bcc7b5e728f04abbdd073246aa0fcb6356c5685f10f5162b2c62cab30b3e0559aa74cc15c2b9d84f595f10918c4957a365e96b8306a17546ff1b0598c5dab7bb94a0d64e8aedf405a35206b7c2ca496535bb2e5d456b3da568a97395ab6ade9358c898642d2b8291b4f67bb05bb657695df398229a70ddec1d3e408ece1ce297c0cdf12075b48f7d85b11c120d777bf209b595aad0f70003ba3b5fdacc8c0bd4e16d86a554d353c453b422e3c8bec630f31ce824c7c75763a898983f266fcb2c7ffa190627def42ed679492a3c8bfacf4c217fcc91d86f1b9c1fb20cd1949f5d7da096b0eee532a3c939e3eff2cced71abd8ca97da1d68ceef069335a98d4ff78a0f799657339381e60eba025b1ea5957417d0cf707cc50543bb0d32ac142558718bcf0cddea3c9bce72d95708bb7166dfb4313c8ddda5f5b50701d8da05ced9072602f1bbbef69ebd23f5141ff6ce4d649a70b7c77d8fdb80949592d09f31916eb7bf2a5d3c148d993799dbbbfbf93c70fb8a2e35b8af9761516f875681d2acae786c85c200d1974e329bf76e6d4d10152d613f1b320adb924b2d1ff6e794bb983ebf50d49f55d4a66141009d8eb669552e9378fb43f323cae6c56f78d2f1e5804801bce51e21c1aee114dfd6b5e73cc80a56bad6fb3252324789001f8fc3a91f30b487103072192d154537eb5c0bbd613909c0838ca370085edcb98fb723f1ceaa86be86c5a236bf603c757b364209390f76417944c0500d70de4436415d02b639685f143fd19a824ac14e930e3259083b63e94fc7a621ef47eb41bcfa82f5bb2be4bd81948b8a662afcefe748d03bf26a2d521c81f209f3a6777158c4278c3088a844638a50f79c72dccc2ac40dbd28a4d9f47dedcfe4c4d962f042dd7020349bcaaebdb8c26ca11eef191635005de48fb14e7573e63d66a10470615485eeaf3a0219948ac2b52176fb31b5aae64488706f5b89be609fc05d3790ff500437148de40a943b260135ce5b8c1c5d9303415ddab438bf038bee77a88979bca48274d9cf3fed652d9eec2bf17e13d4006963b151975637be52335e279c96d22581ebf3ed6804667d6fd00703367d79724308fbe460c711383eeb1add360e42345664e5e7d73e40e871fb4c55417ebaa5e84897e80ea6e48bc0cd039d1f9afde8f2a1dd92ef697643ec4daccef42ef4b12048092ed9996131d68fa79c863658f98d54cbb1209d2d6e4e37022cac28df3b57bc595374c0b001b8443aaa176b3f282f3c0af27f053f6a3e8d68dd5202e6cdb75b772d39b16bb84b0ffa3e29d0f13fa11dae4c780d3b036809cd2398d39f27c57451fd4c4d27cfd2f9794655db36630a5265aebb1b60e4c516bccb62ff46fe9bd7eeb14e0c27b99543fde55f3d851db76e67722eaf5682df84ec70afee665c4b6846d6271c93a599156b86e7f44663165aa39bc6f7ed3d4d583e17e4368b3fea449025681cf4728bf4d155c1a49b05e864fd9a9b192d321dcc7ff550ac65fcb2d78c0eac574100d612550440c0cd5469698395c712615cb9d29328de92903d760c4798b4d076658163e5eabaca2f659590035e7b51b321d977fe2e63efe1f573bff16499666c120532df9067ddce4a41ddf1b44a4592ac6096d03e7d320c7e0a30af2640abbf3186d93d520db6a7db1aed9ac9b62cc5461f7fec09a5376c346d0db0a7939f779d15cfc1465c3053b5f6732cc6ee2c83d8f37952d14033ac7265979fa76f2323f235ace0880c390a34d2e8f90f50d9ca38bcf36a7a184d8d164f5d931841d448d69bf7ffde3354fa1ea428cea9a5d94bf1256c68bd5511d9a1b73abd322c3c711d8e4ab5fd70067fdacf335267765f980cc890fda6b57f71df722b0bf8492206658bcc697da3980def14122e5f2ee5977bc47bcae41458631b28f7f16da4554598c415fcd3cfae3abf0f21322071ca20c8fe9a0481e0534e61c0f9b2d7db4ca24c3fb72c4daa18d95cbae33e3c98bd572bf218179ce8451e50aa2e12d80da8185cf9be5e8b8d67b3582e94ec6e23ad6ccf99d8809d6879e74adbb49bf2c2a4eedbb5f436f1aed588178b2831ae6ce0d51848e3b26421165c8640c2394e3f7a1634301a6f38b46ab9bf11166290e81cf16b0889ec69a36d0eb7ea0047d137eddc301ea1ebd8977ad70dc927356cfa8beaa215df1115cf44036bf4de08b7e6c46e4a20b5c158aca78831b82ad1f17f396acdddd80a8e88a02de649cef1afe4cda053769b5bd4b94383c3890567c7e085b15f08373bc8e13318f0636e9a2d8f881c792197f6368e24c6e14cd683e11ac9a645e8757a27c266554fea386ece5e94fbd6019cb13872281134cf78373184df5f297abfa3c753b3f31e33c59e8f8d86b3ad181896736506a9ee9604436cd8cd47936f8991e5884ea936894d9e084be9dfadb1d4626a122f99ac1e703972c0fa6697a9dc9e6071362d3bda58e38ef84ab66d720a9625f0c48ed02a7ef5213f9edcf4c7d0f291b6993135628b32dd69b3c03c929a7062599546caab0ed0c46fe952b8d0168bf6cd6d95be2b2f4be7072a5f1b372091d353cbff68615412294fcacd068d16485e7430ed2467282830d83ef5342584fcd824c1942e131bf3bf5214d8659ca8a7915e11e6ddf4c996fcb98767e29e672f6c1a28b146ae3f5e830421aa74a6f819d2f1311e7cb660770b578d087ef083c07b02a807ba590ebd5d3fa8eeccca76313319cb17943f6334c161ce824d49c30a08d0235b6ec6eaf0e4d87fb024128e7265109a9167da12ee0c76649492d4f638bc39824d1d77512318a3ef7506d4e24cb8408c8b93d5f6fc4afe9f75b5f4cf62db1c8f7ce732ca003e25319bb870abb55e0d7ad9ca2f07c8e970d1db0b3bfa712e886cfe0a70106c2c94931d59f4d713f87d86f475c859c700692c3bbe010a3fb91265e3bdf47d61e573cc34a241023147a48e8868b6c96ecaef220767d565f5533d3556f326fed641910f67a5f822dbae2f8eb1e3335c2955092c13de3ede94f07e3f33d7b5604e65d26af39eba5e05c43e42f7503abf621cbd28eed3f8d09deee57544f31ffefe9229273a54d7d168ce2410029b33adc225e621ad92ae9a7d4ea358770c9d2ca1ff530b989a55b672c9f3072e215b5472225fa589e0da374e3c5496bdd1494d02515be335b9e442405a72b552541fbb8317e6456eba0d790c3119ab3159f1b1507ee6261894e30e38ddaca876adba1bf2b5114d8ebcd4927a0a66beaae4159cfd5456f217d594ed5bf3e490ad31ec3aab5f1c4b61dd9bb406bc349dc69613081d2c6dc8cbf9d531c997bba69163accbf1ab6224c50d28338bb229dd07c150fd802d3d92c2264a0d547b124774aaf679cfa9f3ebdff919f0ecaab1dcb0e6af5416c790d8a226abc44554d0e2401fdde545e10b4981aa44f1f793c85146869dee62943d9baf5ae0e576f4fd74bfea811cebb76207d964000bd7a3aff683a35034c1a3a8a716b08ec444ce02a09fdc73d273d7f79e632cd52b054029bace91704292c9667821f8374420e0dee38685e4de425625447bd59c4b7ea4b8eb1936ef0de78c597b00eac6e1f8a8d7667bdf78d59a9a75e099e44679b02460723bb8bee5c25fdb12f5d576c07f13b11e3806a787e3aaab8cca962e2a4166f00299fd1d0d12c6aeff6c369aabc3ad31b9c7d2ad45a2803072bf12afc64b57a063372c25665a1846d8dfc535a1d49a47950e5eb82d2ba373fb4d0405c55f28e58edbfae702d7befa070ec5e943f7b88c9f9a8a7ac84244b42acf9955d3dcde996b0e289c5babccdf691264117f8d8d23c612b3ec1411cc11a816049637930c83473f36783dfef01db3d266d94086a56a2d346bf14a2a34b66ebe0d19f9e7c70b6dbf5dc8f61a172ba1cb4b28d9c1113ff951ebed18b3fb32b375f5bc96b48a2bf949ce285a3f70b4f497ca4b7fdd6d3d6e57d208fcd5fc21ccf7da9171454ce67f77f492de4aef51d50b27ff1cf7f8075cc09969178798df1e53d25410795e79a386dcc389098d9341def368a22fcb3c3811d92b9471a87890c2de57fd22137296e0b43d0c7ba645a261fd157c9259852931af1b88db95764ee7917a72a70047e1115f4a66d24ab4663fde3c8404eb071820ca288135e8edc419a98221e182ce1764960888a03b771a5a97d491fdab69f77c2b1423d1e7bb62477a12a89c0075fe6f6f0bacb3ac13bf8f65fd05cee06356349689edf72a8fdc4c60f675ad8fc0a05bf7639de2f0063ddcff178f4dfae0f5b80678340a46ffe3d45be1e2e3f8919296943ca70ca7a79dc3f1bdd054f82bb198b5c2750d2bb1e3cc123c1a747d8db40f40b3cc9d835e828417916b77414f9235770b86141395fc816fcc79270297cfca5a824750a36006de681c3a63c5869b3622a40443cff1387905c0f5183bf05431a091f62466cb6f0ca5aad511b55764ee3273e3db640a7bad4a14f80df2fe3edb89be5ac5dcaea446db7d7fea8fd6b74be964e7cd96198a24046c88f98178fbb5d2045964e3a3f88776efb85b2c8f92b216cd09ec49a1d7b6484bbef23253ab459eea4064b81fc2d4bcc92ed250acd6ba518eb409d443efda2056d27e96d159c99e0c3f203586c2b694bccb875dd9e77ad98a60ab38a6821c1f28903a13167caf914d6c93aa98209e44b7c221beaee914d261dc4c2827dd0e8cb7e8d304f2c10846ebf430ec9d730fea9189e97794033932c27f1f80f0ad11532b7506ae0adac9897b0a1daa2c8bd423f49bc1648bb0a865167d32aebd33db150a13a02901453233ad04e95ee366e67388c21cf7b921c21800a10e2208fe4aeec26b52fad09ff631d517254b01d1a21f55647b3df1730af75907c59281352b7cbf76cac15bd5874bbf963317bec757852302b9930ac1597ea69b8f744379944d8828b7abe278c8134872f241ba23b48ed7c8b729a522d16d66e6dfc9fa89c643808b0ae18ab8f6e046a88a6e9b83576e7ffe95f50877992d3f70dcf80828acd2ddae6d96433a0b7a0c5df17c59916f7c9ac232f59927f87bf816c6b7c1292bedfc407ffa61f2e2a9380b19b069898651c4ac218478baf8d71cb4a08d8256cef481cba97cf934c5016426f11e59b11b740592bbabb3641c39c94c725260375ab12c6022b15be4313f5217522684a990e7831d7221470e371d3fd46540a1cc2aa7ed2f0c1367a12ae6a88927a8b8d6ac1718a7fb05156893cfcdba573ed1d5d2c7b962d5bc4b0234127e492f29d166e398d105abe665a465f86eb051e7374c42ed29ce2ea557a0ecc583e36168eec3ca6dd0d6df74772fdebd4d875c1f6301b0118d533b725f47b5ea7ca2d8b587e61004f9540053244bf1f5c3194631628871263d4c6255798bb95d429118a0559a464f5107cff9ae0d4e939e910aa53de868361f7374d42069ec26b396349a247096845476b9c8d13cf792ec68132c9ad35b8f2bad4d4b51c1b0a2dbaa3894194736dceb3b14d47c3e3e7b2a319efd89c77345883ad623655983d57dad075d65bbc601f9b994ecf2d9350924722d0fe473085e8726c016deb9eceefed4daf4fe02b91fd180ad3885707ada794664680de52ee0a005099657fd49079b540a050c77176d024c7a659c065e9cc4382904160fb6ed4b1b733ae80cf01944e708838686e698c89550d86cade1b4fa3dc0c3267986b253df44164089610b6f3c98df6d09cc0fedcc8bf699a9fa1274299133c53ce60c82c34495f9dbf10b2621203120f98cea306571a4dff9692ef49526986b9f3ed4cc15f96305273e0dec5db256953538e8104b698a2f0e49aa46b7f930354fb01a2440c96cf2ae40c3dd237c13a88b815e8f6cca240aee808b8f85f10968c8b713b2c37dbbd984a17a52209ba11d73ee9cf64f68a407f731ef4b1c9ead43a919b74ca5f94cf88ca4fd429cdbcfc1feaf61da674090e284d5cd0f521c936cadfd2b5c31adcbe7d35f3f9df150c10dd0629236d70df0404ea135c6aa2dce9a1e6b24735d08085ca987f2404ce198762ce8b4e32a8e4b24fc19da6b634472f145527e543853ca84481d7e0505b9558080efe50f56f447f4b47c665a89822c5c27faad55370d1548bd5c19a4258499dd3c156818615225e44b5821b660c0a3dec47ac28db03422e46d8fdc48d590b31c4eb22f086a2e2c7ddc8cbae5797a7a560a669bbacdd994a7f684329c77f24d2489fc223c1350cd21b89dfe2086ee30c903d3fc12e1c8a336bf82faa37b2d4dca7106a533d463f00d243bb30d3d5dd74f7f62ff3e230ac9d84be32462c54fee6e7886a8e73e031916a51f622e99c6846016d46882bc1ab33a8bf32b637202b711ecba75e30a7e0f8bddf99b074838e4e5d7e6661de8eae9f64ce0127f7c5e56b755e0098054a07eaa9b46bceb4644dc57bc8a435f916489fe043388cd51a61feb113221cd5cf127c18af3ff5a2c218ba0b2fd8c78580f8931f46cca4fc26274f3d2982ddf3ed9122eb3863b57a911d849158c0a85a119e627d04eb63f8426bc12a6680fee5c3dc46024b89f27199a9d3407690f06ad845f04881f8971fef3ac30153325366b9c73deb6c33086bd239958a7f22fdf089f61f00d4ddd81a1dd7c5a582e10ffb276b55c12363595bb6cd15a7404e0e7ea5bad3abf77028bb8ac67ad206360947c9541014169dcb16ce27ad882a376adc9dd6410270b4d0c3de2f7884a7ec325d8e5823ff16f6c43f14fb682d0dc493d2fdd0fb85e69dec78fd1358b479ba0819a41c285daf72d7004ee0776ab80503824838a7ebd626250d62febcf9bca7ee42bcc859efa95e6685edd93f0b4dfae25f1a6a0e419effd3051c0e410ba04b4375726f7aba45ea4fc4fc9a7e7c586c0a5c75758ec93e5bb4aa227d7fbdb127b4aa50fbf0b240dccdee881e772e071930e00793313cb085d604f3652eb2f4f394a4a6837a479f28d0499c4f6e1d30c822f035b63808bc04f7057db9b6330404267da4aeebfa3f6f4d186d187394b1ec35f3a168d5b37096a6ccd6c7619a71d9ce331ec4346d5e44a34bf68b020540ed62411bdf029623b6c9a67f0426c2142e71673d9a1dde027ee14b29cdb90b4830a70af7f06bbdcfc71a94d281bb8fec83062df0b1e25b1877000c1ad604099a1f320fda7ba90fb5559b4ccf26f87abfe4e43ec95a597afc588cc3b1d87bd13f4c7e1838f0d1cddf8ee8fecfc0913a6aeb64b305a4e4e90e2586041bc7121fa521aadb21c269001d1a69a12bd1b82676d67c5591e39eda7aacfbecc8c9f93651a6440c14ef1312b3c2b493377dba66aa8c57a51d9eafc588b1bbbd91b17079dbc7dd14c47b8c826c42d2a72541a0fb033f569aa5f6864b25df53e5fd0c46299f019795da12c78abe910182a8e931542222c331c9483da9d027f7bcb9649f008a979e9716b5324652b371a45fef227084635c4adcbdf59b26a8c8a53c5b1c0eafe55ba9ee35ea6af32f7434eb7a8f3c32225a342d16bb54f1c146e57a787355027d3fe4f3112f09aed60303f19522fa6989b1646b28a9373dc63f1780c6a7e19c1672149103e55451abade198824fe9622fae00240fee6688e608de5baa612d0771d70f45a4e04e2e0bc56c6e808430bc663db1e8915762b87c6b1529228dddbbaec5907165102915e0c11be1d1cb80bcff45b861183ffc26f380868ea602709b2169c02d913c5768227000ba949de9d5abdcc3a873db0a4d71bab622450526b6242f7dfcd83a051664960a2629240b1e6047314293babf4609f593639e1255731b585f0ad68fb7982efc2251d5adac97380fc44a632a7dc99218539a6b0bd9c1ec51c69c9fcfa1673ad751250ae70f50e915c86af75862e9c0e89a80e93428cd7737e65573d5ab72697eaa08787bcb70638cb843dde98a241b22c96e5e03bc1cdfcb421ffb9ad23fe04286cfb3ed5f758afe187428d22c827edbb18d9c5155e7bdbc7de89e6f4775167c2d46eff2df718228babc51979d7e4bfc2ac75ae9dbc6068d8b9d9e27d937b581500a5dbe9c16884c35eb102970078d1bb93595c63202530a1580a67615da4f4ef86b9260b48f3ba9a046e5214a4f5b5280943cd9897781371882b928ef5db5ffaaea0a92f30bebb994c63253960c99a20320f5a4f43c6a83f51f1f65d1f60e1036e4c2bd28516f3bfd2f5c2d7953bb75700b9d248fdb03c50fdc97806c45d20410975b1881b8ab4e814395bfaeb061aef8c9a46b29941bdba5b31531c3f875ace5f0f2ec9e1ee432393ba76d07f9b5282a2863ff2a901e38f5e85fedd1c1cbb896cbbb650f710d85217680780775dce591148d5f783ef91208f9839f9d2acb32aa5be4214ff942b7a65e00ad954888b6db5c3055c225a08e5f187552bd06e5eb90eb366059bba29795163225d8bbd857f1690aa106ab4e97ca200dd553bcbc73b34dd5f3f5ac7404a7325c24452f32938a0970e091dc3ab387f1af2c7ca299cc859b5a5fa0c4b0a44a707bd6b6cda5cc4b66dc52263d4cf09ecaa3269ef7299fb263f0be025f7993ae4e417bf267042bd4939ba005f5715cb2689f076fe1b5d4d74bfffaf3a9da6c4ef0f9188410728675e7c39202f95c0a451035386134c81faa1fe34d6168b792a67f1c7097690d1b1b56ecaa8599f6555d93a37653ea8693a2d56250f1d033eb20beb50d58a3ccae8df5a0a94b3144ee1abaabff3c8e1975f30e90c15b7022825502e0e170313158068ee0b8ff1d265266c70e6c2270005a78fc446e9b6d00a1bed1f428ebfffb6627861e2b18c0446c06d29178d0636a1c2ea084ba095e67a60676858ec7b07b4f3aa0903ca04a16e36c18f02d2d4c12b5b567c37c2fea50f70817e416ba03f15ee17cedffb8a4cdaa40d0dffeefb1ec72e4eda8806d321733f409b55188baa40453cdd97b33cc6cc0b12098cce5073783f354181052b05668969ce689f9d88214e402871f5e6e2efd679440ba25ceb29ac29c2f7b095248f8264263b6aebaa2bd7f129b1f9fccdd84265584007ed1f4371855277685f45e6e65aade88870d36a92a07ddc3ed0b6c2df6526e3b55a62ba559b95d4d5befc8aae0ae6a621bfffecf8d9261b4a5ce459c2386807abd837f9051b6fca19a8f0799c180963537d168580898c55b07512383c9fb480cda088ab00b9297468c8966379dd899ae72d9b0363a82ea6428afa12fed6a760992760e2ec654ad2a9ccb764c21582362e3dab5766c05c94fb25e3502c8bf9ca58f065b77e8fb53d30f32fd0f6e97fb74e843a72034d5dc6302e2fdafe41c87e59ee6456f16a35bc49c61f48fb7745458e0b03449bda89bd934163cd766b4e0221400a421091487c3c713722a78b429abd4c62662d6832d13715cd506d17c86acad2ecbbd2b00f52cf56494a75cd4bc3eac78f09f444d973e75910242b7acab007f265b9185770d6c5265b4ad6b1585e83f74f25978f33092ea92ad5c4d4106349fb928ea8269204bdb3a40c5839adf598535474f7bc2a89f495c81a8a49a38b36d4d8a897d02c298119c1c27583a1247eb26fbc65a2503f5378b5b9f6d01e3f1f3b95e4c07489447256d37366dbf0c87ff042cf6786463fe9ecb310de46d88b2318c412f4a4042be4cd7ed47d7a7b79e426f6a017c793505992c1f00715644bdb71ed4c83cd4ca26d6f9a76121471b6bb5fdb734e46d69b18ccfd241bfd168273e9a732ba9b7713bc0549d753c9c8d9e7ef683129907f17586f1188493f9a3045fcbebf88a32b7f10044cd37ad9d5584843d4cbe54603a8fbcf76972a033a4157b5c2c7b4baa5ded14586cf0ea0b061303a29ad1d11865c6ae31d6c73770d8c411858e771beac7b685c3f108332b09990510404d58877825a9dff1ca81e32c4b8257f0f21929f0f628d338d8998d325ebaf03e5d81bdd92fdba439aa3b1d8aca4ad307ae20c631947e0de92e5856268a33b7d3031d167c5d135c93ef7bbbe62f51de96026951f15d899c05fcc906459d07c2de0c1abdeae94544362fe519213524903f4b8c9edc826c02d754f9bf50e149e1758cab5c146c53611150ca272430ed67f677c6f2aa0f754f5723b213389ea1c0c016c758fec1d70b3babefc2de79c33e36872339c695aa7491081eb8eba67ff46b3a80a72c238be39967184f371b67ae57361c08c70017d5e3a1104044dbbff7c5e6304cf0309e5895b09ef3b5a6d3e6dff74fc9516f6bfb465956e02cabf52a135da5d87cde881a809da29bc65099bb8bf9beceb42f43261477f8210f2dd8457da44d20ae8b52ce9e69c499a2e930ee8f32430aadd3e013495596b0dc2e2f46e1196cece113c0b0837f710337b0f13ee620c725723f0bfeb7b4131bb9069294331a44359d05f99a9c00580e3cded87b5cc965344dc143e7eddbfc5bdb0abb2e0c9d14458780a509cafef28bc64aa5b8e2078562a4b3cd64040ec93086b1a4cf1967822b8dd633d41e8ce0f1fdceb19c716add17dce577565ff020a1abdb41572c612fde0acbe304975564f2d91cabac16cba7d15f590d8ce39667f8cf03973a224168771741292983ebee85086abda14c64bf415a4f7f13a1cc8d89a760a66fff770a6480972d7233ae6acca483f991847286657639a8b22a12ccf9bd36457cb89ad4ab2a7bd2bb217c33c74b9c459407fcd3496b9c1a617c03f1e80e9a103d61bc0df6da4c41d96be53a7f2f53cc008248ccf0a08eba54182e581ee97f2f531fb86417b2313996f3c8ae216b04f81461fd660777ee886b197fa463481d69b2135479e4a9e9e6204e198db2b4e915e1d6304a89d0f14abf56a88632c5bff1c2328c5d1392e82f81137535e731dc23eb6eb503a07f070fabe601a8a5d176c6b88378ac5a6cf3878f36ff386d4bef0895e1709cfe9b14f38241e5448a34a0043e625bbf13c25832a6f60cd69ee1080f1bd921d66078bbb774fecfe9693a6f2f22a7c9dbc4506f1e704e8ddf51ab00edfbc614ebed82bb94b077309f448fbe906a8d3b4d27dd1f70ea585d39fd6379fcc563e42ccabdc2f56cf68a722dce4ebf0b7e96821391dbb1282f79b80a43e18050ed1cb7e459f774a5ef4fc4094640ddc2b4b1f02b54508e50d6b3a1ae6bee31dbefa0af5e9e5aad73ff706b3ba0909e643d59082a6a907543da80453628e1e3930d085f42c8e5f22dd10fbcc911eb0ff76910fe824f5abeb42194a9d93eb32a832e1459a52c2cd9381913719ac7b8203d475edf03f111ba09de3e2dbfe32d2db825476a844af3480bd43a5cc27d55e396e545f62a1c9019978a30bf8252d12830ba335d0b14e345f70d70ccc8f710a9abb2b3b2d03d6a3af37552dad43b215b487ab6ead8b2fcf719fe97d9830d4156aa0731d9cbbbf0fd5bf589674d50cc23708735c1e1cd1517bfebb5c01d0fcb16329e2e48712c2f880958af53c52a947df33a95ba214e274695bc298a028059a2758a1a25d9033be79031c041adabc53b63d96a73ea019b4b346894a8e8c6bb21234ada274a062e185bafb42b4b858245ddadc6126daf34dbde7fced60f8dc17869ebfcb0dd391bf10975bb218bee13bbdb3dba2f8633207b6e918a701126d84bb39155efe45b369fee225101066d9425d6bf39787c509a72051b9db80b74c2e821672335d3a4e77cd791d56381af612d9de75f8fd6b433207f0e756e9c124248873feabb93aeb7b34213e3f560010ea01de951fdc8a77b49ea4a4c4e316003f7ee6e3053601940bbdd558d3fe23d1de5e629c1d69b917977ed9593d0efb7831c407a5b7724a5cf4eec32809f4e68a4205ade3a7a5eb0d083377dcd5185cb4444a11f2ff5ce4bc32b0c42413836c28dc5b8cf8ad6e332f39cfe8a5b243f6a1d3a90308cf9725face0dc65995f28775feaee39478defef6b9f88fff1ac2805e1c258630e4cb5e56f6cd5166323b8ea56e05477fa3def8ddd8ac053e8a5d6057ef09e8137795542adb199358ad47fca6599a1a21cbf92ecaacb2251e8fb7fb6fe8e8219d509109222c0a8634729803af660bf45e033cef5ae9dc370437a5c9fc50bbe8d4cd8f76c4f3fd4bcc3eff2620e6d3a597ba4817a112e0c8934ff3517748762fee70bc6418ff4778e8207fd1605c5bac02ff9d855940a5f71321c6f64cdd6b598850ce15d1e3ddfaeeabf608a9ecd0ef70009c3d47b5343b8085660bf23241599f32b4699246b69abfc9d814db2cdd3e0694cb80cd9a1f74177c954bf54417baab205e6a7ba28d0a38b82495e85c782f4e302b51466f8193260121bd675c91366a61e889d5493a3ba32b983f5bda5ceefbbce8a44ebc48a76ad529a573fb0cef78138bdf011964f689ea608084f8a0293e44ff7c0dd54be8f8c2a897f51ac35402bb43634a3ff1ef7570beb7c189ad2bf9cac63b6a564c7f481b894eda73326d6fc2e1cc2b79c0ca16706ca82101b84ace6d139a25c94533183dfbadbdce7a7ff6d9f2aae889625ec74db3d9ebbaab9fd93f7cf0da20efba82371fa958dadf8db82b405d79747df22aea65020fd21d4d4be63688de3cbd168888cefccee88ca56014ac01bb97ff5b716bdbf4f810f1d8d0bbbeac2811c5daaaea64ca99e43de456d953646bf8c3b04a63f3277eb27fef3a4e25e653ff0708261ee19213b138a254e92c5aa6b12591b6231773ec529eb8672c28107e1892d5289f6490bc41cc98de32e0217537eff7a893de40d51eb7553c7e63c62af572d5e663c552c5d9a049e7d3ba945bc0df704e821dc7f7747339e418a76b57c9360bb3fb86ddc2faaabe0fd89c39ba5e1c2e9966b3439b162f03bf4fe00a76916a080bfdbf0f678c38de9b21c271175fdb555bb4caade966f3019a29d0270e0c7ee32f4be88ffbd8c7ca8b126c09618cc98cce7e1bb95fcee771800c639f3480c9da3c72c88e606887b9064e36f6ecf0b5c2e8c2d5fc3e70e32194843059685718ed42f4e09ecbcdabcc931edad1a573d041da5cd0ae6f1a46fc452b6b1b19c2f60b5549d953a3967e3464ff9cbf1913b26ff7eda98b3e21c0f2319ebc32e20139da1a52407cfa16632fd22325e90d0ee7cd5d7e1f851cb935ee49fd9e87870596593cd87dadadd8180b00d825fce8e7fb94c05cba08c33900b2c91548d9367ab9d467b86d99537d603c0df8e0d63866869340c5a9fdeb68b33d9d23528c302caf98ba2b7b3a024893434a327da806cafe64edf3cfa6ceccd2b51ff2f7199a20dee5271206356fb545d78bbed8cf1d6a8e32abf440c423fa20441074a5a7daf0d74bb22a6cee38a6537e4a677f4b4ce44a2651cd6e3b11e9b0c084d4c37859a710ed8f05d91ec6a1f605bc21e438407438713c03aa96f90b952e64b518879321f4f9d6a7acfe32264ee7ca2aff82a54776364ea00e53b9bdde24285d67295a45a92c6a6926a0f876ca45ec1e5ef602d96f6ae2fa5598696a146990a71a46d5e1861f4b439a56b52de09bbbfc336fefce0ca337d9125601b0ba1b81e149115380bb3b3e5de4eb0c15deb3a8d1a9cfd7de322789b78f8cd2c20869aa893d0c025477bc6b13ab36932abdd433c6220c371788747fea629aced83b11cd415cbb1cee199c6dd4fdb11831bca98ac83069b443c43c1cc2701048b98093c723ca688430817a4edb219a6bc34146c08a5e7edf168777bc6f11a282e9d0985df55018a95fcab4252df834a70f7a36c580957eeeeb8cbf92bc3bbd722f51b2eca563be4e65f3acd3d41945b2f85e8f572a1b43b91aed24d47ab69fa2e073baa176f6a0d2e64b24d1c7848f61b3f01fd5f7ffbab11f4921b7a683911884101f01be481240f57e749802871d75759bf81e8b83fec27522a44c637f36d4729b4942e4a434b6e268b5a65f4f250c640cb7c2439f2fbdf78b479121991debf99a40bc35e3846d59d730af1ae24c17589c1cca00812ce713a1a4eb639dfdd3a94199eaa59e797eaffda913220066e8744226302fe0392b7a6a4654b7c3347cdc1cbc2af93c191a4c67ec5f563f2bb34b8ccd8f20c45f5e54dfc54efd67f6ee08cbb9c073a1ad85c3f77b957c9806a3a23932992ba26336e22997f8251b866ac2add1bdfd64273efc50372b6032404deed2af356cd5fc36251435f56ebca5a7e82872ff3f8313e969867da415878d6b03efe1116dcfd761d117d45696dcfb618b786e994e913815e8c5d35da883362f807271ab73029da39a7b69ee1e3faad416e62314e1906ff00a665cd3312513a1189fcd20428464d7896127645bce8e7cc9cb992f75832355ac1a021164ed9f7a805a16235ecb085d5fef764813f3e3e05fe037049074228e83c75fef3e1977cd5270b95189af2b5e7d6eaebbb9db2313b25ee06be20968ff8b4731a1967bcb1c9e50b5f8c03b96d8b9cfacf40e246da1195a472fc5d5b69c1c4260232f910355e487b48aed083c0afac6cf00dd65a189e0806cfd81ffe774e9493967a28ddacc777e06169148ffb8bd2f22bc6cfd7d212a8b90064d50ab83f7fd5f699486a93f444537181178676506805a748ecc626052ec717aed8779c724d685098e7c14dd64c6b151e303a25553710729be58b7637cb677708dfe4d2f0d2e6d6326b7b300c1094b45e78c6ce820b2d4d1b861b3e74cae3ec290b38682db45369eb8a1a3251c87801531ba7f61d8e1c08cb9103ccc7749402acb1d17f92425ae952221616925fb866805947e7dd080249b5faaa2c62ac13d8280050396fbd181b1b5483680a38023f782e78f24444922cde58731478edaa9a089aae2989bc2044416e1e54bdd4a7ed920ca5972329b5b9f1c0f805f22a515922bec28b761bfd27a3d60b69bb0c1cabedd51796378f5cdafd8d9fb5f599dd68b8f9254d61def47d88037d6dd2721a05be9ca8a5c1cec902a6271b086b71ae77e06956ad390f43de007d29e1eb0d707e528ea1bc24a5bfad487240c087481191eb7db1c2060e5472d796c692058ec7cad24582a288e9cb4bc65d2da97ec9b8f5b541a84c82a9a499514dbccdcde0f358e2f129023025fca9be05f364f9c0a87107c05e036129f7fe2c4687d655efee90ab08ed9e5a8a6c2af737c88adf13cb4de71c23bd49a2ad13eca1723bbd254517a66989555a2abe5453e0d6ceb49354226ec309f6ba04334d6e7918c28362cc134c80ce6dd67e79e89f48a21ef8f2c859c6462dd8563b5a61a5011fdec6c9926b612c3f5a5e938a4f5729f2635816da74d5ca501bf2455e1d1ca9e0667e64fedb5db1a29f32a867e3f77e23ea39e5ad0c9d85db71e35446db7b353712d15ed7e36a9d0e90c9e803fefdd3508b84d43c92192b37a09d26b33173da66d8e8456185273ed171c6b2914c03b59c0780e945ba3d3d8f3c6aa4c21d012288f72ddab392b4e74f62deff171e9f0bd62a43fffe499a5d1362992e0727f26b923e50e6c00691caab84997c32d3d8fd65d1fbdddd6169e7332d0b38f22aea4fedc2d07d7f4c907533880ca13f50fcfc545940e6ed468008c555f6290532e36a06350fba1c6d8c5f23ce7befb334db747a9155889acbf664d3422c4914db39de81f625da883aa811a6c15e6629e5ee7dfad387fc6c4cf790f4451e66cd42be47ca3281beefd204b4f593bcf2ee268c4dada29a1ba2fd8428c41dc2d590032649a6f39dd18ab8678dfbb20f2f2122aeaa0f1c1818e43604b112a97e10a7d07ada33c24be69b982844abe828ffc466c944ea5cc07c7b0d386c6a857bd3e2a74bad66ab22ca62bc7e1706b92fadf45ce9c863416a2a9e93788b90280472fdd86260eb3f66585657d4f4e273a6d51d5365ae91a50a63ec1b3d8a72e158abf4b581b1fc2bf437acc7346671699c67bb6b2b8e74e9","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
