<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"7510cc1a3d56f1694007926dbefe566218000b7614a333702c00fc744710bffad69487d378003064b5cd0a734617e6f18f9dd325c6dc2d0e18ba16fc0bac507fc787d65436d0a294f502458feaaa4cba04f7ec17785071a719f19ebf7fdef8583f896b024b41763b2e11678fbd953b522dd06a677720d4978118c9b8d3462a70c35117cdd88a4beb463cb3a6c09fcf35f0ffddca7afde0061f26c351507acbc05f4b9c330612fb336a15f92ebea8a7978ae268122fcb310257d31dacc87681c543ce88c1fb67b302248b78f7f09be678e0a0c4e2b503f8bd428594e3cdff45cf17c4e311bbfa5294a50203857e77899387d3c9a1b1301c402318a038f10d20e5ba676dad524538b2a92fce9bc012293380fc33458860ef65d57e20c705bab2c608b92bb9129d5a47f802c20069ac720d3745079b1a97b3ab0aec9b5873103f561c380e7dd8142832991d7a944f000a1fa86a1504c05d71be9354763dd4a91ae760195ef86b9e9f7da4307171b1ab10320e9caafecb63ea7c1b0917c7baac3866de698f00980c1e519ac87d7cbf0f1c28290d7118b1272b0273b5cc6a40a1b689fcf0392457b1c499dd9570bccec2cdf135b3876c5254e53d4d95508e6ea648add7a70f47b7a0ca0635e863b2160e1ef98c5574f4ef263bdbdf5b44d5133ca85a7885ab88a4b163a1801de765ab882a41cc75b30ede1fb0afce966b83e60b77532638f7403c9fa37aaf34e6aa6dd58276e2702e0a56a3f9bc91754f14786d05622b349cecb8cf81dc9aef9defbf2ca7d311a82b1a4fe429e710fbc8ac052f583b4b4509c0da2853bbe20a4d772f99e229827f1838eddc10c66f969a57cf4e3b729362ebd8cfdf07f024bf6cf4f4d575e61abcc4165f3b1c661af92bf2a86c28496f142dba0c72f18f61ac2faabcf8999f8d68fdfb323bbd86bbc930cc653d465cb57ed9e59cd87cc716574fc15036789e9b458d60764d048f1a109d5ea4679265cc7828e40b3ae17e4733189add26642c3a18574d950a3e9b226cfda7e0503fce585298f1f58449719bdb1329fceb20403cf3f04a523407f9079137875b290550b584eb34a6de21d3a3339a4dc1175057c1ab7a239dde0c1644a52976d23e07b5100e7893a0f0189f9f2196b08b6aa19ec3ae6b33a0841f8e78cf8e904e9bc1d22bd77d95961303939e5219e8a7714279a7c00b06c00429d88ab3feea929d9c4b1b3fc87a19d68dc4e5a66c3d706c6f60a2c75e0325b8dee4c83d77482e0a5598e6d31026705703ad91ba98e2e0b1d62b7f0909d343c1db26788448bd416b6502f4da3088e9a96655f8bc79926f9bc952027ce05a40993cbde88dcdd2f5398f86c3074cffd154e2fa61dcbdd7b27fa2ec9123cc754c3034164c9d417425ebd1325ea88225d89842bc5870d77a8c4ad1de7237bcbadefd9b8c64fc0932b1d72dba6fa3f4fc52fe5814121ee5d8308718a134c47225952edc88dd1b7151e7a5ede47086372eb827e90a1866757bca1551272f5ef66f8570c53ab9813d08fa58727caf60648858aba083e6ad670f759178cc42719259a90dec45281f7ad1697e9de10e3603838eaeac20b3a16b80bb53680fee2dc35375f685ab2f9e4aead711d08e213414e09d7d3303f16c3a4102a51745e9e162c6e1f1508fc9254bcdab8e027d5cbc890db7242131afd78751e60040e01d97a46b7833a1dc2a9a17cfc58416424b248e73bd96641bbe79ff48205f36904b106d4cb79e0ff9326d26d833aab28ffa9a60236452bca3c4875525f71a87416f908883d4b8992b07c3b74403a652857b30be062a4f1ead9d3ebf005efc0c4b6120f047633ebb5c367b5285f671fb08c48cf78ddb9f7a14bb45366fbdd21f7d3ceaaeebc4465c2abafc66b8084b13a5936c6421499754707c4bdd477ed43619495543671417d57fb2cf55d3691a3b49a73c366ff66e16900fdf7a231c98de6205cc4a0066b6bbbb2bbdde0bebd61e04ff7d5a1a9026ff93f9db94bf63dd6b7290f0489ddf14e0759b3dc4fe578f7c985dc72eb940f3ad8f992d534ec8c16e64a5aab99467a4fa54f3b98127939464e2a0df2996d05d05458798fbdd79a75fed4a4d3ca760de0ef16a4b00257ac5cc5ee320458e0eb64982efc9d0007c84aaa78259499fe3db9af09abf2114467e53542a203b8dcfd2d7f885e8a5ec5ae77221312e5e7768fe32c3b9828ba75ee84e26dcb479703cc5e41e7ac1fece8003fb1eecb5b67739ba9a7f162198f82fc5cbd5bea9e726a2f66a82a1671dc155d521b428a9bc8a40dfc0eed4596d352e4a19c347cb62d692ffe3c6059a0daea59c18c38baaaec873b067935eb918f131c614e67d1fd3f3099a630c3cb9cd0d27fb71d1e2c8b0baf116eade75ba8e45459cac90b68507cead1ce52b2b79da96576145ea0f99d89b1b1192201809ac1e8eea1d8e7a083f672de334cf0aa28f894bdd86f4801f7a7037ae724722eb35cb23e75eddce0b07dc7ea21e7b8b7e4ee6088257862244cc332f70ee1039f13becbc9e3815b60c23005250faaf4a17709d2d740a7659d79e3df6dae755fe5883d019bec693afbd06f3a1da22659ca6b981b311eababe314ff2c77cf878cd1111ceb6e2421ff467e110972a9a40fd4569bedc0dd7fa822e9571731688b9210ca246f08898c94f0a7da979855d6900036766e796b8f59d21720ef3ae70687e371cb3ce8f56001a6230ac2e05b3c8f376f5ef27f9c8cd570b7cb555913ec6f5a106c4a3f9bc2fa20f4d5995ff2371e752446f5ca9374534270ea761f1144a15f063d24ef8b57bbbf069938e9559f42f13062ead008f65c03e44347d13665b30d6e9744bf87d9cbe3122d3b9553223469cf51114ec5fe24e098f9f3d7fe90c37e233833996ef975fceb4cdb7413c96154c10340dd520e3c5cdabc03c81a33bb27575d124a267a579b3c95ba30af44748d8c2d4c6ebcb5bf8d22b84f8edeadfccd8199c95bd8daf8ceadeccad32162739a919330be7b07df4e91885dc48f41b4d3db93fc4e52017fb94e0fe167ee9cf0787ee04ce3f06a147942db253121caf131bbb74b3a8e59f44ed8aef518e8e153e14b5a17293354aa31762f45eb2c5cf63243da393f7b52377af5596629916d336877aa11497bccf1a47cff91a0adfe13089efc6eaef9a6ef12c8200387691eae94d79605afc14cbeeaeaf47baee703af4f8d0667d1819ccaf2b95d50921416f08b9bdfa9430eeee2e40b6fa8b52d062e7266c0ab25607cc6a244e9656ece4a9cae340af8b8ec46471e76f54c1e0933df38883252aa68bb48b01e1364e482425df8920c16c51890ebad2593f57ce17b52edc1130529664f2551437e163d24e0894294d18702827734f1e8d2a87ddafeeb0eee03546c3ac68e96787c3182bcc42c4b7a2a89eb67b69eb27e1a045926455e74901828fad28347abc7c3b661f83d0b6044ed441b65cf8c9da8c685dcac161367878ee6f0e246df157308f272b19f666ecb5660354604deb85cd285199a5261065f4023824c15aba4fd72f856854ab1b48829442a40934bae2179f4564491f23f9f2e0967a6b9646efe2149354de93702c4265b62595c3ff451e41579ccd396b0db83f7b63ca94cc2303d688e56fa0b1e92af5902c432bb166afde27bb120d4bcf38c06b53f745d2de2d4854939753c9c96aba71b551f9aff24defb68ed7efdcebadf9effb51076c80cfb6b1b3c8e5512667d9de56df333555f812437b80c5bbef4d8c1ede7ab192c12bb157231d071b4a26a4f3ab495d39438af3e1a97f3bacd8a59c10083e427b1b43f1b0be5e8d65cc0ed959d3befdd62c6edef78d1c8ca227f5ab845fdde250003c3736ffd630db8b024e5615f819c0837d100c31470fb475423913bb401d352267b993324d9a24c462a15b08e36e65477bf89d5a6cc72ba00851e31c8825a90ffc8c80447e57fb837b06c8954569ba6f484b385a9dbf9a7293521c971730e01be313a663f1a03d8e53fd6023e78b82a4de6db95069b28a3eadb28af1e4ca614ed9a6f82afd9cbe3bcbd0668db77f04293a6785c696f879b7f1dfc3ecef8afd4075400908a3755e59ece29f5f79167a954a655bf06a3e46a873236c7e30bbb142887a52ce566187d0a02528b1f7cdfcf7bc455bd0a7cf58eb095fb5ea8fab23bf6c90386cff721cbdc314dcadd39f316c5bd624eca63b9861ad1288af8fab633248a01f953d8b93fe52e10821574d3d856e7d51de6497e21f3357306a336262cadf99962205b8055382b90af77252fa312d6a26fffb132ff030555438e5cb8bb18ca9ff09467eb00000b66e49196a1314ee5a1a914a3c48f3ca5a499bc5e114d589ad3d8b128c7540ae8205b8ba3e61199cae5d99db35ed17eea5446470bb478674634560677065b3d77655c145d156abdd64367f1cd580f9e8a81c1b8704e25c730cc2bf5b119b814488727c9225a888ac31b286453fa64a66fd11d5b6db4d10ddeaaf5ed060f93e3e04c58a1f25b15f624f5fa3812d61726cfeddd1e8971d9b9d25065c67d071be64898f665d6a55f53816d8c10c2c43011745273ef6b226c55b9a4a0461a7cb896aacec4cee3483d6fabeabc3afe4272ac19ae0d7e09f86503d0738443ff2e1e4e17cbdf3d485a224c7c5c87c6e42ca8569d82be9459221baac2ba9788df21a9f41d374dc758e094700d7ff0acc9323f31343f72151700d4e339c251afae6d8673835f20c65bf321dd967c04f9e72f891bc2f0964df0226be4d6cce1aaab63f8eb0428f8ff4f3fd00e610b3413b83a31aa39b4b881ff785c9fbc8985805f0b3337d1d15fe143744a786ba21ebaba477befed74e8b6b575bf5ad634c71690bf14045199fa9c5af6eb76418546314195c0108570d84eee27aa00a9a529295384cf156572e3a9035727b4977cad9550cf403419d3bddff72fe06345500346934c8ff98f128e877829824ef2236999741ce027727618f2625b7a869b5c853d23289d2fdc904684396d82b911d94fbe88abe9f821064136b0b4322003641212a7b60fe81e985c639f63bb59eee8ddf5efc52f84540633c29a3680e24e51e0f1f601015ba73842ebc5196d8c7a26d4c1643cac5eb6f0a40e3cb74cd319471bcdfc370751fce999a6db2f0786033800cd4da414171673c811e123afce0e1e2941a7d8d62c26495dbab67da0f47dfed5dff87d7434c1079ad6e44768efedb817a07b1b18954e9f57e561b9414409b68112039a9f20378006d0c62768f8c0a76b9a91ccd952732df413289deea9b229d6d398f0ac082f76ff4713e9f4e194f7e13dc006f0023c48a28e0bc89b0b2ffc26bb80d3b8aee692b3806daaf82a6316f88441d0f3ee4679c3be7eb3c9f33db23a2bdc23a62aa4718f463feccb9e75fc93448e186d0240d4057f60e985de4507bc77f6b1616f2966fb6e6b25dd6c74d6109722b925df640fdea47391bf75076796ede464ed051ef75869ac03d932c52507e1cf0d77cb0f43c412e0e621e5776655d7979f932c0270163ba236c9de86db8a5b037e52de409df96ad1bc7468f8ea2b3f985202d17a72019a3a6bfd8361dae22c79812a817c3a65bad2672489e4598127d0a4183f4e65aa81b88f3aaf990f943dd143ad6f9561eb7cd7d8b823dd0746122bd56397bd68577b4fb11408f81ead6e0c5f4f03bd07e59818d92557210f701083a12b2414b1cecd904b03f2663ed3b96df287dab5e9c4312c684c885353cc1e1af92635920867a0d9ac1735fdf0cd5d4db2bb911ddbbfa76dae42b6b5c7abed2a7ffa9c8f79d5364d2df7b27bf0b465173f6c76bbf5ccb875df57d1c5e4dad6f9a70e922054e3e7ed1b90da939b006b12684de5ad4f844a41dcd4ff99d1f77ae59a3fcf1f5b0b9d74af42a86fb7dbde9d6cf958247ed1d6657d552ca56827cb7f958681afffd2fbb9be16c9e4a53fb6b38ee85f2e5aed86b6cb173f29163bf540754d21d505f25b1cd8d0e6e7b5f7d0654e4bbc918fc2d494b5082759a207956584f1c45d200c96ba903f7141327fc01451183347a412bd9b2e2de24c07feece4e4680c4f4478ca293f1ebb44892d134efb301b5091f794a821be77ec36748e19b9e27cc88b3c94ba2bd8686c3c2f3dd407f63dc61504d67fd419f8040269b06a300527bdb245ebcb8ddb20a06b0606fc0a97ed266f5ceab3c269b5883800f27e3296018d16969565975d41c184547f18cfeb925036778f306a7f9651173c09fa007855ab68bcbd64bc9bad00005bf48666ddcf58fbe75f65065c4b8e3655a2e47299a681e2c1c9e3b0b3492310bb092c1b48353d250144c01004a2666cb88830ec3c7a4ffc7effc89122e633045d871d8b78c579da46930465bf21a150f9ff97e5ac00e876cdc9a6d30b630e32b6cc5624425e93f40970dafe3ccf490b947f08f03fcfdb98ee49d7f7781d15db1d5bf3259c9a4d1f89ff8e6ffce968607b6cbfe50b4520cdc4c09f03dbb3f2b583b2a957ae8e8e078d8855858633473858c14d5072200a8a048f0233193c4fe075c11416a9f86559456c7f0d7fc40745007a60e28548ff39a783dc7bd39c5f6ce9fdcb0c1c3e17a7c95bde50b0e77697232589ba78a7ee9ca47fba466e439e9256c50ffcbdf83edc892cb9b04ed87a24b7122231a2edfe2ca4414d5c412d34a907f1cd45f1a59df85bbd2dd63e9ab24470c9f98b783bca7308a8ffc88c253dca33e6445700f5915f18f2691ce4c72d6dcd8c6ffe32a928350fc1ef7bfe26f07a0a5ef2ff90c6310b35f633377401398b52c32bdaa875dfb86671cc50585157bc3ca24d4f0a3236c359cd3363c0eb68a1b5b41f68693336a75588280565f10ca6b7ae5f70df044a3411546ea234e06094d1d122d8fefaf23e4084b913f900653e0b5bd9ecb454abd16acedafc9ae269508f623cd56a66036d4be4a7fde43845a63bb65bcc74bffa2ce03bcc4c4a65a4008abbb452f7ab6be290ad8648f8e0847280f9606cc89df6d428366f451714126decdb93195a9f7711740c6893d033f74da41d95130146331f9bd3dcac7932a3fb014f9b99feb85466d6a83b4e229985d1d7d68d5148000a08168c4ca4c08bdddcbcb027d9994dca6b285db9647d6a703ee479ea72b95b31150091ad188d2be80b48c36a07dc81d565979ac5fa72fcd8d098aa293c167ff336e29fbd3fa7e7faeb1a68ef70b3c55cb69dd64b18be629570bed4a145a81578fc6ce02f51375031a653e1408951348e8d4593c25fee34687fa8b581800807704184150374ddd8c4bf5e85aab573238f296a7a2fbf4ac6d7b7106f1db960b346ddbd41ac6367f7c201b67b011ce3f81c1489c805255c402f7ebcc00f239460ba3da02258ff8a24f94e22fadd3fc8966794a309c337a9a3b92f5a1b184dcd8010d125b3bd73a6fc3202a8e31ce0762be3d506facc22cbb00be75115436ea5cfb2ae1279c8e868ad853e9d853d4f928b1336511b851ea200a71ea5747f92176fcf553d7665b9df080a811edd814d56e7e6b1a73a786d33b8af4868d06dabecd9ba969e95ff76794739ebed5a24c338387ded5d244f7383c590f55b32d6ed531fde9ed7920fa6995ba4170a1913237ad4c27c676300aa4f791cf24d58ac840840a12765a9a2190b6361057de3edbe004051b4fbff5ca01c537bb212b5d04eda4bcbdd91e16933af52d01ec3a10298fb18d16f03f9f2b79ea4067604c1fd8f4d6caf17628be4930c94371b7003f0a886dfeb526eda997266eb9ecbff85b212488c5eed53968682bfc4c031a2041070c2879f9fcb2df9bea185b5144f81ac6c830163316d5d9cce8e1b051d238742e5f05bf81cd5a9d02f6003abc6d788f406bd7376ddc2838917e5d2c49c6fbc93424fad21f7795e4c3973e71067e7dafb2d94681342f4d6fab818c6188c2edc1a15ba5b8c5eaee93f1e695b439bac30ea6983f2507c2b38132eecc3fce329f76a2b29d94acbe53a6b8080e28cd239aaa41f0766d6e987f992a7f0625ab3998ffd50d596f6b678a8c8d042239ebd11532de26f81f8c767a3e65f2f785c72fe6b4fbed3bb4f4c1ee311d032e3181b83551589585e43ec882139bb8ce27d91bb2571c84def3b73b6fd20ba0a484e428f9916c0b7114e1413c7c88d9fbf2e01cb825a2b75a67de854180267472803eba36c42a6358980ccaf27fbd99e950439269abcc80d170cca0953ebae5439b356a0529e7487edbce021a26ec30b19447a7f423ae59b30940b541324515029b7306bb6337cbaf8552561d1b3741e359d33da5cf5adf719a399627c0cb70e3926fd425b879ea6ac6f29647405f9864633053d99b123bbc99e2e6597f03cfca8d7990e54ddd5f1a3713c50296619b22d1090e07e49788bbd1e64221686d30280b14f8c53f7998e80b61a9f611dc5c388e6045e120478b49c004803d3e258b996d3a8397eb9340d3cd4af429f48ae504286dcf25f81d962105e11b170d2d6d93372a32cfc3d894aea7465f7a29ad3c5af434a38a3e6840a8d9039d7525595f8a73436724acbfe82544d8297e41f0e1eda2dae8ed6d1ee51dcf1d19de0ee15e497160192591a822828de0d31cfa14482b08bfbcfc3167e0ac277cdeede5eed32d3155a43fda80f9348c22d3dd4117da41f5baf93c60c11e27df8ed6b28a1025fafd0dc937be26bd4ac95a2fe9e77cc4aa167d05f449e5dcea66bcbd218694dc52fbcf56acb93fcd78772a9b7baf990589039da76ffd17245592e95f9fa7839544bbdb760aa6b6e342e32bdc583d436c0de18d6009c24ee33bc14632bd77f39b258b10ac2de850390d2a36b2dee0bed05968149fbb50863a0ff738544d7af2ff8679e7b17a7aa0ee98755adafabb12c56b74b3b22c351486a7cafd403e1bf28f405d62cc774334df2a6dd1c3a5ebc95f0a4bafc760ed3e135d473affc680bfc041b1fd2efc3ac96df913d3229229a0bbd6ca45bbfdbeddaf514ebaf30b0f6f7cc2693612d1ab5f71ebb71be0b943a41ef43b092762a60b912bee03314e400fc9ad1aec218244094d25125b8ef34f5e5e10244ef5562f791819cefe9c243c8f07bf39d8aa40ddbf08098100b2f99ca645c30cc4cc4a9dc60d4f24c4c3e066f41d6bccfeeec34e154c541ebe8840b72a7d2e1b096999a2bd2eac063be2217ac6cbd9a74506a7e0b7663a6aaaac52032f0d836426ec4c22a2fa5eeb86b64335ba47d7889ac78284d43e3fe183b2700b109815ce63bb1c845ed863e423e6e12acfb562688d68033e6af81ddf07e73de0162327fe2413dcdcb7e77bb37d80cb964916233633fa9fd3596450da6393bad10d6287a3621a8a48ecc5841c3dd41912f540b6be64cafc2bac0874dbb03737bbabe7e5f988c45810b398cb48ef9f0a2ae51fcbd26f3c8ea3c65f4e62ae590ff2f1c333d4e5859ff3d53b63b0ce74876674ba0bbc4c644cd5a8b45e8e530ce69e2dd0f4790aed89b3f1cfc446e0c638d8531d360adc8bf3afedabd05eb26ba5b9d3a95610cc6f60a60a070814e6e94d8d8fe30b4690643538e2d325b7664073c4e3388c644f7139aea8f25430b5a06789011441af3873dd91d8233df9b104936e416d666e8eb819ef88d3f1968ed2fc78f31628e33bc8fb6446601118fbf9491a84f00dd658b33a002d564fe1c3f2770ef32ff03b5072db3d7859f0fdca6884aee681eece13420b28416b439368022ea7b1a644e5d11fe35ba957695e09e416d2632b2c39fbbdc590d558bc0b8a9113ddaaec311741f6c805a4d6ca112135c1b673efed6a18dfd046945bbe2563013dbd2579df3a4756b806d2f5655dd6b14039b37838e4518d97679cf4caa160da620644c1b860df11717598ab0fce1ab53d72a95eb8d155b9c38e594ab29e71b22f06a15d382516e02d5e73713c2e0f80741a60de1b8a1f23421cdb53df3694d08bc77c5aa9c50133894dd14d763181ebaebb466f567055357c5f30c3ec86a566963321b92030c1b77725b33adb6f9e4a3e4ad00d1d4e1925a0ef87eafa8b7cad53085924b50bd2f7e3bfa1c7df30526f756035795fb0effab47123e0d93f7a83755cfeb4939e93db3690d2b42520c1debed10de0e3361fb3890bd2df6ad44e0e385ee0f823a9b80073267676aff933e4b2822d545aa569b335fb3e65f90c5ec61c883d6a0437569e91a72cc4b2f4dd01ef2fc72c61b2bc07019a6291f4d08c1313cc3ce358e90f33908cccedfbe15817ac145e5cc887058c67451296a74d12aeeaaa0057ccbbe4787b70c0476abeac2d0c6c1c5f56b5ecfe5648e9ac480b44366fea87168093984d673127a7ce8dcf00be82b0f9c9a4bd132f69e89b760cabdce93d96cc72b19aa0121768f3824130915fb40a086ee11b7db2208960bcf84fc4bc20af46ba0602858b145e2685376918f7b36cf1fd51ed562712beb65be36589091da2c758c4bb6c0467625d1cb74b092dbc208ef631389fa2a044cea0d7ca7c849ed75a32c895dd3a530a4b53c6d2a201785a922709da81b99d0f5c4dc15f98e0906ba4941644fb6005696b80837f296d8afb673fe665d7d0bf1010815e649de20e31c8fbb04e3c4c96e91d044e186c4f88bfc7ab56e1bc4ae462841502b8902958629b847d1338e5140afcbb29f92ac4052c28432e8a79ed00467bb49f481b377e73507f66121dd8d81cfa1b86d7a9a05dac8355b72c0cf27c3cca44a6d21f199b913ee16234d12383803e38012682f9bb0068489e29efe7ff747a355a7e402e7c2b54458afa2a46cf2e5fab5c2c7289bead14e38baa6d70a9e9fc965be4b6fab5213bc39d57e39e236989dab214f7a80911893a1a51f90a11dbba72e9fec91dd5f998e21385ca293ff1eaa042a7a4cafe830658910f72fa24155f3f17baa6bbcf3ec0b6e160a5bb198b8951103398a0cd9752854f3190b344387c22b7e1d128484e96dd997b2a0fb50425306a08e8f67584823e92a2edc4154034e207e7e9a7b4906c7fe7f234c58fde3c01936ccd12d0c4e067ca8f49db533071bcd39f4ba5f3c0724119f29dc8f424ee2adb29079da99e0125ede90432c6c2178f2fc9d3ab28340e9a145656023ad0c6de84bac9118d90158047b0d07eadfd5d4b0885aa167a2ff3a9b5950fac07087194af7cb2fd270029d87f9b50917240a864daa90fcee7848728dd948ba369a7e9dfa1942d76d840b26bbab2f412932b2d6f90ca0a6394638415e32b12fa0d44f0bee77b32304a535ba22cd61abb70b3512af5f3a496ae39f1687b5dbba232151c42474656895710a0bccdff7221b48bbe1ef13a18c309f14da8d8074e48d4d554c1516475d17dd02b8e84ea87f3a3e08704988052eb0f10004a3faa8030653014e0e843a4ecbf9c813d82c30ff34526082136945e419243b905f498b9554b17c7d2d790b6427d1c73f7a055c45d9d864e89d3f17e36ffcad50da7ef9ce9e412c63d2453c5fb0b714606cf4a70397a1f6c5ceed37f3e20c275f8b179f42b384347af0ae402c418567939a44cef532e1a3234d0bf330d564455efdfb8b4564a4b3e8bc60146ee73601324c31de1405a4b9c4de3ece120f3bd3e418fad9616412b98d6d42c43439e7fb3150f5d760c76b19f61c72fe8a070d7eaddcd84b6657b0f607fce90a7ea959cdbc34657b03f8a39fcd7bcee80a24a38c6d47e7f5cc48b7f256ea0b9ed053d6b1a34cbab5cb9252ada597e0e911dee849c0d6a9c64eedcd38dc28a23a1b49dee4f758f4360184f13578d9574475affb9992c1c3b29ef4c11a77e7c2d525495b15ba40856897d4dcc509de807b05747fcda7f37bc305990d3f0cad2a9ff79d6c9d722c4358f6e3770ea4f6e2e753b3055c0f371d4bd1710caf434f945db689d44811e6588b0d9cff8d44b30dd3c53afde05479a67d1b57f5be21bf1002f39e23b8baa94d5b1c84f5513b0564c5810aa33a7a09bb9394394a550e910db13c089f43c151d9c9afdba72b0130937ecdf863e1ad77c63ea8b1bbf346d9b286b03401df9d28072280a031db93fb301c5e1a4ad644b07a84f88d0f9314ac87ac17a2fb4b05b622f11a0dea5ca7ea15d19b403bb08004b031586e2713a5c3f44be67808f778e25944d92b1f0cebd7a11cd42a4ad8d26cfe6d0ac18f3a83643e99f84641715ea62ef7192c28948c5ca35b2dfed8e5b3de4fed9969dbe3370b066c7e321f4e932b4413e7f4a8d42890c4c161f82811e9e205a03e9fd15e96f5b4454dc4dc5e6032f27b9506a471841e7b696094047452ac933fae93473cb4960e3c66a06f376335c530ed994db913de2a1c3ced486ceb78203a22a754dd91319d152f1fe1266b0075e163b5253286b87da4c0e790fedba590eb98624df883bba4b7b99d12dd1538b77c00a16431280010a2b72c3be07987608c945f141fb51149064e9bafa7ced0c87c217c11e9b6a6e41b9ad811b345728df8bb96b5355fc16990563f2afe9ac33923acd73fbbfd58de4d29f011c824943ac8861c68c108f6455b0345d8c0f396d1bf3eea049403582c2bf562c787c32e797635957d0081def81d54b4b14ca87610d0c590ee703f2d0311bccf01922972d273120ac7fb36fd01c7e2a8b3d0cba0a015b06c0346429a7cb8b42faa85b1bff46496dbcd4c574024e5dfd4f3bdda84888da5efe4b773ad8ce6b58a964fddf793dcba0e362e2c5cbd859ef286810471345be6356e24fc15e07c99ee88fe0b0e57824ee6062cc457aeecc1dda757c424d765c98641e3eedc1fe074c5d394c9e7950ce0429db023785b7264f8a6fce89f20751b0196a63dcd8f8e7e60316a316d3b54597ca85cc00915bacce7d2d4352840f5c9ddfbb31d3197a61ff3ed30eb8412c0e2b490ecb4281c7f1456c592eedf6be108d955ec9170bc28bed4b34841b2339591065a4d4e15c87d7c723b4bb013518ec932a4b5ba923ab8cf21199ebc535bad1181f08a5c04df6941dd62e77a524239471b410b61ca3ff3cb9e49f01ea7c4bdd235738061fb5bdc64f1747ff1f04d1ba708184d6500dec1e771bf37dc8b115cf05c048bd82dcd7c91f3c2eeffd33f701400261e2918897f66fbb0c3b8531033e0578b2bca2face111fa63112fa73542f360d758947197f838175f7bc471054b423241cf0587fc70c75dbfea0caff1b6df26299aa2657b6e8fac3973d382a5759da5cdc7963c1356cb34766dfb5b7e84c05eebd2abd3a2445d9d0a8546da3e7162cf5d7b6f054a066517dbb3f2152bc1aca6c6fcc7b0ac75548800b74651ff8e67177466a93fe4007104b6417dc40677881c5076b0298d151dd82834ab6c181b3c0231dde76d5bb42b607e8ab7c83fd292b9416463dae999635526f9e16ac21cf1872c53b843cfdbc1619d79f1415b280b07ad776e3fc059c745f5321b6ae6708d16108d38a363228c013b45c6855db7db41be4151ffe59a1b8f850356e807afed2d8573bacae0dd74e6d27a30c4cfde95b444851ad261685d34b3645f8728e8f06bfefb45fc42bba368706728669e2cf9f33987b2563b49039ce9529f35252148433a8073349a401579dfcdf6f1e492379e468f9b3de2a2578b633c6389ddc6d02959887a2dd4d60f6344e88085be11e09b30ef08487a5d2120820b481253b6b6acee6ab35e1f632637a59f3e2fdbdc0c04293239af0b56c17ba6d883dfeb8cda727f636aacb4101737a8c1ae60c574b007f12dbeb79de4a78e33557a4d37b6cf7be0bf966a7cdada727e12816b24b1f13cb037c8f564801d62406b18c614869db37a44a38e20f4b0ddd57184cfa624946513636c98204e21cf3854716f718e23486e3b9207a989d585b72792ee47f3a5fbb2a30652554485c60902e7199dda6e479539bb32a8d56fa5e39296950f81ee3093f37e36aa88953358af75a3073a48f998f8a8bba19ae1a7985aeda55d7b55c6bd20d59b674245fc19ec635ec98d2c22317e983bb72645ab18b7492914362cbb6f273e6e46b5701373afe968c8d813339ba2fe80a41671908a167542e31c8cf922d9322b0e2d89afc7b086bbd7ee3f7536a07ad94b8ca649d7ed0d092cb897f3f40ac9a43648f53b2a1bec840b6d70733d1813b94672fce214b00b891bee1a3f77b2974a92107cb7e37fd007e6cbdf62abc15d348e4bffa63dde6ce99950bcb9d051c33b875f34c847bd53667d3889f37c35f8c473f90c639bd44381093ccf578930584841e7f49917320894c15bbde9881515377bdc84614e58d6b83f37fb13383b5641b3046bc69349a20253639172a78b5557606fa481cf1aca992b550133b51e85959232c251da8ed30ed5efa94158da4c76736aeb88260b941f2faaa92451d26fa7d730730a60a56e126f3350ed0fc3bd1145d1c91bf7b322747ce23415b168798e0ef71322c8cad8d285b23e79951c780bc311750ed7bb52d11bb0295755350cbb6cfb23135c74c5309d7b06848d0df2bbb768b50e430d2d4a0d7ac46be5e13990db6d3635ff2f308d8050e79e546fa22b962c83835a7181d674d1335c6fdbca81b3d5c1f0e1f5f95a56f0d6e802973d2b621d93f5010668a650c6db1a38dd13fcec03c30a5a741ec667197324b9a6d5d850bfaf277a9a4bc34fdec1ab26817a81695812ea986c748d482aadb02bf71f0044485652391ac510828e35748cb614c63bc8cb02145657497e6d9ad00577c5315ff69d87a8f1481c424825865fdf47e62986d4ebd5715eb587d8a79fa817984d69e5f4bbc69f5215de2f350fa3f642b299dfd0f223224aa968a8c1f6724020cca099ef184e743d4cf527d5bdef95da2070fdccc46310962bfb3a8f167e487deea05c34f3e6607653ea170805ca0d3b5a0606e8cc5ca08c4b66b6e652cc3a795a9e4be5b7a47ad21cfc0b0c1cdcd67791beed047f3c049a11f63a0065c295f1579e2925a1e9fbf36814c4608a3d91c7568ab3f56ac3fe50442684eaa87f024f9743558549217a819987b2e7a46257a773774c8d519db76dd6c52a123244b9fc7d9a3fc7a391eea63587eb8e5844118f5276fe47621d36d7b7d8c4fa87c73fc98365294d1ef560f0c4bf5a6bd371f49065acf797ee99a761f636b82607fa64bd584a5cd8012c3a8900a383b0805fccc380c6ccb7030acefdf761884ee277b58fb6dc64bec6070772b2e6274268985fad3d2add93808ebb308eec24097350091c3b61839775f1d0f44249b02a2d2e4985e872a71d59e96aba6f21ffdfc26fd51ff9e925939feeeae26e76d3ed42d1bdf3919bb4c443fd0f09e5a9791a62c25d2ab0f556888855b6c3896b53471b4d1679ce9683a85032d4c83e538d4e7079efe93f9e0bbf7a40c324855c9ea442dec7d7e90c2abe94162af5592da2266552252f14cb3ebe7b4d0314d7545321b36cc08044f0216eb9782f035fe50c2fd42ec410b9733843f8aebcff80bbf5f61fcf56519ab3278e2fafb7d0d4a73693152811399f0adda8c441613b8c28641174be40cdf55aa68344a9b45948f939610011e650bfeb5e5ccf0a322bc0489891272019904762350255b5c92622de9961b542f769c48a68852512eafb7c1920b28ebf47fe3362373f795622b0840124db0376eca9e33494c90c5e39178fca0bd3e6dc3eb72c140397c409e88a1458b5c0bb23f2d2c36b08520bf19910c2eea2d8e22c30a6eeb082fb9d1c84aea1ee49c991089fbbdc9cea08d50ae28a1f0f3ad2d67b7396eb357ec67426bd97c4e69b8aba96fbe4b6bc53370e6c80e3c8a85f3aafc3504677ec6b56e42af1bf3358de2f2342e77e8c5ac29d8600de6b6869e6aa9c806e3f9a419c54d934a663eefa40d811bf7edfde82b1407ddc9e97c7b0ae6351b7cb3a55a73558a66664c1c31ac8e44310305ecb2def594c8501b1e7f28d82f4dad269651551939ee692446f2ff13b196f995d4dc05c514612fcbd063400069293f625f9de25164754e7e6c055ef83fac4b9829411763e0aaa0ab37e38f83c1fb0002701fd408fee9a8608c054ac3958c8ed7480551bfc793d8549b1b073d479c0896c34715cab64d235361d2b1a361f2fa0c0694870f9c8cece2e1e53ab3a8918a25d9d0f677711c75de5efee5ea421cf4b6cb0b2201a7bd9824ce15398748ba7aa68c0159b296fd4eb122c9eec9a7025c878c3ffef28379b118b2e1a5b06c6726a4745cd752870e093fd88a91def008a9625de9ccb5390748118e8283c328e1dcea5cd3173a25a6df","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
