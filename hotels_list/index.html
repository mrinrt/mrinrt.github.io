<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"22da1edbb9be992217fbfecc52a7439ee66c98838c9929ede8c186a306602b94803945db4ff0b8a6339edea0c01c46052fff1a47a83c36386a64726ba1fcabfc3422d59293eb08838d3fc9247624813ff28db5f2c57c66d909bf44487c7f3690cbb79ac6733e894981c8cec0211ce58b2153b87a932fe0f34fee71a3250ef3e851ada12f3a429c81b83a1bb026066aa3abc7d77cca0761e89a029d251386a459f267f0df8fa356a34ac78e625fdc0a7c25cade86dabbdd2908a40c2d5d1d92b9e981a537de2447421f7271c544026857df493874b18cfb972d34a809677c43f4ea5a5550546d1d18076133c4bd0c4e76e3c19fe8ac51fb0a1d1dbe8704672d4fe5c71fcdb9d35ed0bf9b8e6e49afe3c0d32d345314b4cc5dafe35a7c9cd977cb6b1124d9bbad4939509abd93712d88536f38e0ee39154a8cf1abb48b244a39dd6070ae6c97426b9f0042b041e3937b5e10283fce765cb9297964023c728b116f83442f7f92a49d30ae7bc7c6f5b1daeb349785ed7a194ecc7e1c387bd21ede22f992b14dc43dffe445f1d4b271baced07af36489564054c1cdd092582073f9c2a719512b575b98b0fd541a7ee8bf0f098db8bb683dc732f7af9c5baf21cb3cddafb7651d59005ce1ea80cb14ac345ecdf6bebfa625330a7e67982f75b33582d0fc1d56b3e52412036ad9d06b6a9778f619414ca84c716aa6d0f3e56234da2dd6f6de3fb07d2969bfd968ead102d522d6095c3a8290db8f195454fc78f5c54d128b80b7011b7cdaed3ec110882cc50b71a252e53efeaa8e75b8d414f7eda8605e6e4b66d188a7d6c527d9a6d2b877a5978c0690477b7c47a02953021f865ab5c7d0dc45b21937e978469a5333d6a3fa86ba7bb0a4da43d6b26398f48abd2f90569c5331b765bd851706d48fcaad930d73be547ef901c2e2c1588fd2bf78b78a417248fa98e2d337d9ee425637b934f41c6a912988320265f4419e15db996ad4040ffdc4dd7b8b46772e60ab8f2c83ae651947256ec95d72986636b02c39ab44a7690e9100b805daf680797d800f7ef8f6dfb45ca8954e81f736f3e005ba7e53f3716ab57568d3099a44f4177dc714a3332b10837ae34fc21ad63c3481b6eda5b7a2d1d97c20332ed9ebab24dc03be6ce3bb6f99d4267f80d49b3f5e6536c104722ec64bdc0a40a07ebbb0a1634b806f2fd900d5afbdba195ce71acacb3e1d8417ccfbc73ac85db82a0302d1958b3ee4fba8ca602fbd69a8d5df6ffa7c02ed703d9277de80272dfe82e8a068a0e8b91b4148c15ba5915fe6139ffb192d4836a0c8de80f2f3adbcc12a3cd680369287e0a6a50a5dce98f4b39f86100190006cef50187450197d881cfea3292cbff0ac4d2d5ee2e1fa59e9185f244c3a74f46054d025c328faf637dc3bd11a86096620f4bfe01f159cd406b65248812dc8216fdffaab2d69d0e832ab387b758bf829e7c0ace33cff19337b97b9d843fe3ed190fd5290e442fccae44ad67b15117d89fa5b2050214aae7ee3dc5d939c2513eb4924deef92a485b05d2623f116d9e8f299b98ea8f8e66b17c214cb3b978e8514c9878fc58e45008055f8885f2aa18ec351bd58e9ec5f964fa1df2f8df723b54c2f7bd8d05658f878d81b930618b6e764b23c71ffe76b4b67dc59547b99b0371a1823f043e9463534e5417ee14116c0e8da0cf22f5729ccc53750e9ae01bcbe381720f98d78b8328b2e3a968f58fa98fb8080567a8c9ab51a44acca3d278b64ee1788ffa91bae8b3bbaf723e95893967f8efc3bf4012bb5b0c057735006a6c59a747dd5105e5071553a15c78d8c575b8df4e3c5a6c24337cee2e899d52fc1152603b81fdcffda3bdd3e4f0342b6f63ecdcef061ae8fa3cb30f12ce3d0ddec3f03937b2c31eec3fe19f7c596d796b28d6b866160828839db0310685478fe3c9d1bd6af3d6e12f9076051fee6ddbdf08a8864c37c951475cdcc6e019845f1bca506ab8c580b317c56691ece8d3efd9e6db674c1f186841d22a27f0010a2d4f9b4e0ad35970e70380307bfbb581d3ae774ac76e083c75ef5eff40e514d619550494232478fd1cee2d771f256000b193a6f628ab682858abd9fa1f246190c93990b65953ef3c6ae40f7da17446339a5a6241849c25d6674d782459f9d3dcbdc12932b3bf58041877a87a796886865359ce7771a7d4fd7bbcce711e9c508cae89ce1933caa4bcfa40f4733191c9b7291bfd82e336af06d89816aaa18623e6749a0f35e1092a67df8aea9b26dfc486540d4b5ce9a0df17d7d24f9f25086179e190eed3c6b6440d3686722d1ba2ed66f4ab5b6217c7e144b4910aba0636267de10893c266417b0f3b7aeab3ae73edfdf4412683ca1fbc4aae02e26e33a89efd1f36c77f62b3fc286151bfd504d2c0e645f28b13c1d27060276e3832ec4af3a148e4954235091055e59bc68ac4845bcad66a238d14a67443f5fcdc31bbadb3302534fd3072ff9726f8cc88ce39d411dd6edc543ba856011e96f84909201261fad3b978d756fab38e8747793f88dd1000d22ab467ae43b2fe2c11b4f1ef755ff12026b990e33e7bb3e86ebeaf098509a026cd2f4cfb198e19d8f7c720ef736f89cd0a547cb3c089f1e59c36b3c4f6904d9796fe5d2d83c208bac5f2a985e91a4ae3cd012c3007b6217c5a23dfd298f8266e82611d562a81e683ce0ec9220fd9745d47d9217bfa573e76476a4691af3a3aff7ff4bea0a04be021f1971108f0f3e7f4993a00645c6f73a104ec3c1c8572c7d68cd6407c53db5324348004a662e2cf60f278d2d80f078fcedaa5dbd061e5061144ed19b8b99e0cb9e951ae8f7aee3b5e285689b123479edb1ab15c35de9423931bebd3f668ad0fe1414bb7f7c71edf1fb1f69e89e44f4e69e67c33079d6f13f35cb14c353be3c81158d06574c8efb60ecff29d5b970047f1b0bc1f833c0b90e4723c15d070ddbe78c62fdd900c0f8706c6646846510f877cee8e09593e71ecf337f5989017ddc574d2ca9101ca37fe79a05564a7239324197037f58a31520cc8283ed2676e814d5f9d58de1ab33b999c385503c9bd93f8749fbfcc972f9e56fa2eaf75974832c4c3984ba8a7ffc1c5dcaf48a49f8d0da452759b81408fb525e481a970faf0002ed2879168d8142bfb99a1cfca9b28c1da0d9c2518ecc9f578444bc0aa86635b10e6cea5969c3d82ccb1b872dedfbc202958cd838b1ea92825e93d0f5a966bbc45709e5ace0fbc6d849e97aa915d045ea32c252bbc7dd368724008c8aa35ce6933b14226d117e304841645069226740c6626af63f3ef2800677751a3c4f6b53e56ebcedc215ed3b51b174f9c8fd4ca19e69c6d0b81a9f97a9be49c928db301348f1154d7a739e164ba65719b78a84552543203311af9fccda79535360ba294a8d1cceab4b38e84789955c07c4017ff4a9080ed2b2f82e2b059dfa91f8ea611a1758ba38ec178c31f8c67b4aaa4fa21fcdec8a2374d315572298799b4da0706e1597bf13144dd4155e7e082b128d56cc2685cffdbfb46fc98befec3ce92b698daae0c6c1c81cf20399df10ee8ca81b158b43c05af899fb626b379c6ead8e4f3c56f50d99fd67f2f0355c18ad7a0db6ab1bf34b20a18b4ddba3e111f8c7189c5cb97c34cc9a715859a2b4291691429d7fa5d8f301da60b3ff383059af6fa3e9cf99eb1c90ef7dc76d09fb42fcb5582a7aeb2f42457fe88b391c1e6829876a5bd6bccd0fbb5a2e3fc1e9002f078b819e4644ffc83742419cdcd3abafe7ea29cb2404d064815d5e300f61aa40fdca143232f84063ba726994173d73470e50578ccf7ea1bb98149fe5ef626d11ca4d9e02ea9e4910bd0cba6d795601d04a0fbbad25079f682bd754bf8273e6d8b2bd0d8899491525f0f1d5076712b88a494290f8e98632486956fcadddc1b7cd46fba83b4e9adba56b625d7541f44bcda0d44e214800ce6bbb5f1038d7f09aeab9f0f3509274f71d32b001c3b04733f894192a46525edcffbb8cc4fc2242109d07f841b7ce13a5602caad5bbfabe7903f3fd22045d3c3a7a834eae741bd1f0cce6a488293aafbee479c7c86add784e7ca7c3cbccac207adf476aaf897162ca7fc7550d279c7d211e5c2421b51400f32037be5c59f7750f9fc386aec0600578207645b90ee2562bc3177242e3bc037d7fbc1ce0193707d0fdb319e18c611bb8e25a713e64af00ec80e18b14002a9f5cbda86ece2ff9492f24b96fd668477a6de0bb7920a284da62ab266f0525d8d307845b3ab98490df0c19184239d6a74b9d6a35d79e81587148f3cb3c4261d5109942874e6c98e48c4f17aa29c5b41aa60f9062f61ceb764a93564f4eae5ab1336f8d9660e0f4e0926c505ea3224b141edc161230fd69e1332c0292af8eecc50ad248ec98d6680476d95d198e4b307253cef6f324e851a7f0555ff811411370f5bc952e08463be9e92840e6ad8e7f1e8832b65aa6f04d7d5c1b16effec8897c9adb82a9ed59bbc230a27dbd421aca607daf12a9a8ae352968a51c48ee856156cad54cc650f23fb926c960d0d255d80f44333686774cd85c1f1fc731f07298d393cdea3dec3580dc13773619686d0c2ff21468891642c89d5a5fb1aac6dda0b2b83235deb3317837b45b3fb58802189d8963ae12275c180f15ef91ceed7eb16f91b7718ac1cdef1dc1fa360bf2e52341806e3b0390f02860094bb11b92bf31594f36ae74f12f575f2f38d0c917af480373ad40a1d976a160c1823663ebbc1e4a2b7a2991ec53223f9e1f9d31297454637098a87995bc27e5c84f4dbb00f7f524f109aab4defb9edb84d82312955517cc88b5a193ed2429f380dcc4ae74b14152ba4b680b0c7a354a1925e2e3fa6c9354ab970e6e22833900af7c21b82d15633ce43b2d396a7d91b222502d57ca4ed610d253406744c4b90d7aa51d5e98c9f20eae2c64d5efe1fe321dc0e467f216423d1a75331052f25a0315473b7a8949dbe34e44a2c6a51815a0ca6e0c55a65d686e01957e58ab2b70afd79fdb91f0843d79be25e80fe4cc3c5472975da873cbc046d6ec566bc87a1d9b20693dfef7554a0af9026d37401df9ca2d16b451c115ff7d0c11dfa486efd8ca15c5de20f386dcbd203b74098c7a5bac030017078ce869b921d88d40cba7788f3f0a84d2b2e4e8dd7b83be95dba33d3afa5818ce3e91c86a80f58c9a68207bc38e694d4bd605cfff6c6b33da04c13d3bebb5ce50c2e7247f8dc08df3e2d98ef24640953f1c06bc61827ac73d26d4ccf0baf26387bb1bbe6685bc4a694582b2148ee05b9c9d0e223f282917ebd1b96709ec4f382d37ce1f051fec17f70792adc38eda0ec12b8063f544cf57bb117f4ccb79a4be1d88c369d0da54b4c5227be9c37b4f588b0fa5d0bc563a55cd2d3417978ac8da6c8968c1dd216a864a56027e62ad33380b51f8b70b24f8501da1f93dd3a00f20bc84688ff57895ae635aaad92cdd8ebbc8e20c464871696046c89b5395e6a24b7d63c26aaf6f91e987258eebd93ac647301b42f7a138728a8567da79215e6e8f8c92113b62d31177c6220793ad230cdcc356af665b8b466530ef4f9d670eaf67405bfc6fdf1770901d9500988be66884ea9194281e8f2757b5fd925a599a6fbb79a87b1533921da09e3d4ad437c8502594fd48641856403d17c8eee64f9dc4a1fe623bc1c1dc5edfeb4f4dc3fa2777f0d2d7ad98898eb61fac3f9db81ffeaf7c353e1689dcd17af8a06e7fc2d87275acff3e99124c6952eae7d96583ba0134b8e6421839ac43952eb4a725dd2f2f51486aa8c34c61a864f27626d96373e55de299aabda4568e3fda2a05c27c95413386e2a9d75089807277c6922afe87ef5cb7e15d0dffb2c1d08b85b365d8a446fa7792362b867fea7de3447462366bc434c8102e9429b059493f7cb5cfd4fc14d42f8a0499bb6c99b98b875c227168c20ee92941e5d893b632e39b8942a647981dd25199c0595d3aa8f615b35cccf4b3ec04b0dc5706f0ca22a4ea68fea3d0116671f25564516978843d0eaebf88cb14e0a856b8c66f5f3e4b856232de1ff88fda169fef38f537585c98394343556a2780c585befe08aa05d0646078607975c72557715088837580bf9b79a62082a2f136b426d46d1c7857f19c185ae370357d24c4004ac6a5e96281c8d9c1b6b47a2621d871d74801c81d61dc4bec99d74f4351b8b3366efc4f177540b0811cca87da5a8dda1ba64d8fdfeaab57a5431ed1f03b3cbcb2f4e9bc2bcaba549be94255a0a96960bb967360fb5a544db644381bfd9e7a1202664a09e44a1402a64fa2112e4968ce844c9f0db1473bf88642f0b3b0dba6fc890de825f133a4a2fe6706e84f58277ae4690fbf490e87e499b588d09d8731e5fba6f34a31c7766d0aeff3c6baa86f55abbd673a649d26b2227132740341ba65ab03f84eb2624553edd4d5dfdfdba79f319b0cad08b1411f5f06d95a6dd95b4f000377dc11b6f88eb0de7f81d3194d19baf88526d66d5f98712ee304094962564b20e6dfc8feb9d1afd2f91bf430b7136e9d99d4ca99952b098b75e21af913ac3ad7aef315a8b6a53e4bf2e20ae41b25450cf6b185c338145ee07ec35863b0f449ea12679bc5dc170645e1ddf9199251e8b35ab1f0ff351832c2f8d6bbc40acc4cd0d814a7df729b230130d8c1d08b37d68b071ee69e22d5c5a1760d2b3d462a027c2596fb0788b94b15973d536b60b475b737b4c1cb42bb4c67ddbb171b94ec16ae6bfb9f19912d1f1d19753f4afcc7067c39583f5aa8da89cd58517462293fc592bcbd12be3bdfeb68382917d6395a052d9dbae6fc496343e62156d4dbbebaa68a531708986d98ed3723b57cc4d8e8aff1142cd8b57cabe48a0e114abf7bc3adcdf94db12c6bc6509cbd72bebac144f6ed150ecdf612e76668921d1d37747f411cc7697ed52873db97f955dc20a5dde71dbfee9a17d2c1f66a03e72b61ab2a602aef2f2025bb65330b470ff2d37e7bdd39aa6f620948b34118640a65263ed2ed998b2beea526d5683d7fb83475286bc55345b8905339e3a355e012d166f97261713b9a8db7203065f3a85ff9299f0cb272f0960c72cec31f9c786b33fab9fb04f9d7dc5a01fce0667a4cffb3b0be3823600e719b70178b8215a1737cd74dbffffbf28da8913f7195cf26122f53f89dc3e908a225865e07ce4473103f1f0990e5aae8cc11fbf566bf07af15b6281d4a53685012ece582f8a08fafc3057eebec01a567f3310afc30d5eccfbfb67e3e94bbb56fc0efef9be21dbc5f0c10a1b9ea9526e3de29d208f4724985cebbabfb43f1107e0ae0c5e3487babfd7446468ee017dc7221df5c18392c91fd4ee61b0e43397d455aec20ae26695484f829ed937fac23f04b0b469f104e5b4eba941f4d6eb070ac4fcbd406be6d70035df2215caa1790fe97663c53959bc6f08ee224870725b8d06791c1298f077def6a73cf6691c83ed771a223a3879cfc209f952bdde7d8a9513dec0f6de3086ed60ed3bf5295c3fedd2f427198252ba6fe7c1357e0422d1f9a90fbbf017c1a30a6fa3f1ea54f278e133d60802ead2d0b7d539da85f07c94cd3507818e9f8a4fc82856d26be4d95e6ab83d80c42060a6fdcd3eeb3f6781d002dcd5d88848eaf95b0dec7dac94cf62c24d2f9dc61988d6d41487ff094748548a9382c849b7b887e6e8e75c066d551f117b10417f20bc5c03946d1d67b92525ebc3c767ea0016b99c9139b6b34f7b5ddd9625e21ae648d4d17f420d83256ef788c7fdcd489e4d43f903b3be5e1f04d64cbf7f30bc04edeb55550a9e3fb3ffa6bb3da3dbd6d6aa01d6be8c74d8b5eec71648db14057a05bbd7b1e25e3d65f9d21b6994e51c679870f32c4bad2f8bb5d9369d2706640261bf292631e5f67f2b2ab823438245037bbe0f1989c9c953c01427ebfa491e13b58b655ce8a7781a91b086aeb70dd4ee26e10d5cd7b7c2100c435cbc197da8ae82f03c2332dab9d27e1dd933aec3c486d60a7de8440c6eccee30c9173680322e8469f9f074fdcc1af58d68b3b33216c2872ed759ca0004006985df08787bb6759f15740a9d0f2a6e8c3c513df7cd24fff481aedd90e8cf697e665f03c978b9f1807df3ce3045762baf09967dc93d3ffbb088af110a3b75454f67fd4e25a96d1054a54c257f85c0b0c9e6b8ad27a21e3c95f06724fbb1c10310724db24a0468ec0e6f853a35bc91463b7165b7a0e2459ca68abed543a1f68cb18ac23b53ebcc07eb0e089bb3b5c61ed3a4649373c8ff51768120eb122cc99ab81ada8b619b37955501a85dca651ce4ed43d134b481d546724f52173fe1d637d98c1e6f18107544fc1eabd5ddc5c80288119063df0456846fa4357e1af195b397452fb24160f344571fa7ce8224fcfd96c344cbdb4f3447e3d07b1d67b6c6f0ba2136f93dee7897bc9e249321cde343a95e5388ab8b643c8c316121480e801480715c0c8141ce4dc59f664c4922a77e277f9bf2570df697599123780d30cb5af32a2d81f774920ecff69639bf1cf1293576bb0e218141e805ec00f5cb18ed6ef18171c21d2b39889c08600b06b53523a6f833c6449595e1622a56e340cad5e461e3d6b211c89c91e4e7ac32e8f43fe8d03c04087bdeb1a228a2822dd92c908b522bfe3034536b30c622e5a4cf45c4ba3b7f3d5701e6b99541114505f30f3609c6639ea02154aef7300b2733d0120159e5e57fa43d5a638c8abc05bec94f62614d8380d16b60c955a159fec192d0b544db1b525fa847a83e1162a69f6fd6b67f9bd93dd27782b160528de6ade2ddf9239fdb06cc052e1c012c502bfe3969076b15382ad32f666759eaf2bffb8e7a36253b522e658c94d36a990847aee4c91edd6a22019013e8d18460e487009a1b94918b71db0e6289959eff72534d03fa41ab1773d2f47f2e2c0986ac422eecb563bf0d72de250982f70988858bd03f202ff66b4da68188d2653a31b34399c7920c70cc8310d9e54e8ad6945e2ee732289cd57dd561abb0d53d11c2607ce788005ab41c7dc42beb5027d1ccb581edc76bec246a9d7a4c68202d583bf22e1d3683f9c1c30fa36995bc7c8da249b7b244db958199c1d3e7f8a447ad50f744319cf7caa09efb5395b4765cc82a8c0f63643751fa2d80856dcd5e7623d58f967e772d2279908391301d133b7a10a55671351cfbf77a06052f67a124c4ccf9dc8d2242866ef5c6a819f074f0fbda90a8a42024bd04b0268025bfb1dfea94f8156d578296cd7aa749d11443c135105a223d1bc355ae3c37de149615a0a188fcca044ecdb801039b1a77d3895ed8207681ac5e89d41310542dda1de56ec448886dcd67677c00f8624796c8a4e2c4d9f6e99b63832634721790e1a48efa27a400e62a580ea7040278da161f65e7654596988b18d714772e3132bcbe4341285a21bc07878aae57d48659f275bc914c01fcf4bf9a56fd94e67a37e90db32d7a7eca4b95b7ac0536c6ec78e2d544540f168bb06f0daa9eee3bafadfb3626741f5b5e6800790b7152521b7a6cca6b240cb8b01ae75db660f48d20f16b9e4655eb9520cc664877819181be1de2aca785285aea6a3a1e534c7f8f0817b90d57824cc82a80cc36ceecddfb9a381867b0e14e50a593d3d55b003374277be5101912832ab5a2ec886b20d73fbd501f8517b120993b839d7d27de8d79c570c33ba873a3a36b4166277aa2abb667f3b51c677c983c87c266c5aa04fe0651b31d1ed7d5763305aec2a484ba024fd7df249a536e6e924f28f8c665120a89b633f9d0de7eb0eb52110c4997e74748971825bba4f5eaca79354b919dcad6a3931b8d64a7a66a3ea79bfd69df12a281fa31805a5abc6662da790191d8906f4476b2ac03e7b4cd281c35b4d9a5c8071fd82253995b9b55fe513137ff37ec08f7bc87363066477ccec09fc8515158fbc3dad2e729f70c114018b54189d291e3b81ffb1225303382ba0d524d1f01819f198d9c5f29d8247389a6f9583ea8960c38fca491bf8e9cd5ccd87d1d04ea53e7f35a710e4837f1fb0693969ade43d0a2754d041b18d1ef03c6ebc028ed1ea0d139b3da6f9f418af5e0aba442129d0cf630e64202da9f7ec9632b7288c5acf5093ca9afd95a007e7f809dbec14b636921866b59e5b65f63afa2709db696ca4b8fbb6de8da12db5cef1b2cc94b68c31dce81c7d9b5df0b6588344bfe4e41142adccb905d4be4d71b55aedb5ab3c1ca5448973241c9185e89633295ab3c19dbefeb369f6709caba920604238b7d0471353b6a507c3ad69bd4d6617a258ace8a51835938f219cbc842d6efa30ed3dee2b3a4eb3c629aa824630918a508bd8187fccdc9b8d3b19b216594f92cf7429a17c1c57d86795c3918f593ebdd3b2b915d516cd39440fbef2a20242773d518206f5d8c6f17a88bba2ec7b9bea4fd51c89eb08d5ea6faf6e772bf60697ad66c870274a4f9eda9abbe8ebd1ebc59440e84296544f76d64d325569642c445650c90fe5285c2224f5a3c867fe287e27f530ced1d9faf365fa472606bb281200ce52683700a66532d5d712d92292b8ec37b90a840d6f6d0301f45d25cb78c6d53dcfa7369b04cb45da8f65b1133eeea33ce9663496ea2aa1c0060593821bea9ca2b2b1b123887fd5f0ba4ed84b04d5e159f92417b797fc096e9402eac2453a0ebb36586a4cdc1eeaa81f7f6e3e2a74db9cd775da8cd81c1febb02a13ca03d62dc198aa721d1f808b87e6dc77022173323f712ae6695c32f900491f6febf4e991f8c1b44d9808a3b36b2667706cea62c425931226e0e1357e2e86a0444aac355037bdafb7aecdc09b9aa4819e64fca0a181c228acc79b50c70cb70d96f544fe928b3c6ad3ae5ed44f34c36b88753d0daec38b8dfa28eae455ae766eac265afefb632743dcaf4748455bb755d8ef8ec39362ca598181a4afc12e23f6380decfec46c8c7377618876e35aac24e2ec700b3d421fb0ece568113edec8217a32a0f8b9fe0334a6b36885a6c6e4da96c12c141290669542ea434e5002b9d3bcd011703be9125936607ddea008f7ee8c21b4b30e0edf8f00f36601e2e66a21f307e011c84a2bac65eda7327edc0f55549175f59d9014821fbd608302ba8f8017789eb69d3db0a352a7412d36ede14e315b3c28366822443cb243df914264df69c4cf069d7c262d8284b29fa2a6433d76ba19a07c7afdce192d32e9fb16b9b1e3643d2352d6b2c58087248f7f93fd7d9994374c57601b4d1576f9ecfd2decf34fd84df8171a82d718ae95c9a14ce68af4d18e15cbf9a54805694023701f84818473228d011d5395d38c3c51a1ef59787aa895ba4575da26bb50584c9ee42762566eed8447169678deadcd00b8c3315dd1194b24b2b7d91c9d8ed0c9cade5eebc5e9a2d9f215f8743ad247b4ac625dfd1eede4314111e60b27e34062e825a85af71e783a056ed29d7d19e57a75ac19d176d4b1f79d65da63be78903fdd892339f01a447496b1fc1a57e49034e0ac49127a9aff664040bb7df162632ad80d76f8b15ec2f0c82b46e29fcceddcca357c29aeaa80606eef7ac32a254d92e660f1402eda74115a5e19bb22a4ed645ee7599ad37f4d692cbcb6b19ac00c2a07b07b992da1ede009615a43d7436a352265705297f702c0cfe21806159b554722b2652193824b91c726da62b07a05eedcb27c0703bc26c136bc1e445ff3cba25452c1fd4439dc8033fb04a3cd7f771da88c98380f8bb0603ad9e3e9ba398fb91c1edb173335df1c0a2c606b40a8c5fea7fab6d86001ae8e485c61c0769968502658598df7d4f9f6ab3f80f916044a665bdd2965025c118428dd79cbe2c02a1cbfa59a9d227b84f32e3d810ba2941226194635d1ef65f0431cadbbd601a6b4101f99938d0ba5f2f17b5789e0ef38b6f2ff05a9ddde070fb532e9efb20c49c63a024fba0723e5b59f5787cd62fdffe27f4de8fa7cabc1c8fbc7995d92ebc12d90fa4c04f35913fd12978ef7a0a9c8007a98604f3e24d29462f2e438f89c454b24639ec6f5965739432059176ff192f1efce3788dae59c52594589b6b0678f5c7625d6ecfb997fabe05526ba30f09e2f3c39e5ca2fc2cd03c072a5d9eda613f1ff3bed76ea7f43e6a087219160d1dfd61a99c8a137488f3288ca2cce8b1fa629a4a359cdfe444620c274dfa65c9b08a22ea2cc54b5649f74bdcf377ed35fe08fc703d76f2b79fd3e09839a1db1c0f60750845ea1f512f64ecadccb3b52d4b3b1c6addc55694777da19ef1431746e47d6577c3fbc1c6bc8b88ca70aa76d3b4d50d2b3e9f748a7a54b41ae04bd2f4f5f02695e3783bfeb4bce3db37e1bbb99f800baee1939ff81391b6ba629635b1eba0b6adf4a20ace14283b682df858e15232329e8169ec5684bee6f9117f1dd64a31d04f14e40b508566b0af3255b2e714d4c5a0a23ab12ac4f3c3f115d960003bc5389b5e17e3ef489c6489951bab26ffa46d4118ff065658e0bd4a81e8ecc92a7ee0c6ee9a7d6e11c1fff1cc902d75b8c33f5f331c43a50f786267dc9dde881b4bd2c02d4b5dcfe1748b58ae1812c0c716342aa7df6e1160272567464a6a219a35e8059aa718e66e6fe198f9a4045daa74a798fca3a85f3c8a8bb1c94980c26a4b10fde25c81a4c6987505d26bd3fd87ca5791e67205cb2965a8d89eea095faf6911fe2b7003c3da8aad79b531a19bbe6a24872391b346f5b42392f194a3f13b44f8c4f5845eb6f4bb3db8eeb053f20c2f3d9750bb22e899f003229daf029e7c88f231471822e33d1327ef0c12b34867751acf598afdbdad7c6e9bfd5863fb16656c25bef4a5eab751571b81e45777e8e99070a63246ac5c8350cd51d61c5183e2e2c61a9bffdd44f9b9195f9d30db5206aef069948a7b602db28dfa1c711493f4a3a13889dd86eb4e5a4f9670f4ab2bc26462dff8c583bd270284d9d2f98f64897853ee655c3d4bd7206ddbd382cdd442f83bc35e0d7a4815d87366ed2d3e8f04a1b2ac128a150455f81e84882ecc48f99f8265c3b951337cf12e71841f9f8076a48ad713b0bd2c0d0e63f76237bb1ef8912a93bb87d93fb7f2c06304bb42fa2bf435eb7caea66972326e53431d065142526f05d995d88a8e8bdb1d8662596caf75d4ac8d887e3345a72d5e0142d922a613cecbc0ed7585f4d717fc7bdf2278a159f08db45a681fa55e68cabe580b70cdbb2396b568cb79c1931234a3713c2bda00fa52d80ecfe410fb3fb4e6924d30fcc76edcecd9062d0a47e6a60a374d49470e83ff5a72a0cf62425bbe4211787a6225126bcc4f44e8778c6c9248ff4efe960858d23a649e3bb3c0e7300e3d91cccd7d139f9d2455be0388de398c35a3e6563b5115d26a3af7db68089dd516b28cdbf192585089a4baf9896311d511dbc45be009a4d9b1fa5d65d5c30853d6e383a8089b32ae1c20e6dcc9bf1e6858c734995abbea4726f58f2e0dfe0d755f90bf05563ad094a7340b66524b3e8d637d75a9768fa1458f08b4fd924b9907e6c818cb9568724e5be616f2112435d4a6be5d03a7e35137f0cc0745c7453ee965ed5ba0b66ef2ea76100bbdbb8a5d510f001ec1b1232adb1692a2d86a245a15ee553b8be42b40bc7cbc66966a7c80c0c94dc62dcdffcee1cf748732cb6a4033d5671729a8b2f64d70fe83d31e10e78b173ba87f6e5f20ad3033d2ce46118cdfcb6b4c15f4eee6aee5c51b4fe65631c37212ddbae7b0a9bbad1b152a9bb80ab76fc265be94e36a17ff523dfa55f07abf7df1ecc5b10ac6f3170b386660d918aae37d40045b9d934e7837394cf4fd2322e24fd514ead50b69d3529cabfe17664993d323a89e97cf8a13261e06cef6ffc83a106f0e4e21117aaf5ed61136bda1d7ae2d00a9cf6a11e0208f5f1d5011f5edbe9a50b559ff506827900809486a68f66f39944bc41d4bfd778ba20f2c362f8248c2d1ccb28313e11af5e551f8c63416426ee98127abd087019166e60d0424d9a1e9881d4108e18d7d0de70c088171b4350229b10b6d12d017e905ee149bb6bb4c6d60a13ba089829ae5818e95a02a3d78481989934a773dedc9fdbea80cc3980ae838f344de11ff0bd2039dd46464c5755a1b35d01d7ce4deaac7d9f43e2dfa9d4543f77f3679874b91e8be40455ddc24a8c3be08816b3d5d2a134f739904df417540d3e514ec576f9c3ffe5504e43c8ded002f968ebc96f8afaef8fa7a7df8cf5d41d9d592ec773457a99c8dbb456524ede4d2f42e54eb18978c8797e32bef868c05d86388d244b2e3a284a3f16f425b8bcc284594fd707f62fe8a1a0169a9e3136570ff2875f1c91ca604c1a47f37e4713aec0545175c674d6dd3143680708edcff0e530babe4f18491c5fcb93f8791c8fa537a39e1eeeffc7ac86597438b3511b6a118c646df7d03a6b0ef93c32d634336319598a16ed4be2cc25c1279db78ad5ce9382dd89f14c3faeb6d2639208c704c76c751b82127f05ab5c6260b44cfd7c5ea421c10e0fb1e6c9a509df8212c3a9dff27cc02bf076657668da65d1e6772a25ef0a2fd97e1157b32b431e7a88234b9ab4a9d98dfe01f7947a620b7d474d118c15f85fb531abe4f37643752726ad6301e8a2a1c2d09bc602063a2dc40cb4212b98e2431dac44538d3b3e7a6340951171475a938f75c1f8788aebf6f747cbab59f209b09ba0e93367572743b320c30f38b53460a29e4902ea1b10e90f3a9c09f7055cc078161217ec810904d793c88ae28f8f58f7e60c0d2b6906c1b9198aa2a41c08a864b39bd26145147dc9525661fdfc581d92f065292f4604214bf68199c06161791aa8d7858a1d8197d124b829f6fcd6c089620d187ae3ae14f5c62e1997d2154cafa836eaf6bdd29f58c6fda281b6e62184cf3621e1fab86606a872f569400c36a5c5884e3b9d34b1c2928e19743aaac20bbe5dc80f099d5a06c2b6e7010f81d66c8151b70d9f295e3642bad7365b562981327d0a3c228e4005545c7918d731b7b475bbf8bc3ae7a30ce70f3a62ab005ba0665290fde5f4913f154676b0ece8d114517566305b885bc6e914485235728440d353348182f309a340af0e77fcd3c41bef7f5f0f1f1160750e86334c639496562b7a551c76ee14c731c8df0ec438ce5d0dca9062527c209a1497734d9cc232a3e1da731608efd2eca61e7f75b127c47c5b4ca057cf3fcd19f2bb0903fc12f28af013e32437cf3cfef69863f1f1eb083fd6b19bcb64972dc95a05172d7c55f109b957e1874e8e9da6b8b52713331ab048f4f7719bd16394b6c1a5ab5102e0dae668135864254b5b8f3ef68daec272774fd6f0f7c69bf135402c76fc99256c63991c9b94424fcbc70df78253e0eee10ea193416c090e1b6230e5b378ce55841055daa34cd376083b0540851e00c92923a97d28388f8cc112549c6af2c6aeb8ad35c4b79b0c07fe8e897e01158410dca06d30670a852c749d502183957cff2a13627431e0bee87441a214899cac277dcfccc7705055d11a5aad58a3da163e317a7fe7e0e75873a3bf14abe69efe05a3b1ae2fb10c1f2fa79622211a5eae6d6d8c16aac0bec9fd7c161e2eee25148083ea3b0f9a75dba8837da2f5cf741da89e9d2ed975dc6fc342e88addf3d679f78aaa5d59c64af4712fc8840bb631df7615d10b9a773537197e47d8b15b1cd220501652e5474dba7799124da016f7bd66472d4e8e6121a84e0283e7fef9bd3d6f2129d513175c8b747b6d3837e363bfdd5fd4bff258787a4438abbc6306f04258e22259371be3a0abc2f9a4aef7153b74b65010be37b1993ceee8682eb6ff29dbfa595f5473fac5dfe1ecff56ed83e13aa919188bf71b6bba3349e41b1761c3404a9bead3cdc7cf83c91beba47f6ece3687c97c34b229c0cd12586d79e9cf2e20427008122455f5122756c7253993cbdf836def430545bf33e76bfeffff164f393489a84e256fb4f467846809fb72fdfaf3042d39757b2a907876df14cbe639148e44cd6fe99631e8ef9fb8e1b1e8babec9fdc630b5ef5cd0162a876ba14422d5ffd3d7661f88a3dc244688e9f65a5324d34a1d91a409f73f0e5a624fdabafc4722f14caf79ed32cfec96524bb79d3430383f002498de10a39733cdc656ba1a7ff91b39cd14b308d407994b1fff11bb720e7a27ae9cc39d4f147888f3b4fb1a679d41d64cc76a55e51afeb7cc4c6ba278315933a0117beaa41bfdea7850986e1a767bf991f6e0e020e8876b7c2c5a1d30086709dee33a9f9ff3fb0069e45adad18da0e2a08ff2fe8c14aad82d0af86fb20722af4282d6171332d161da446a6ecd74e668219884c3cca6bd8187a885cd76ea36f2ebc4810175f42cac4f0c26c55bd79a6dc725ee029fc009412e9d70088403554c02fc4e8b868139ddeb0e4caf2023b536ce5133ec3a73c5d47119ee0e9cfb8c416085c75ba5ab100cbbc0afce149570068af17db00b7824cfe8218e3185c0f4032ac05df74451576f40c2","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
