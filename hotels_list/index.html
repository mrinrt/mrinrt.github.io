<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2699d5bd8669803666f7a88c505ba470c96c6e570d3e52a583f16c4451c95f980c95457f249595f7e723621f609d7081c113ea3dd8ed7ccd26b1497782ffabea1bd45abc2c25c5ea5d918adc5411149c7f7d80fb2ce7a5051f1fa67ab1136e9897397feabc06eca7ecb370bed146987b773ec403045dc4c7b8bead3ed09f0548bae74519cfacce6c61309cd0f58e4dea26bb717f860674ba726ae08ab27a585f9760060ca12442b9ec089c3240aec4c0cd3309617569a9808fbec093f338c661c68fbd6eb994150309c8b2adc7fd20c02c7903096f44c1c4493937cd2d41807cce5e3ca357a6f190f4b9e2bb6f2b3a26ec61016db61e37b45b4a71dae0cdc73841e0c7cd5a5eda3784ca0730a9037921bd38e5a9ceb42e36c7f30f39dff886cc46c405d8f87e484a8244d26e41773395cc05140ce13fe55cb6ecf7683982470d3339f4f6939400af13818941df8e227f60ce8a0a4b3aca254cca253ca3e47a62f842ac0aa8f1020bd4ba8376f1a87997906845d9c67cf58561f85b18cbc07f2a5c9ce6e0ce9e10ff22817ec25a60ed7108ba82f83694f687ca6afae325fe030c256c125b4290becc62a9805e729c945877f9d55ad33dc5c1b40cd3a4464e29a7801de1e2845f00501ebc7c424adda621c248414731a268cfd4ece53c71fa739a98c6e90978e482acc0b86fa40d24f8149d6707164eb7252ebb516f74090593acd724be4cfce935a62a347656a326b70b631abee77ceaba7d9df754566ab97e4e1c25300c5d50c207decd3b06f9443dd8a153f22fb29a1276ff730c684406ccc396221df756babbc0e40865a9e0719f18a9e503216739b20252d325fe4930aba73eea4962f972fc11f9003b548815f6bac9cb8969540716d71c53530aa1229b87e19539437ebe87ffbc4384acad1f7df9b5db33e2759a49b6351957080ad4be72b1d3d0439c2da41c0c175f7922b5e05dd76d5f5ff7eae598855298529a424a6f21d98f4a2774faeb2518ae6c0d6b0f3e2e2c04acd94805409dd95f0a73f386341b39cb6bcf2fcdcfceff4c06e1bcb51a34f67958769e44d2cc0cab875e24595f77d68a10f02550470e53f69065e540e0db43bc927a88d0a07fd89600a5d7006c80845827906aa65c2f1fdaf5866e4206bbe63481fe213a121b84d7553d4d7703eab15d1c1ac956fed0540b310085c512a49316d8bc6d7333d6dd6fe3e3e3677012e8e4a7e1235bd4d40762ff729603500ba593bc45d616d6e582c937b1e18e0db7fb2b43ac0e340e12d5fcda8dba3ae4850f788cffa9d9dae90f7ac62f0ffe1fcc38f613b66ef69fdcc7613ab5c31b040b9db8131877232180674d14a7908cbe684657aec8bca09d5fa411fe3abb059ccdde84a6287a52370fc03cc67944a3b81886eb9003dd0945570d21d927c30dd26ee7c13db0596406972b8d83627fa670caebcd457879e9f99360feb40a09c087459d2c32e83a2f9f51f0c3f3d595af72b7ed1a0f3f13f66a47084baa3ab6ae9215407659e2118ebc35961270077f8b3fac3b3a57a2b9d4944a446379f716a9f0907663615415410abcd8c0d6f193a64335d6c4a71b43136d463b088eb2865c91359b42a8a5d5cf2055469ab54497e634c53470668cd01698efc511dd844e052ffc501b1022a41da994e7c9454c34d1d89a7e11a4b88928e4b4e5dd5cac4d231bece5558fe624880d3599943fde77dd9e811c2304e3ff8f5d907b9a2dfb364edd48d101573d08a7df023668adb398e245d00f6b659336b00ef24f8f457cebc5e65a483fbb9291b6bf58f2062f6f2bbe2bda42fd908422e5149775b84625b95f69023ec9d59431ad5cfa6e384d3455256a6c34e8e9fb379943dd849ad3fff7f9dc945eeb1cde83113bd93cbe94091b466f79ff8382417824daa9a7ed36e48833851248e67fbac79263f64d430d3eb268780dce6f75eedd7ad5468e45210ff36f2f1fb7a52158f459bf1bcc17eeb33befa18ec53182bcfb81101c8e6d19907c75cd18e2a6593cfdff53800dff5782e71b125661f9028897b427e99c22c5c77ef7dee79ebcd44d27eb97c82abe6311a6283073beeca3766fed5c322c42c92d1bff31e413c277321834d7089db8b249a3d2895735ca449d7b07565aa8e93768c90295613800d11da777c44b3c4d0d1680a281931c183305d09e907da8eeca184d2d628280233ea3fe8e9528647906f881b083b382baca368b582e1c8c18bfd3922f1c420233024fe5c6489d647fb35bf9dc7f0a1fb46605722ded79afbd22eddd6ffe91f35a8919db015bbb72c3722e295432dc3a6a51bebaf72078f79021fc9c87fa1be284e1176f1e4fe00f1632c0393ad4048f4bf9bfb896b6e3b68033f4bf84e6e3e8d4afd711c6be1e35d4b29f475dd81b59b74e3657cca8dfee6a14c38b3eb963194d777c6a8ffc1a6adbc549712b67138d8db20be9d80edcf014520c5ad00f329905eb69696de85835e623ccb70c3f2f195fb70977aa06d3ba84b2af934efd208c599d4040ec33dab3a373033c6b2f27437f0489b48571c2b4b0b42946e818f7e34ba6d58320fd764a5db0bdcd814597e350403f6dd3766736851aa34a283e54c205db06c1418a7da0f07a1d20816ab867d39a51f679503dba845a6706c587c152496aa5b8f20dd76c0040ab939137532be6e2def570a9f2cebd451ddba94755387c060487ecb20028bb27f7ce767aa0011ea12a538c4b83df8246b21b0a4da1dd2a88f3bf599ac4c09256c61514e5aacb05dc3c6852b3be2bf1022a08df17ad938bed8c74e025e601e9b5fbcffd57dfe9eb7c2e4da85ea15bb417ea234f91289a55c590287c3c1fe2bfba0408e0b9ac8560dae8a43f20f864284cd2706733697006f2c0cd6fc173826c99ee9c5e82e5fb993555148efdcdc35bf6e60694deb32402ef9cc7e6f46ca7259b364d17bba136705887eaefc76ac9115fdff7b3a76d1b89e71118e6bc3162094e0fd91ec2d86a7781365e79ffb57195100832c442e7831cbbddda648876d2e25d735cb68284603a260e560518dfdaf2d487ca611a718060beabb26765b7a8038ce89c124177955b02506ebcb99ad0404e9f51109fd5ca61b13cf2b4a858b34e2950c1d8d704718cde86c11c671b57b733a18543dd4c81921fda8e4710f3fdd8df77846a1e9bbdb03b26b63adedde4818667b0b28e69917a398e9fa8a7f43c7d1df3b0567b3c5cb40d1bfa09c7609175ee5e141d36ae2b77eec2892ce42add07ac7e52efe960541f857febbfed13a5cef974a45f435574719be07a61e2d8f55f30d093dc0284d2e97dae23db64d227007b3b1ac6c2e4a5dfabd92d3d272aba9e7ed9f2b7ff714d7f224b68976146092b3573ce65bb3ffef21ad868221551f1d6c2b4023a0daf797a97fa95cc32045c0f17d826336c7a963cbfd9cde26e5beeebc780ce929b6e41c9f429d7cab3131807538bea93faae4c5e7fce9f72c4a74d9254339faedd94cbd9da54f06ded58e6516e2f0b5f8ce6c8bc5aa712fef2301af79425675b23d3fe3c45f25f850f8fbd2d161e1db196a9b0785b011440396d1d6f9c9964f34340b09c6656e2fc14769677ea76d6fe5a18d45e262648bae48ae2a94360c42597f92a495875ba16bf6617c2328788a80e230ad3c5cf97893bb0a2072cfec7244c471f0ecf67f090cce7230e3943eb1ec76d40ba673e75523ad3191abc5a02b110b22a0e192166dee275f212581e1278ec569145b77cf61e7935ed8a881fdf3954e8d44bd08ae7aa302d792ca82fd59b292d2edf4b4e7c6cacac5bdf80ec380bb417cfc4cd701b515ee41dd7481f7686ce2c971d8ef2f4906e8af061cfbeddc80e2dba8c5b395128eae1eb0b03942fd29a755b7a6ccbcb20f94d69a9d01c9efb3465ebefab2bd82ac0245c362e2b82a60aee1fc2697ecbefb46fdeb33475856c870dee51ce8513fe35e619d4e23da68e6c33ec02f823a1ac0157cca4b31b2a3f7e746b0cb6732f383a0686e9f700503a2c6a7cb5550c4b530f18de175aa09439b67a2aee7257a0104e3556a8e6080966a2ea09a7b7a516b43aea091570dc8bc788c47b0e60b7b4549df432caf3ad8701fff6e9363ce33d536c346a3e0427e987cd9c32286bb13307a32b4b537470157d9ac575c4e9313c9eba8db10e55cceec251ed504e9f53fbdf40e30a2f3bbfdf82da996f1f9c2919a52fccdad58a9321117d6676e3af45405a9bf8f4492662679d716571027650e952e1fb108ed87d86fbe29ff4931e5c3dba45642fc74c034c8989d691e501bf0bf5d33e99c52b939f277a2cfb479ccfc19a2fe8c9456a3f524a8c62ffd6ff492c769ab39cf0c7c9615d7f78022949cf625bdefa916a5bb084d5fd4e07438bce13d842ac62cfc87c11fbb686889f22df7278d9c3f2b6794070ad5b51be50009a3ad20e469ead62affbb364f4c3d335a67502b2869a628502e5f86390cb8127f6b04f7cc53aa28cff3997908fa7acb7859f827650fff0eaf0ff4d2453b721cd841db8e1dd3bba639b522b81f9554e8c99a204ff02273fbf5f269227ca89da7a65e5e84bedc7b77063ddb3c13f678d457ebc30ab6dd3e1303c60af7d1c0020b87bd9a1d6feaa5c1748874aae16d898a2888d96aca777374465bf80ac560aea587766eed6585cb77de7573423881dff6be937c82084b1ff127762276b12532c3738da53800b05ca3bcdeccf3353dadbc921ac73471475e819b5646bb7031d7315c7304a8d7b1af5d20f930918bb1c549861aa6a12d973f0633ad44ccb2d7864032a72ef6958776122c140e650dfbfa2977734012137fd1ff94d1c93a817d6e682a0f585fbe28911282235c4a002e100ca2b57fefe3b877d2b36ea46b7b77006013b18c0e64437df93f0bb66113c458b04b2769dd533c382bf54f977b89e59d231ffbfe8b7ecc24fa11e2c29e40472be6ed128f60613ac914a0fc60688cb4bb99d49a8d1043775d9c33a87717cb333e8e4ebe733a2c095411ed28fe321fef7b3d63f31170c1e92fe7702677eaf349bad97597b56f0200d9fef51b5cadb35d333b66aed0256810bde42605bf270b4cc4c83a92bcf6bbd32d340b5a4c3fe65e46b37cefc3caf7322943ff3afcc6d33371be2139fbf72f64339436649a96880ea36b9b41821a921e792b996fb66a3d2ebd70e34b245d54d6aebd1a1cec5763242211c05980a289b79dca717cdc42d7899992e7f62fe9afce80af734a6e454171766fd66d42abc0745d420948026208eb72153cf1e04d6f21a1ae7ad87c6fab816aed52970db87df630c766639f6486c8764a44f4d986f70099333cf451fb62477151068156c50cc521eec934a9496bb9ee095d804c03956a64b1c604b7c60b8fe49dbf5c83ac2a0b9389eaa2b22950bdecb1aec2e886ce4a3d87850261647ed5ad1c13c972a948747f8cb17b810964a50ec7557ee5223c5df4a6ad5182a4607aef7dd5b0c8a5054379708bf311f0eae7069755c8f56e06f36f5a05c9ded679e6f646dfb56efe78cbeda600dae8153d25fa610acc107bd5a974463f54dfe1c0f3ee94c9edcaa3c8a05e66f35e94d6ca94a4d8e25ab8467322b26884d0f29dba19790c310a5213096067900320054230b765fe1c55bb5af522de430895aaec0abafa3dd62af2a5717c3081d6b04983b80ed650b9f43801ff568842867038db6ecc0889024550614ba94cdeaf4230d406fc7fa398feb67747fe7e6a2605990fd40d833e9f252f7671be6c282754c7871896b02721896ef4b33eba5591800485011c2456f1ad949f52de4f6efe60bc42cd4cf211c60efc62fdc0b91461b33100b6065ed68125815720930cc57c5e6882380ee9d2c72eee93fd062c6c547346cf1b92012afda43c29708701b07c448d5fd1368cbf7fa84ccbdb75550fd67965bf5c084b78ceb6beec6ec38b094191b0aa2a18e7c8d47b64d0dbc10d8cff7633ee137662596957fd781f7b50f01a0011004f2fbcc84e13255bf8b6f07199ed3c59c2aec5898755e989ba24b9cd82734153abc6b461543b48e0e24853a0c5f2bfabc0113e358b11638b8398f11aa8a05157b71795e4dccb24ee358681bc068c7ed50f5951dd6304d2c3518019e78069bf63e651d610abfe470cedd184df21340a71643abd36d2c479fdebfb470abdf6c62dafda1760f87ead82d6bea3465acad0aaf44369a6c4ef79d72bac3298e2e1461be57316773b73d41bea349b98f33e288ea1ddc54167d3a4d1a4faf695de4f97a8322469417190ff4839496a02357a5675249531866458db1d42f48a977347f52c6a788fc7395f5bc91db517b03626a8f2aa90fe444f79848582d827cffa41cb85c379a59f15db7c64225121d0a757ebbd956543626b405eea456534980f68682b13f3205ff89ea9bd564ea61fea3070c22ea62973570297b6a1c1268dff9e4690f60333dc8bf9257f1ee62eac0b9031f03181f4b828ab5f38d2dde25dd0eb8248e134374b067c5258fcfe5c83c9d6f03d1cf61582326585018e98f1f72e23181c6b23726da08229c12fb3e5df9fd425d9ec9f989b7c0d8f5feb0f582a417fe1af4fc57c390e7013e9896b02bedbc2b27dee3d105e36c3296edcc4d34a39c580ebd3297cbab0364d05e3148bb256492a5d77e3c44518e47dcc7aa1021e524d8cd560b59f4e64a334c8e68c19669d71186c4b485ab9aa1c6dd7bb3d0926fb83ea320254320bae6e800c7e188c94633256e9e739692a7c753498bfd436a4a4e22c837803d3fc5b1348e295f6f6b0b4b7a5fd5c491984f694192428e8e75fa7a7e12e8946457a351636e31e6c44e31143bf0a95bfd6db2d483b2919e0fadb86e413f4fe6f15827df023fed03a7a90a1ea92554ac97b6cdab7621bcad5b91675079451f4686683351ff560f339d199ed5031606f16f2d2e85438b5dc3313ec851b93f7b380af0a59fc0cc772a54873a0f5619c79d4b92539aeda8ea0b7dee6e038cd0c50eed854e1e1549e32cbff5861ec1ecaf71e7cd9d64ed57604858d5d6984b611236884cef00ba1dbd113be491dcc5c40a70776f920a1552d74a49a8ebf6f5b4634f3ec1085ab6d560be01ca8edb6d1f547c078487eed0bea02987260e51d4b170000f1df8d1fec4d85cde0dbc879ba9697fe7a634f3fdf27b7a04d1e115be76ad9ecde6953a37c4c7213a6dab7a4f614d1906021d43843dde5c8307fbabb88695983c216da6dcfb8478b58f8659f18abe435533616de4b9f88ad4a7a27af748bc5a2010a33678da00832df2f7dcaadac1ec663cc666bed2ec7cee7cdc85ef6ea39fcebd15fef5a9f185a371d513295e9a3f1ae22438f0526b29938c4ab742df338f64c471c0bf497532a4198638958d93696b2bf407e155facd82fae20da0fd0521f0ee8e9d29ce506452972169ae3a619dde14fe796edfbad5bb1ddeae51b933a5e7c580c21cbc0ff789dca5f3625651ccf742944c03064fad2e16a40aeda35075e3238a5a1a3c66ed6dbb024dda6345b2e1911e24b8fc4a8c86d4279a57555223463e335662d288f8ec59df43ccd5a6c91a4c0310ba843d0a4ad0d1146f484d4d9b064e03b4adab36fc9445cb40d961472dc0ff31caa290b32ee88c464e009e9822119010d7611ca5fa7cc195784887fdaa6a3b9b61e8c4facbb47dafce3307e6d8a3e0974d0cf69f3145989efe018daca505157bf8f27c9dd7a1ed26d752b78b06642afed4ff7f3c6c6df5d49a21122f916ba2b962bff612d89143e1e357a790433abf0c89f855199cb84491e191fa266635cb6f11d44b34e50a5ac3aa69dd438d1a99d286ae2aa317430148e1aaf74d19f12ad26a457654b8f44483a1feb9a6d9c2af61c5b6c07555654885eeab1313a1488786d7711f9c47eeb3cdd464ff77f497bcdba26cf011ef67e6db7a09c68f7616ac49a69a6dbdd73ecf79e0b39f20b6c5010910fef4367aa6049b701a1e53d98c817fcf6ef48b51c5763bf323de82fd29f43bd2f2cedb28ac71d50e60bc2dad660be57c4aedc695bf9fd54ef81d3d3c29a71b37ad21b97b84e385afa324c020bde5b8eb38c4055678ff1f70436e34c7f14575dee53bf0c21b44cfc411e042008475ba21766aa1adcda3e40638dd7a71620ce573ea59ecaab79258ce1474fad608c1228a9a2daa446c42bdff660bc87dd6c50685e2308006a04b3584544d74e776772fe60c2a75cf019b549034457a47239023b8cc2da81640347b4e5c962b6c38ae64ec7120996c41a5403fe467f5de665e108c6e9882dd2ea023eca1ee2a5e06a8d439f4a9cba6f66775d97553d6c0525dea5b391558ae55f2edb57c99c6aefe5ea67d3a9ccac32b512363758520f8c3540989bbd5d91e2739730299886156c92d7ea4877e03ea289692c06e9dd9fce89350203c821fcb8759e5580082624b42254df4c3f4999e1a161b828b151ce9fa2a1ab83364134f9c9e3bdf471e221bd9c8d32d2103fc0335b7e165ec1e2b7b2172609bec31820866035d70e64e7559fb930947b40968ee419805f3d8324a72b9ecaa7c011175759c4e4f260d01eda5f43966e1b0a3ea707ff9a10c20f576f6af230e75630c095cf40dbf57f60c8ecbe6d90106042abd8030c3e553de815e47e06322bd2b5968eb50eeb3fb907d49bd4b95ce33f6d313abe1712186f6a415672176d74f0d15a72f9c5c64f514ebf41a23f72e917929d0bf86d464de33ea25c8e559190e3bf35161e916b8cd53b2eb2853ad5370547d9215042479a57b9e6f35f8980828c8876ac5cff84d9c7ea6f7180797a0df06768b614e66cb09e984e9ac2ab5f210850699a27d472e836c5fbc73ef6ad048f757f266c67a95e8d2f5efa7db7f52a65536b3f2824ecb8e646cfef49f9cf166667bb08611635d443864c1dd45113b303bbb5ec01464a82bf564159a38ffce5b5585c9bb2cd95df69ed530b30b4270a336f36b5e4583d6d0d0b3d76d7914dbbc3ee3e697b6e17187d3c90eb74f8669c9a62bdb00165834351d9a7ca84a5e06a03341fb6184d472755bc30e22099a1cc0ca512d90b4603a1bf844aa0207416701963248e78391b681741cf3a6be0613c0e489a3c5213a3a3f8af784d62aeddfd7195552a0ec6900f8d01e876cd0c3a5f7c7b52eb8bbc0d946a0505ac8eecc5a073f9ddfd651bd041977bafc5440f49475fe5257867e23174e0370a22fa192ab24c21a8f772adeb1a8715fecf8899430dd7223113e5dee834de83596ab1560528325d7060d150be56e0489e18f718c95d2c334669750869b5a78ca5d78d4984b1821527fded7b0af820cb9814a21ecf9c694ad5f368301cb316c2bba07291e70dd6bb62f3c727aa7ea0a1825f7fef92fa538717d819e424843e9745fb34bd267bc28cea901675deded8a03582522c71d7ec13bf758809705988dd4811e370df369fc49b7b35a0162cf7777866ec6f14fef4feb70195ed5689ebedc333061172fa14139b972577a96b86ee8f2f515b980a7f4bdc2788aa57af37d01157d27bd4a5e10d4ac9db77529f950d17074d2f11118c8c55901a6c04bf3f8881c4545955f729177800e90e6b58671a52d6e9decefefdc60177d76474ff673b7a9c6e649df4ada06dea3cb419fba9496b7353537861cd7161a75d6e0d94625ae8e1970496491ac91fa19f07c7813d64e394e9e2f27ad8d99c02d9e8480f09983e693901e5c5586cf963515070d61baa6d7355d1ea03752b911a87388064b27fb159ca6108f93f2e066239cc65f104b975135900aac294e70ed3c5ab76b773f757c0b057384ce309f590834b6965cf1652989f8bdf116a52902bc366e27d6289bc6606a813da48b137bf1b3f6d310f8b931e0c7061a6f5072224361be5c0536c2d001d5e71f6685c22bca5b1e790fdf50a565ff949b3408d32c31c421fe1e0a6e13ef4051fc0803df89ff429ace2f9d781d0b686f674413417f2cc7389bd565e383a0d875a75e6a549cb8ed8390849c638702b60eb374dffb20d72bc521ee05ad1cc9736d474429ca33df52abd200dcf859fa502abecbfaa7334bd586a81bb73ad0fd976118032674e3db6dc293ba89d2e04116fdaf1635bbc2e19e872d3d273aebcc28b8e53e2378fc662c71232e3fd6ca9a2e352d7d494bb3127db4454ca2ca9c3e6f44097b3efb0dbc541eeaf1f0e2ab32af59de49513908aff595248f2c03fc5c5b766e4d6cda30aa9760bfdc2c97524acdcd9dec8dafddc5b5772ea94e982bef4e72621693f16c3496bdfcada14ba7726e0b3eafcc0adf4e63208aa07692f246bca866687f8c4dc66b9866f502c6970a4726cc0cc03407f1a3bf6894f20b489c8c6c14d2ca2a8d1ae64270d3059583cdb953b0c3c0b138360cfb26a14f1dbd8c9a518f9d0f898a1c88eb1112238270a4e5cb8fda94b7da1c12e5006a3b601f6629e77e6ac19e98c45e50ab3da0a39097015aaf5b9b7a042482de5f5bc522bfcc0fb14c74ae989f758c075a60ff2ef924ca878a69359e4db3a3df79630d32249449025bd7e601dcf475c437fe3caa80e17fbb4ab60f67b82f53afc5a2cb6d899ea22a80d2add6d102f87158e5ac7331e7af3687b5c0aea25f9485ce03f7ece033f94a555865443dc4276c03854bc698baa25292ca883e97c21b62058808b2b4c2632f3b25db0e70d1e017f941fe02abfa5c0717a7d4cb891b990a1c2c872b408abc3895f7142a70cf87652f4f5281277597bf679a89f9ec364d107d6db2f2d615f69dbc288367697159e30934d1b7f2e61093c10782dbb15e1aaaa31ba240dd6087165a99780a779b329d881c363e921de3da64212dcebe99d062537882b0bcbd434f85a01b23bca275b3e2bb1b7bb2f40c3a28cd311595e4fc0b76436f18410d716f346fae9fde44317a812a20eb06d14f8a6e117ab4e93db28dbabce2170c952e6b95e08eee8a8402dd19b866e528a8d13d2aa6bcbb19f7f91b654d0902861a3efcc6904eaff159b4bfb6707e5daefef0b0bf66030b8bd31eede66dd6244193b4fa89d7c4c059fc8eb2fa09935d8bb1e1840e385357262976f757b0e5aa84ea89aadfd056c274ce8891ed4be5b4fec0494d002c33db8bf7e8e78f78c27ae63a01e91e60f9c58c023f68aeb79f4b932d295f901ad37b2d179fcdab099074cb0480cefe36a96f1244c8c9194a67b7449675f17f01dd2c35eb3948b16dbaf2dcec04402b478fad3d4db746f423418cfe9643e00a6edcea76465797fa0456c2ca97e722ee18de6b0872513021e4db7c08c59f2a7d3210ffc3e24a86a48bc78751729a1ece41f447a6964ffb3957fa2855e2baba78a6c1eb8d00eaaff2ce9e1452271e6eae45cc4eb7b956efe5edea1083153818f6c98ab465644211239135fd8f61848cbf124da27513b341036b95e4937b6e20bcd4ed38d3691f6c03a5f73958d1ee261c4746bc542f720b2fc3ff2ce3473d470d24acb52e8235610530af8f8ffdc4546658d948cee41f29e949447ad2762a646b6eb779df141e896cb7b6fbfed125c25a8c2c0abc1e905803a957806613bf577ff5e4d4d5e65d2935f680a1255f85ac602dc626ce495680c59cbc7970a7881a26ade316c3e1041246f36b2562ca5b630ae05d97ad400d8ecd0e2531ab0aea06d9dff661e1c48eb632e217f1df2f0c9ab09dd414de98eeae893ad10f338f3964dc90594ceb6ed5f973f578a88f9106ab91f7035a896897de6510b1a12f745b822fa1a9333bf34b7e4a89d6d3a0144e4c2fc0ad9e2bc0c2e7e2a6f7ad757c4b439fe1ce4190b5989ef22efe7304932e2731c239e1920034ef982ce79210952e622311200088fe54de64ca988c362e6327915a9ec007c934958751ebc5fed7c2f530a8bfc056299e8d4385e4912671dafc9a4d318374fad64fcee758e32d18679b1d4e9b63aa8df84b1df309b6aa8091eb95bcb59528d5bc5df96b4075491004d702f3d5965e70dab667ba831b72d1d3666d46730e7fd3c354d8b0770cb9ffee78143cd7a7a605c4b37f34d217570b52f5886f709de2211f681d6703eedbeba485addcf71d399355148a022df9b11c05577b605acb77e24d9f6c783349ae40cd3beee24d0432821828d8dbced5c156c9d73c180b6c6151f2eef3903fb836678ba1a13ce7974994d55a6a22a7373c4dfa7f17fc7ab1d759f0eee0a2250a5d9dda91e42e4f9c77a661024faa10a12818b2a016eb3a674f829110c86915a487610012311381bed5c12c5460f2a8381efb8bde474ec1843c5729bad33a06ba270e324babe0997e99af4ee3a37247d4106d641321c5bc54c5b48a3f3fff8a365ebee2d70f0d0989408cd8858b1cff73c4c7059703c8930761f1b45d8466d8d24607091ff7586fb21d3bf6f3fb3409721b811334fb23861f6db89b3364c942590f9b89ee42acb6c12314d40159e94f9a89942d1e0380ee3193b0040fe71c45b60ab64fb12de5cf7e7de51fd051f399b2739af48a4347edaaac5d38bc68a388a8b6d8d104057f70f6ceee442a58bf1ed58e4c98ee33fac602e96a950db673545200559003a25b368951d03ca3c76e24f95236730dc54f9a36421b67c658090b72979f055d104630d2b4a7b4f21ae42b469d8caff49b1742b75a7adf1b2afa4426b1d8863a4ea1f7ee73ac1bfd89f01a8888acce63c2404f51a8126c53535599b7d83bf3f4e03eb958a3a9822664fa53ffdfc4dee4234c220e74d3f5f00fab27a61e7e847d9f6f4f93ce3b8d6bd6d289bec8035de4906e9755e88c26fcdd096fd900e740951c08cec94c3fd1b372ce3f53d60887ef453c6668beaafd06f8b7fd772b30868f4435c6fa4f1efbeee0922549b362b6ac7ff3f180afe158e0de544ebb81259445623f025c1887d180300d00292a6d148a0dbec564a7ba433df3caa09a1cadb21aca4ab65a01be3c87161eb86aeb0a199dfe39ed4cb4a9a120079a55e35ce1e3408084c39abaad89004bf15fccae67c6737dfb18526c4a690bce87b4fa9c715c98c407ae2455a2525622dc950aa9875fa33e6b37833db5bbdeae8b7a89371de73cd38d28de8ceb45578986ad03aec8a51e7b6b390c56603cba386df9d012b28713af3dadb2fcf94aed2238d94eee496cf85216c3775b9bffec5a4661e471b6b294e01df0749a99237ba81d3c3b7875e358a667af6289518c757f87f4782411c6f64b31d6fd8f7d81d3b626b39ac2556356ae4e941d3d99e6a8d6465a2dae251f3e2a36a9bfbf0406e5af20711697d4936457d52ba98f8174773cd1af4767d45ef4f518edf14bf24b1364f1fbeec857a3455d1806c15f6203993c910cc7738235b039d443a6779a4f3d865b7b3d8b2f91e3d75362007152032732c1fdb17d97a8747432bc18661e51ca4bbd64876e8a423e77d5b2103202fc13ce94091c51a9e49c2fb0df3e3550a92b9870e5f56603d78c0ad32870f125d786887a2a61e7676938a1d623891dfed17394846bdd0ccdfadf4e1c7e679fdf4198b343e70f4d221d2d2a8e1aff65a1e9e267a57480d9a4fc1219505586b7864243eb3861f33c5658a74eec2cf83db52ba22403381a07153d2040905335964c4ffa0c0542744763bcc790e5193aba8bc70b788e80d86ef72b89bbedafe74244a7fe676ada9116b42faa73c0bcd481be5eb0c69a8cb5ef737f0e7dddccba7d09175042edc0e500e4ee4e68d1fcde7a80f57a75418a840dc14b8c359966bf0de855bb50c55cdb64b6a2fa541f42c5be8dc8e0c3b5507aad59ca6c393265cc098ab5763ea4eeb60d3843502a130d7f4067dc055818aee79987442e7301c8f31e1926a2e84c5c093feefcc9d10d40071786aeb34d5d2f3face697f0d5f37375b506d6d37a460e2e94ddd5cf12aa0b657f141af35eb831d8638aa28524d82ecc75d7a44166b56468da3ebe5d7701e03166cd4922d6e9910a65b29d53dc0593c4c3890aa00439578b29d3c6ec411eaa29ea67c365d120919c4fcdef9403187322bac5bf768656f54657a45534ef431c68c87dab4468d0b9e408c975b8a933f84dc1979332d8785552ebc481a4417885ec01e7dd10dec42ca5148a2770dd4501dd462ecb0b8876f6779cb5b56ec62dfca5139a3d6bd514be814297036581cfddf6c4651f04137f93cd661b1d6290df88a9ca902f43f357c1be9de6930ee4cf21e275ddb9d1759ae205f9911d7bb71e2ddbc1b5af4d608da26c51a2eba195f67e24c8984bd6461bcfffec4b7e135edaa7677f0ea8a3ade1fc86ab223c67531bbfb5f04ac2fe3d21ac81850decebff312196891b35d68af1ac21c1ee1f851a806c84a278338be20feb3dab7a2241d37b346c0f0ab6fe823604dbf260f9b529d772699199cae4843abfb49028c66b7519fd1d34d6fe32179c765cdb12de80b42c18d8b5e0a4b384b57c7e9bdb0159e41f7e7964190ca5f6b038ca61af7cb8908d70d0ae7be3c20ef8ecdd19a61f3189d69decc54d878da4dac0a836fcaf1d367225f15006b072fc5e98ee455669a4bc742f577080c21e35f5756d818f5d737dff0aacd512e8be98e05cd54becc7338b6658dcc8e5716c2e7c3b2c6283bfbe5cd5f8a4697d4319eca2feccadc9cdb343b4f4ee247973cf4e69b51c0600131e93ce459b5ba6d1b920f16e9111dfbce5b2ca4fae63325cd65f49e711df88e2078935cba057195af522333b56cad583655fcd759315804bca6a04f13358f274979b21614e5324c04bc49fc0d4a86100017ff245a9b48138329b19f99774fa2e7c1eea2562aa043687b81eea86bd0ea39b7f5cbf55cc00d0168bdf359da1afe1c371aef3acb752b7d94770822ca62694665814b92e4f1bba09376a364aa3ebbd345b123eeba22eec704f89aae9a468f5961a7b35736c35353f0599f8f2e150acd6384dbb9347a8db62100ab0e66f76b4684be2d362c029f9f02a3d60418e541a5c19aeb33ddbd525d8075643d62941dce8ee569506b5ebaa4a5eb13a85b0baa5e58e575abafea293007689c009a6eedaa5fe473ffc3ab87ecc00643ac712348c2aeeb8d960b8f665794faa9ee5e3da2c4033d7b91f936dc25674117894b948d80f2ae72794ec2b676809eb6d88d549738be5fcbf90220ff826669804c76338cbca1edb29668b6c3d740ff9a40a6c3cffb3fb71dc2932d11155c836dfb2010d2c2d6c2dc3d83d331734e8a846c7f91627f48870e5909219d06c51fc2f13d6b80a153cb34488867bfdfa4ab8dad619da3438bc7f9c742164447f44638fdd7491b74d61f13a29cc0b44164da2d7fa7330b5dba6580c7f5f1154d4f89fe329f29740f75f426fadca2351b79d204465321a5eaecc2b560fbfee57d517b82156883353acb39cdea7aa98381930e96abe682b6de646cbedb03141b41b29a7b79e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
