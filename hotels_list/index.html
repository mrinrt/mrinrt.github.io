<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a4feaebedfc8f911666604c255d8c6812917e67c99da0a41af975145856127a625b3aef37acf0e1617b570638410ac8626862be3d6fc2c62959b50d7b5108294f72b6e54576c3bbb006a32e1bbb5b380c3a407f618f87196c1cbef9ff1ebba0a2159cba29aed7b61a028a5d7489627c7d5c40eb16d240ee8f32421bcce87d77bd804751e30dcd87587b2852c96d58562b450baf45c57ded9dfc21d5970b31be85099c9b6967b5a9d52f2bcb9dd0e24deacc1e6be834bc90505e4762a2ab730a456fd24ddf7b06e7a61e03d17a902a8f3916aeb889829f3f6cb7d520bbc8654bd19a014d3557d9cd94d0b67219a21d10b7a30d491ccd251cc0aa6fe3e8ee0ed79f74522f894a16244f76eacf05be165c3d33f94df8a1670396cbcad68ce13816bda4effdbbf984dc42f6f5d9569a77e73a9f3a0d43d3269de6767d890393b7a44b6267def78883dee4674794381b17203671c814e8dd9711e8093c327fe3fe903232ce50d996a3f90840912818f4defb564b650233869fd71de7e1c71ee37efaaae216747b608bf264d4be4929d7cded9b205e8f1f99e4ade467ce0f4a808a0b198575de8805a2af79734a55bd6052847f675b39eb3fe4ec613004c337438c45b8af3a0c0c481f37c9d554fee62c65e7520e46ace062f7decbe49d884202def37408aff20a8b8098cdc20647352c54b929c39d4be6c675a91d92306ffc8012a8ccf9ddafc694edd2ef8f91d8d3c8cd629d765b8ceb564c96e0c27627dadbb392eb488731ed3c8bb883df4fe15fe292df48ed5527bf03f6f3ba9a3ddeb5fbb2df2b4dd51386c62f62b2bc97ffb32f7c59b64224f22168f2c164c9925756edf37694f9dc285e3f868749615859cff3ba186d747805556aa2664b45a81a5c19bd3cd27f35bbc60dcee74bc8265a911e0a16d5bb0e619cf726094b3d011c5c85e23c27a888697c9012cf9a1d8523d66245b941475122ba17c8d4ebe58e6d1d6caa80d6c709b7fe76ca9a9808227c9f7d3cc9317f8672da76e0a5cffbc39b69e40bc25f33e96189a6521387bc396198928cef1d77e42d247dfce2f8fed94e67cf75211466036fb634dbf8db715561279e35843809d2c82dd385139cc592a2749a165373c1ed62437b71c1c1b071ce0b21eb5e7c6b34db920a5fac49811dc6fdc1f86373d20bfaf1f3e62bb11c1b3a55fdf5acfefb5053666ed7b9af54aebbba3180b4f63d77d27c3f0b1696c1feefa7d594b61110bc15403faa910f690065f55605bba2c7401241d8059da3d2ac0cbc808e903a9916d3ae2dd68229ffceb28076e8f694ce4e736df0f18e43e8ed044e34b9c3f4d54a81875fed637fc050179a13558c5f0f3e5476196ba71e85775017288cd0bc126c5e9a0f350502252179d54a34ee78b71d34fff6a7fae9e81a912359d76e461003add437710be2d4efd881d3771b5f4cb90888cf0f961ef805fb560ac29d8c95c79c1dcf1e5cee02bee0f7a668b5afb88201f1a4dfe9b623cbe2780384f552a756bb42c912d1d402b4dfb2227df8acdb6f67889cba605ddbc18c1a007a25c1b2f5e00af7b66af42c51615e89047a6678a6bd34f81a2308d2ed7df2025a2c1f3fa48300c50d5461a6b6b725f7c9138341bcaddf4b457c4990c1a3535cbd2905360157990c533edb877110840936ce1129ae5044c9e99a2ef360e63ece25cdd007e3622600bddc36e3d333689494b63a6b819bea3d6202d8cb839c2d7b9b0ab584f40295921467233bf8fea556a64ed5e8e71ff36acad399e6c9e3ae59cc81684407972807a346b2a5d495f5e5b9c7e0b6e0ac9807f174fa40720cfd6ebdf1e872e7fe59026246863d6f3f93bfb3b051642c889768c1d34d066d9fc084b2ad671518dd75102762dd185f5e25d27dc98b1a38ae41734a7aa53db8facf9777201293aafdfabd3fbd2e034992ade0616dbbf12346ad8c00b6997e0e502aa28b5e8c4211ad895775d4d5f85e01170d181567aba5ebeee4b909c6328e849aae0cdba54549d18a2156d5e6381f4914e49783b05c1a38ef1348175843206e794b562e3502a23cbc9886ad1df7002a000219c00ceee153b91efe2a6c622f1da2e2e76b0e29d33f927b0137b270becdcfebc5b056b19e0e1925a40500e8aecb8fca87567a7f37c78d31a6c502f8ef2f33352200ffb128df2aa2c7498abdce76a6579fa6db6201b9362197727315d060828f38646b2c74c7dee188a66bfd71295c49ae13223c0e818a5c63deafa094722426394a41f9e387eda3e29a9d92f5ff52ad36ffdc172dc9b1b2b2811a41b1cc85800910e701ba84fa2cc0002e9f078d6c9968946342f18454bb9ca21c97597e2a84defc0fcc3fee0075a1c1875bdffee2b7b00dbfc51314acee423bf66e0d28247db774d1dd46c18c6acab5b3205681441979a063b433230a3878eb13d9a4813aa71f2c083ce821495aa23c7aa6610be6c76dd018d634db4b54a9edc700d23a04cf2480d402199bd767d49ff998cb186cda2f1835ba77754fc53968380226f68e89efa51bb6c827cd21c9aaf5f793be89f61885c6729b4380a69b30b56c841539288e0bec162d7aa75fb410976fb603ae758eb45cdda0d582066c1117f233b516f272ae2d3b3c74e98f60be961aaca2c9b0c9e448e0423dfd7d130cb2deffe8f4309f892062e735d3ee1b79290b307eec8891c7abfdf45a2342277755d85a7f1d200b9763e8b280029959bd7fd711a00e50024f4658185bc9cf93ef0fe7ede0b0e1d33e4325230237bd392a8275fbe260598f2392b590a0d7966fc96d380445c42a869121a0e686a8ab065139f0b2d2d6ff135c23f63d539cbf13792e139d18f5a1cdf1c52ae1680925c94118050a4c134a424418ef40dbb06ce18a113af896e5592b20eb47171c56c42d327400a5607eb07b6c0afc49fb286493986d98eb796e7614961f38e307694793a9bac81937a2c60ef9418dcdc832638c69afd2ea8ab771fd7cf8b1bb455222e6af5b9cb256a4663eb7f8e8a637f1938708a087503429c43e173b66519f7ca8c5cc6cf18c14399dcd1fee4135a43968570eb9eea09a27c4a4a761714a6ca8cfba6422197afbb71da60905083d9ece4e7b6df7746c7314efa1bfab7597098fa901105502b3850bc5391dd88aa3b56ce2b788dbf4944164b0951d875ae40dd2e8e14e81bf101f7f5e5a75d2706169a2e1b744dea9ca77ba8ac1143ab0ed2826915a9eb260e6449deaee22f79c29c7e0062b69e2e9f7e659dd4390fb821fbfc55ebd7ebd7e062c65955e66a5578136b124facf2d837f293f97221d9b9c94295568e0971071fc6b8bf6868ac89b2db3b6d882bc53ca4d39da73e7233c2c190eb2f3cec1ccdcbc567b22a7d2e9ce48cc0d9f3d480eb063de25fa189e1a648f9cb0268d358bcd563f125e7a9ffe03e48cbfee356847587f6b9c023b6621538f9022953b0625e02db2c24d99bf1a1fb867c5093f070bd54da7b2fbc1d6486e0eb945eea29671c368b4ca4fb8ed55539e741e612c09bdfb8b95da223a0623c054755a6bc8f1644afc1e2a3508b03fc7c88d168bdb0915f14008dbc994c955a2273d6de27c07aa6776af92801ee143983955bf6bc89ed13ae582ce3eb228c4583b35ff6cc4d962010e640e0371c6bbe8ae464d9a43ff1449d4c2302fe5eb9a43167cd15649e6d92ece1729c86882c28c9c57544a68b8de636c96ce9fd226845b2e3c7fde0dced07ca56971f7fb140efd05967074a82f0f8491806d5e940e80b3a74377dbd82bf6505d785a2af5973f4a16f421668396807882a05137cba016695bdc87029618cd1be3087ae67bba9d985fecc3b90b383ecf6db8f38acb9fc4095718b7f4ab9978bd0f33033b0fe9c4b87e80dad018d2ba23ccae4ea75e9f971f117a5fcd5c993b351d3864a59f5f624faea0984c1fc45a8a81e3874f6f06ec50aad18fe28381a1e0693af5c5a8a3aa5be34357ebe38f8d1d9dd9b0aa2c7ab711285e8c71b33b62e981cedafd9aecfec76412053741274690671e91bfd499c8c78e373ffd28abfc163a37ea3d41a1551573d0e849a2b93520efb6ec286d7cf0c7a09307b78a5ec2d999e5af3b8c1fe0512e2c525fe4544df8b8f2bf3e8f2295ce9b57b7b635b3df2dd68ab5ed5d039e94a11a1ccb16c23e652ccd753e75567d982f32ce8ade54b80a23b260f829744e9bfecf42f24170257dacf238efb6cb70c05ef7cebd84538a2492d963946c0648d9b5018a5ed993fbf5a54bfaed45c6fe11539bac3498a7c00d1016d51b4600502d26c70a7c52653e00dbfdca217484986c331cf778e452ef881c92166535eca6e4c3383bdac84e61142f1f1c70424371ca2809edd0222b688f50a730bddd5db124f730363bd093fba144c6a0951e84db0219434eaf21f5ef919a578a2484bc58eceb874750c6e427f043a5069f07e5686a8c0d23629826be408ed52d8e411bbfdddfd285ebf02f0006a960922fcde330ad510f8c49bca482ce9ba51979979ea77fd2bdb4fb0e00455b1ea52a096a87b8c566bfd0f0b5c91aefb7119373c92b4bcd1ad1725317c5560a91d8b07b357e1c72ed4fb0025b61f7063dd202ac5577066fbe0e3607e6c21433cb385d658312f3ff17353d2839bdba70657e8c46015c82b5e1e021ded574979483453934e3e0ce2df1d9a0c23398ab582cd679cc8bf0b5fc85b07af1556a7cbbdb4f0128ed082a052f98faebc783f2f140218523bd7dbd191ada2ef8ff09eb1553ece62169d77af3ac0f158d30f561cb60b22cf84d8551bf5421ef05322631297cde92daf4e11d34355ac4c01fc18fac784313c9688c887cf9c7004e0ba4c03c8a0410f37042d4068561f2f04aef009c00307f5e140089ee7f6ea01b1a66e3de270b694bc9090413336dca7dc9bc959643050fcd5ab3949113b36d3f182a982aa8226e52bedb966d6472b3e897e92d30d80c587ade788d3c54489c40a8c4769868b5cef35e50af5ca8c83d1f8c19d29d96400ad5162de1474158cc75454549f1543097beaa2228bc6e5a9ea327b22459653790de9b4afe9dc90e3506e27b46d83f55113d4017558975896066496aa13f2e447572314cbf0420287476051e8e5e8d43de2ee41b4291de66aef41ae19e38894a198a4f86ba81b43d221d3f59086140c64281b45afd8f39e942b69b8030f4713618182fc14a4ac982d2cd3df4fb08acaac9405cded470edb5cf0d97aed448576d5f97defa3d57bf34846708078fc1f95c65f9dea9da9fcb65a7b75808da6cca477b71966ec4f8f485ff6d17bbd2e95b170083b53e6f504797779981683ab923c176d96e59f8aee7fdfdbbf0be130d7be17d2759683d1b59429dc2efe0225222a1269c3ae77a78e0585fb5080d91752168d4afdb60da84818a7f16a4db26e42dff6f7e224a79e408b57074b8fc3278eab3f486e654b905ed2f0930d1aa05c3b0f47a73a750ef8e7565c7eeab8f87b95c5040f9ac4aa8010d768d796f0b9254a1f30d72905182730934d22ae32c5dab3bea388dae050f71deef322d3b52f105b97804b7c46e54e2561bb33b292e32951266b8dfc103327bb6f5a33cb4f79adf633da9956d198524600cb6af77974e58614ce19c2ae088b223dfec1a7ef19cc129ae7a03c1c4ff645a9d0ed9845546284b086d394e863afaa91badfea53ab227b5a9eb0b6fc95b6fafb03833228b7466d25a49e673cddc312c3db62b611da923cf9f8980f319b7967fd8ed4d62855fc9ba02544df55500cb7895d7fb1edaba5b518fb1b0bce9434593a2a64f60c0ab0c8e77e4b7566d458d44a1e326bae481ee49c4aaf890cdeeaabf6d7304a6e6a203a128225ef706ca942c1260a6bdb708f9c0990b73070f9f2d1342ab79ee2f06b5340c2f7312cd2609ba7842bac0d865512fbf516d49315087615f5e941b7bbbf91e7e2a187e557102c82150596a32291ff0d702f69311f5d7df0bca338305e9df77f86dbc83b4a60b790e2fe4f0eea055ce9f10134cc7651182f55a10dae2159c82064de306f3aec7debd6206ce3df33c489e500b460a90b1149c2efd7c6803d95465df656417b3da505e4b4660de8a6ec21e6c2bee085865286fa8cd54afd578754856a2a6cf711d613ea5ed4a3daab5d1b9facfe9096207c7e905da4d4fb61f0a2ac263e790652bc67a646163df7d6f6d895eafad0958c2fab3082177c2b1a3cf35d00a8850409d512ff1953282ba74e40d7fc96733834cea9d0de1fbc95333d825a9191a9aab8a8deca42b182a1a2d6f9f2fa196fa7ada3380da9df75b08fa177b6afb7d8d72b2a334a89822a7940074cdad2b6fce3b5c72ae24b736dac0c7d3aaa410b870e717f5669999eb37d9ee6356b765dc023b869a5444a5b36eef420aa4fa243d333ea7aeec23193663f2352111295a53ad6b8bae04a95cfd10afa15b6ece030e3e92e4f08df1591bd023d0e9887134345b622d1a89f5f2c0a0144099d8a51beef86e57d135de3f89aa85963952c0fa243bf2ddccf40b60c8448cf5739f155ad220f7c4263aab352a0dbbabe73cb352929d086ae11ef2cd6d7d14b854b3321c6ce0c5cf10093aa6835edde9342c4b191105d59a3d5337cea5a8eca8e514dd16399b402e291b9ae6bbec377548626956e30ca60a852bf9c60e1750ae8ce0600e1cf9b2cf2fef96133e4765a9ff3ad2a4751f00af1b3ae2f4d5b8a38ba2b80896d54d54a73e90adf350aee33ca5193119cab813be4ab472c5b7ba18c1cdc6b127a6790899a2caa98f5c1cbfb67192ca70c26d2a70215f213a25361028afca935824c595df12f3c24631cccee4bb9cc6274a585ec65f465c4803c3a38ed5e80263fd8af231d70f5a2c3a9b8b1c96f7eea4d73ba85f1b69aadbebc40f26c5702ba6f98aa21492e427a3bd3b29bdc1712f51ed8336a29304e26dc38a5263b3a5bca1f995ad7e7a728e46de6a564be7ddb7fd7b9e16a3f1d2c2f3b1e8e065062bb06c25fa21504edb4545aa73aea4b2a6d5e49511428786ee6d879caba227435270a810b93675526f887bc4e997e01f5de88199c12d80a1f5b8aba31b93df35f4df013d4302ce0035042cfd0fbd6b4f2b6e189bb475eaf4814b9e1f133e6c736256327ab04abfaf3283878544e1839fec4b43f49102c856e21acddca5c39725c0ad47968f121ca23dd7eae8d0b15f109522d3d5a853932ee78a014a640af90ce77f169b6b63c041e9afdc734a3a4fe59858ef896c41f6efead7f2a3cc343f74726364a2a8938df3b02553c5e8ea298ed639832241f2fddaf2495e63ca2fbf70a01529f9be06186acc506ae85214e66140a6d516e07a480ff9e48bf57085328935385a84bf7105d2044784e6f25936d2055bf9c1e7c93552667390d7f2432d8393205e752e23b87f12ecedfd15f09a9a2e442bf9e033ab7c358966ed17e525010797869158c3fbabb55b9b79d42cfc2e7685c7ecd76772fdb4ce7552d31138b76d1016b4233cb6f0d99c499e352b358e2e18b9baa102a016e41d235a71d151c8ec1f88994e0f8a3084e8776a1625b3dc6d32b6d33f994970f8b6fb45683c1a0ec084a7d2de56f7d581ee3b318d36230c3b1e2f2d55237257f17bad6bab3ba17b7435d357fce34997a7a0d780cdfd0e7fe7927a725b64f28ab023082fd016fcb55cf27908e32117059b73f2ffbde625ee1d6315a0b038bdf82f1bb1da0116eb1b0631de51437116d0049e5e546ab89a321d92c4c9532bba531c02b2e7ce8b9e27d6b336d8181ec084456e30953cefc9b28dcfbac4346e27b3fdba3132a3a894230063c8f283c41be621e09eea543bf5f93c13ad1402c3aa3f6d67a428f44faed28f8f6d8fcf81ed0973511ca6c145d350d3f20d03b25a93b156c7195752f41ce34505dbeb78ee26b5536ddb7ed770a4d56c5a0f99680beb798f6ba1938a320fbf092c42daef9df4dd1485477adf8472001e402fe5392b79c5512f648b721d6f9dfd2393e97281b1ab2720e669e9fe7703b4d092b761887de20a6fdc3b1d90a2efba3faccab92416fb663b4c3d7b44cfc0e7627360d98205cd192ba245ceccdacce4ee5dab954d5cfac9b4762a099796b837f26cd1907f944945fd81d91e4c9e5c7f2cd0481a84d738f5e8ec858879d51cfac0c700fe07c53034193ce4c175f213a5d61888ad5859d947028f900327ce5b63e1d58925495d090f7f8fee1e64ad77993492ccf68b4a279916cc1185e6e7154d6c746ffe0951849b7e08335bbf217d8790c2c4ff5b42d9aa54b82dec7e8b963b2f5ffe19d289ea0d59bf1d88fe1c67368918ad25e1a333b5a3bf4cd352bf88652f3df46f3320afa0e3053d28fa4f14fe39b281402a61a36d1241eb5df8bca6be15c8fbd072e96c7059f7daa832a8137eb875de2e98bf1efa8992e830b58dc3501e81311a7fa20788cd077328e6baa6ed70ce89693d8c484d21b5dc2a2103aba8833cd00197b3d75f45207d33a0ce91778fb4464e065c58b37b193161557761c8ec7800e289f2a50c41fa4c2440b67d295a9b5eb6a4558db76148714f86ecebaf49a48b8ccd736f1bd8223143e9c04815ca5b6d8480b3b61404d8178ae2ff0d549dcd955e63f66961e6de8ef764457524839e3fffb33138ceea098a51e3e4e2586c2532171ae77897cb0b1e2f2140332c3f55ca72d99d065ab0ee0c28f7a7e936e06506714517ba431dd1813464ddf30dfc2f6cf86017f6cb960369479185647233d6233fcb83c44854b52bb3a63a056fc8177a743d3ef18bc8a737eb14acb7599e129d53242e77df913ebd56a58aeee3beeb308f173d1413f5fcd9c7c42531393840ca68f583b039106655679ca7fca57a4a8f18c15061ae4d25ca8891b728fb2cd5aa90ff5b725517ce33572efd97f0973825698b6c21614b74e4eff8493eada3bdf64c016679d15d3df2eb168eca077df322da3c325c8704cbefadea9be911efcd4d4000cea92e3c23736e601ebc6110418b45563194ec46ca6514a795c6d6203b9e0ab37d611e0a8b3ad1f44def50224c408f61ae6b5d527721e5cb38c75b5907a9ea675f6def9fff64a16ed965b622ac59545e225aa390b53d2169edc09a2f5cd80c76d11abf2e9d48dd118be9acc9bd818d2edddc35729b60db5d051015f8bdcdf02512d465dc71d8ddcb8f64ca2316f1cfafb43a5faedf33e3f1833f401c9667c74aa680c283c9d9ec0ad1835da9019e93e157ca631d4b86fc5e0245eb484e8063f96bfbb71062203a8d2cafa7260e72527ff25bec6038a0b7ef55cfd230e2e51cb59adf5c232906163e457102fd98967640244371999bcae8503c3241b1830386bb14127b3619624e0ab8cbab4c919eaaa64ad424f74157cb41932714656772194129be2ecea4500a4fa89c1d0c4d51c0ebad9923813c8ef00b1df5f189f5557d3722db56bd958ff60da57ca3f6f391ecc9cd22d4e45e61fc86f910edad23fb0f8a04f29f3ef2e19a8bca1540df61aab8941c25c4f67e6fd99ffd81789c5a2d84052251fe9bacc0e27001476db69fdd9d2f1a105849d233ed75bb8030d95ef88af7620cfa43e10a8c1a503709963213f87a98d6f67d2919cd8e85d94bdafa94ed4a5c962a024b82b2af83d6269fca47f7be077f3b1d0bb8198a8369a5c0547b1791986344445917e829f3bccabd59a4dada8cc9cb27435a256dd053a6395fae929d2e84de8768ea84d90a8075636283e506abdf2aaacce73e6d97780948c1a448a8205cd95b237254cf4fdf5d26ac1700f32efbf6438f5d514acc19eef056580de8af0cacd152831c1d0e7942ac945704dcd4e60fca6ad48a53b2bf88c69e0965ef78e66e165f601023f9a6bccf22e217bb8fc3d46b1a7bc19d9fe5fcd5dce8cd1a762dce520b74c642aa65a17be2babaf78bf9bbeff4c9d567014f03607baaf33548b0f74c6940044db54774a029b32655ee07556325b1c0fee7a2362ff6d583f4e1af04485dd37506ce3c3c3a57c15477e965c2f4df80224086d73c6884bf17d32afe804e69dedab2f603667cc48c198bd4ba7dcfdc396eb3cd3ef90afe0a79b0157e45dd5ffb52559af5b68d9000ad85e659e7a347451417770c4799ad65ed69d7117cc1c7fbf76e216c99e8dbcd5d21f63fb47e812e622a58453386cb1ceace392ea80e6971c78dd406d3834dad4bba841f3d000fe01c4ca66ab455bb19f4df6e8be494e6bad15c4f55311964568b3cf5eabc371c7150bd413874c421eba4eb8f214f7dee8649aaa1fd3c71146887818d2b849aea499d6ddb34959a23b393e5561b5a63484a86612ba64c241c87569fd4e0ec6626c58fef3ee2276a087e69be0bd93de21030c990ae316b639e2b9ba74591ab152936ada30c0c45e0a3e769b319b5e2c981a3bd0ffb2f8156d06dc9579af8941658e60989950c99298b1289a85effdf203f0076249a5f5675748a91c27eed436e176cea7ae97602199d6d6abf244fe5093326fbb3ef3632c96ab76b49b452f18ba83025af7cc177078d6f6a075a327dcbd235469f45240ab015cea17ab916208a978d0f558b16225a9022eeb05fa1c488c6dc204d59d242eb325c6f7bb28de27012cc8aa950aa2fcd33e7da18a659f7afea5bc31441c7c20b980ed57aaed96564408dfe429f9b918865ce66892b86dbcded2eef9591763a5a2df06c291237443dc743978572001439a326973f0e587c98578033a64c6959f71c0cbfce99686fb3fefd1409d2b275515709f03c66c105a0e673daacd3e29b0c01820d49a34ae536504df9afdfd5ebdc9b40c25ab4d2510508dbc4ab047ee0645d0c2c324149ed3b704f2ba215bd64064ebcc9bcab559e92c3e5504eeb7e2e716a9ce53bc7b3ab6456229ffe5d42c1e4e553addf4f2122a5dd2dc46ff843ae1d436450345e4d4f342ead23ac61adc19b503bb1f0d440339ec3eebbf053dc37b3c6d38eee5527c3ebfacac512de2dec027eed8a9106087585ae6fcae6ffc8d92f279c18c8efdd4f09637e11436228aee98c222ad80280890b443082acd5cbc89568c0c2d77fc946d2baff2e4ea3e2db8069a508b0ebf379243be8ba9ed7049eba9f6835bfd416a20b84764f88b9c33d128425b51c1df88d9f5b37a3d7cdd0d9f1e4ee6bc738627b387d435d5f7db3b85cbcc6377e01e5c38ea73d581319bf7f4a95abfef7fe51c9a7347e3bfab71594a20da4b1276e1f3aaaf82b839b9c343c7c1e7cfcb392db43e73d80ea0fe1441ea5c3d27ff18191b768f5a7accf6ca992d4c4156fcc26fb3a8633198272f3da31542fd888556809eb92cefe5f765899074dfd3cac87be13e647be2e6edff8ddc3334cd5b081878fbc4da480ad994fbc8603005d644fcd02e3df481019a783f5edfffe8f88507dc7621cdd52610d86acadb9f35e42ec383f201267a086758be341881269ec36073eccd7df58cbc66e8af3994a5bd570fb94ce8c9e45d13faae983fd8d84de08c326978077f9920f306300d45e051a06b18fa321d061d73a5ef3d7d6e176e7712423697cc1b67483b97bac1a79ec1b93e1c6e95c6bb13da84f932a876860565d48e3cfada425fc9a9643edc22776bd551b7252c5d523de762d8cc76bf3554b4ffb0432241ce97ad0769f05199f906d8cdfd25435ee446c6e8aad6b4a4b38bcb4074c698f2705a32ca3a732ccc0ce588021bab6f0d6164e6c31f6d438f5e3a82e1726f1691a1c890fd7366b2abe7ba71d5d4d6fe303c95fb1b437bb1f60426199e000d81f30b741b49fad3a233ca302f8aeda3208cb39e7173295b276d159aed9301d121aebcb3d8fc63309674983e6ff316362cf1dcf8c408c8a95662c500957c678c90a88bff28389ccc0201d635068f74c5e29f1280cfc122b57bf6e3487ec19ef24671a7830a0a3284b6d86633f242010cc88f48094f5069437a5da53d4f669e02940836129f5d687805a4d5a981caee0b260d3e948bb8a36e35106132126a87465d44cc44b9044629bfc436af94738a27a0714f16e40ab5b8588181d01fc4d374a23da0660c1dc966d0abaf4e33aaab343c59524f3a904130c39e0287d17a2a08c60242bf5668f987a6a240882de0f4cc4e85ea3741d075340889120e9f3ce1f8dac9aba44ee3030954e57aae73374d7368ea2ed81e1aefed51cdc411e2aef9093db036b5ba4011adaa189a6e698772fab4b44871ad8907662ba99a911ea79743d9bfe4e6cf2bec21f71557145b296f900e3ac0133e67124003699ae98889b4e524e5f3bcb95fcbd79ea2df5faf6b1a21dc62ed29cb293f13389c6798b8dc2d44df48c6519bbfc79e0c4afc8cd8a32ab5c03895ec883fe0fb38ef6ed1c3b04bed52f2a1732bd85a0ac4d9d458ab2f5e2c207f12330116bb88f4a9d24531ee6d2fabc7ced59a07628a36c7ec52c9229136882bcf38e4dcc22cb375f560e3298bd6dc36b909b64debad5ab9d843ae13581d4259a5d0b356284271ab19e25e17fbc46f82032f36fc46ca2f038633a16575d28d677c01063686785665aecc7771165b6af1421d1c080dbc4725db76fdd202653f37e80efd0b66d845f75d06491bf0e81b4ae1480e038399cfdc32acad414a6a9e18357e713b6e370d3e9c0557edc6fac53eaaa21e5abec235a46aebd1cd95af2ce96ee923cda3598725a96d747005c40e42d446adfc14817c3164b995642d367ae1cbfc4b4a1f4e47a0ce29f7980fd8e706f5dc362cea7e3e0b4c38a28542a202e368792c2e505e1ca0b8e074c671dd10685e60bfbc7ba899899a839879a388554720ba331a04f5a2071789205befa596af5cefb000eb30571bae7ec5604a7c773dec00c15bf840e57531244a29eb4ed4454ec53e6413c42fd71a8e82ba9c572b549cad587849de6808dcb81e9f78c93c256c46f09cb0ead9d56b27241d29a44cbcd5bf0da68274548b12a59c1ec006875a337526e88a6886ae35ca4e4372b32bbe6c91dc3a922b47580dbca9b71a82ab8545579d0901423f898635ac64acf9acea4d7b95f694139d9286e0b08e4d40c26a1902f499d0cb7932f2475a65cae3980b4afdc8132e9a82245636967c82e270aaab60034c5db2caf9f5bc5415497ef75dbe37ed21de73fee46050e3e815fdbcbaaac8b783d1c7e3615214a2e3dadb943b0ed9e81ebf1bac9a46d424d7115f4ecf845750e23d740829233a8d4ca1a78c00424429492ba9c2c8c1b8fe4dc3d71a6f14f3b52aedeccfd4731afb633f79ead99d10b7adb241c3362e64d55bf63c47a96de4495b057eedbff353e3edf7b57b34635c22e002f95140e67438a753d7328e69ecc44ac981ca9019ab2e9abad6b380c66ab551dbe79377a9343e1832ebdf1b0693927e6e2554e7ba17d268860100422c011377ced7189f18445fb1f3898f6c3680452fa0e80d4dcdfdc7f6c48bd3e2f80051b163b7a62538f2323c617b45929dee801974ce91ac7c1cebdd8c3d96ddf9b1d107dc78692a9fda9f65ac6b571e631a597c2fb9779212ac936b9bdcff1ddcb203d3b6517c3a342bfdabf09d3ebd781ce0fa7400b1af5ef58acad85a7fb4795e1bc41406712a264026a52e6ae3bf0b9aa3883190bc7536366afc515c75dd70e30df12ed83cde4d0e2c79300cb4ea4c81a0332f251f96316e474a34f299684370dec8bee60b18f33a025544dbc96386851413999a75fadef262c8172d0a365d017bc61d7a1eb533c5a17a6f6efa2c166521c0fb2d1112688d4d6b434508e1623c1a0905c1897e9ece19edb1c50bf8f55dca1b5cabaaadfd4ee256d126a86c318957f364143b33418e196bd92f9dafa464b11ea7c93c6b8e5e5f092819c7c54820931cceaeb86aaca12e29ba53b94888406e305acaa7b617b3450256efecba12816b12313611e8d54f0253000c1a9927d763548a35936bc07c730746d9b7ad9a3288b7c424b3456889f2142035f5a91ea72971690b172748f6b134ab61939160fbb744ec84acbf79656c5b16971ad4788bb49d5f8c294fb596d7bb996d2935c22df942bf36aa9cae1b7d202ee5352fc80c006a7e8a953ab224e0636d0264fa16729c8eda015f931169e8e2746358af91c92e83b0b31e919a2f3101bd99f15f52750c7717a8213e0381cc62bd4f7542a7c79bb0eab092162134380d2d6923d1fc4dc2b2a7f5c74683b326c8bd981c2da7afc4e707d0a1932d38ac45e9bad5d9b256c107727f99794e4868d4eb3717d39f01dadd7c79ca8ea1d5431d51115284b3f0d2510b86a35cb02837df3f0e4740126a9093c03b5ed5bb191d0d54ec280e59ba04df3879659f1b0e4652b9f993399360eb6fb40cd2f365c0df580da7fd5047ca6bf29c626dbaf207a7041d8730dd5718ebe55173a29411f413996dac83cef86670ab033f274a63eb93c7a7599e9e17f0ef556ba3520636e31b44d1d718107065674bb976f99a6490f4f7f201fba8086bbd6230cdae23cafb8016a413d1894609ef17fb2f5865a493c9b3969f3d3368703428056e8e5a67a22067675f663966a53d5e76a390fd8b73980e0baeb2a6bdb8c72b929801e997fbb1ba0cbc60a0c4eda4ecb9113416f8266892625a54a56be6914c83feae28b2759ab304952d6055f273a5c7b4701e6aae028621c0c59dc65456f5ed81c688c86fe3ef6d2d1368c42ddb154bf7ae03850bf8a6b489c46d78ff0a7e6f1f994843f73255a2515ad1e67e1893e270d22105cf5a2fb143c9b89e9715708760accacbb92ff07a0c2af14d9162090801955c2cf1d4672f9856fb3d7961f95ddb3f6207e6e42f55f5272054a3ea1fdc7213b48ccfb43fd073df1f0021dc50b18c7a07b9e870a6bcdf91d939faaf26ce1f8d66ac65f48761016a9da523dec6700d9e22e5aefd44aef93777139aec2f580b747981f1fbcd8f047935778ee1f4d7607a730d18a35e98b8362a02805dfa69d1565c49e04ddfbf1c419ba59bb4be60262a0dafd204144e7d9a5342ef041d0f9aa24b7cd9030bbc6f775762218722ad136c2bced3bfe26a72da4f43fc4592025a2d6d54b49c9c10a6b2049339d03cc7a44609941e2ea42ea425de7b067152379aa670d27b05c226c0107cc85b928bbc2d3920afa425713df75f5c0d06536ad84f9bc5a48c406615695ac880993d0d5367efa004b6a8016a38cb6a1e2269df33bd078c2fd54248a6cfb325501794e74678cf7bd811bde00584118b7e48022c94ddf1882bb3a283bbd48fe65a9b40f49cba4907471ebcf89470474c214e02470d477f21d23260ffda11d6a88372d13065f070d49027d9de881e942036f6af5705f1f0c1a48111566a444b356c17c469f24bc739f43780dabe8a3e4d59751599dec31234588e77434e2b4f1a0f8815606b42ccf947b9d7bc0945d619fa8f519721a49bdc7e134861774088fda6b8c662f4af914d4c7944fa377d877e835d75e548e8daadda6c82234c6f30833965d6da9c0aa6779409ad3e407af8555b7961e2348e546b0af8be5bd6546beec96a5e20cbcc7944fd5109c79f9018c975e251d95c8d57927dd5f56132f11b034142fef327af2df4b06e83916a0009071d6cbb868e58abeec7d27fdd8ca56aad2f7bc9754f0e1ee0b6bdeed7caa733e6053bffb8b8339883699bb840166f940308d5c67a73ca644edb33700f213351c60c146466bbdd324c6b08dfe1781108d94eca73b37c4354ad6bd5b11705bf3643591b968616c7b33e92faf866117ef4c552f0a67f4e153c82fb03eef3576ed94afa6871c89f6c972da64c6da566c6b645197674f3a52bdc7c9895e3","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
