<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e8dc910f8aec64714b48d8f4cd57664c3af2eef3cfe933dcf1e0dac0fd2becdf9f749510a809d7960f7ef21b7f2148699bfba2208339f07d1a82a9d5f01c0b8025432e7ab6a9884af0e27132cb15b9873d4df3ce6450f44f034b3a3d20832876ff1321082cd94b29d73b8fb4e9c99703983d6bca484c3f654e88113e91edf3a3b387b0f5b891eaa662fac6c1d9a2899745e071c4eb9d6a91b292710ab99048c05b475e254a709b41390aefda498693266618f7e46e623ff6229e848e85a136bb40d246e00077b0bdc3c9d12bf587c263121e7a000a3b730d385a27bddbcdf6a6a20e5b79139c1b7b789486e524df837df310020c9e407ad80ec1c7aa2eed95b7a7ca1b2079a344311984cad9cf5e2a3302777ebebc2f6871cf518f477e35aa8a6c0914268254350faf0beff8f437f6dea3b3c5d036055b7b5d5fd9f36d7cb372ea83568dfeffaeb4ab1badbf51ea6adc115f9284f54cfa1ea7fdbf9bdc6d66ac935251bfead825f96ebc12e45d156a7307559ca9d74e98cb71b925845d6808bf5f23130afaea2981c52ec32d8861cff3b346caf97a723ca472e095ec4288a9dc0f4c8a049b2525a5735db0518c9289a8725441be9403cd8215e925faf3aa78f8162083b8cb1838004bcd56cbfc7c31febcd269468cb5a8b49af73b6e2f77de74d5cdf3a32b36e6b20882de4c5bcaaf8b8e0eeb312773c04742ae7324371bd423a2ff4caa6e28c7ac2df6271e473d176cb45d34be552c2310d4558c93b351edb0424f9e61fd524ebd2f84e9fcd5d274fac47e92b3de72e9a4d5a30a7536dfe46ab3232e765289086704c4935bf4dde91d71ec232daca32fe34b90c57532e6ab2b69a1afa6d07e6cd48db9500daff3e6229dd4b140bde7587a1aead6e996630a1e199df392bb8dcd41afeaf519c5a51f511d5dd966a089abce0b27643efd05513b2ac53f8041713cc2a8f77a9ee8385425621a18f3a43945dd14c4c65c656d304958ca146d01ed7c462afdff739939458251e615cc15f6227d7b72ca0db37dd4c532380dfa6b897bb21b2740cb67a538a9144d0206ea4d487bce6ae847973b433c949fc9f5f1db66d586dca9b28c257cdb5eebaed365c112f3fdebda8cea624763070281a62e43800f98b434b6a19f37a69dbad224cfeb89686a56a74309fe7a426d13b7a0b75f2abb6f5b59e9954467802ad05951b5fe5ad61ad0e472e0436791a3e1ccc25318de1d8f7e3d19ef18f58b4386501e432b3fffbbf3d1bf0d09850d0d696062ed2143f3045fb487a18f8706899290d21a103f4b27a28c4529dd9aed2f37ae3731e0e24fc94fbe78c8c4bfae6c7ac48788a07459b5690a1a4b6ed457c6291033876797a1089c95e8c377ad0ce56a8d64f11c977a85c38afd49616a61b03263a1534750d8e57827238dcdd18ce57dfc5d29cc31b74ab6deebbca262a993e26fada4e3a3b2d65ea62a62fd2ea643f99cd3127226ebf31c5df38f25136775ebb37baacd77704ebdcf66f35e89f8eb5c5d66cec7f6fdff7949e0c384768520dd7096f3aca58b25f215cb12b8164d9f1abef946f99d6f5d2a366bffb291a154de0614817ec67bf388dc538a7ccca931e9cecae3a18dc6ae8e54582d854875c94ce4b8322c0acd247c674e763fa22e93f2937cde0ef8c21a2a24f247c3b43ac7dbb0adddf9416cd2ccde7b623ed0ab1963f8b3c5afb538525dc3074bea2bf62f05472935ff223aecfb963dd64bd427a689469bda68899f1924edba0b877e727cd883a0cccdfd717567d2cd59c7fb33135b42fac92ff01ccd624daefb8416a5e937ac45ac65ac509eb85c899024afe784c40e67d82d207e5095e38da518470344f69f1f6687eef5a7c89f2f418358c518a3e92efc93658d17eedb4611369e21888b91befd8266399bf0bc6e9fd1db858aa51e01e611430ffb3fa8c818a7386fabad6dc14a1c637936430c4bea5326b7108ae9f9560e18269ace7b45588ee426ebbe5545551ac9bf85a37d85d6fc5ebd6afd9aeb7c13b8fca63ced85217c6247982705ac860b1cfecac0374cd71d3b7092ec0ac697d7426bc738770592332e679ff8817b1bfb5b40e92a978f6e3d5e178e6e2cb28d95805226865365d509b76d83d429b787939dffd8cac82a5cb5671ca7e2b935c23d2174c75a6b2aeac21f827024c635912689bcab0e8b25645cf8ceb250e89c8c8d6f812ab7513f022f70d2b224e94af41bf398ee0ffa42c3015bb194a6d191220bb689a8087f6021652d7951aa4485269837832a17ac68d0070423411dd50dbafee43e3935b448bc33857be27a56dc86cdedbbb9972385077946c790128330a25ca82cb7a77c04c775653ec9925fde7ae456b3c2fa87268f84506a96827c155c826c292a73388f85f1f4c532c6280bdda61b6738348fd7d971d2504d167a25302377a0369befaf79cf717cb568a6b64ac5d87ff2e6c1af9bbb8cf1348a1fa83ab49f783e638bd8e16522ca0a7bc2562b33f77effe272e443ed90babe221fd6c69ced5c6e9222ae9d78f89f2c5d89268f1e1d12e183d3f6311a4da9ead0d489cdd07555bb54a0b12cd9633de94c707a91cc31075caf59658cd0dfa69890dce3fde33872c2616cbff0b619dd3b75a44d5cdfb750465606aa6be7f24f03b37dcf147ee046bba64daebf1cb817db74d913f3c58bb6bc517b86f1faba3cbc353b149b5e8c64084373c0dbf7747af1c9916c66a0c95916a8a4a56f10c7413c45315a44e17171668aa0e4494c64c13276635e92d921b06c0967cee59d86ed1550ed3f4015ee8f71a0e7428fdd1694b2c852b9ab4aa57cad61732289f5aa02ce7b2b584edc90345bf838c83ce8d35528745fa7852731f7bb13999fe622071d3fbcf31bc9490d0f30686de04f6e84ec4df4c429a1369f7d30f4f4a1ab31a42cb9733f7e05442bb54e133d58ca299fc214510a64d8471fcb748235c1c9c037135b0396568df72e934d7195aaa9b3d58fba23a386dd2640b966789e6a76216699752def402a9d92202c78c050496af31037f1c30ce8d5cb0482e671cf792c536709e3cc2430e80afd99d215439673a4099e675101db2166b449abd83b0f875042e5d39261b01c71af1921d566186bd0d1fd9a284728284d965ba29fffce6ace1dcbc56055c64c81a62f4977e2ba9aabf0190d41b2a106520f8dd95b4b4a44f50c586a764828b5e488f4406cba1e83b8a75737d131da906984a8df734cbaa3135173d4b70597fe33a77f081b121c628aac01924c681f54f2e3279f22588a70a0e1fcdc2de13e125b0a0a4754d148cc9aa6b46acf5d97ad405d4c5f5f681649f96ba8b72b14e4000888a52aee19a3655d2b8ce212cdef2dc99a13f453e7f756a88d970836bc9c02fad2c8b4932c661719bd561fd8eabfe3c744ed6a14f114f292c209d7a643a5fe6c747430983334339493da84f8dfbfc0e8551f505fa7565d1647241803150ab2a2b1ea2dfa277e99b03db34af0728c02d4efc6b13971c94394034c1cbb186b275859044674276822a36692a420057fb69dc04c48fe9eeff4e86dd7a0951fc8aa9b2f4485c0034bac5f31ab1733868c65beb54747522b9d38498ceeea569ecaf251471ba0a1f89ea23c47c0828d1bccedd994cc04f64c7d7a235fe50cc54fd4ac77990d6895d8314a9ae57b83acf66f3b00306a300b63b794b32db2f9e69d1eba0d0a22eb353af7682373c3757fce0fb7460ae3421e6b415d7d8e1b0bc294f6baca0013c13285865f4ef676e8c1d18bf02913c6a9f3558d8596f5cb311ce7baa6e2f9bcdab8e96fcd679b72c5114f8a22630676b363ce084a41652ade4c4fecf3e95d571a676b52636d986e512b453ae1c26698981f6a2affb3ee66204c78151868782937df02a7913fb2995e8256193bcd444acd79f09edf114a463ed54f3f6c483c89271c1a0a132e20694cf36b329b4188409be4b7dc0f231aba35ceee6d45392877d28a6a66fa45cecba6e96d38d9b6bce8dbefae3e281d6bf3c711fccd13dd2272d22260a587472b6cbb43c780f4b5233c340d79cce4ecf84b18f738884816963ab7c87a8dd776f7bb776c560e82b664207ea9f2ea5fdd236ebe8aca46733073f05f27221791e2ec1467c6b4555a55e0645b1b7e9bd57636d00dbe8b1885c680bc657b255f9a9893dabf2e84394fd0317ae03820e32d97b2a182b6ff28841d2296310d98618fee65dab7728650d9635cfab275212cba0ac3ca4ffa646eae2d636e03f4b202a5bdf519de21b27938981ff5a183159a1b7b567daa9a7f85002a191b09a9f50ca0a628b0fdfe2a68db7dbe985a0bbee2eb8a74d1e708248074d955dbc325473861840007e300413d206e36178c9d17a50f42f48c79ca9e3926e3a9b080077929baa9452d00c82f4d1a95032674bd27a1361a47e7ea5d23161a16ec3026d2b5630eda1ca197283e48d82c35785cd152ab276c1c7129633b6b30a220b5a9c67459f0e5c11a14a4505ae2c513bb4011dfc4478b3700ec19d9111f00f3f291558e1ef7ccb78118556e0ec890540f81183ee20dddb37a5c87f095f7e07d71f3cdba6b782fab8ffbce8cfaa07c3734b6b3a57d8a41ed26ef7aae087323ce959014a821d6abe54d52afd4fa1d3d12e59ef8a1482ca71202f39c2c013399e9b2674dc5bc4c1551a89e858f95afb0ff5be422707fa853a29d112c3f351fcd9f545c2930a5cd9999c4d26a52bbd0de68fbe3a14d799a5002fb859382cc3ef0a0bffb8ff5852ad427347c6edecef49ce762eb7b5b88df1eceb7a19d8fda8491a542974cae87f1baab762a36387fcd5d30d9bb5ebe154dcec7169502fb19760caf9ee9e7678581ab356617ce8d8c8a6089680d23eea73e333363c7d9890dd8624137c59b59b8cbf469509a095e8f428be10752ed82e911a4126b41d67d4afca1bce18e832249b33c403e0a4c003a4c0a18dbd4f7b8634d9aeb7eda47959cfd5ed82bd775ef6a82407ab732bd150e60aaa20e43cc0fdc9f2afba1de2d5217f7bf3bdf39cf1b75563d3449fb80c41249ee54305898b00c80236a0bc7da01e117cb8007e8f7e03e9c7907495a43f32e03fdc1cf0aada0b449619178748981b251045d6e3db68d32fd18bdf48a5588cb8bedb95e6997a9eb703b4a5543699f462296b7c2b230ff6d69519d054a23f8036eea82b87106687bf2b173d50d3abb01f80c6d87c5249dc8bc034e9e8ab9008c5ef4eb524723a654ee04241f37be4abbf1b274ea67ad119ca250d2483ca2b8ac8ecec42e8d18fd4359c992a7d38ff2124f7677f939fdb03e47ba17d3c632d66e3f2e0af46964aedc78a5cef1eb02a1c81f9f376d29e011001f82f88df7bddd71eab50cee134ca7bd2039133ebd000d8155925a84b4c3ff124e7cf9338148f97b0b777effe8daeee4a38d276561d878b5f086188751ec67fab8c210f95bb89f42b49461275e659966536afb0f605dd6e6a81653f6877392e115b0e7506d2a2ffe41700434cdfbe554d048726c978e5a24518f5c4057ec00aea0894c38823347333ac10e4fc34ba1aca4b7fc5bc81e77a6360e4bd88f1b330c17272b27686b53a2d3ace89a6ddd5c75f98c025b183407ef377474fe58d4593de27e7c198c76eb7d5f0f60e7c98bc2f98b4dc2f2ccfaf3264ee8513d7cfb974bb1d17bd99b8c10258f340d12e0511932ead1aff02b5cdec411f2ac53db4fd7252290a08854590bb27e8222aba436f072364d8a37f8b927038dc5c90f3553cdc15ac6208128830a8db0ccaf9dfb5d084d0fea3fa69a623555f2e0d25acd8f517e55889c079c3f0ccc530576d5705653e310558d993de5cba44f315a3e9a8edfc92a352d26b9a9c6ac699934958063a08305abe7fc0fb4f5fb8de8e0a99b0b5af648416f27a6f649abae4fd6dd47e512cac892e738e4f1834623175aa5025f2b35fefd996fd41998fcd8a98e03cf8fa27eba0b59ccb9dee31ac23cde45f06c9470e8cf241600b2b349b5f3c1f0d9a67dfefdfd571a0e00a98388d2757fb1f9b218c40f3ceb43f95e1ba68abc7331097646f77e7d63490378a785615f5229cf8bf5865fd12507c193a4b77d57cbb32ce2ebc32c43fa892071ecf1d6cc0b0ba246411e8c1686095f5439cc7ea1b2c58848e60c3f8badd941762274a6cfd1838cb5c7fd3cdf678407ec8ce438234fa7af54162157cf4f0cae0ca6dbefc17a2c0c7975f621331652956d60e9ca37c63504435404a6659f1faafaf9d824b9d9eeb61f0c96714aa0905a05dc350f1831d8b8693ee7b5a092c63ce180307b41c3ae717204d2538f0114f8d4627ae84cf661227a86162e1be8883523741623888cb9dafc0ddfb8f285300b73b399add203eada4fc77879e6c476fb4ad1c33d00212751b7e38b18d04f6454980dfb46f2e275399498dc874e64189e9ea149330b47566ea4c31102c509641157308973dc77bdf070463687635bd00e077bf5268f00fef48d6ead7150b736ec5ba16a4f1d50c78202e743a24331b2ba27a8a1e4c46256a836f208498d88608745a0410bce6ffe19c2aa6847bfe054f0350ffcb5803c576781ffdd59143b6351846110a87a98f93c021f9d01f9c34fec01564cd8899758d23e196e1b9f12124e29950ae6aa807b59a7de62acd52758c7301ad4e6049ae842f9cded1af81f5a181abe5b0ae04a1b71c02341acf5832c6c9cf2c22e25992f44e2095deefbdecc32021cfdb275eed4fa7d11bfbb766291bcec6e1ae74101125913403c2175c0512f9835e4d1e4ad490da644fbb5009123d2db6e508cf7121cb10ad9afc338df03152c9d565a1c6565a3868526e43bcbc395f174901ebcbdd7f2a51c462ec9f17a79e32c212798be556435d8180dfcbfc6f2e2cfb66caff4efc1d994f8c1b57b97b0aa03c833d918abf096a71bebe308f034f13e563bbe5e41d184649f63203b0e18e95ab26c49a9f2ea07d4e85e7da26db9a51de2e82130ca70f772e1f36d1b730401d56f2bfbba9310d50cfe8521a6439440d94db0e92e9169588a68e84a056ace0f6564855d4b90f2afd7cae97d824f584170f9aab5c2670d729f0d9ed0e192bce4d4736466c0ec8e6db0559b273c5e497db7ace5fc7d75d1b26118aec789ee81ae9030bfa81b6ab6044368bf45e80a4149ea40e375c3ae3e2c93d0e7a26c42ed0578d279ab5a95a19ab2a7f6adfb88e369a8200025afffb59d912769c0f0bceebf6cdcf8bdd562e6a8383c7e4da8d20734f7af7fc26c24bdaa6486e345af48ae7a230be819b03911b4066d35a495206902cf1bc2d3078ffe6009ccd2262c19d75b49a5140077cdea93ea896e03f7465eb6a1cc376fb471bd3e04b4275eff9dc014f03874b56452c041eb36ac59887a638d46a7d6911f32d172861b6d4dff6d16efa533e563a1935e79caf4386935f023c9553adbbb727c1a896a389d404c7032d170bcb3d703c693463bd67f74dd28692591d6bbe804814bdd0a23e01d4e9933bbc3bdd826cbc695fefbb1547bf2fc73c7097507c20e72c24688bc970e87858f59f026ac10956be4298c445e85150e4ffc169b507d32ad81a77e102f119df04b5499674e51421915feb548428f5b8d81f7cb1d1aa1098c0c6bc0986a6aafa95247e6beb371b2baab5343b99ea8d815b164dc3d48e745854410275a79b028e8b874cb56f49f80624478be087167241db8eec8a761bfd527c0371e5531e4dc288a963311163348075f9cc9bcb9e6d0a49210376185252d854912c09ae4f2e9fa928b05122376dbaa1126cfb71298d154b8142058378f3ed63e4dd55f3aeb6e0f53e4f40165aa47908131543fcd89bfbe7aba76086bed30893c7ac9a10d5f22fa8afbfcae15e9f76d7a7089cf60eb10130932853a931d3944f717ce9b47d0dbd031f2c50bbf6d1039b948036f6baa2f3f4e1e4e2e21071c4b27b8efb7eb542ec33caaaf58377719e6616e9ea4966654004695d7dc47cb9ac483a0906f8f4a6393e75aa60b145034ffd33bd7963dc7846a2b39b8056a5d0d8132de5effed0ba0cdb4902ce00f3db4baf503be5660f1c467125fae6794cceee486b67894be6e3a4b1cd30f02695d5e684256874093d7cc96bc46c1e4997be3105c8a1fbc5b756def87bfbae514e9ebcd6d1139a8803faefa0547e16efac9cadb0e38b2215696e300918f57171708276a61c33da606439c6d02545fe722900d9c7f45d76c49671df7c861da2343d50442f3e27c7815e5f32b682090ba52c06185f8f52e80bb042db1d75ee2a708b2ad46daf383d10d7828e1f1258c251a533b9dff9322f820dd52d34dd6274d0e5b6822a6ebad9a980692c9d478ca0c5304a14b1d6cdf197750dba8736830e35f361e232c32f9678b80d997a6a73ab5e5e324fc57e9d49234f0f19978670c9e22b599bb08610ad9ccd56e5666203bbbdb0d92fb99d818b277bab6c2ad8f5bb35f34611b035cb6fdf8165c4cd4642333f3ec6f726876ef21b62fbf88093076130418e8aafcc64a6ba51ebd64861fdf58b46ab8d493a38de178df5edccc3ffecbfc29171d7b38eb11d4837ba9395d01ecac1a09d65c59775e7e4f388bd7252a01e2fe25df582274c735ddbb1d42ebd2aae5f6366d12c84653ad1d91bff27a838969f53b868dbfd8f9cf2f8f180268772bd0076668c2134e955c6e1ae7057a3fbcb2a20aee34029cfe78b8352f5db8e205e71631fdc2f196d5e1c3d25d062ab7a801abf6b1de43e3ccf1ac8c3fcc27754ab1170f6ef3cf480c130ad62b9c41ba5fa72c3dcca4415fa6c6f8a85a6175d4b15fd940c0a989b694ffbd03b1a93201005c78f6c424569a93accedcef1d7f71c8b8ed8514968346c02fcb87633fc7932f09223e1a71ba0d7c589c127b2e783321c6752ecd9f6b609b302cb67ef11bb2c41cdba197ee078efef6bf1ab076357d4e7a014a28074f322d01ccdb8a9ba8c71a6ad377ff23a7a96d4aa59d1302ea5447e14433e569e4e94417cad48196631d5bf5f3b56eee23559fcb4118294322914984eb48e87d2f656dcd55b4d7584a13d0c7310d9ca255375a7e8176614ffe91cc6ce475d47ad9b876031d0248de67413df9bf6ad842abb081c4a905487abec16f898155c74e028afc38ae7b9d9b03d9562c491b7270259571dfe4ff482dfd1f203446e7b8ea80580577d7e2ffdbcddcf59c18949d6873bc8a57ac234a483112b5db6a8e3911007a98e4e64d36b227f8356b8610b1d94c84ac9a5f531f4758022095f7c4f185c5a17cc116ce44831f3e230551181fb60c1d55bc06329e6cd689331739b3f220d5aaa36c4a33c9f83fb88e38d81baf6c22edb82b1c67c37b901d70abae27ceb7e6562f2e6c2c5dbf3dedbb5a70a309389b344b8231cb68dc65e248e99e57d3d86e6e341b4ea902e8174b8e96b23b1b71ba9cc4aa5ef89a3ed0349a67e61b86f6ae23b8f3afca565634b41b262a5727d6a2add4438b0abe226843d25e9634fe01409981267a2b6946f5a1aeb1e5a1163ba42ef8925a29e80e3b3193ca6e0d8a3631bac2ecd5b6159fd5cca69f2b9a8731189bf7295f888d13193ad5e1e0338a4569e5e83cc4a15b8351ac30b97fc5a71c6ee8002749d62c64cc0537d9a717ee95ee4289e3a220a1fb87ebebf12587c155a2af8c997cd2faa36bdad8a0ad03fc3a9a1ae7c7a63b866bbc02a027a96d8846113ba20f28ccb5feb8a54baf909ac9b69ffe87a1fbeeb006d5e97cd5be3cbf3bac4f349402e6225ead92fa8b2f750cd265917a5e19bd75ac12f5366063a208d47bef4ac18d6c48213f24f06c9daac6bf2f39d6a78c8a79d0a2578c0b7b47e114d6247edc61b9fca2b842b25d4038de8ee713ee8498dcbc4225ce710aa082c2867b98c4ade046fc31d3f33e017ce12cf8a574093fbcdcfb1f9b2499ddf3e34e5d05b93ac339b315d09f6dbf4d92794209dd758bc242c89d450c8ada5dcdef8534d2015a9e10ecd75e0a4324921e003efe3a6bbf01d993965928a86b1fffb510103a1a7fa5c9deab7fbce333b5eb475ea9eef452280699d6bd55187c7dc26373283add615835ab7ecdbba60548fefb9cdf82f487440fab3084898fc25d92f4c18a172af07268f9db8cc4dd8a2167126e6590799f95ab875f0d4c92c721857afdf5fda356446aa2734d074518dc952a77ce236d606cc91674584467904bd0bdd92b8e96c137b395a479f603ef0c2a383f1497c96e71ee476d9c5800dbd71b7b96afefc1990e73f4c7dd2da798bb34e736304d531131e34528d386736464375ded8a81aeea0589611e613699d43ef45e7f184cbc7387c036921d337a24373d1d7ec7b4ed2521babf2e353da08e043cd2e94b2aa8d1b7d11a5bfd735198cb2722642fe30b8961b56212f8edd6b681335608d5defd7fec4471bfb2b54969be2efdad82426bb82bf575962544a7a90c8ee7d908fe069580482e9ca0536c26369f640ff27e0c93c370df155ce8a225881bceb354b83fc922643a67af7ac46de82ea10e05bdd7a3d734d7b0289110c9d7b0313df5cc0b9a759b2f0831345fd931f9fd4571246970602c13da4e851c45b107b505e17e13d36220d40cae94f33693bee8a80662d0356c54f3750595433948615eb5a8f34425406e16f3810deb4847bba70b9ee1680a5e9230f613e1b533ce814337e2b38c7657c75211e5fc5ad30b2dd9bd099c716d9c0eab8fb5c2f438d614a33f7135dac3f62b1ab2d4f08ab9e311eddafa03378014aafaf86be47bb7b601a54e7b00b299620dc5cf19036f2a99f4ef5f378b38b4fb42873426057cf563cf4d5dce44258d68b305ac224b26ed8cd51159920be79465d9e6331796dc5d596419a81578bd2d7055684329a8ffa7e107f88bb2af2235e50a927ef00c306cb7de442f51b712960508857bc6d3208b4098b005c8109b80bcfbfe61385b718d09cbd00b3d562e57b3507611279477b7a96cc8af33eec4005d02f6334cc3154b39e975aeca116feb37aa34ddea4a94214ccbfc8e79a5bafe5e61720852b15809699be418c265504ffac3db66ddd004b15ceed9ee60aa2916bd7cbc5caa94ed312cde21989c3f40c8ae14b68132f534061dbbc8b0dd174c64cbb09d7491e3a36778e9580159a73fd76d45f5f7ec2790bc5bf938fe724d468588ee3055923a2d78600d97bbca3cea30af314874a9855c7f57a4353725062022f64721c7f36bb16a4788f10f67ca910324b65ae50c92c3821fa3a8fee27a299cc1e46f26c08be689e2f8513d4cb9bc38b2558742b5b0b21f00b770f816b9d91b838fbbe673c1a3925ed548d7297558b4c99580b91e35b86a962680c6594d20036e9f4d8bfdabedc332831ae1fb211828e3cb529092d482af03a02a9b8f396c5f7db583c3bb746856c9d05ea1f911ef68552967133353761168fc05abc26244ee7f0aa0388a6e183c0dcf913c2448dae6f5c3f935d93d2bce55a3a6d0734d502b064865977c0772465a7c268c7af2a4e140b026a1edac8caa7f1172c7eb28f1c362f1f01d0a91959b8792b7d97995bd1f5c33bfc9420b500bfe0fc1d7818ff16827234273fb456f0d53be10af2bc2c3de3078e5f398f93b0146f2b3f5d92e4b83eb538fae26e51ebb04259ad9300dd7715aea54f1ea6ad9c1004205934c2bb655b32bd20c192d3628d4be545c2b5e2ef424808fc68f24f7e3076bbb81cac710f9098fc9811f453a7a631a0f370313381fe5ef167dc54aee4a400e06d3e3bcccb15cece3f76526d617a640ae30ddcf76a8ccc50662be75aeefd3549e526fc57cda20fbebd283675231486bf3200c4d0375158923a7cf02ca58873e9b62f747d9b1a7c626b172348730fa7fa2aa2c23427d4fbfa1d9d9b1710b12d366c3878a3c89a49f50c932d3b7e13d40cd4b2321b80bdd365f22eb64ddb5b6f8aa99b04d1a812e3e19bcec2cd15d922e0b1ef520cc6d140eb9b10286d69328157cd21e97fdfd65f0fc634618345c5f8b3459aec1aa20e51402953e3a8af70795578bbef60cb62f3b9f67e0e21e11b476cbea327cc319c14947764b6585672052f36b155dede9631cb6ddde560f29f4f2cffc8a0a1bd87d0394e70d9e3687f378a38dca1cba6dfef63757df39d09b48ce75c00d8a743a0248c0514f6580da6294b5c392c9f8c94755c6411a4483093e5c19bab0aa59994412b71823a858530ae2eaa4e58b0d32f466a771672164e3054b9794726a99868e6af2bef03f66ccf5336141610650763341aae911aa7634b01cd6218d53ceb792b98f18bf29c106227a1df9e93107492ee4254e81e6988c2d49c6709c6d7659de8f676d7d05d70e435750ecd43e93c2a54e6249aafd0b340dc6371fb124430f9a14c45ea18edfac5ac9482273e247992bfbff6c668f87f7a599be3a7ca8f3130cabd939b82ee3cdb9810ac0e6fd614044e6030b18ca24e7311040ccf73285fbff6157611107153a902bd131bd1c89e83797610c0b4893d03eb353dda0aa72f4bc0746371e3ffe65de0c33a22ca1aa361fe63ff1a522f584653a9cd35289674013a850a659d768f1a1c0bcb6efc30447ca8163d75c6c1415eaf9db43bbca28701acaaef3da7497089ff51561215197d1923055c6a9e7bc52e5f9717b2706e15a4f95bc7a5fafbca00d153ef35d60adc2248353d7e318d095038c0a53bc7a63deafa8e77530735e75d62bf17a6539b8452ee77e3275110c502a1f1b46803d342dd49c2a02d2e9f70dd19f8326a81f803d1ac54ed4f26323b04168e79150368f27746adf0887ff467ab809dd7771a91c5c29d4a44c3af911c5f31dd221829e1f49da0ee8df303c69dfb88ce69442f87c669bdb14a8473245525039243db51df27761e0834e72dca916557dadfa0b8e2d7d3b41873bf95243be844515cbe444c381b0d3319bfab3ddfd331e741b05883ee5400f9af8bc0e18f33cde055e346b3832bd4c967f8bf29f8f47fbcf7fd432f4b30b15c037fcc3d6ad6bcf973bce950bf8ae09bb8b5a908a2acde05b9d8295e580028115f7df6819ae509dacc15ac6db0142f013bb50bac2975b0f59f7d6ff7eabaa44dbdd71006a1efa229f32414c685e76994d32cd25d5b6a3bd097381cdeb85e9462a0e74010a48c761f6dc4cb5b0db2f43c12468b573f1ea9c37c9f645da85391487f2d68a6ab6d7a93309047ee3787e9ec031212e7137ac57ef0a54620fad2a20ed992166bdc2bf41eaffb4408115a19eda88a058228c7ec3ee21993f8aef32908813319f4b84f075ac732edda58ef7ff749d743d7c7352990ed2f732dd4cc6705bdd59e4027b9127dfbaf818893f491f0826e1b6ec82da9e7f3d919896986d2c557b65e30f72f4c783acb79cc7d169aa3b4aab71f8a9dc11c88dce8771c03c3f13f818e31aba417590dc0c1f3a22577bcc92c1adc9f77b858ef85fd3a90092945f7b17fa2cb55796f1988abcd9fbee28a5dfd1335270bc589521949231a45ed065f07b9ebd5b6fc872ec75a44419669f948da0ef4e830d9432736c14e8829ab80b7297ef0030883e7454881c4579eee66dc4e384d2dcf267ddbdd3357419363721d0fc321856a701555c7e9e8b616afed008b5beb7e18b3a8546e7a40754d199c3b616584eee03e2314f922535b41eec82a0559aa935920f18a61e7104cc62e327827a52d648ea3326480d6d6ae5e787b7b1ab231bb9df94a94da7f652842e02e316e5c5fcfa925651088c954947c89ef46d7b7e8b606630ba915dc133f9ddd733854f605a75e3116767130a4a2463686c04f3b7bb8ac6ad16ffa66c30918bf59f1f033226f4aa2bbf66df5b6b452bda7901dd22fcb031455e847afb62a5c02a060b7ba0cabc6c781733f7df76bbd765b7f5a05e4443dfb585d7ca52b385f83b61a087f8ff5dd90f1f9f79d4efd6d9dcbe1216a42e1836efd03c3a2b0a77a2af1d2d672fc03f3a7c3d0743bc36e889f7f48e587a72ef0a197e3474b8d77bf6c8fdd6384ed6cc0aa2a5c1499a7719719970911fa5a1823a5fcf31c6b31eb5005300cb62b837f710b3952d3ce90a1210eaa476bcb899e54711e86de9c86663ff57501c9b5be972ab2243a4aafd5374b6daef29d2b01217444d46722156621d8a62bdecef6a025d390b13dc1553a79cf316fe17ed2e3626337ee0c2acc348eba9003b0f62b98ba58be72864a9d7a1b673108144f906a603181b307c4c0809ee2cd402537e9ba576df9d7d7739dd10c0ea4f1802546d96f709d5ddb0336ed9351cd041482739971806f1cb1bb2f703500e47029e00f50ff322e9e4b78983e9eacb180648960a8608ad25f630859b1e3aa4562a4937cd5006e1a6679fe6f08ae4f9bdb926702d84146ad03354505ffa844867c86b89100f71054583997f529ebbca1f284ac665fb00bb4f5fe2d3af0b226e9955af0f7b2cec2ebfd17ca7c2dbd0b8ad193098c514e32f83e431e95708fb76edbd10147fd754c908bf428b099777e64743abf66a867935638c38c5246e68cf7ce9ae8b508b57514da0f558a7f3345b323ef889fcaa455df88b8f5d94b9f8f6717b2401836a3201a3bdd05e3b916755fdbf6394864e4a36550925527ec313c757082a9c9b8402d28aca36c6e5f63f7c7c9a96e12cbf898542dba9c6c11bb6a5bcee97d94172652a76d94b84f550d2bd22353c13cf56462b23a71f0bb51f39c6818fe54790b2d2c6d3d9e4d07b74323b79600a47562a1aa02144f92860e717b8ad5c6a9cd3875f3431f280a70926fe5be844129b755397ccb89751a57cab3f00e0542ec7f7136574dedf63831b958c2493a8c9ac56b197c717d00a54d350942d3db362f444d0cc7c19f9e225b1096a4203452a128cf7c7a3f0983ff1781c893b0ca9b392ba4e9805beab82f00bc82ce2536e5f796d784f10fd6c090008061a8aaa78870b53dd55fad80d7a3e1817793713713113030f76cd9d8a033eb61cacf6f76e5c1b2335d5f1740c064664fb00b8c6efe14c857f5a7a07c35d4f0ec42e08c54de34deabbc6b7c070e9ff8a3ac0ad162cf0ccece93dffd3b15a6f0295249b21cff73f7c45a48c305c47bea6f825a2c883f6f2af789558d0263382f184f702fdfa86bd51b446fbcd240461b70a91814b50e7f78394b6698b3e0766976a52af5ab9b02628a97d2aaa93d3617399d73decb89d101fb0ed4f2762ec44105eab3dab5eb2acbb956b90c83e3db01fbd959b8bf0bd5a90caeff8a7b313e37076453d9d","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
