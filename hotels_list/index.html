<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c19d139159822f0bae7c6fcecccfbbd3c5cc9fda6324a9d407d739ddeb98a2e88f66a17ddecbbfd57cb75fb3a45014b9c1c68930cec43bb18f621477a14505fbb9a97c7a4ef099591c027913b5b5d48e32ef55a451c3fa56471ed53aa2e146301c595ae30f33339f1279192d29cdbc6ff5e335cfd03a8afdb2601068f9c247f4257e864688ba0fa2a7323edfd88836ed454db35f78d2578fa30bc60ede8bb147e97d89c5c2c9ef840a9f66bbdb355f5f94eadf2229b4e797a2a47ac72645924dd8db95525f7f3bf08c3841c82867637c105149f07f76699870b8bdb592bc9343506c36aa8dd3571c6f1d2f45c8863ecd09dda33bfc4ea15734206c6e0bf2422370b289f334c5e362308a9235fc3136d0c6036b7b43b11448592c257b5aec210b7b83c398f05c16c8e27b5c1f1a1496b5574bde3cead946bcfe86fba3d88a8cd759062497c65ff4ffbc0c02269878eeac5dc9256c2e704c3310813c11bfe8f919d870e859249d3fd9cd95ec6f0f92c6a70bf4ad67c50e474ce503a2c42958a957cf2c1b207040af04c58b5d0053c9a2f9d216a46870d062bd8e78b552cb7f3933ec4b5f5cc7f248f1f2e8bbab96efbff95a3f4f007c8c1ec90c130062c5970885f3b27590bd29ea5e9a6ba7670981fccbaa9c7a7e188cd591e9c00423de7cbd479d8fea67380f7ebd7efced0a0635e89414431b4ae357111fc2ad8aed9e7a980af2dbee0138603dfacf2fd1bba104ab4ac15308f16ac4f9a3fba3f01f2e4ea760fbf3b1a44af808bf779c6dab476b740d54cce08e925e18dbf457682e8e52f2a35605aa1e964da44209c9a6b907517b48eb78d614fd04892d7c634ee249c605485d3bea7c309ab674739c7a07cbc4948506aaa23e2a7f7d3cf342c439d4fc78a5d486295b66a17f79aee00cf410a7525c0cc1c8212f6870f607df07263fe30626c24aa7128cc71de278e544fb26e3e592ddbb511e7dee18e68634dc8846b3cc5fd37bfb9d9b4cdbecd7860a1e4f1264e5e0d6f3ef03322bdb9d78b92fd115bc70925b87834ed17941c91c37082268a5f6f3981534facdef770f37494479c3c15d6561e6761363b7276a02d0dc302936a273baf18270a10c61569ba2a4d8bb5d328547d943a72c4132d368794725f98e40454af3c0ff314c352d9a4804b898bd736fc5aac92b91cfabd7b3dc15745dab42883bf8fb242485ee738fe2b91e80e88cf9e3996f521b870c232c19fdd92101d1d620506f68de7a4acc900822b07d6afec00a1084b838429fbee517970c38b9b189f7269ec327d81a792f6e5001960434ccfa0e7f7bb6a0e4009446422bbf988acf569513a0589c05ecdec1207dab3f7c34755c9cb90ed1204cff86b1eccb8db0fd6033835f23f0de088a9e4fe3f8cd9b2ba49239a83d10155c43a44411b095eea2b9d51520cb18121aa1b8e7caa2cc83ffdd1c3177212f0b10ca1e80cd2e403aaa6ea266ef71487e36dc9df36e5f270575641af28f717fc67afd7bbffc67591f459e76417ac7d4cb9d93171eface70ebc0be7e6555b2d28e0efbab631179a3ebc5e29ed8d781bb82cf95e602db4ff9fc835b982f4a34c65e4da79f0ccae9caed3df4b9a092f749133cac31c6bed297ba99b9e7ed1f59cca44de0aa3bfac076519070c413a0bcb93759ce909e16d682d490b58fecd7f394d6aed6d8feec9c9eafabd10c3e5043f1fac3a36b0fc2d9648c57d6df0d015bd6c1b61114cc76634722fa8d16d8058e427c6ae8f43fc32881b901b20af43b68e11bc0f820e5ad1247b3b20123ddf360a889ebac2a5eee8977032fd249fecde32340b24d2a2c3f5ee601ee07c6dbb5b15946c750d2ed89b1d9d299f89ad5f93352a4f33b8de8d838f830b356fc335f7b10898bbb50d1ae80313c9d3e77fa83f7e0de9d19ae7b8c5d8e9ac41d65932c6a6ce8a05d039daae5def35226c1c9daa4cc266f4fa7d2aee6664943d88a90b3724ef37fb74f908544c1866f2da7a1cbcbd1a666f854f5943f79f1ba7918cef7a0d8f2321ab955ab096b0d072538e2a572acbd93f3fe39b28a0f75adbb7bef3fa13556d844532f1b45ece4bf177b7afb52477dbabce0b67f71b3b1f99696f417edfb999d5cd9b693e7b1c0e41aaadfee29f003251d0ec9af1a01a93002a65cf8a9bea4f1f628f65dd77876124a9332fceffb7a7323e8982e1ed92aed72d54c0572511748c20d7b85048e6a55034d3d564990d7ddca7b964946137a30945921b233dbaae8f0b958dc919227ee6e15578f15f5614074823a0a4ae7efb1e26bedf570330a7d2dc258d0950300f78b47a8ab44b917a40460d3aae77f9ffb7a3c359cd6f86277082f3ba98ebeac40a976bec1c13ec3a69c3d4c5009d5348a5c8afcf854510e18a0fdfcf861ff4728684b169c37abf34f5d0ef02f70fa6ab60c17acfe00c4e214f60aae5b48376d99da29fcfce77749508c679a473de4bb0bd29d1b382665a2ed68813d9282aa900e6bf7639a3e98f11294e910121287713572d6744aaee0f3b558166a77e2051dfac32907aa270cbc25e3f18066d83817d3d3c03e1b07dea073155a6cbe14ab88b47d8cf02da65bd39e8e7900e62715f91c5503f618ea5f1f1ae4dc437101c60dfbee9b74e9509211a18e5b1658cfc5924b62c9230a914fa26c775542d018ff3364cbda86a913d3d2e6ea1ad6c686197f6af40d755f360a0aab0aa38fd585c1828bdabe97234d81e121e3d0f64cc9923d7ae56eb4749d0ab827370e740ab66a396df52768998297cd9a5d8c444845ffd02ff6d5b6acb35abdeae8a9e9cd6502e93c25cd2624ddd3dcf36aa754a0851cd83f557589b6ad8115b6d3e4dca81c594c6b394e3ccd2d09258825ff4682f5e4131ee3643df8e4da9ff3c9021a6a6121da912820343af7d7b594c50c83783a44e5980fbf091e2576e0077f3a322ca8a4470b3a664e6052b039b5d77da413e6fa0e267185f1c84db48c432fbe20105d1a0ba4616989e523efbc6830eaec31b1256993dc90fb6f54a4ff414eb6f97b5a374316f0d1c7474c4e151679655d2f954ab250952501261efe24525d5fbe69b339036ffc6595227d97fb13ea157612966d1d59621b0c1e7bb82eb604a8b54da0c5a6e7a82f2e16133ba641c0d5d5b5db0dcf9eda384f03772d6dcbbbd3c4c5312c553a41c8dff72c33f23eef9d588faa54ee1471b493b20915e52fa7050ea13fbab872c6d3d93fe7fdcf8f1ca5e7e3f8552e85fe207982457e196705a70eb3ccab6dba193876e6356abab36f3bb6c63b3c477b532076544096f289afd34cac52e13d7347be2a4ab7eefa61b792f1f9809823c7678eaa21ba59ccc1bd9d4ce91e64ba3d71a3f469b4192a475abf207f63a283955234d00c725ec8b284a82ae6c757d36a8e7dc4304cb246e855beedb9341da98f31217ff38d09465b877805321a975ab3ee4d1e77bf5fc0b477c5d537b910416db3c3a88d5469c200fcbcc791c533a2a398d6b2c70a7b2b0e999c34b4471284730866f3cd993ccf49c5bd62b855603fa8e70f9215a09a61deb92fbb757175a4306bb9f3bd3ba2dc3403b7d5854ce610c7014aec3c4e5fe0a7af7ed193ba592493f88d69d0e34ba4eaa580df6f856b384b33a34547eb92775100b5ff5c21cfa0547513e43f86c2d30cb8f7567ba5927f8f96d55f74bcd8af5b4966c7e4a12b266ddb789d27be7f2090cb2b3923b214de9c25c55b923a8347462b2c7cc0f49d6c65a3301f49dcff52dbc1a666b280eb9ef15f3ce18747e6fd092aab2c1d0abf608262d7f60a995abb953d077809f06f396b74004f2e8d6627524117c9ef011980bd3acf68244bf62f3bd8c87c38e71948675fb30b66f1f0cf659c43fd4ca733e5a78278876c3c878a27e6a0553eb402828bfe4c81aa88a50c0134a3c53c7c635bd2470e9f00c89099676823094f11cf39a1bd86f1276d053dc86dbc0f061d5ef781fc80b77f0a40902f6fc45fc904e4e5bcee613bf51ccbb63d5e3a02a15ce6764b9ae299d8bdb83a36c9d0342009e718eed6f8ed5e815d979a3219132f25fd497e6cacfacd8e7886369a264f6a5df00c3057f60b4728d9371c64df40c8d4accfff0a1d5cc182359113fec7bc4525965cf0a311a03ed7296ee60eba9bc902847878e28422e00875419f73ab7389ecb0696b533bb884106ee634c6bdd0cc76852d7d1593aa6b9c833bd67846bc16899441383c945e3f42540732cea37cd848e8b624b7c58e5ae83267998a6a497e3927001e9885b97a41cc5788003d205e282b040a970697ee86e61c5295c13f5be414d69d57381a6ceda513540af17b3428be6b581dda8b670573a7e1efa73b734cef811b3e4cc4ebe148a08112e3ddab98605fcbae79d1f76e64616d1872f3602f04d9b851214aa48e9fd1589e7a5338adfba48518eb863febb9bf3d74c307daf583194f4d9d74f78be9cd0cedb7eb46aa917573409f0bc30c398595bdbe5c666791288d889cf4ab57195308a4897b9f2f392dc7dd633cedd8fa2eb975efff107d5d7ed984bd8a4db418403e63ec2256a69fe73a418c2f0dc22dd0d196c50ca428d10d27731d84f9e3f3dd01c413bfa4336cda98d19cc989b9fc52a3b8cced27459cc9fe0cc956cf90905b9fdc67205551c252ad67e8aee48279ddc6cba29cff730473fea0534a0326ce63334d06915f8e8b0bd2b0ddc05fed731889cb90872abcaa2ca498547b289f32cf2cac56f00bf521269499b8b6327d3a5931147562dae5ec82b61e7b3b1227f550641e648deb59f8bb40ccb00d3e54bc05972e8c1a5aed2dce03c98a7e078877a8d80e255d40f2a5b78936189b8cf88eb6dc26410fa4e1d8a220574b65c4bda310ce71e61979f9abe14bf8ec0d94639ea8393979f3ecbb7e154695f11de98e762f4c7feb14a99024e8ff3ba5fb270158cc9f7f988ba7e876749b16ecb790f1e384c35d3f039723491dc41883deb0a24c236022e9eebff8c13e5ebe5a9f8a4deb7245e0a5668a9c5175a01fb58a6558efa183d948dd79d44c91aeb2dc762607ab1e0a95087437538e549ad9c6f4e86567b7967280e852cfa1235ff4c4e3ce84b41a09351a22c123b2db282d310a411a84b35a50815f836952e8c168cb5bb5ea9ecd50139c589086da56d6fcb776a9b923a298c5fdac01c59199f9811ee305f7e18607e9fbf6020eca7ab53a829fec2f2a4417daf8a52ae78dca6c9f48f771fe28567545f88f49d030996a8590c2ba3073855e46ad9b4a9c2ee36b003677352cce024f78c33d5c53b9c858c05a88ec36ab6768eec80426e19b7080792fd2a0bff15a651e454219b9c6774dee26120692d14c10ddb1247b33a289013ab277c267713a9d32fd4e340e8e46308c88405ee038efdf4db1c38f0c6b54815d137e19026f55f6cd22a1410007cf595111a00323e318063c71a029f860dd7ecba493ad519292773641325f7a30c9c1851ad92072ea5fe4b693cdc7b2b9656fff40d1f46a858c200ca65b9f5e9efa05ed65dad1e76ed5a2bbcc850b8b051182aa06bcfbc1ff9ed3a758f50979d3ab12a93bbccb3aef88a64b29b3a7238e508aaced145aa9ce2ba10ee7376d03716e173f56e3ac5a058ee45c439dad7d947bd7cee03ce33d56623d0916ee63fd1e55ade2a2c50fded1ed52b3ce40f4f34866b9ce5dc76d71c31360b2332f41fded7962999a1225da0ee2263df6b9b4e678d15d73a540b28a25691719dae14adcb71629fdbcae7b22ea496d79750b925aedfd006ae9516c5d8052f35a49a2b12f86aa9f9de1ffe384957c5d5349848319cb05a992afa88a8f3f54fe4d2705fcdfa27b99d3ff9fc1ad02269de2438aa7067c71247d026158d99d2a832e6e37924b94c8665a6e2e95ff2d6f7e775098048364c069ce5221da2fedc532e9e61d504c2e1cb070041162dc5d3e58572b322fb3522619df2e69c3117967b9446b46ae1c48b4160437055a5da1609cc97b912b15a329ce6bade5f4277a48a6c5f55c8845da8e16a1e7e98bbaa50e57bd6e4b77a5f12a08c5f99d5feae4c73f2702e04e81d64ef6e0669879599ad83045ea9308506f784be3aa55740617eb091a5e6beed312eece65a4b995ea26ef115055c7e84fe961f58f22914cdaca52997cf5e6988115157298b8f57ccd7dfa82bef4e258176ac2779d42909a3182f10d7c04c40c40abe14f7abd52099f0bb56d05e04ddbf750d384d57b548bd731c82da5c3b9e36ca36fe98a628ec9b82f7da19baf2f534eb98b1b3394bf4c2e1e11359558e583b236eeada364873bac8d469607dce863cc5d15ad029b0509577ee293f0fa0d78536cf7f78d6dacf143fa9daaac9d0e7bc307534024dfd0ccabcb4c907670b193e2dbf4ad4e81d94793990d8db383b7db0cc91e93b606e5976a244849045563ba44b658a06b2fbe2703d73fd9c91b271fd5cb76e0c665ff43b3d028fecf8f977fab3d700af818a95d8dfefb4e67ef711ecec9b4aeabff3446309ca658cd7924f5b9d783df9f6d7ca1aa0b2ab4156c95e8147968b42007661f1f4ffaa8e4ed9cd05a1c2873ea49f97a749c01c354d0e9bcd57b6805f97be5b2e5118d2743b757e5e10c80a7f2559f66487a813d54c43e7f1f028ada4631025518d5f52ab8908f0ad9057d4e3eb43f42dac12e41bac1288ad39ee11e26e5b995fe1bc21151b776b8ef4041a1d25437a5cd68b879628ad0becb2a78dba960fd532a8604880ce7d6e6665c37e5c9f0a704819dfe0350d4696785db8587defece48d0fe80e59a000021a72a4a18edcf0ffe961c1767934d038940988ede729244887cf2b587091ef18276670dedb52b402d2e2d615a05a54d66ab9814b570dab277f536686f8930958808ed70b71f3c4560cae97f92f117c787b10197ef13f62c062c08f3c36e80510d9eda24faa70937a343512f7a490c34ab078889989b9149d456584a4cb404f611c803b3454e50d28469b27170dc486c401ad7445d782a0b898e1dee276317b9d83270b1a88796d41570c4c4d4e21aba7a8053137b981a9dd4ee2260cbbe79bad182db7880f9946986aec448499fe7bed7510c2617c8c0acfca26404a476d1eac49bb43907004b50d2de8983e7087b2086e690174c4871bc81603f5cd3328f54c91a6f10509e8dae9351733efb87a5aea356bc5ee40e6d9494eee82563a1271c0db8cdf7e3cee11591cc535adc1735b0c873d8f31dbdae5d1b56d0627fbaa72d36a7d414491130d48b50d8ece11faafe088dd181769757227b927ce6e1259e55d73c8ffd498db6c91ac0530097fba14fc47a8fcbb9df9c9c94273dc6046841ecf6160a784d6466ad84f1e5407c2f503693222161c02139177b2f100773da0155180c7af6d5c415f3f226c346beda313efea0e22252335818a93f8e2dce945c78494380d3e6c08147ebe858bd59fa8e8ea2185f33a2619393fd69a2ad08698ddeb64bcc998a1d9460431bfa1b4abe5e0cabfd7fd69fd0e81726da1bd2ec6ac93219da236e73ecc0987668c53340d69ee6ed4ed8307922ae798235564fd45c322b37b66b0dab0f10cd13a2d14b27c7effea394c6a7fb75bcdd56bfded657bd2777682189c8b19eb5fc5b400db978e8bb1d7bd856f530f4fbd96ce423a67507bb5c0da87627d7af116ea2efd2b5943157e7e354188d837d5279c5fce0b5b7e3687c88c97ec8762dc5803f6f88ad5f827fffbe8fd81452e1b33668f400435517d4975f2426584e29ebf83b2c0417c4cea891c4a9484852ef4d0481f16c9cece39bb4ad35f4f5656d17d2bccff9c16bf78b7eca1292bcc944feede874a28f986c7cc24142841a4630d9ea284b89b2cf9a5aeb40902ea67ef40bffe717d07285c193d79a55193e3e9b9e93472923ef87cbc5e6ba5685df48db4c04a1325b9f6a2b0aa1ee7987883ef733221f955d03ada091c9c5ccb1e4bd5d32f2107fbf7e849da811a6bba741f472b8b601975d82a88d53f2d5e002299662dd9997df8e7bf64f86d299990eb2a0f0bbf8cc84a275d61b7378ab1402e1bcacfc513831896b5129389953ac4de6445acbf07343c9af975829906ec38f838e1c1c8283cbc2992af3635fec6ec13f4b77062342f5772326d93b8d1a5a2e5787796c6ea1c6d51e939d6da27966ae356161c847e0e52000602b2a392f42f051fa43a70e57168435c8091ee25bf3cebd7c0641beac9b5289936454c7fcb41a510b47c79f490f1e1475c99c3ff3d3387f749c7d971e00022f675e9842794d986294b4fc667709a581f8cf1a3b3ead5ef2e1a9b53b37c0a60ab296d9ca695a37d10a08f67278ff12d9e8bd29ccd16249a0952aa1f2d971cb647b472f51b4ebd35af0075083e2e659095a72d3dd86979f10c54abc464286a745f207a3ae58099d5637150a810687fee507eaa6fb4f3303b51d6fa00bbb726863a7a076c0684645b6b37d56b488c19cd2ce0a2d675c3f8cf7ce27e5672d702deffce9b37fc845d678ad132d2000a09502f93eb0381616c193cb3971d8546a45afefd59df2c35045b5cb09b72132c41d5515d86884db653c6c4dd7032f3dbdce042a7403dc577ae7670cd7f5832570d054ac9d29c11397e01deab828f1a554399a407ac089991fb4716698d1df8a8162be68be3d9d72910552a6d01800698a3b3f2689bf456ad80c332633e562e0d80d91fe5ba0c9f386e46697a0a1865f7d90a6f06b4bbb6410776845044da2bb209c01bb9206fa52bdbe63fbc3d52d027f2319d21889db4cb9ea3d69f13e981912a720e5ee06b292ef0a76ea7dc05a7fe8d7d468cf5fdbee3d7efe8920dfa8f093bdf8fd6fb8ac818ed770e055f305c3d622d7e78eb9df148a9a75f4713204e175ee5e85b0d2f837f986ab6d8009d2c640ed4f70ec4019ef04cdc1ca5b5e26bafa5e937f5daede55956f8b7875dad896b2775bc01849c14e4501ccbbe99eb953fccf2f7c1570b5ba4e66db2321f4792552827dc4f48d9c662986d4a7d380b735ddf31120f65f428c19d60665f546e1c645c8545e34f7d82e6e24d1ccf81d05b4be59271eabdd521500ce4f7c01d87c2a8546d1b9c483bb0736e3e88749fa0e82087b8b96bf5c60e9b83180bd56faa9b3a1a6a09a5bfafa6eda3705f79cb7e21fc9936c34d0be4f4d8f0abddace68588015c647042be077d267fdbd4a7a54dddbc13659b78e49612c9eb98021dacff11841ad1f2edfc78408abe255fd541167001cbd55512f728a0b690c75b3d13f38c55301cc025969eb9c7b9eff8f3c82e2fddea5bb47d938ef69f97e2758901a571657bb2e53f2051760ae5076e7c80708a1315d71f2d5b6cc3c76aa61a76dbd402a84bc5475f95c2fa9d8731bc1c42b3fbe01ce1993fbb0465b191a0530a61a7d7dab88117befb8d96f4f17dffe223aa203f0b5215a02bb364aaabce9e611fae58cafba3b7ca85e9906a1f136ea6a9402f7424f1bed7817cc00da55aa94a83f064e8598a5c0351a124bf65d1824d99a0176182962e85d39f2c435dc1b17322c55ee42335c8d1b904918b3222b876f078cbea49718e8e6049e8d5279fb76057c3ea3d2ff8188c8d717e734a8a51abde58be0f21760e8b9670cbeae508477a785d7e42b7b239d1ad82c62249fadedf91b3255a686fcb62f71a3ab6333f63e0f8d60972763cd46c058e6d30fd0896139b549c9d8f02895fdb9883a02578c1e71ae8f19546e07163703729b9b6a44406e91b58d6bf56b1af5ee4c870080e2fa924346a97309485c03f543f186dcc9f7b2f9e198dbc360fc281a1aac4c8fe7a9c8998d7d1149a944a3fa56ddf8142925be1690652f10d3c4f927e9988caadb9e30e2ccc4aec796c17cc905fb425b17301440f41ba537ac9ee0e81e80968485fed4f6d8509bb629cb90f8ecdc923eb8447c45e0264662ba1a431624bf25fb538114dffb5e21b6c7e047428cc6daa701eb9113b84fc9922b2d0e7ed619024090229fe9626dbbda6c74b9e7a9f961dc49a860af9b99ae754fba28976c09b3de3faf5c6e4836b7683c534a2fd8ab200ab007a2927405e3c7b1c1aad259941bb57a527193b554e553ddb41db6c7ce143d4d129666e90aaa0bb34f12b872daea53a343887ee75d630806ab4a372018920d62d147b74daf9d2e09945fd8c3c0e648f5ef6202398572fd8738b2e9fb8523aa44b5f1e0ad5849675c03c01dea93215825448609ff94d8771b72e6cda6499e0d4ca214e158983b140bf817054f841f371565f36e8a77e65567ed9835a36f43bf6f3a32286c03b3dcdc0297209c1c58a528b80240cfecbad41b1c08008e129a056bf98a6c0197c9d9f0c5ad2e15b8c766702c0d111f75def6538593f1831cf610fb597435307f3d599f75a2663d8fbacc3a77adf35808bb74708bf92a136f9337cd4a6af8d5c10af0dc51f0b784c198761b19ae8a25008e4f6fd20923d0b4ce23a684f671bf53be29127e1a2aee72f97bbecac1c796491694cb409ddb029103e9932ead202f68cc2c60dc00e3c7bdc0031f6ab04a9e325c09e52494911d61b87416af77d273214f7d4ec057edcfb510993761ce61c5797e595a75d268c13ea8cfcdb62d8fa4254551d5c8bf543abcf398b205bc76d2466f7aab1ae661398b0fb74378812b6ddb023a643a43b030b14996f4a45624f69e8fe60fef49fb8782c71d4b4254142ba0c83aa2cf6273de0e7853af8460219dec32c6ed83e051fd50cb70f257f7d97e7eb73f4fce03be64701d2aafe85c0825f2f39da6ed61f3999ff7d05afac7e85ded35ed89566179f697bd1d896d6bffb69f36093e3165e866d16161f869af2dd4846f00eecc837869e8b9756a735e07b2c403ed32457aeb086896c41d83c0be825ff354db51dcf78a0c087fff08caf7f3afeba1a08def212e276ae1f84b694d45ae6f5d3cb096d632c844cef7c69ee599cbfc48f40fdc5f006ddf3d9a5e09f36bf30166bf69547b7b15e944384d547988baa92bbbad5d557a622b9ecb92a8f536a7707e6612bc5880e8e02655fe79e9b05a83d3e69b54db7ef6739c5f640560b60cf3eae605485284e81296111362d4f37af05a0ac44fb2bf3702244d4273dd30c97bdbea25b48251922f80725e93a188fc8fb6febd763ee11e9b1c089df1ed7cfe73d4dfd3f491d7e0e760dd214996aef592c08f33539ee73a1055b6eb817a6f8fa7977a8c9675365cbeb045fe0a15647003ccb83b4c0128adbbbfa659636374e63cdcfa178904f38c9468021496e2fdc12a2ddfdd18859497f1a81fce136fd10d087f7f84d63e9088c55e7e1579a811ebae24632f0975deed8653a07ab3128221554dc9dc965270cb3124c12bce30608137a9bb33c9189ae5e320b42f4b765bc5f00e8986066870cca10eef3dcf65ebffd7a07521b014966199e49964c1de360b3ab096c02bc8f2df94c2075c12e4ec8fd4b39d3ec3aaae45116ece6b8cd5af9409c16cd82407d2c5078314b843e2c11714a683e5a1a53396eb2662c6ac1d159a069b9fce012101e85cdcb07510ba2f57d5e799f1cfd0c7b843b23425f31593f512d633d017066b8102b129ca9f60ac81ded0c75b288adaa4e23be524e2ca592234ddc51a90f66a5ec605f980baab68f862b7ac83427fc33f262301d0644712818bb876fe38692539c9d347cdc802aaac7b8c3fb0d6b8d2a5657887261b68f04cb4d5649429077596a53847ed54672aa20ec12826e66e67393443f9a81251e53064117f26c384244c8563262daa2e3fc28270a58e99f9871aa9afd220519939620479a2b778ec0c4754385d3cbaa36a602d9dce8e895daf3cdcbe50075384bd12ace3cb654f5d438c0d84228e066f05eae586fdef1316d7dad1b24845080655e471744f1d0a4b2aa0652b0255501881878e395fd81e4b05f651e0298f8915a9262b04faf83d9f2a738ac61f61d25baccc06bb830cf8b57357f7626afddd4fc2a44606c79f94f962f88a29426ac80142b4b45eba3f1514780eb42f085a934fbd5edb02659801026ad59d1bca722c400e03d476f37ed9d32a52362fc11073cdba82f78ebbbdf65d2ec7d5c2fe5299c5c0b601aeb49a4ff197c3c3e6cbe6295f03d1afa1a631d5af2c7c97447dbb9dbd67fc6732693e7f5d1bb57715329c3c7f6bb5c37ce5fec9df93ec15b02e3d95c4f56eec0bae2482660384747b8c5869b3394b72a93eb05e7f5323852881d8d1dbf18f5c81fe10a667d665fc6d763077dcfae6406f4846668d23668118c86cbad29b1f38d069e908edf79025ce813c65f91a184c6ec501bc55e5fe3dc96ab10185c8b168844272e074c76e697c8810da2e80b28f1baa27dc2b70f09701cfb4d952ab01b8ada5b8a4265866326e07b039d91f92a8b7eff2b632438fcbdb48800afdc12d1d54ab8fb1013f57a846f6c2055764715c85608d46273280d38e150c2c88e3067ea38f4c2be8fbe032e78e809939ee65b3e0096492229d912d876d8d28da4a5acd0ae8246ce4a33714f2babd8587d67f29a70bcc452dc354c8f00d6a3fcebdcbaa2e952d1f21921e9e7856eb96a00c7ca949151ba7554fd91d10958e6bea9f59d6fe441b9eada03c2e9a90035d8f58cd6d0b58934d06f4ca0caac5ec11c89923b53b63f3a46c88a25cf409bac22cbed4e33f177768258a74d5d3278120c9a20d2be59dd7b4e0327addabcbf0638d22dc606bc8901f9e5070a59b7acc035b2b0665afcbb94b8f0c13066fd80870d1d47ac3bee382fece9653285859ae99aae5012ab95e985fa2bb3b0091dce70d41376d2f80efff10e06ab289da23d5d3fa700af4f035167ba7e93c25246305adfd21fb4421c446953bbb64d209728bc244358eb61ffa19f8c6fcd5458235379cdff92e842b9fdded7ab174e5a41332611acae1a606d9ccceadfc0de0d30954e103d2bcc8bb94e91a3625607b8fca91ba406aab65f1f684ff4db48dbb6aab06fc442d14c48e5a0e01e31291a8f194520a57f11906dd2b9a9e8eee922a6288829754fec1ae33b7edcbb300d3103878f0f2a56fe78425cf5bc836739edf56a22278a2c41aa9b54ae71a5ac92362c10dd81004b4aabbb47cf534114d3dbb438d3821647d9d64096e8cb0a66370bce75b46f02788d7ae4ae71e39f122acb9ba9d7a3176b75f72b747245b21766dcd8eb75bc2bf8a3d715fb96b1691ea5be6e1afad149b15bdc18b7f4139e970a1b209006d075361d49d5fc6accd49168b13aed1d99b738ec6696b238a793fd30df9a73951377f5b3d80e9585998027d98cd18a97b4bf995d4bac02ccd861568392c83e2e01c51c183f360afda4e5f7677306ffa7adc78e5009879267966f10b4b358ddc3e60582de2008c88f9d2091a77092a5ab0ad65341a05a72693adf583510d592d861793817e5b1853e79486f8659bef5c0a55f664f14d8c09d6ce3708eaeb77c12bb37a243334cd4b41a99c3befbcfd122d894dc2893a487745bd2f76c157148e78dd233b2ebfd34cf1afa02bbd4f8989c295e6ab6cadb3f93cded4909e64565af735ba867b6fa68241ea39d53402ac0984d5ca711f4bc318eb9292210b53c0fdb91730859cdac99dc6d622b3573f479e9fad4d2e19af76ef0354ae9ca60ddb53cfc089d0e84a85c1496d64bdc524c44a5a3a5a4aaa7e2dcd5c37fda6b39065d8347a82f9d0cad4926d61e5c1af9ad8377b3505b3fad787e5737c96fdbb743c1885151fcd471bc69481ac8e2e349e58484e420f6a3febc4828b0e182f6b6dfe173e0ed3fc824a98736222b94d0fd57622bf2f9dde4dcf8bfbb8a3d07e859db6ab2a6299f0aa79650cf2d5a5bcc0a043543fff1673170e5042ee589ba1c218d682117335252cf11472d7d6f93d79e937aac26e0ce041fe5c69c9e67eede82132935afc50bc8269686b12cb7400f6535bfe19a4c580ab2f9c966473bc568f66e0299f509b71b3e6f54319cc3e834749106d136d3e2cb8d61179b7515114d9433ce5525287ee013b62a4fbb953bde47b59dfcc533a789318a1f8ef968b32f17160d19a3ec24ae9a38cd3671f5511f3caedc7c4adf37974ce54965c03d86023380f1176810396493422f0ce35e42cbf564e6b898435a1aa90e3991bb2ce962a8470b7c092f92ccda030c931a1c5f09f8ef336e519ba60ca9a569086386b3be1e3e9367d719e8ea4a7fddf5e9f4072ac59e1c257ea163b5c93ca2f60ff94b6f52226cf97db2d4ec09d1fcf971d3d8326f4d68e27b3026b14fe711dd34283b1e180a69e9172fe6bbd376676bc0a1c25364f68d5395df626fc39314942655790ed5ce303997ac63c0de818a5e69dbfdefeffe34cf8eb9c991bc9a665ed541ff3cab8fba4773248ab1915e2a61a1090244771a7f0b0bf507e8fe6782e430e19b1b82cbae32206bbc5599423025788f3f6bb502c7db58423086b2a3cd2219f9704e4275c763b5a7022bd4264c9c6144606b442d149b7d0bbed864763269d345b34083695d8221a1a48f0ac02d9f9b41f4c39e367fe2f72afd7d6fbe1fc00beef67a2ec33218ed840c98727e4a6bded214474331e8965a0dae7ac7efc3a9a5a09bd7617a6ed8d1857a3d41404bb8b83157e0d691b22bf35d91bb98d098edea5bc6eb41a83e22b7695146cebf03e947bdf7ea8fc3173f8f998b08f1c59d9ae0ac5073680ffc4aca2bdbf77fb32e4b5a96a2b455b60b800b671b05a8d8b23be07fbcb02769d87a9fefbe7367f53771922d0c40d6bf640045f74b8107ed4f72a26a3fd1c53a90d43fe7aae61a82289f805e45d4076020e3157e7d2c2fe517bd4207769d49daf148cb1f3efb18567acaacf9a72fc78f522c90b325f270495687a15c480845fd8d9f62d115491f9370dd7d28f12a07fca6096d4d7e5dd38afcee89b07d169c23148be365f28a3b49177c4586996446c09241f2b1e0e486d5098f6b6faa4a5587b6f964407877cb86dbdbaeecdf5f0860aad5bfeef926ff58e9b59c297b756a6c2f0ca675d165a92a81758fba6f36c1e2b50c6fa43bc186adee26905324e6a6c7cefdaf06ad73a48e056c416c44442a1a948028028422ed508a7565c4547d1286c86a3feee3878c4b6dc650a38dca183813a04d96497dddc395f8c3a1dd90ef86f44d05fd652ae218776b174568342075af47cdf5b64128d73bf80fe7b6131f2534273666c38823aefa507cc8bc075a6de9b235fc9e90ae82111372489ae0d50c59146196cc8bcb5610984c78bc44cb7b81c49bcfd95635517a778a4610784e2ec368bf6902ea764ba63891c62afaee031114dbfc3d92c86c3faf2b06cc846cf62d00a58d74c16f1182a335377e11aec1f8747c1116c5239bd7d5687f541625aef37c338ada28bb746da8d5ec56163eb70d065d823e87e42fc862d352f69b823f296e8ec516f3875f24b3b9576f2f1a2b3d93df91d8f6684346b6795e5835acc04c5908e289a1c4ab4d99dc8413eeb64c38462a4270b3338fc85fe7db4959b6498b9fc96559a0a9ef45bd88d51c4c7851ab0819967e1529b2418bd697852e67a6ae0e4039b8a65e10cbbbab3503717b9a9b0c1ddb9be412dd7a38c0ca53c8526932cfd6e635ee91b04963d82770836f979c495aea0865d0332ecd31be308afe01b29b18a3574dae838ba10cc6ace65e76dbc55621eee0a053df42870af3c6ef1b16651dc4fe5f68330f69327b10a795c7c87acc91d50775e018ed57087656b0bfc0f1d5c8a5f6b09e60f06e2caeaf288b056248ead8c25f135725b77a417f7f165599abc2d1fd551c467c43590a03044f4c8ade74ac05a6dafb36433323d729d408f953fc5834b985871e4d8af29597f9e36eb0dd190d293324c9fc39a0919c37360772a17485a3c06a55a83957f5593c9c663423babd3f230d2edb2b5d60f7f93b2eb55bba307ef8b061060ea4947f375bc3b8fc31ca772a61c58c6323383ea249460ed4e3c27a7382ad77e89192c91c76dea5c69bc3f2d840bd4412c133a1d3b05","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
