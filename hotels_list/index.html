<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"33a1b87cec18b286914a4c2563ff7a5c7cfdca08582a982542b98c34af788557383d6229c2e33767cf95237bfbd6ec02920c3d2bd679eb9c7352dbfef6871aba4f4033fb129e7e19140e2b37116f4771a0137a42eb4e1ea74f7b0610c28db13f08851c48d888fcd4a079bf6835a66fa01da2a9eaa0dd66993acdb68ebe5d626229e6ebe015a1a5abef5fee2f6cde170670a8328fcca33b19b47879f055872cde0fb7b51f34e6c8bce3956714042debd0d16c53be9496ab9874357a61905ad7277af152d28ffb10e5ef7afedfd3394912ed608967efad1d361d33a9ede3dcdec642544e04a752cb06a3eaf27084c68e7a67654401b196647f9c4c8f4b49f8d0e4a261524e3a50a8be0c8bae58191d3884aa65d1ca285365225fc195c38c9c5039425dc06207ddc76c9ac7c07b417fbaf6e4d874e4966b70daf4844eadf713653553c8427b6f64d9d55e06216d710bea5c2c31027c352b6ea7cabffd2d69c62368e66e0a6b66120ea67676f55dff668ee983b657e4986c8cf16d945b6266d18d668aa2c92cd0052ff3aeecf5912a1bdbddaa9cbdde081e0795542943e827e172bf029f89f0a00d00f99f0ab9fac3500f2582c59b32e58c6d2837b8bbf6b99052f0d8b4faf94f9af54e4800c14e805f6c4600989cf98ef5227f9cb90fdfa6d5a13c68e71a60313c792b163d4eee78e30b8de9d5ca2876b1d2d5e47b20b834fba5dc78627ceec2604007764a0010a10aeab8c48248c4ecb351426ebbc928dc53e996b6ad49a6d5cfe71e2339f0732caddb9f2ed503fe2c408423903a9172730d5f89813bcfc63af6bd82eeae600821502c5e4afb2d35b1144e9cfa517c8c0c170cea7eb3ab8cb387e08fc6570067c706005ec610d1627406a900c8f955b6b836e11e8bd38dce9374a46f4539c5014d0be6120903ae59e8a967b3633b35f2b80a11b2895ba36a98019a41087e9bac415b2eed6890d4d93d86ff008d45d98f25074ce26533fbe8c69fd50ae78728fc97c395ea4ebf3647ecf89d58d5758aa56183c00c901b34230db24575d58daf78e386f199c7a8fc123e14cd0483700d1a480f2921c11c644a8ff268006f66222a8f3483210e94021eedb95c9921b2d66263ae6a018dc80e833fe6110fb234012fc739c17f29acc4cd0e74785bafcc2116fd8d0fd09e22e4d778e3bf627b4c3e4b3738dce7c7db8ceb4fbbc7d0f528b7a43ab35ac19f997634a1b6a7fc88fd20d89950a8a8d7472466c5d0c9f1302a9466f7d240941e1977771815ab265643d0afeb50634490057b7f299bbc6ff3d1ee60789b63c9fa61975f97bfabb30315c8a1d1623d180b18704a871b194bda54fc2864847959727afa82a651b00eeb488bc2980c9188e7a01126d33631eba6c59626387bae154412c09dabfa8ad90450e8f2a673aebe7278d76586e20e451da54e5c60d66eef7cd206cca214f7ac64854e3628065e88bde11246e0c6b676ffe3bad24fdd8f8b07b5292e4baa0c29e86a830cc36aeaef6bb86a4c5d0b031b251b50fa4eb8450dd359176b2685bebc48cf38e902854c2d6912641c480c6eadf6372fc57572c3b02652043a8b03bea03efde9e7af8d82dc750f0cd58f67f098e789216919a6ddc7c50f2240a52327bd131924c69261e9f5c782c43e4b905e44f29a2fa6b400fba6df2c0aacdf688131a8139f0e86866043586edcdefc7295422c72fb7fa9ea0f2cc309a477ef450a5ef6135be15e665ee0b4097cefaf5e69a34a19327fb40836bb0aa3c7afee3fb86110b306c018575320e2a4c522a72cfc94013c482d3c151106cd9637bfd1833f8e36caa6d869e4bb19cce5770379236f9f06a0176d33cc440bac12c8725614e620004684dd5b401ccc9f88f9bfd97614860530dace05860b2a280ceb33002d4f3107eeef29416c7f22d8fdafe15f0b2fd595a639e84eddf3cc4349042153ab394d550f970076aaa83c90f96b78710879e0dcb402d6f27368b6d6230fc8e55abff9de03d575900eb08519ab3d41548c2aba07cd9d24f9c60311a9b2ea0b0332243cb88d96a2c9614b30bc001e50369396d27d8859ea8d5dd0a6df9237ca5154658237e329fe49d13f7c316a59dc163a0c1291371b04b4bda4a802e5a7678bf8699bde78a8bedc281d6887e68d14d3b987f113ec9e5f4be7e0c4924d0b8816619673463499ee228a2ef40253834b0d8a30b70a1c687aad9b4936cd96860c2ff64be03d1330c9f4aa6f55f7d8880cad9b319e452d882332e21be7fc33854fae6e0fd177ace9c9e1daef88af5208633154a6bc6c908ecb4a1fd9df3e0951684af46e4ab951a80e7c406de3900d72dd7084cba6f5f908955d777b7d28357534ec2c5b304f318ca8c6af8b1d9e1c1f4d0223716dbc4817da8673a2c97c376031d32edbca30f7fc054ed36bf048d4e6d70a258b366d929247a363bc20f0a4df8f14de853cd2f61e914bfd725d0b28423cff6581386c1e887c23dabad23026d7c93656354deabdaa31c8a83c07153e56d1e907eeb4c189dd88a136987b5a67a7baf02a8200556fe5c1e4d85b454aa0b2f83140a1305bfe08cc518ad0a4a0d0442591bcdcb286ffd22b04980747065dd027dbb9e7a22185d92aed55e1ea775cb78052ae5ce47f61b2c56ccd350bb3f2a4f7b9250cddfef112cab39ec1a571a2beea15f82b695888961e908a211d01b762d55682dbc6e1aa04c9644c6f0065c0175efc98b85e8d9a2b6a5d5bdd93de74142722f584221667e1d6435062183e7ffa1c7de46bc73c9f49c34cc0409418b686bc442ebf71208da8181f1b092d8bd5059745ee98a6084d501b8b69ce60a87095229042e320c2573dedb0bceee614559d8e60acdf5afd297c87bc19a18ab315d46cc60a886ad7c0206a8255e1bd5b9de09b579add4edde4f422630475ce31b1e2b4ed59698d2363d4c6c4bf04e7ce0dd6efac6e285990a16b218762ca61285d444c1a88f8daeb4f89c1bdd8d67d3823664302f320a6bfb185875b9154082f1a6ca1881399d892883ae3bebaa0c1eaea45ca3924756591e18be1e2d6db7bffa315cb5f06f48b62fdff5fdd16b4cd68ba120a34b3f43c35d0823cc84570d7832e6134d7c93f9ffb59205432995208807661211173736f838e5f67444cddb9daaf618037264599bd1713253a593de88314a2e480afc5b9607edcd1e9520ab9894e38b56b7fe9d740f92ed1eba776c96508acc96c9d59cf3d110c5dbc936573db0bef891556e6daa64af51b471e2ef956d1eb4a0ede925006d7cecbd6258a2b53534a244fb1c78e40f0315842f3258477b9e8f01617155d58315990f701c75c793050f810ddfc385263a79629b3899b8ca8ac76be31961b2c8b3a0d6018d594fb0988aecef7dfffe62b7ae3c3a87d8c311773bfe812dfce5cb6f2109126d3978a64dfbb75ec4d841de2519f6a37d54f277a2e54ac92125ed7eca50f04c100c7750bf47c47e2232184fd06f25a963aae3ea23e493ddcafc85a5781bde0185d740bac3e622f413e03e1940ed7fd744401ce3be846f997286423a10cec053b81b482f5db0f602c0e6b5ca77cdbcbd3ea9c49c24b459751dd6c3f5ef1e1051352b208c54b10d3e1ecc977bda5b303952788b8d5bff04066a987eace86355e8032bd517b16b734c8ecfd58171ebd28a4a14ff0354a05eb0b1ae7fb1eb1ef7318fe29d804fe55a83127f400e057a94aa33860f7210d8307b6b212840531777904b809170c6c0d3a94bac627ea15ce45e0c6ec0f51f36e06107bd1bf6ce3b9cc17395029ce567eea6803d528bdc3700fccdf5372cc30af2e91cb0ca26b94a2bb81dfbf457e59c207ec9a02fba358183dd17b69c135723a3542c09bcaeb7d049639418a016d3a002212181b21f4ea483f2d3ecc993cfa910f3b322d9eee60a4ea4ed62161b14be430a3ec1b67742b68db95a4a5d427c65f37379e9a9d2dab77de8c4e32087cb48b6c4f3308e738e9e3f35f0c7525f25cc51f3653f226462a4718af692f3d74a100340e3e07246b0be2fba59105f0e6447b7c678caf31d45a64b93f153fe72805683d4ddebfa103096865f9a5c479f1792cdc6ba059b20fdd23cbc7e0f9486387d934c17992526455cc48373d28343382ce341678695f2fe62c0e5454327ee8c24b676085def513d7b568d9a397b3dfc0f5ece9c6551d6b9ee9185a9cbcd14ef102d940ece40862eac74295af5af76e0ff9ec180ed6cbf221b3d9eebe12c65313b4e79832e44ce384580f096b986a2ac24222084a7017d7e2fc6594c2aa6b28ba08bfb7547faf345553f52aa2c72fe08ad91424563ea8768f89fc0a2df2dbd8093f2f4453a980d8653a332bf5244c10fc2c4aaefa779b4d2a7fe16aa8744a2654080ca7e253d76c215642bd11c2fab710b939e70575c8cb643ff28ba1237d1cc82391c3ecbff2259a5ab3aec99268b021892b9efb6bf6a19d63ec1be6d0df02d074e1912fda0f28381a88c354068499ade219e6024be2568a314b361908de48de9bbd926372d4bdb4504c10c7a00ecb3cb09ec1777858074ac318042fb7abfdc36f34e5afe9cd5258e42827ffbf41d13f9e5e1e2d39ec99420731929632d676b5d77330f04d7ea06eaeb2a9f537487d5628e767bf90b23d6fdf770bc4a0ecf06bb7544984cd98aa1229c39de5f61fb4b66928a00a8f4603b2c3a773d2dd26be4d750d688152efb3fd1885768b72bd71c7b9bed66e4d0adfe3830060e23a5b5327bec3fae370b114fd0fa83e6ed20fbc3d1091150428bd1bcf3789b7794e430cc0a5ea744a5a73079c78216fd45ea1bc5e7fb347067959e4ee0160038e34bc44ef2dec9cbc543d2a1e4af463cc3e1426e446d24f4e09ae15ba050828b5843936bd6274aa7306489ddf3b8e9ed8abbb693dd287e2db4685026ad829fcf32aef4730cd705b99b94afaec651eb9e931961852296262d9ac51b1a58b05c65602c77bb73194a24e7b34b83675ff9f47fdfcf3f4639687d0dee334a1549f9ab97179e8980db897de95e1ca9d512df60b59233b845ac61f2fd4f784523d6c627514f8c7908d85f96faa20c57ddbe2df51c87b0880c6ed03ef4117910875a022743175e65f80bb106837464bc9cf732649c49058168ebd18b87ea6fd61e0581f6dc201ccef4887bfd58bb9bdbfc39d7a06c4c5a17aa7f2842e9cfd40fb6ffa5835493c8f8b3067d9b674030e2ba4d478db2bbd7ef197249943ce60f19b09b4377fe4227082968a2c425021a569ae7570789208afa01e31025fbf2150bea20c1cad9e145fb2508d0579f5a69a203c4b3d9f86bf3349ee030b5f0d4c446c5ebeaea85796c6162173f8982ec14fcfb6f33759f93063996b40e83d27bfc81afefd08806c425c48c3dc02792a8e2f6e46d0727aace5effe3776d0f7e026dd7e45666815c573c90003a470174af019c9a55fc4d4c20a5b15c72699e301e37615e7a9bcef92c4da4c5caeb913fa9a232a506efbe77d1e21afd96725e6d911fa339b85bd0262c9d5dde2703f6bfd5618ba28a41cf737fd97ff27fa64e70c0e638fb4b2f9383b79d2e33d640d1f5b57f9a57acaaa1d62cce33eb7987c3e6b9a5b8459ceda85c50ce34b4679a17e779eab21bff5da662e74576ab8116b2cf8166c726905aaee1ce75c825dd47b2abaeb7b1e487b402f02ebfa1676767384487f547189fd3650964c79456d46bc7b63f40a5e17b301a808c4d774a099594a216ff52f235744c0b529a282e4d7320c4c48e445df593efad63c1dd88606e580416f114eca7e87d9c5b4d21844c826769f0b1c2c8d4215b4705907b16c09459b5df44be0676ae8e07093e9d2a17e3dab7da8fdb744b15863cbbe8125701200e5af378b2b680c388b49e0bdcf9fdfe9dc0827b788a335ffa5ff9ee41f51789ad2453a0fe56eb5ae71d7e618030ed7f7a3db3cc44d411e71a5714f7f54397eee6b6d0596e36d900692508f5b440efd7d8518ae11cd14aa44914695a4d14c3ba6b6fea23cf8b03916c58534436d5f4cad19416d9187bce28733a2d47e6aabe0542a6d8edddc9346983244202059de516b0d3f42beb6bf2475dbf6be1367adc30276a2234f879213f5a243af2a4fabdecfa09062a827f812f363124cdf4ff16a8844cc4dfdee0b70255cbe468b91af5bdf1bbc9899724d7cbd3aa4445aff2ef82c2ae8cc2c60ab5663f8779cea6b4e0318ea423573aa20ff6d5d45e8211aba3465b12165c7f17452687f17ce6647a44ed9cb5ae7bc788b23417d1576fdace9b7fdbdc973f1dd218171f1bf3159cc50965104e436948b4782e249e6d992f1149f98304c2efaa529efe9f46fc8b66e33ed850ddec78cca9df4e3d3e7f6f23a22f870e6bf7133dd45b9bfdb54880c3c93950c5f3927cfc3b601139b55582add6e9c57c03b74f9bb30b9f5af6a3803b1c0d9ba573b50172957531ad4f383fa95597843663e5096be506e914f956ce5c01a044d8bd93b0d53eb2231a172db4cf7dc35fd4d2501e91702a300cf8849da86ba09b02a03891f10d2dcc56120663b61b3157959d4a6b281573e4b5b72aa908781aec2b36f3353c95bfaa1c4ffdb3c7a1d1f4880cbc4890140cd04f5409053e59ea2782521b1c44518ab62da3e53fd3f6a7ecdfcdf49e60938a1437ea98702881caff18f18f6152b4bae1d950d5d216262dc9eb4a442eba17dcf6b592289ca4f7d8679b1e2e580cb98f83ed2a465225d74a7279ea6218ddd96d2e3c493fc9c1968d9cebdcf918aca22de306b19c0afd1f7e4e89f6077802f9d5a2a0e1998d5ef5d705648d0c9158e894cc0d24b070b62d3c31dcb830bf03a83a4b3a462be5c6f01e789e5b4b70b2618df91f5215f69763ef3ddf74c1f18639f61443ff5eefc712d0ad381919dc3e06b08f25b14ca66444107d215d8b2e83d94db42407745118b1be428e256abd1b5ba92547ad871a84e5492f87a0423c7d82170ff8148709d9f324be71030f12dbf11f27f18ed92c1e9190a134289be0c653c06c1b004202d7c6fbd443d57027a2a1e8f0117af9b56e1ec9cc22d6032ee5b8cd487d2fdf0999e8753c3cf108c5be0944a7fa69bc2858113fc5b9a17cd0739cc811f3565b36eee92cf388ebb1709a5ec90bbb3466055cad4a9e43489abfe4f45db9ad8a245bc1e812109306c0e5aaa8096d4d1f2658f770948cf81ac03e5da82761b2a27d6feeaba047d28c18b880539655965a201228b9e5b8f0c6a6881a44c0d59fdf9e38d8a62f5ff44dd8f407d4497551e19f701ab2c0a601ceec45ac027fa38e69709af997f31872966ce7142886510cca5e791f48f17a4560f7797367c4b8035d56d9cba8ae8956a2632e1717f90db35b715f687314ce7f3b804a4c21c793888c0e862d525a04521631a49ffa5f838de7b912450edae3667ba29f34ec929824b322a3169dc64175ea64dd8ea9bc30e4186002f7f8c39180ef045aaac635a582f4ab46e91a7f6e04368e22e19574deac9d0f770e8b2c12297b7611cc2694b2bb062e2e582bf39903ca129a9c75138a7c56c1d3cee964b298ac47c3611685d74625ff74456a57754c0ea68f6d2d127409fb150893797b916b373d80f8776b5a81a17ada9f47ab5204389673dca494ffa392223fbc62c73d908dee68b14c5e48a140e8347418f8913d17aa5905dd7854bf7f86e0f97f6f6ba292f395bbf415125032ea2460b2f2cafbbcd5fb38d9aa2890432e3744f6bc25b5da9b7614a6f3d7d6fdd41f0739d3d5b023e56e65c940165ee7b06d597da7cde4ab644e93e3e2befdecd69bdb95ea737a41e44b7e41e2954e2d06478f863d9faf999c4ca653b2fc1f99a4baa36864ce9f60e4c935dfcb4957a7b335de1b1bdd915cb5e06eeda9b7c385f99b39b1a027ef442720d6b3dda4b382c62acb7feab83148eb98fa9109278251eb943aeb5c9add5bf120e060bb7319589d56c58340c543a9f1eb9ce88a6448a9c2ea972d7428f29315413ef5e6aa9fcea9c0ceda2bd64028effb1da813bdaa6b2dba88c7062d31c40fcccb8489d989676036f445dc99d3a4d073d2b52c215d620cd24d899c26b2793e52d4b1c7ecc890eca215b38e3c66ec8ccdee6a74a6618bc49be35e984162e9cac97f285f8761914ce7199b5f74561b4e4642a2a36dcc08862d6b6e54a7934575456bc4554314326d17c8f711b6a16fe970a4597ba6307b3d9448ae5503436535a1837dd3004b68f9e1b6d6dadd50fe8c4f532acd045271026d0e253e372370e750a5f7ad667869f8993275b6299d427e8c29794052f3595c26be46fd37f5f41e9287071d2eb5939724419c20eba037a7424904b1b880d2d96a6facb7e472d9fbeb57568d48391348c7c49419b36d541a2596e6bf13a869881e0ddf32de070f2e1bde6733ea61a00261f071d6f4d66a0e0387959dcbe0a6e1e8537c871b1f4b43dfbf9e9d2386e273eac2c0c4aa332bd104f204833cf824a0c8c2a8e602184df1620542966a988ae3d45d76260c83c4d352aeab2dca382d6ea10a9b6411a077b2568e3b59697c4ee5e0159e088edbe194a224cd88e5da73706b640fa07f8cc3ead71a4cc8c08e7e359ddc1f1e1f225ff9ee4a8d7f72f87f4b7fed7df2cafbaf77d0d8fd9e730a1109e4ec6a07419f9a950c534847f9b5d3f77a00007696bc6f47493909e5e039461c1c09290ef822878a994236d68e6e369dcd7f7262c1e8a7aeaaa9ec49de95eb9ad7a492ee3b5fb25b84da48c570774dccd21da3443f04d659f002d201ccc4f1abe5d067853d67a13a9b92303307121fcf166b329434df1a4844a506449b2b82300d110500688b7d383b5d891e01a5f8008f34aec0873a098c1d69a795941d287e4aaf8d59d5b75b5aec51424cad24207b58755e21494c07463f308a6d9810266071d0cae96163245a9815154f16e67f0d395cefb074d18ee427ae293cb97ad2455aa1b71df2b4195b95bad0c6e4b9c9d3649ee439e249788f12ccfeba5110a56a3313db3dd5a82644b6565a42689e5b9022cc79bee399fd198346bf7605194db39c3b032f96ccdef6e230e21f447b611deae2eb6dbf370ae78abb75b2800cfcbb7082175068bf4b8b2142bc87f76c0218a4a50a67b9351b81b172228d43cc716fb1b0a27bf4f58fad6fd159adc4bf9a1d5f6b035dbc02db1a2cc8a9b2d58da9c8507e57e649e43d64a81503c2621852db30fc229eab28c4dccb375c16bd4cc065f916c4473eaec14be1d704ceea9ef80c48f6aa04d0c909e845281fbdc1cdd988ac879f062fc36da50351ab515f1d704071a52c278f0a0719a70da385810a3e2b6eac2b4d3921ea66112515a172536fc7974389e086c679fbec6bda98b234eabb2b4aedb4f9d861586da4079b59526436e7bbe89c04623924362c4b944e05b42dd10c9980ae652e817c800f09df54dfa811e46434ce5949cf9ce28badd2dd40bcf40a3f720b4498edde684e4d812aece189553275bde4600799436c099305166bd5edbdd20c06227bd4af5680984d1be000d9e94c2860c14cfe950072547664993bfc80766cefae396b753ce474a916bc3269a53c8ccaa0eec8012ca703954b5c61026d4692bb3e4730067d7793fba04976f31c36b17e476fc4434c3523bc7b0aef9276f087f31609f9a04a68c85dd32ee404d076ac38f432d4b1bf53dc9481c439602f7184c62d1028fd6d53dff46187618752991b84b6c7225a04cf40377e68ce1bf9b2b45ea6032dd1e08e7dbc469cb2024491daff88fad656107b5ab03100b3fd2385e4f96afb92d3704c9509692a9de4f36bfe47a760e384b1718f3ba4ceea67c586fbd23d27e7945c5e7db1ea2cdc2c5de36e4a374fe4a112c3d87b2167b29e2fc1ed9d2f7b4e4a95a323546455d2dcc3ef859afaf5b0a8b85b214f28d51d5cac2fffbcb16071a1725abd49d3db260e8f776e18da23ca8b42a27f5220663890c1ea3e0f12759afd94eb112101c02f5a34a4b0b67c2025d2fea479a7f0b478de29289e801dcbcb404c6aefc67309defd1d97532d0ffc3e0b5f8ff61cfe1c0a2cded443209b3b8325259ed2b812085736c13a42e48fe2a9192952b21bf4063e33fcec42b47a7b29c3cac6f2a0afa9944dad46af72bc6fced4d931090c8b8b9105a1c3dde12fb96c115a0f05dbe8641954659d21a6eeaebc99d6a33b30c97691412442bbe61b4022bee707b22e239299f4a9ef755593480b848b318e0763a4864a7c6dc0bd4d340918d19e4e3d04c3572aa70f485ebeb31f55d5d5dfd2493515d571ce2f71270ee6152367123cff4acbc29c05a14fa4efdb176791e9d60a933fcadeb84befb2367f70ca7178d25503089184a1183cd890343c41a43b848b529cefbc1a749b94c4b47fd69a949aa6ca5812fc980f4d4da7b1ab1dfda3bc2ed154a7ec19b2bca16ea9f1bf1aaf40830a23bae1a0ed6b146ff617130d41ddf91ddcde1f7fdddf399cfdeabf5b05d05d4cc91a6c318c7348f9944baeac4717acaf2d669353c5d3ae3405453bc7081cd523f13764a1d1d3f9d54c2cc2ea5634698261f1cb5a06ba0d7d331634461611456ebaccc4af6d81cc5c8d5ba8ab535d65214f9fea8ac406d3e6eb9d1e505d167db389d01677fa0c9c97ab914cdbe33ed837154f8622c457c96a4003a2d309f7ce219afc1f1aa436cbd0c581e3e40323471762950f4baf0845b584ebf128ca50a4f868f85f4e8ec3adb8360bffd07c8ce9619cd290cf9c52fd6d8623cf80bc84deb38913c4db1365d0439154629f7521dcee23e4d1ab8d1d83768fa3b24bc8bb0838d6b36aaeff7b9b0372d26f72b6c5a36de9c33239bad8fec514a8a3b09eae247eeb4ec9725b06331c08e31fadfed00e3b45ba111c26cc0f299822f697cd859223f901757f0d16a8de4e6f749a0701b663a21b72096fa7abba367f5a0344b4c305d44248b80617c436729ae298b304a28886fe34317957214286a788e710d818a1aeae0c0e4d5b801b7bdb3a71cd49fafaea697b439241a4edfade6f32dca41620cbc4de5ef8fbd1c74c51eb565c6f31dc6ea6a7b51579c8e9ecaba685d74bf7e3955a64bb1fc2262f45edb263500e64b7bddc54b2735f3c37d40cabee7dfe23eae144c3cf2fab846f210c1f8393eabe23ebc2a615a4015f80b786f67b4abebeb5aecf6b4483218328d7a34a4c421472e197e00c12b1b6a099ad0021f3edd4accef4ea16bd4aa2956b9398b89c675b9dd793d18ae42fac724ad054398493738fd672ebf4e1086a560c333e2257c4dc79eea117b504002dec8d51c735f0f7f4a41912414e51527a1850074494d9cde69bbd5da02b09e588eed286635fc0e31d12a4fee23287339e692c9af51dba83e9706c23d0c649648a6ca6315f12966af4de3b6d974252eafa229047593ff6e239be6fe893380f6b63e1cf1e63a77abdd640e9c9b093a201a3d38dec49577d9557aa44ae18a59a42a04896b4c91fd6fb914bb83e3bd29124db6e8063875fc0eec2ff21131509e2cb06c0998b2fc8dedc80ed686061a0518b2f8bfd33239ed754e666e888573b1545a0c96945caf7c1272cd7710da4c61a388cf41a1a143b1692ab86bab0cac92b130c77a9006966d43679c495b3505090dbd96b330228fba8b803d59068323156be88937f351cc5dcad9edd006da9a48961bcddcc61281dd2e33d47bcdde3674b84aa5b6a73c9bdc0de7358c04734cae8c7b860c9e0c50861ca69e3ff26613f9686e2a4642a3f0f5d1093cbaae1eb7e9a5a7b94a06c93b1c81c236893f8ec6623e9e8b964e6125959b6644724888ab1791d9d35a7eb028559e71f0f580440dab76d05bbc57db2c03b6e5356707a68d339eddfb80aaeef00c6095959526b61e5482d70305045116f5e31a5103138c8550336802abfe211307d666795f8c79ba0cd3c46a8b33e38b5604f053384923e7bf0f43b8008349aa929eb96ef916c4db16a64977cdb2324e205f33d34f3296586e7752e681c25dbb77213b9af00b51d7f1ff53f5a04539ec74fba2291226062784ebf24c4bc8b080c7132d2f28a709766eee2a776bf11e7ad441f5d6b65efe789e804ef4bc2433ac09367e654c5e89c2a91fce760a9a0e3d98c8795d32cd5dc86d6842477d96ad7caad643e99ab74796622e08811ffa08a97c056f97285dfcf8db4d0046eae4048c2d44c6402342cb423183423c6ad4fc169a1c30a0e06dade8622b94f38f7f8d271840a04fc869d38c2c0211a4101830ec65c52f03cb9ed40130e3fb8916c11ca14030dc77f5cd49dff9f964df234b9388727665816db5728ea6e60a003ae8cfd586202f0efa737d1664f26ae780a2fc3ce718571c51cfad3f98aef6e3343fb03188c497b6e11e6e09839e719112db878eae00631ab4869717a6b6afa64729dd4f8786478bf048aeb104291098019c4187e72e849e8a4cc4528ed799b692dd94c737457b37463a8b0945fa3aba196e3d4dc63d246e9ec28a953a4c7f3215aee085eaaa627dd5de5a464839accba1558947904c41600d9e6225d84485abcbad92db252dc3db3b0a383fddc3007d4e3565cc574725e652eb944e493f521e0eee4961a69fa7403c150cdd3240b6aab9bfd0b1165fefcc79befdd825b15ac436baffd55f9e3a22f9bba02218d4a49a15564ff81bfec31bc951781fa89c6b2a3e7bb2a2feab3628e0198d69a9d6a692ad3a8bbe0c0773344df1291d58ed5529adfaa656312b38094c3a31fdfa7058b85b3756926b97d4e10d684d630f06a70d69e3b6434b974fde4c1aed6519bc9dc30017083544c67e03a7d39662d135866ea21802be6eca9436296232245de8763b16062a160cae1622d1eb84120521b413396ae07129f4b9e562efe64d0755984016f2d5045984236315e879b32bfeb1f442b4a11a4ad3660f1bd6fabff6c5f7eb87db72decc7f2067cccca00f15a4bac610aec4909715dee81f4a7b0242633dde71968bad605ca8d00136844c26fd5dda68c44629a242f4a95b3ca1720079366359ed58fe44047527e6ed26b37e29549c6e2ec1068ea35b16ce1019700d2d39491b42836236b49e752db4a6d55c0688a9d710166fe0a8386108db9a077a3bc706299a7c8921968fe9d09e23616be35d75a0ec5b4560e4f33d2561b36341b82d9a4d74be6d0daa61616892f67c50804998d3a3d02ea9f9599d4bb6ba1181f45cc8feb2a74c2d2a80c9a08f041f6086c9adedbc7920b24128778d14c3a691d0c068f73242ef96398a597c4b2f39c4b3696b4698a673c973dcac6406f772d15c0b1d16365943ef7b2517b11e13e6fd8aea0ed9c564c2d3fd13ab1717005985eb977e07752e874b24de08aac315ea4c51ab4282a8fa0c1afdb545f9c0b9fbde60b8611f5a34d8e5a2fda1710f138d7d033d3add652bd591e8f4ffb92672c2c012faeb0cab5be7aa9b089058bae295d07aeee71590951c3eacf8fcdb09c44e3fb32435169f24c3519eabdc0c2b0fe5da20517860492535e2267a5b0931e3b13bd0ee835f5ac43fd58b37e1e327aef041c6a027e0c87f53bea99dd40ba46690d29a2111b78fd75208856669645a802ffcf831f6c57dfcfc738fbb4422e9986c9e08035514f07574eefbf59faf3d9b0df1f98fac331a5f46b8a0d734208c3cab06b4495a8d4cce2e0e1dea931e76fad7f0575174cacc1893e9f769aabc2e9bff7488cd8148fc6ddae355060266c714b83872752f1358ca4a034561e0e1987131833fe70718afeab7036ee6da491fab5004d4b5f45a5ad63013269ea9b73fd8300506772bea192821b0273675f51fc7021b9cc3a0f6c6e8bd11048793fa4c860d3ffa13ff01208e0b364d4bac41c392801ac38ecb348bde5d5bb097e1dea220f236f7f89e735ee936a1704396c68e03b8f0c2c926d348f0ce769df55b72ea0966c918f1dde66d92fa1db6982bccf6f1185c9e5deee720494d35d66e36deac318864275e9cb7854aec5a730f0e7e40a4bb277aee2d1aae8cc0da5fe330da2742ccf56dd9b7df0dbcae82cd3ba88de60a483cdd9d86ff39f673b424ff202f8cb93b5d3d94ed322da935aec6de9cdc9497b1a67af6ad01d57333ab544147f625ae9274ee1ae2a5772be72553c07e0e3687146bdae61ba8c49a743b8e8c75d019f822560d8891b5ff03cdc7a69ab97fd5672c2ddd46537a372e103886ead787521baae3bc1cde5a625c9550103f62a3d682ed7182216380ad7fb18ccb9152177707b63e605416fae54a27870c6f33d5fa3982b7c39a67a246b3347f177a95e129b2933fd14e8f0807b691a2a98d2537cb062523387d7a8ef8f600a405f6e482d609ced23a2371014375ce1eb7901ac584bd39f00ace4112bd1ef7b6622d35ebd0b82b774e7d93eeef048b95666a50e00e36843e4b90c80026c273977c2d6f68c0b61b582998523feb1e54f7903bef89457adb5fc3e422ca3249a48e26180a3ddd1ae0999db04e5283e08d453981e65c133707ce854f81b977710220477073b27bd27d84ca80012a363d80707e418ba275cb30400595447c5bca57b11401f8faed8651aab13ca6b34c7777a542e83355c06a101e993ed37a13932566197e13d9bd6bd4377f4ca70ed0a8f6a141c114df37f0f879cac784fbc9af347ca942640a540830d975f832e365c563256943ff8219a373a18526948a0563bc34fa51920232e346164db50c8d919fb61c97333db286fe8896d1f1e1563b33483f501ac6087f5ff12de943f3a4f54db6ba3332d80b31639af5a87464e2e66c8ef9d038448003f3965183f64d21a2f8bc60604452d0a29379ec24e2ad1330d3e69b56a8460dcceb5d27927a21e0fba5956be0509c4a0f9c1684a67b2e9403fbe0b9c1081323fe6f014cb8a5f4fb2c835c30e6c2e6e86cfce6efc40bb409ec90559e57f93c882635671a3aa3da97c1559423a29e5de3d5c68fd7210b2d19e2d61a9405b3f14c10df56728407c1689780bdf94238cbd4edf853a19fa85385cd7c1ce4b36b36d1c69b0de02091a5e434ae94da8c86144953ce0dbf12170117053d13010de02164afb22415f8e73df11be16ca4b5892f13ac3f7a07fb05c81e9594206bdf29bec47ad6ff97c323dc46de3111d01c2c73f653884bdaf6148cf811e9fce3e06930ff3be9c03ae34823fb0a0ba5f829fe8772d241cfd7ef1ff5afd0e02298377ddfe7bd3e6598a9e80961b608702cae14453247262f111ae1bab66be381c65cdaf3d2efc9996561731d53987968ae13921e2f8b2d4f36f31b1e823c680b3e32cbf082e24f127d76890833a922e9c6eabda7f485cb7a517d9c69dc9ad1aa830fba41733568c4764de889ec383678694ff2cffcf818a948731ec9163f923a904581a10248d311d0d890b362ce76d030b26a2b1f776d1294645054a021ed98e7f37d65c96553308fb15452016aaa278ea55d1e575f957cf6348ea498b838194c62e751e060e07de752c446b7ecac82f462c15407dd47863ae2879b8e86ab18020aa5584ad03798c23a8998a3b9310fe4e4d48e8752172ad63eb88ee9857d335f9579820f037abe71ce989fb7356bdf4f517fe8e89a696462b6b0b63502f434a7ec6378b0dfefd5cc4d1ec495d4f82f2cdf7482677569d707c5a5c4ea7c527b77ef90bc01b7731e24418a0125427fd7fc7cb223c9f15d5e2bc429c2a02f27e00927b596e5e16bec14e8fbce700e29f1064cfbb4aaf3a5e9b4244908b9104f507d6a2aed966f1c9402f2b9e08994a72d8925d93f8da1f279d43dedaeb6f68a18d30add8239e4068ef8dbe352719dcef02dc158d6bcc5daafeb7118d5032d16c6948e32a8e14d22ee925bc15b0aeeb98045f53e38aeab1e01aa50d846645cb4f9265e67e9f99c226afac4fe26f33fac759970d4dc539787b7a7faa16b4780a3d4aca005d843a2236c2a44a19b83793b042a25708aa4976bbd2126c7bd37499bc48577d5b9a4260d4a21df0c5ca512e7e45cfc59ffc00674598fd9478da43e82f0bf26b70d66aa996cdb2fe14ee4d2dd15a52236f3381fb99894cf78c1b9fd5f0029df84673505875b8df7855e1a71da4c0a1fd91aba38bec7210dd861aa2caad57f8e8f852db4648c6b742385a9b210d613282e2704","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
