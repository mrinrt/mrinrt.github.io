<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"8c239b7fc074db3a6b531edc563c7a57a26324f16d9ceffffe539b6938471587af7c0cbc62e5b7c3176dbb22c85c17d678fb00546dc1e61d397b43c559a4abcc8593035bee06c48b52b1381dca0699d99d40ae151689fe9f855bcfe810f6b6735e0cb1087ce879e2401f68a42636e300732527576d18c05d51149f4ce3a0e43944735baa60a4c700df3700b272e83960bcf0b12666eca49fba82ebd473328e806a83ce5f5a4367f5579120cb19ebd54e42b2709c6d9a08a33e8452310d38b1d5ed72f0ba2aca913c1d81b045ef55309fb95cafd3698848711920ecb5f1b8f14f2fea96380eb1756cc8ae56a00ef09d39e12a43c9eb33a6304fe6c90b2809a82aab4a1d087ea9590eba9f19d46555c9f051c6404ad144d79d7de005b789b3fadd451dd3dd7f005085133b532f12d07208f78053208d3c99682190e26ec4a8cfdb3409672f42daeef42092f8e7fd14f668e0e50a8d0cae23ffda083e62e5caac68bed500149dc77b64ac86f91a6321510fbb8bc0f0ff16d9ef4c0f4d0f328c10f9df70289655b7bd4d205a5687b747f87caeadde3950b3bfc0efd94f17dbd0d2429e472e734d590ccd48b4ee83c948f23bd5fb5e4112856a99205db835747a365dca45b2a6209deb280df32cdacd3bef1e13e560f0ad8d8ec575c926615af04a7b294e23ba048b073e990c3afed0a47316a908a3b7e38d39899e6b7e3f34882304ba96bd94229532b25813e0085af0461eaad312d6949299fdf5dbee16a50e12a8ab1af36bec76f5a739ed1e06b923e55d84ad13b6cdf82f4780a722de017b39b55f7c2ce375224b83d348ab37d626719c08e5411037fae710f7e016bed9a295859e253cb89af8f007fe1d29360d28eea4e525a1d1d53b11fe92686cc89ea65ddceba3cab2bdf5f625eccc7ec88fa5e53a7542047cd59efdc334d3b2da264f5eaab29fb9919897532f9c0366d474fee49ae155f234eb31772cfed273ec552dc9dc5a60da4f6702c3955d12b9bddc981809eb8bf2632876304b2ff7f7ff00632d9e4749679f8a5a1a56ab76ad178d2295f83208d335a5901a73609dca669bfcd510b223cd6bf431700efb4822aed34a1d82ec7cf77291abbbe46589add3e7da5c82a4685d24bbbd3e5c10c0cd8f9eefe8b7e4487fe121e85bde4220adb25041adfbbc105ba8d06060e51af063515619cf57e8aa4ae29dc051f3b337dc868a34d649fde45ebf565bc1b5a0ceb1bccef84002258927a23cc7253b1bb39756075c9dfc3a39639e875bed32e85435f404588fe1089ad126714cb5f2570be430e76712269666ac566c0bd4b6f10bd0d46aac472bfbeb0cef6d67d850d17eec571f3730bbf314794fae86937dd4f9d7256bdf76f9609253bacc11f9c85dc147a237214706d327965a9fd4a5bc6f651b8bf5f0cf07d5a41b6b500f614b2b36886d1782c7270d930b9e7a8ac0c2fb00b9e26957f9bfcb1238bb8885b038c98df397ccc3c9dedb32b87e8b7f3a03e85a9c9bf03f2c224f589fc14276479f5f9b2faad06c02e184fb034680ea4cd44fa20e134fe18b60ea860db718fcf35fd4e0b981853e730fc9e64fbf5fc41a3221be91c84829ecbf1e7b265d30071bb17494465ea406336fd79ff028c56a53c0597b7262469950775ea5a026f1e408827b360ca5562a0df13304fbf0bdc6ca70a65865554889193462ce97bea0068f68a3a795cbcfae5e539f49b69dc911268912f2e998d50c771b8e9ac673b821766a5d126aebf05aa8388fe331bd59a5a57e5089c67652e1e8704913e9b675dd3e55889c20015adb825ed9a9b91e2d51e6da10374bd2acf6885ed88867e68ca56676a98ad1b418c2d4f69e9e4d439b87f9d26d8c727c9f9219b5b8fff192d7701e0c6ac4f21bea5b01083e3d49d4a52e0b99c0787b658425a150806d03709f693c7a7bf3213eed63c0114cf3d09332d217748691c9fca6f62ec7fdb0c57c5fbe04ead37f5be5fbcc83afd101754af8f5f7e0c6ae7d59fc489ca21dae9b1cf9866d1b834c7dadee3abb00a87b5ce4331827ed0781d2df9fcc38739ab951e984183c117c84765c69f6d518a85a2295a5e3cc6a3c543c549c7e10d5a8fbf17cda3ebb88974fda4c5c2d5e85faa2e07cfc7ac6f22fc994da91244befc7a87d2f1dc0566f8becf3da1a833112ae624a93106a96e0ca8433598937611ee0508750dcdbbf00f3eb2f3fedb99f7016166d280dd08fcb0715ab813bd0c433f3054ef33580d19c3da165711e736de0267f6b1542bc4b841d80300849a37a6c2840d29613a5e523711cbcbe6256a269d7f07ef7ce1879dd35108a8a73abcd30367deca542e833ccda154b8c11640568c1890e75aba17926bd9d58d1f8fc9d0acd6d5566cc7c322f6a5c19e15f796ea75500163465f8471dcc80dcb61ae3b638adedcbe3cf343a476323f2a59970099a3b1a8670714ccc27c8a6dc752ec5b16a271aad172e9c9bec207c7e0a8eaa7152fc9b6f254d0cdccd2a4e59048074fe196b532daa85213642cae73891e54b34531278e455dbbb1a22bee433741f282619b817a48d6cefd7c073aacc1f97f51492d4b72616aa21062370ad2d5ff7c7733dd4252510984fa7bf3cd8d1ad99f5ff4f7a43ad78c78b76bbf7daf6d3ed9c04acaf18f1f39f1dfe9b30721b14c6ed90ce7799f509d6fcdeb473f0fff45c860af813db29bb79ecf920b2478445984443dd60666536e83e9cda784dbb0a3bc1bc8ddcaef7787c4d1966e39a435f8716cad171c359457112ac433eac25032baaa0a14201ce4294723ebff19918a6a261b91a6016998cb65a138de6c4266844c9e721100c1f6f3c581f2e287f2ee3b47cf007a85c54bf36057705f94f874f7386b6447c79c6ea62b1ca10d4108b0b271f83727de0ff80cb7d8392cd6d520367a9b4258aa45f35654045653253ce4f6c1d4157d759d79464b526c2f9b9dbb8c2a7d724279d5aaea3eceefe6a9f98a63c157dfbe791078c5814f74cec517b47dcaa11bb8bead5a31ab733995951ebdb9ad23beae70f9f550d9b20e2cba2b5fd0bcef843284bcf03f32a7351e9f3e8711f8c109e07478eab002cb808e6f76c3e3f7f56f01b25ef249c7f9a05fd103d78490c7837e178fcea44b909d0147f03ff1fdeb8544cc80f09c9505b2b4307e6a2301ec6b485d4c79dfa0d10b79bb3f8e2edbddcd9842afdf58405d9afb9d11b5d0885a04682003abe321ea9dc742a42bfe59d69e2006fa48a29502b752cbbcc10583427a5d72d2cd6b588ae54f6af78c5fef9eb5ae9081eedad964bf710b0ba1d4dfd7ce3d6da894360040003c14f8eb8a74431a2a2b00d072dab176b05bb3ee9660a8a93de61bb53205efecbd05c684fbad782736ab18a9da8c6ab863c7fcdeabac50823120ba86a263f1e0ba66696ff0ab9b31dabce35969b21a178273d2bec62e54e54378fe5847b9f00ea6e1992de26145691e4e5ba4db400daba64c45054fb216379ed0cc29f7739fed2c7fb2a5e82f680b4319a6f2e5f9a50dd66cc4b64297c9d4855287c111b388bcf96b6b6a3eabd9cf2afc9a7050cedfc67cd19b636b72eacc41c845eba36f4f3bf94c67eb89feae7880791f23c94daabef22fea0c99700d66496cacd5970c5762f22e257e20b363fe69406ad8b3322672f400f8e6ca20ad821e4af92291785609f248e7aa21f215de27824245a298d6d249e673e41c099455f0d5726d09f39fcd7f84fddec441c3d5ef597db8ea56b7f680f17b344dce1706c221ab84e9ad2ff53c6cde5343e244af48370bac3a5239053bc5c8225833645f7bf31c349a1726d6389df8ec844892e5e00b569c1b4258d643d82eb8b8306fdb0b1c6e006d16013d6c5788d311f44361b1c13546f8a190f1df3d1971b6ee1892e5fa90b20bc08abcc4f44836ab2f4a1db59a06cc808c140522ccfd301cf48460757c33d69aca8687f459fc418f4d131a5f0a12eb84fff2bec0d2f5d7dee3eef43cc64758bffceadf2e8b095ee3f70c712f1d5e739aaee0f63ff0977203fa2643529509850cd89cdefbec40b2ffa615720792b93be3b8076ea18ae1c071e67978e19001cb236a5526af9162a115de8b2e9579a8268ab9b835c170075e6e837653842a0156fe4d84c13dce346e182a276c8a41065425b3de35aed8d06181f7513ad9822f2acd6405d47728bc66ab1912dfb26a8f67d01321f81cbcf0e721a4037a20c9d37347d9aa0355341219577420b62623b74234ca21dbda2ad2261b1f1d39c1c287f722f06452dbc95bbdfa8b842ef4ddf82e8cce676aad78fb401e6866c8c03a2360d9386502cdf06d69c2d1f5eed97f04295ec6783788fe3b1deeb5b7ca87a6f6c62fa9b9fe6ec91a6bd810d5e1a775004e713e30611c738c0d3262120e360be31dbbb9001b183498a983b6d16b74085178fd8dbb253734735b2d90188ccef060598be4d59cd5048ee38c9c965539676df909cf510cb570e579b65281828751684ef76f12c659f4c8e34a2da067ef4c75ae66e7e4f671d9686307ade4f55d62e6532b1b727bb0244f5cf45bd3c5223bf36ad5e0d365dfc0341d892cf89570b578df631e5e83e7095da7092ac5713853811086a2f8ebac22d24842f444505c5e8c3036e498a4e7132163bfedcb61a448d42471afa19e3347f9d2760f3eff72fcea09dcdb56a3199352f24f974f3718d533cea8a61d0cb90d582566409972f8b0c9e2990e05b33c4a080d8e5784de90356de492eb42b2105d10b1781272a5863de340b5a2a57ebb8ccae59e9663e2c76d1399d4edcf6ea5de9fe213ae9f60c4ffc0a294407e2080b3b4e39826e8e04c24119df8845df64253c3badd4ea0e78d734271ef6c02fe71a33a74d83cdb69f1033b69fd0f5d924920b9f0ee99dc8de017095bb4a148125b51981c222be1d8b8c7bd1a7ff80249d5328d93d232fbadd6750fd4e68c7fb88d5b2db756f1754b1f3f3dabff2c54c898cd91ba08cd07a4e6d0b7198da5e37d5bf56221d06b06e996210c6fb31f64cee0e4b9d6dc4cb23a9e9cd8da41ec88d52ad79c9443b328aa4384aec4f798e5a5aef5561d04ead361d1fe1481d005b4466e136435f40170b5286cf7c61ae7c68d0db13246a96454c00611ae03c6b2dc325bc84a94bb6e005046c24f1ee195511dc5b3117274edaa010d432f8290d8dc14e9bab7bcfa4646a38cb9381dd1c8ef795267d8bb4571db3cfaa7f249695ef672a88ccf69cd9e2f082e5b9d0ff2d24e0fc73764f72092ca3e6e140124daac2e137bfb7f100dca44af5c33de8fed694fe32920ab3e24370a78da2601b357bed5773d03002ad5ef568271275b557694750743fda84fd1636dcbfc77b7adf53e2564cb4488388d10c3dd16cb988d56ec5cd9589e1d3dbd9d8462efdc4df2da732987122c090a09bfc461c2d112ad643e067929ff8fdcc02ff9c1bb0d346e1c09384c488d8048c2f241ab8bbbdcc7f3e15cdeaf7912fe71e224c0edf3a2f9c39007fc36a05e9c098b28c6884edd4ec8d8fae99f99c6fac949cb02f7f7c925faccf1b030d0c1e767788f8977eb777029fc3b6fd0a04fd2c18316b0ff8fe25db2a5831990014c08794e10eeb74c78f91d16b80c3578ee371cc66007da3e7f192f86c8e2f9eb0a160533c60e3644da19a48e3d8ff5fd3c20db0629d87a9d2373ac2e6cb44f56cc5fe37bec722e91003d0dd21de46516985dfc1298365022f45188edcbdc9ecb5a0532ca7b1822bb1bc000b88d58b31ef3edb04347d97cf93e160691bd1f85681887735616c48c5fdb6cc007df1ae022d58e2b3c884188e97424e84b28fd994435b28613333d7962bb5affd6dab0bbb09962edbbbf9410b9ac06e484e7b92bf37268d15987f669d9c340d34c418f73b7b202b4684bcf4df8e14bee4320021c83f0b96fadf076b08f553f17470dbda40466dd33e96185cf9002353a9fa20a5e9cfaf2dc524210b277c4dcf3f56a3bcdf3422f876cc61902d11ca87d005975ee4af7f7f645d2ee0d1f37b305e6d7dccdfc7a47b5b8f881147c86dbb643ba40b74ab04d28f8578c773c2383306284dbe7a25700896d89596402a9ca741c5dfc0d7b3fc3bbdd7aad9ea26ac2157cc1912a21356e0d6b7cbb7abcc29b916c3099084f8dbbae983c4918df78e73919bb6983dde30a3d20cb792a8e73cd1cd145581704e835ad03561924d71d6ffe508faade1910d9d0f60bb69921cfb32460133d3a11444d28217791d36b0a63b1f04cf68bed99e6b2fa94753d046742392e2cea83ae26cea7eec72d055a569f06cf2fc602c22cb1cc6ab6dee01426a03a3e1bc40a9f5451ca45a79ac9f0dceb68f220ca4533d581c56d1eb8c7d208bd8d5832fcfb29098759c12c6a4bba1653560fdd94f11ef59dc3bbfb0b98bb7dcc06923d16d5159e90081495dc5c46e0d48a4c0e5f5ee49a04f10f0a4cb7ffaa74b39778491ac8e134dd10596b0389c4682ad324b98500cdd09e0efa1e0d009f9da42ab46eee95b375741cec29c326c9122f49be7e8a4f12ef063cb7468f2923d1d0799011c83380445551421f8141ae43ffe41e3dba31fbc500f5ca354346ec6a8dde5f38afb4bc614846d49d8182d338653ec644d6f022454aa80f461f1f4c9acaf9289bd523717e10c145861651a3c1f8cf1a4084b49d41e14ca4e208790d776ed06c485cee856a09ee7e4766d1b4a8fb35113476f2430a7f1c86fdd03cf55d73a4b6652150dfbd9ac16f2dcf405c99b482e76c1098030a6ff3ddfca431f7f160bb6cd4ff302368800e0bf2ecc44a16317daa88b07cf7828cfcf4c7b7952504f85b06d725efe4b8191dd38c951b7e6c2fef776c69f7b4869e512038d96e579eaa93f7a7683783b2915e45aacab68edf5377f6b2825cba5a7a79536cf95251014f45341b4a137b75ed804270966eb98765968d45ff280c6a7fe1a234054ea2799ad5a58cc76f74571b069a2e3d0718219ed6ee8942170a11b4eff86f381279d4188c5b5f08055b62c085a3750386cd520b9f9408d64af7aab955d1f47ab29664e940b5d80b02f0e4de5ecbdc76aa9bd32218725276a50f342f3dff73f75c73450c8222c2444cb796f3e964aaea577ae722d10400d907d58d37efdc473ceaecedf8096066b558a27e757845bf5aad025fe168d4032573a64135bf56b83ce9647d2375a9920c4a4af5ea36c856e35655a53a1ee646fd3a9785d8dde7b5523b22f9d58c0772ce626679a373927571f924564d9dd52638709f3206b6c7e40eeaf2248748d3d9d2a264d3b5e7b2fa8f9d84ecb49e76b52f5c48b5164a54c6babf9ce58b0825fcd2841a669968ba6bf69393cb71ef17e44d3c1c7b90fcc91d9a26f72477bffc96a9e7bdb5cfd9fdac59097d1692db5d0b6cc28928859d62c9f19a8eeaf0ea7eff98e61594e624eec3e65a72ba10c6d83e5cea6999ba712dea659566bd7c55765c68acb46fe70d53159f08d9a48e88062679c21e53be1c01c04d0228f0fd55efdf44ed1338b5fa72ebec6d43a52e36b449307757070b625e3b523dbb12d6e7decd985d1386ebf548c257bec306b17acfde01a02c39b069aa27161c6e2c700b7bc4d5d3b5efc2650f02245be0b4c13dce909fa2083ee9e2a6e5502bfb596349ee91a5d985445d8c45a039192f3bff72085a4b6ec9521a422d9df51420b4ac2457bb504f4918a2a1bb27a834c05fc0f3b1e370579cc2d1b496b6be5259757033bcdef8aa81b61153111889a204f21b7b0a205c51beddd30c4d4cadcee452c0d8f3d2375d534599065a13121a2db9864d05b8f3616dc3dc8225eae72bd65b37885bc5fb1d819298ea5386bd84ae2f9e0693536fb9691200144a1b402b6d2de4082ee89d3901f591864522d13bf941326381a717cc9a4156c1d695701885a53b1bb7321cf7993d1f2319888df3e4e942676419a4a82ab286d6991a69e5ff704dbc6d971680c64a751b6fc277b97507ca5cf2bf80efb8ddb75995747dd692836c6d39e7259b1bad81595feb8fe8fd27a1f3db5098978170ed81dbc1bf8a8c4440fd5485d6217a21ad7a263c923bc222cebf80d9baf24e6b76da657ca8bcceb3a2f5e0477d2ff95287a3b94b6cd3cd055f88ad6c571507ea7df2e7782d8d955cd0002cf8db33c3e14396f77365d9b18912cbdab3694970785a46bbc3212b8c84c1a63c754bd7f490078ee7db99d9dad897e350eb9da0eaf2f2e8ba3cbd49ecd1e6b1768eef98c27923e9ea3baa7d309d206bde7b2fab9c59cdb6cf1c8edfd5affd13a151b703a1d29e6080be6a9e803a2b87c16a74e475581f44066665ab3ad5b4189428a0c3b2fd7559176c80e94615570d88034627acef90c9ef11892b7476735fcdb4d487bf9f7cd7902c7a4c3556c381e4a453f1cb0aa788370e30d26d9fad320f9a5ef701a7f18e7451a599b9eda3a1cb9534136185959e55c382cc2aa73a36a69fed14d7333fbfccddcb15c07bfff17fd65e5bea55d6d8d86d1cdeea025eb451f478f1cc021c7bfaa4b539aed35b15f32c4fbb3299e123a5390d68e09497e7a60cf2fc5af5e4f5cff11e4bdf3919b7eab73028fb6a3c1d49f9a340e946f922865facf7cf63c2fc03690c47684f320279e733c6a0b1e40b1a8dc6313e8e70e6ccc265b356c24405dbcce83765a8c5e350fe6abe6fae3d2d1104dfe8fac28f0d243fc1231908651c3bcdc4211c6b7892ae9adfd74958f2d145a5ce518d62cc7e340faa7430dd860d1ba2faf688aada8e8bba9e112c3cc19c18b0bd1b59bbafecd42b9d2cf318e991ccc0bc180fae307518bb7f7de2a127f259f56afcb86360ed1e0323bdf082d42afa74e9646231bc65d218acac4ed04ab8e7c1031dbaf222396c07b4fbdda3125db36d7a9a15b785e271810882240d607554e04f0ef74d593bedc3ef101702b79faf69c13a9a268a653542b1f41c049a08c56bc46a090f9612ce5e8f37c9eb1e76dc927a89caf946b5d71325e2b6467bd1e638ac8707467e6453e9dfffa823e0ba38ab98c633408e02274f7b01e44cee18b6e29294a1c787bc441b8e3a54fb0e605739440587f75f790061549a8a97d55ca8c154f3da16fd874105b6436e8616e77dcda9daea7f5320cbbacbdff84f10c2dfff3737cf9067a18ec11b5c6c10ca65cc69cc6b5d7702898cabc0b185964732f2d689399bd5a078fc4fe49dfd5d0061cf355eaec49fe018580f29cabf658b70ec132811c5963fa133285c092280067c0ea911a6be416aab6eb56683e0702016a655350c8ec197185c2fcc4ad014bccb000347f4ced9252716850e78777f4b652cfe443dd164f7e364761163e4aa9c16cd50be2cc6e4f50509e326575c686e79adcf9b94019c623843b731bfc11ea3977a2347daf5d280ed4cbbd2163209c76c47f76be40aeb5c2ce9c5859a440d40d15d39e21216e1e43219d87dce567c86f09846faddbddac51c4b68d9737aa5699fce0f50ca035f25c73d8efdf12421c77612feab86ee146e115a137c57adf355052ddf17f4788f63a8a30865248d7002a59841989ef92d0c04f07c134107c6dce39a07c3fb31547d662027a173c09664e301c7f57abe0ea1cced17f20d0857e9dad0cce8d9057da87e855151cff6cd3d58911a74e539c65063892c18d7c0d5d148cc92abc7058d3245e5d93e57d9e749ce41dcf2fafc5cbdb8ad264d37cb10d0cdb3e78e4f304eac2c99be390926f716b1dc7153d3147b0a9a67fe30352903d50958286682cbad78f3707465db9903ebc26e5349bbeef9db142aa98a4bf76f64237656bf5cc4e69644d9aa09f69e9489106280821d9af1a32c373b1c68e134941fd31e9058905d92b22534b87cb2780f55a14ff8dec6aed5276315a67a8f169372e4c094ecc236223c149d0a41f1279f68a60cb4fd55b2db1130dceb0ad78802bfb7010006a75e5d7a6e46fcfd20608759ded3c02a15cd3ee0ac84320610ecd6d4d5deb6b3263ffae567b545c6764b0cfeed21046a034293548a7fe64e68dd07f968c5af34a4f3584d69e52e5f4aaf85146c78f1696b923c42096fb81938965ff8fe25127a045d05035b28580590ab482372ed9999e46b480f82bef58e1d2d57504847bca107268fc8ce1842970e6a6041342de789b11d4aa12b26ddbaff175aa15bd0868f574ca9802b642ad41cd1b97e8ac5511b006fe34af4edb1c627d589ad73925a907d164e2be39afd6207d03c006fee60b2e2fa5dd22f95c652ba84d76a126a6622f53be288bdd2b4aff505ca714d2337741d6bad63397ce1cdda30d4634cc2fadc6893ee5aabc82b3c5454eb0ed399bb9851d388bdb61f91ff89884c10ad6941a372a06107e333080005897613f6ec46db3eb38a097e86a5101f49e377321e1e3567bd688389b6d677c2290d4a555a561eb470233244396b872e044b07c3f6e7ca0ecf093a244e0dc3b31881711b50f768f562a659820c565c8d705c77f425adc5b6728f9475afd6bf7db21ff84254859fa63b79ffc9f9244453a68cad16fabb674fafb2d871e6b6b63d4ca3203a12ce9a4ff13c6aa9c11576fffeba7f2058859a9da822559c2a4fd3a4498e7adde89c38b33bb70cdfa4fe9ba2cfa8b99463b725fc871a96ab0ae5ca206e94f4733911f19fd81baed1c97262c4bbce45be4f47305db0d26411b85e8408b09d0bf493d85fd87650766ad4876a4c4ba13e68bbc9c742dda631714d191c69fdb729ac7b3342314ceeeb3db836b52ed38edd95da1be572f90fd5d3c2226b71cafea98256a20a8221b0aa827bf99c0aa2afc56962f651fed75f40daf4d94cec9fe42c78983b6b9c1c93e7c9322389a5c55db669f9723f25f2defd4cf7c89f6ade0b3e97c7f4f4e34cfadec55a35a72958e0ac797b098f298458f29e33cdfaeb8119dad788c2130bb5b989eb526c81110472db8b1356d773bb1f1d335b7806e1c2eca1e98f2a8a85e39d79894162cbdd755f8ce1cf0e7e8ee0b6c946c204ae8e6176a0b40ed6413241132f359f0aad899f0cc9c93bbf3b5494238a3e51cd083a4e50e78b74043dbbad8ddae88c135b441a1905373ec699123ddce1237a8cd30d1269a06ce7e24c2090f35bacaebad0f0977ef8c830a846e8259acd301ae8bb3df330c5eb8799dd3da2ac19ac9355719d8276faf7171b764bba3d1c466f5e4dc0a2937f269133adf0268dbaa0e2320100c86c30e198fd55af7271a14afee3be9aca40e8b2a3bbb04400c8e576b6a5cb0c0b4b1a9ea93c31667255e24104689ee13b50ef6ce482d0a42d2bf5300243d3f2595a9565e1c5528cdc8cee73547b813153455420553665f44bc914ab7256ae6830dfe580ad262f110ba715e742c1402ff211a8c7488f479837e225c373014cc7ff74c0371383125498212ac258e4f12c5debc738187f669ecbc1662733badad8886b87836018c6ca97c6cf71a0697fa9160d4b3aa6206d32d262d9a3d04b8fa451e04ec241f461a963619bd5fc4b49183f9467e11227fdaa8d7337c5ffcaa8bafe4432b42acf2b8348910b5296e1ae6e8f0dda6f8ea13c5fe1ce438cc1d8c5cffe4bfdf96b84cd56b542142eb0fbd60123792c7da31c271b57fc12d2c7826cc18f4f09740f2e73aafbe6f9d910bd74b2852421748989d00bd5ef2ff6850e13f098222d95ab2ca2d27c20ac219ee009677e2fc3471e39684c501fad5954dbda2a2e5de0303c835f41eef6532b9a8ed086b0276ea3d43b9775be092f711a0907a6745a2c589481f70d19ff19ca9a0e4a38962ab6df26a7b38b4dcf59fb4ef8668e8af6d275167f959fce2659965c0377952d9d010f80db9ab440a4dc98405b7237c309ad8062a78ba273ecb7c1cb7279bca7fc2b644445760b816fe78b55ecd5a49cbd618550dae34d8da72d822c3f21dc1348bc219f2318ded144ddf56208f7dd8d5e806c700070553dee935bff4dff3981ae90bffcb653bcd0a136acce576afabedf91f02d52d6c02bb37dc180f09ee0fccc20d6fdd995861d34542422079dcd5bd41a68224528a8a12d72c7bb8b9d62fba5215d0552a4a3961194510c4d67767ccead3f6997b6e6e5910370dc8ddae80ddc24f5600619dd09a7d4e05beb3e83c1a93bcf3023491945e1334f43bab211342a7a1d7fc8848078e093ecaa23d14d016f0f5eebcaef02f531a636522dbd49e0b3551131a20a0d1548437d9a0fe620651b1abedc45a39e9a3b33d813fb181708ad0c4a2ea41630f6e0f9a55d822664b476c0bf978cbf01ec309d43a33e2eb5edb070ee1ebd5c5b5a5eb4808faed1c17555e522789dd515d2f8fa3d71c01eac3c6971c9a043d49c941aa9010ac77c7b07cf99d271379f9d750db01103733053570e6b48990d32f546d51008b2758878194161759e17e73f43c09c1c405a45535755207168b2ee932a80f0844ec87a0dec8358840adc37015bc531470aa56bf5523d3caa2c2450a96c8f15700371a45ee0bd0426e494892382ad27dda76a81d0a078ff7152dc5cab393a7b978f660c9db306b7205b1bdfe0060446ec9d2814604fd45b95b7cf7c16ef14cd229567ffb831b0c7476d5068f32984e27b029a9cebd97760c13ab7f61f99c773ef6418fe2b18b5da42c5cc7b17b24b7cdd7a6e100412dd46e4516416a00bf29419889255806dd342e39e7876708945b8c6956767223cb5d087d785e4d43e483554795de66a3deab583f2f6f526afdab42e4d1cee29d22969224d6ec481090dd47b500165416ea52843d5474cfb56643a831791dc0cf6a53d6a6b38e5e70990465f92a4807788dbc33bc4034d00e7fc4d518dfbed6e64b89eb774aa83cb5c5ccd1f836ed5869c68bceb8d097d83d34caf43ef3d135c274a2a25f5d165aac243a4b28bca0c4aea359c94abe7bb4abb723118df83881ca4c92a5eee36e7d2346dc11645c917693af8ad265b0f15614f8d19ee8ca760b4823c8389f5eaa689e0dfdb4e1c6922d5a53b753d4d346e82e7204874565bcd08ca64d3cc2aca93556269aa486e2a190827de443f5183b6389f293d8d6f118676fe98fd3672bf3a74ac289c1d827d92bf9afa6a1f44390e79104394f5b45d2d8d7b0624317b57f0c8dd8fa82a5fef68fbad15d6e9b33e583fc87e0ee933fd1c7dcb6515acc2cfe26e156c0264061ec86ac52374757814981cc8f0ec1c35000ff2df6b1c79c7394d3f01bba431a7ac3962ada187a72d8ca6fbadc72510af58f334b8efe6d353ca13fb745a3393ba84353f3133dea9865af683409a97d3ad1fbec63542d56d0da87642b0978e370c8613063995992e2d2bcf93754c92341ecda1869023a5a014ff12250b0a6a24d32908af2a83ec076560d61faaa6664a8defedfcca92bcffae815d169a171faff710c3b7e888edab8959d7fd17b37f54257900422d0405d58bbc0712011e719818aa4c242b127454c8989d263ec2cdcddcdb8bbe538eeaade4f033aa7df4ff1f207f69c70ba408001a703a7148ddfc40334fc9eb2c4ffff94989fb70eeb58a8d22f8c328296b58a119594e6d55feb7df4656ab8876ab2d1f0f67a09ca4fc019fa20caf5372a24bc0d2476e3c338b0808b5e821933230c4722c9f06ee9611a40c3bc39b4c5e7413400f6c03422274fc9088af3d4d60baccc096400d6428ed7cd8de2f63a9081c3a79c227a86c7de752ed3a9ce579b75dca3cead45c23cbd5ece4537341d7e09e62d8b412264e20c21e2fe435896706026ba79434cd1493a79be4c040294825195b46b48f437c0d149844c079a1d7e5f2d4a3ac2af23678a66196e1dce4268a8364386d7afcf142f561dc81e21ae776ea31da853f66b9bdcc496fd6b72e712ce447c2b99418a8488c9ff45b921e8fababef8c2ded3e3f4cbb608d78550225b72f367e875b39db5266ed545769fa4eb186866367b4c0d3085b8897054bf3e19c4eb08f663d409f817c0d3f6a793e076c04be7ae3e50acc7a4f97db6c4d930c5c055adb505e281461d13d7a370934ef9afb86c12c4065b56d194e23f60c360ea39260c13214a43d530902e75bcf8d12059726e740fe827235b881cd0b9bef91dee455515497ffdb7f885afc4368a04224ae85d7e67aba562b4703bbd43838ebcbcb11ef6899b3ad6f16af08633b4fa378afc5195d1d2ba6e9b2ed1a17d2cc26725069870419fa5882466dc54ad6ee3525336c791892b84c6eb84505ef64ddbcfc740bc905ddf0211741df88c308f21cc072b2f6ae677a586a4aa67c4f27aa162f9e6fa14f7c7ddea1893ecaeb13d0b411b2a4164f796d931f1dc782b6cd85377c2f34c8ed3e850802325eff4d84dd84fe55278f817314fcb53c439d26dad34f083d4467899b1e75b5a3684735ef81906327e4888e547f60476ff037b0b916cd7a4b1b83ec0d5b068b909d12dc1e8f14ec33d93835acbac2e5e13626c33697a89737c4dade47afd69e95a838a86331c958e144ccf7e0de68d9beddc210fdfb22239bf1374cd3aae7fbfcaba61e82982a56a28829c7f60222d8c31326bd62396d5525257392b5ef60e3294f5bfaa012b8b9d4bb9bc7e20fe13a4052ea7ff4bd59daad2d5b69bf81c35a23761aaa2262445ef8f878a4bddf334cbfdb2225cecc046285d664573cbd6e4cdb07a458460696d042705440aff76b67c07399e29443bcfabf380dfcee7f90bd3658cae2f31e53a0e1ed5fb280e49ef59c830af1102875834b944b86db910306055911275065946fbda595b8efa9989436f62a08b135048b5ffe0726d54fc2038e09e117307a241ae5a88a549b497dd2943ff16dc31286b73eda1878b10aca66af67babe30429ca29df38e3727454e82750a93c51764dbe66ea496c593dd5ae9e423c57ebc6bfd24764c8a0bb2cf0dac2f496ca86a44c8677b1198a51e4e4b9e763d5a915eadc950cd500f0425e26e53cdfe4bd6fa4bd00d44b53cc3ba52a27a32515abb8814d9a75726d0a2a138e7071da65bb96a4fdabbe388328ed3c5a94adabd1049f38ad594f42105a6abd4323409602b58bf16b444133ebd4f6f3715cdb0ac76640c34137c6a674d065e2eab2fac622b7d6a24ef4fea5826567c0bea37049d3b55b38cf44cc0bd4163a4d91e3f0026274b9cef7e2b91062dd2932b11833dea4dbde9256d32be799445c8f1503925e4e54b7e4fe449aa0866bfb931bcf83ac1726053c639630c996a64952bfcd6991a51c22a98020b210067f77f9e0015c3205276fb8069d963305d06e8a174d89ac89b0bd6f211c1ee2a53cb0dc4b029dbf99ffe1a30ed4ea2edc072f17562eb5509120db32ca86bed868afca5cd34343a6cbcf106d87821da91ca271afb287630afabd2d6fa3995acef0b8e52866e6bfc217f70ac58452bff930ffe67fdd4e3596fba60db96dd52bc713d1675df21130d3fd2e50ca98912de27a2f2b3f8233cc8595ce64a03b2b48f02ceca68898ef1910102c196f42025bee1e79d50ffc745d22302f72ced617bde38fc6dd296d4ec9ea53f2c92fe13f95f90aca2ec617a00319176e0be5754826336930379ee42bc3c9f262db339a17566270f668dd2930611892e2ed4aaa9b21920beb42ebdcb080f0a585fca5a2499a939915473aadf4ae014d385282af2b37bd33852612df8f10d70f58151c84c7de55734d8c6bb97f45962c92ae367a2d16409883a5b4ba1364f3e165fbc5fd7629617f5d002336b43e4d9513f1516adebbeb2e9b0bea522da80b604234839581e901f8a3f02463f8f5a93f11ce7b910c3f20101e0e9f7d5b72127eaec27503e7a7dbd716b5d103f34a96ad0f9ba002b5401490869aa1d320241d9161e8fa7f42f56b15ecbf0a454ecc1af64b4896c2b58e416466c043435c0203098ac7decdef482094e858cf4357e233deb463744b80efccdb5907e927f8ea8fd68e6a9992cc716ec8368a560c1d3e996caea3cadfed1c112e6f3849f22537d678982cfaf149bcb75c752c0245d6bc881f5d8f96c7a121bcd6618ffe7b9012e6104485c349b8fc9c8840ec40385c56bb3f67797e8010d8672a01e7df254d3fbda0c7599cfb21271d3df8074c8b66167f9c8ec09f3fd6df1f6f04cd2980bdd7046d0acba42bde43328532e4b28cb270c8702b41e43993a0c8851d24","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
