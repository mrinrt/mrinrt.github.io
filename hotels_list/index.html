<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"906e00fc66144585db0323cef145be3a41f30493292d06b49b56a5a77833e66d72832298f84937087ed69084035437318d17a41129f0d2cd29ec2b16a54ff0d4e2e77959a953eed4847cb9495b41a0317c677ac46f19cc5461dbeaa85c3b1e827df2761b0211c2ce546f647b97f7fe85031ee801d598c742b54674c6682500e81ab95742884229ba38571de350c5105d7157e215f1be2d05d4049d640d1162afe703d233015c35e8a9deeda2178e16784a4ef081ee8f487a7ec6101b2840a957f9f8c963924c7c5700a798881d89edc82dd36a1488c3503919f037c465c92fdc5fa4564099a9bdb4427df3de81976ce495c9b085529a467f0a501a71acb0e9a9e80f40c6ad4a73965e3217cf368c03ea27187058b7b0fc132505b058946d6fa43805318592a62af19a02e67459a94819731ac6e60e4be4b6c8cd8a777c4b114579cd8ba1759eb896bd99533d5be30c56d2e306ffe79c70846643474399c1ef53a0c80cf17316d36798ac69b11f83ce9da680171a263d13d30e840da4f42a12ee1d80b8a3b289507648b5e67b7c7ae75e092f1320fe197f7ec10f8b3cb68e6025bb1621a592c84c900d041d5f0718498b2a3b07b088a271f4713e537792c2ef5f32422725db1928f3af3619500f03661800b3021146da9ba9113f7a58c759b9e69dbccdfe339d4ebad1b38268cc5b7d7510d8da3be76b38b6c9393c40075cf3d80987311d86371d7cc3100ba586f0c5b8b16ca04ada5ea8ec8786df2285e67d0fa1ac267d736c5c8001fc73b49018a1a6ccfef8e1ed55905143a7d66f839ff846cddfa426bb007203e972830a9350aa492e12bf6a32ed2877aac703ed00a6dc595e60144a6f9ed01e3f6f1dd1e88962c0c3a31fb8c2fc24f77cd91117e7f8beb4685d35fb58c862a5b0c92601856a329763a5640160955d7fd6b4b0d0e4fb1485dda921d48a7dff0c32636c17b078e6a241f7632b1c79fc2521305ae81194073b21e7f3adf96d97f8f32fc929c986d05179baafb9c62fe9771197129452e729db7a971a92cc2d524848acfa88f9b0f0258c7efbc7c21e02bbb71579b5a95f0e50c7c81efe875f8cdc7bd0cf26c42a3801575716145fcef60c978e8ea085522b1a60f6cce435f1c918a5dd36a56b0ed8fae95ba82dedbf12f55e32df7fc3c12d74ebe97fcba3f56606e0c24dee9308b9fb5550626414db0ba56723ab2bb1cb4f3a9c358c64e672a1f1da2316310e051a66dc511c5dcfa3952bc82c098ea79e965940f028554702185bc41b8f2029aa03ca30062f87971dbf080f3e3bdf701be6291aad901b2ab01f08fde91b3cf8506ff7fc3e1ad92b961724b9c6693d3a88b4ac9bbefae3495a7e370f565f1e51a39bc1418d876d12c3f5be9ce11db7e69b4f212ee929dcdea892b178d9276eacdec2108088d2f6c49a145bfee4b16571b6e4c648a2f9cdd9023e4599883a06b16929756dbd132762f0dd66a8ccf1e0cf6c174cebed3337121313c10b6d7ddb76b88ebe620a16ceda4f8461276f382bf6e10bde1ec772ee014e215cdb3a957b5a973ab0ba44f37a6cc78af393470cdb9e51c9af559ed50e01cc8f0ef74c4bd746307341041a89cb0913ffa065a74c7b3767228947203e3a64dc05397d1595ff41688b11fc6b862429dc39a8519938669297b6d35b70a7c2d62102f069deaa55c83e7e9ec078d03dba5307ad6327748a4436a1ade379e4bf269540dbf458f8f33b431505ede90c2f418ea4e6643fccdd8d2b6a423ee56b4e296a1c0e940829b11488693f6598126168e381bec294e72e75f6657c4f87c230dbf8a71523475ec1220c8c4199696d904c886826b667953884da0e3180b6cc004d58c8be60a629985f186d57338a79d9152da7d3f74152fee0c1fe9b8647dae6ac2da7299a18fbe0b0811501fe95b04872fc45b7d113cbc42507aa260c0b9b2af453a69802c4212b7a1f1bdb1bbb78c4b0128175c8c82db9ea82b76b966bcb8e9b1a14a10041371d1ce7f5b3b606040d027dcf0a3bfe69cdc552041c97cea7e36b1f081e6b5c3e575821cdb221c8f5b222d819834566b2152f340bce9ee4ae3940dfdfcb1594c18e5df6fb8b9db4058847c883eb1cb5f39477ba3aaaa25b14bcfa08f3e52e13e6adb6d5a16093f33852701680c223d713667cb79db52a77aa79239c0fb97126bbad476aee3bf3557c13b531bcc19dec4317e87a1e8772a6e16eba90d4c277c9d40a591c7d933bccd01e93c2f436acf0f1a9600a616418328c66dc5682aed50ef99ec237a753fdbb9be99cb2e7e57e505d239841ba8d100b793d810b64fe18de9199f4850521d5b088dfe1ff180e28ce6818179c232388c344287997ea2d037c4935ffccad78919196c0a49b36371777bc5605172a297c2941dff03b9fe03a802bafc7a5932ffe72f0c5e5024cfa7d3ad8ec87038246a88d03c143d492ef22bf6b3d5799539550db385a7f0b979ac2ff37a0d22feae1b6c5a198bd02f3354b1b685b6b4a587b1d9d3fb6e5c8673395d2d310d950a5d23c98418a54d4fc4f243cd61f5c41c2ee13d3f16e210ca32e0f1b5e4aa251147416bfdac26ef35b9a0f5344d4ba75e1b523c15af3bc437913c3c206d78407da44ebca77ee388de8a0c9960618229f0c6f6e2104e8cf30833b9115489a61291b3b593efd0dde966cc03a5ddc7822b5fef1583846dc42e13d71de627bc22a691195f9d0f02938a18dfa4b41abee08548b1ed77f145957c7ce6cd3899116b48f82269f644bc7f5cf5063bda3bc233e15df5c897b318529ce3c751f2ea0479611751e635326c657c99036515716ff9a88ebc24b9f1257a67e44d1a15ff21a12b66b9ac6fe536884650e2a5be7b585282f716d9abf56131521aa86e4f705c4533c57bea0ff9407b45923284af99abdccac1a7c6c39f6e83b05e45ccb935fd0ea0d78e8046c67b6f39e625586e9e60a660eb2fb07781a53163ca4ec6da547dc3a7084ce40b64b27d084094a7bb3e82a426f96f0c8ab18972c2f2697af5dc249d2759b8789f994af78e66c526c47f9bee2f7aebf7ff1622080248e746847ed56fa8ff49a248c4c670c08135c36ab31af1ceee5c7990ea298f1c3e53101bc9339f6f575580ff61ffe749b6c36e42f959973364f7994b2e09f8f8ae1517f7b0db09be06cd1b45f9a3db62de6734d1c3a730b523a9327938c0a047ed066281f8afe062671d84b49cb9d79eb78b622726bdc35cff056eb9f8f9b8266c7d8ba80652742257b82fbfe9391412d43ea37e992b14dbb763d25d6e68e77428999fca65194535b5cbe18958d00265271475369db93f84035d67660592ceb93063cc3dfa5f6551769d1d715c3263a4ed495c260b3e0d2477e2f60c9bdf0efaf48a3faf7648ca0422e4c34cc337c9fa4df9ef50cd0e497016474ecca3c984c08d77095f189717766bf5d851c9ba856a3cf33860d9101c83239a798f59eaac36fbf99c5e8697e8caf87fd0242521630bc336c5528efa2ba99ef8f796d8ee5a91a38a4a62ddff98f7a481ffb60298adfe8bb437b71d4679e3b1eeb4ca128316a62aaa1dbfbbdee6f158ecfa5bce1991f002199bbfc51174330d659bac21c4515937d8667143e6c5312913308bacaf27a3177ad22712948182a3892382227bbe68ce477b56ec37b2870ce3a2449734daa76b532d4b5542a9f04e55947017bb2cc4e1645f5fd3bbfca70148bcad4aa86f96a8e00790aea4fb5d5f031ebe5abf10791aec9f3130eaf6217e13bc2c95e30cb9d37ca86e22d8bab34dba3b5ef8b056ce210f24b0bae7ce5718d5b1742c07b6fae27b865d5c0c57e407c3ee1f4eb3e795a7c669fcb117c44d2c1075664a5734e67dab7677a1b85e87bbb998d55fe711f4a3136a699867c98b55dc1157eba447f5393ef38032d872d4c36a0c4c92ddee8fd6d0499626d1e59083ad6e1e35e80c8696d310286fb912aa4044e783a8e270b04cb4a6e11b3c7cf7cc88a94ff87f7c57b910f3049bc7ece15f260759d91047a4715fded278305e642208cc21594b643c731d29e88bdd08cf4c33cedc7df9648a82362035acccc6bdb0558472825ea452d29c743e358feb008a24fe12c0e2554c72951e2f0526a4e461cdb8e638f64cb680dbe44d02addff1ddc7b57ff34125f9e6e6121a29aeb0bd7d1ad1c4a38b033b9a5a28de27eec38c416ce9f5b138bcbfdee7ab1dba3ac36a22bbb7b040ed41bff1c2e6df27116e06b0c138260988a4fb806ba641fc2c5027b1791738cf0bcf8ac58c84c47723b96dc93522442367780e3a62582a38340ec72898e7be019bbc65224dc5e08af272b317ba73d3699d7bd8348e8d5aa03d63be1ab17883662f4147cf5e04dfc19eac3e31d801b5782943009897531c6ee8fcb8bb5c2d264b5c7bb49d8e1ca02190da7542138849222c1c9af40d63b2be7a841f72d923dfd92559e7a016db7c7f074aab1ac28c0d1c74fafb95d8f5f0348581445efbcb1af66844c2afc7a81ca61d261243fbf7fdb88a37e97c3ed6aa9cf1d6199c3941a36b1d7739bab65821ac9ff7d7d6065558ab0263ec450900f20b64adf90a1e35250e0fd443690fb7d2b5ff3d31a6ed0af600e46e6c9b09c5f61d42077b05005c1707bef1d3f759723acc34e641c9fdd44464f86cbf69798abcac76b65ffcdb9b87a7ac26464ed2c634236481ea91427735a04c1bd2e67cdfe08e2c3aea26de5f06c3730173c91d6a02dfe425f4e1445609a056fb7cb3822b21e429c6327054054009218de82256a9d45c43995659c1731824d2d42170593071130356c29c032f4b590815b10a03d03cd700250371ea8828ae5b13d32227a0d95a9a8d973536d99273968fcb38f55e12e5d8c0077f8b899a472f4f3db943903923172c4f56a6bbce33602c097e8d8600f23f10ae591b61369f352770c518513cc606fd0fecfce1eece2e1fffbf59a6bdcc6d528a66b1abd22b7d888b4f2d38b10fffcb3014038171b6acbdf14f44713ffeb9b1b867efcec2cf9fa368839ade40b806b344c27e65f93a0b1730a77d865c12b3555f2aa1af57d8d595d1049e8af8ffe6c5e06977d20c76c9d9e44ce0dc58f553d37457cac41324c5edf2fbb888bda1338123cca732aed3ece32d7a3d6528b9f1536a871132598a8929d008c6e6a2cc3d471e67fea971a79285eeb4f7eb156e36735b58b881516d72317553abc8e5e7bf387a9e957737e16183cd25829aa643da8c0047c028d2886d5acdb2087d0ccad9eade8d9a1fe3f74faf550e2e9395ac81e90f3e24650ac21e221aa11fed066db4666ee6ec46028a350d75e93b1fa3b4e8185874e092acdfc69f0664a85ba7ffd1baecde5bd6caa6172dd8c1f24c388b61dcb2239dfa05e10bcddd606ae194ef04f2bd290d099623390a896fc56d422d28b52a0c363f32754bde86b671d7c651b24eb82a24124dd172a0326bcf81d3fb883988fd71f42b9fc42d1d9545d6d732380ad54fd3346c7b52f91665173d23c64a58965d30a9405265f27b67b1d07be4787ed58d1beede9689e0e54f32eaffb6374302536e5adbd8d4505901c0b41f759220b13b5a48920028566a384e0d34fda7c9690e61870686f1adf79061159d87f96e1a73dbe521ff17cb8c82c19ea3838771a5da7b68e557659663efc6135e6b8a670cc185be6e9751866adbd31d3c22fe5b6f64ce427bcf6fbb8ae1b2b2207507bd4f76fb892479b9d36dccaf66c11a853337a91ca7bd03224ab7334499ba5b5e5162ed4ae7b44a49bbf5806cd0380675d79086275a729487b10830b9eeba23d2fbc3bfd5e8979a16e22299917c86982fff15847c532a4f0f523dce6ca46f50f47c54cfd8c749ab012f927cc3c3db1aad84e5a9ca9e34ffa46bb40f69961c44aa897e28bd022acd9d8fdf3bc4476bf1e5a96fea2fe62d8367f02eabc08a6396a683c7f4253e823eb5811164d364c450782a9f5bfecfcb1e4443400eff78e34de4e2e0283244421290cecfb237ee6593a558f0598bbd399b4d7759df6daf02d18dcb82dc961b8c1449dcb0d0ccc94d2f38dba96deee101830b9fd636d3a33fa8cf63cc1ae89bab880de59aba0e15693580f70858f5ce644b367b39d739397ae7db92b3e3b258f9491fbcbd18c5e78b155bcabbea72ac02d8d8345ca575f33a70b11c810811f2950c2a3616ffc08c1cd95167d31138f523c6f5cc38c024d8da1289317f03569935ccac37a59347af50910effbf8a29d6c4d0a6846a63a9ed02912960ed19b39255d5b9f398f57208d0cea615df01d0ba53aa41bbcac2d45e4daad4d1b957f65f22c1aa370ca605beb684fe7d8052ef860e1242b22abcb41889c0a8af5063f2399047caae3cf5737ad4a91e498b3ebf93fb40028ca4470ebe66da8f482feb5a45b61d6188d94d99990170490938944b7eb913f905ad834aa0b8839bd1acc9aa1e9f3646dd705ae6755ace4a9159a5d2a6fae9621ffdaa7f5a18b9d387ebbc126887372add9d022d494f28dc72f61672be2bb6f60dbf4d3294af74ece5b1646a00490523a2fe59371cc2519c35cd85388ec38e98c163138c2016bf7e0ec08f341711eaf3639f0a03eaa1732d7d149366331f6091d866fcaaf7d66c334e368f6bf10624f51e1c6d49bd8ef1dd4907c485858aa48633d0063806fe2614c3b06525f8a02a1901bcd144c0f9f8992f509e743d70107677a3d22bfc03b8819db77c12b703dbe8732a4c155906e6a164c28b6887f3b4574bb98b518d29441e68d5b953f094f980b75f0dd5d5667c546d086ae1a3dc78c5981fe5ad1a8746aba9334dda4669e3c925a946e50e8bb97291e6f98f6ad09071a278591579b574c9a97cfcae263b93576e04814a2600bd4bcf022f1df960b9e366b7e029f5cced6f92eff408405dca17c4f7ab78db3c9bfa7a32d9b7793a673ac086e8d15bda86d428dd6bae8b2c81673b8a862c89fe3298df8579a2fc7944fa9c7807044317e15e261d9f7375737cca86a8d1afd4b146b726fb5674e0dc6f04f0e119b5f700620866a9061eed22d862c986db2f22fe753740b0647f27bfaa8f083a9a3a41e98d457844893d60cfd24c240348a83b1a97930dc04666fa88b1f77e0d288490f0ae424afa2657dab369e822b8aa1d4fbc67bca78cc572f0a30118086aa4de0c7be3d81b98d05ec8a353e5aab385fcf50e99ece2ded2f4abc9f534e327b85d7e3c953d3b3ebf4074d6abcdbec6723a9f8c2ee59eff3f836245d23812e2028e9f4a7f3158eecb992e8a73e41a0ac85ac771e1c5e162c66032af66aa800c81d732ab5049f10bea56869e8da9ee30b041b7fae69e9a92efa10603cc205ba041933f09c9935a6ec398e404a5a34ab9f409aa886a4b66548d8ab940aa96890f50e2339b8442d16584aea2566ea3161d24551d724483c85e5448934434ca21b2386c7d1fdbda3861f0665ea1d620631f71ae38876eb5ae84e6a4bc578226f719c229ab435e11487f1907b208d0c1de1a266894d7178e2a24332280a09ec7b89c3221755013690e28bdf9b9927594cdf0cea0bd49aadb0baabfeb257cc7111020bc00d4d49e56ba4683c3c8ce2eef2f54f3842ed9348a3143e391fbaaabd34817d14ab1f9d28fab8e01c261595b83e19d76f08331a2889dd76b0d9a834ca07dda41b4baafa18aeaddf2d17b6fd833248747ef4d013a2fff3e96ce53f58e2d8a27deeb09f181d36ab22768b582b54a4d2e774a866dd89fdbc0a2658a2c309a857d1273079bd5270ac80205df9de5478ba813c73517219fdfe14c351d7847a387a2ba237423a399c8a347ddc18d6270ffa794e84bf5d62787279c4083c4ecd8b7cf3f957a80707a34991788086c905a3efa0545d8caa9620193fa813cfcb28fa1985d03a1d64956271b0a3ef91d84fd4bb08d4ec83d89c569f0fb170402b24df4baa1c8f93e20be320973260330c6bbc5fda16b40276c28b74c186036a49af263ce997927e87e824be251137d67d421c20a388c370cd1d01e68c5d6c9e844aa1625071abd3289ed888501d35cc306b67f20ef800fedc0c48e73e6990d67af62b9574680caaa6cc341b40aab4d416a1e6354e8a0a5d2592dbda1657dd0f0c89ea98f7587ce4e26746d8f52c76d8499c3c69b3abe715462110d16c28731fe830ef67f6f746f08821e624b3a5b2e060e1b7dce616d96e0fcd4cfa569a9b63ae6196d0be2df5897479bc8e6c4b2dbd4e38ef2f43c3a8eebb83d799ec8e51945f43ff6e027a739e76a12a6b4062e7cae8327a9f8c9a3a131e428a0f09f4a4c75f6baf81cf2cd0422db9e440613deb4023df2cfa9b10ee837d2ea7863c665f0aff30c4e5a41f6be95b932e32e646dd58376afa4e397901d837df23491a8137391d54fa35b6e913c52258120b81174aad9826b4015fc5d3fb66709944ffbb87a6c43f1ebb926048af208f7e80a3dbe24f50a563d40265b31dbb6d2638da285d95a631066b7a85ccf5fd241b4bf8991f003751fcac5d8660fb3ba3fee42d6113c5d43e283bfb9e1cfa19ddaaccde0c015e44ecca10833e10a37428dc86fb86f4bd7be8fa1a8a146354be12e7ef328cf37d530ef2b871b5bea52d9f6f515ad07b7f2651b76bb233aebc88f1506bb0a7f0f50c114616786d8e0625dff49d461f15777cb9573867af4861da8261d44447ac526e6d0f4ee442214b639e73856c497e8bd2a3344b399b57dc5b870e23c2fcd6288cf73e5941f9bebe4c7b7cd16fed457a484601bb810b85453695705a41623c006ecbe81470f4c9010b04a8661bd6e6275935f0b4c64dfad48c853b80629b6d8ded96cdec6847cdee56e28cff91322b32064af987402fce271621733d8636f283c1b55b9859bbe3ec02da7fd939455be7d0ba1dbe9c8596921930f46c22828a0c7e4a3ab6691d528ae9b9470cf9583108060a9cc9d30cc05d9bf5c66eeea0359a4c4ee1c42729dace597edfac2c8b19a09bce5edfbf755c5531b5aaed437e789b03b0d80c626587484a23acca35297736e4577fdc09343662ee5aef9901db0e6950f56137f8d1833ffa3c2f8e245ff74fe36433a51998c4a392642f2dc542e6d3ae84bccd961f71f7fb208c326620598f3e8a397d2cf3d0a5a6f112e744d00e55a7b2df21e5da8b8e7366c713bc930277288847eda47b9aeff819582b8f503130a292d3d185d4518e833a5d52b11618de63e97e8fa516c025d95598b31bc8fe537133739fc4e33b4dca09fd9ed80455d0e8d760bf605e936d381bf0b5fb64e9d3b2300397cae2cfe394fb5bf79703497814936d03499320b8050b5df53457bced6a058108bcc5d4e2ecb807d6a9a15e6dda65c4e81595390048b9ef46ace55ef4b403d1f459d8003745ac8a30481ddf324f5e761fa6344c823ee4cdca4f2a92e7ed37d564837a9f829f1fd2ae274adbc21d68f3a069b03491ae18f88ba4e5f545a379a154118f583b7c5b67f514ab42f7a0e6a848b7fa6c0c49d46decbd3be23794482b45ff5924a93e5c55fd31e036b09b0e3a72c1fa44710ba3ead2ede1f00aa973ad6f26ebd4a07fad369a1c3626c0c023ab2c60a5b68603bb5066726ad0d45b76c407fcec0b916a4ab944f8a4b21d2c680734d566606fc82dcde3e20b12b36d73cf5a70f060ca772e85bdbe55fefd48468eb80e61555cb51e5a1f01c31ebffd5d3045172b88e53a9e14641e0c973feb7f0c1f96d7d806ef0666f89d5c91251d984b55ba101ded57f281c3bae41c83a3106640b1d0f3955f383bbf32d4f74d3372d2e6e533ddf4fe46af0ac0e4c521da660717835bfa5da5417d2ece3258d59984106b3c1768f7feb7c3cbab54337c62af3ea8162c31f8dc95cf4968e6b9540d74b1afc619ac802f3476c88bc0fa12406d7a47883e11e36a85487fee45096bf618c27115de31c3dffe52667b94ddd390bdc36502548822e99c011f285762cecb70cb81dcbdb9476f25091159be8d5306a1570dab6493b7485f396e71cfd236fe1eb99a64cd2ec53e4a78b62ed3c78d8aded5dd0103f61102cb8532e44519f2138aa601a9d402b3e9aa61c4269010d8c962f87689ff1bb45e435c76d29da94b6b930091965f1beacdc6c97abefddf7feb89aac1e84cd4c27fb7b9b0e2a66aff9cd3889d63ea452199d55914d30e99303deb33467c2bc699dc6bb183aa1ef8673e5dd88caa2dc883ab497f70642db19974c257d931914f78339621f3c921e9df53e9325522a2d9f77a263a52ecb8abdb618def84ab029ce50d16fccf65f65c32a03e05579cdff3e1c6369e6a981b2520400bd3855d42288f0ea690b4f2d9386e62fddd48396118b265c657eec7d82d13a0b9c666f4be359b144b9d79408316a6814b2e6e5acec686f86ae6ac1023c825be8160857846607293c4e327acab409533f3bb2ccb2bd7468cb6ea58713a7aa288d3849e318f10b924b81c105eac55b269fefe9a2aec5d57d905dcbb7afd6a711b3d636329441df90ef2c8ec9d7eb0b679f60fc139f5bcc9f1906d0093ba0032ee18eb13b9527183a4735fdab4302142831de15c46ac225b55721b691f5c3091dfc5bf7753ef3f165b9321f89d8e113adee80bf631494cce3830458241b7682a2eaec70f7cdd2f644e253455e4ee81210b1c24510f9e81ec00e437b2b412da1c19ce4998c3d30e5d311e45643fd142e7ef1f0b4af91afd7d3bbeb82b1afd0b9cb25b1d53beb4c47afa5ea836bf8a3ce117944beb2f3f1fb52724d739087be847bf0d37cc10b90e7f311bd5fa6eff8861ad767207d8c97720f537d296612f7f2e1c5060df20f927ed25de004d2a15703cbc3c9f6e03286739f76ce51322972b6e1f27c3e51349c5b0248db5ff6e37ed72b1af00c0f4235e353b7076314aa68283db074333d8bc8d634529d0aca63f5a96c67c29988b3615cf218a8408d58bb51a8d7b3b51868963487a0b46a1b1f1d5222406599556c253a2b23efa806719435acce58957c6b10f15c340dbf9014185f803d189af80ed9221dbd251748f3c3963def3c1cdd0490f8b2effd7c8520e6f6a9719454793d5f98b0ddfd0940e49c47d600a501d707ebfce637ca43ddffbfee809892823d5e6b2eb622564b1dac14c784a165f2a7e6127e82e7dfc12c1a8be375d53145eb44a99506001b27c9f22ae5d0cb87ebd94e1c470f890ae83e472a7d40b430c77bfc2a6dd458671a041afad630a47f1653c972615ac33da4f256f5e2fa28f4d56d95034fee8e77b119b34c1192ef41c8bc99b9b83bd9345491702836446e7b61569d178e1ed6d955d7e9af7823b14a69ed46b66ae2483393456b60c51f5d3a18726dfdc92a4af3bf9e48fb2b0f96929879e8f787fade6649ad25ffae1defb7dbcfaf0d79af01162694249cab13d98e20bed811799e4e89ce4c88363e8bc2afe4ec8d3eb4e38c3c5a2ecdb985224ffe1b991709c5065137072961bbf515eb0d5ebe571d0cf49677e4a307bda65f09d469a6be7166566246b4028626dbfcad2184c3f41fea85167f9de6cfcdd0ca66b0ab254cab5612659523f60be18bc33e3d2b489bddf2fc8e709b3ca3ede9f0710ee89cc9e756c0406847d5e581dc28241c44eb0915dce471b801d02970fbc11ea648d77104da9f0a093e59ff7276a9df02cd290bc3c044f342d8b11c91e86c1347c78fae29223ea7bad0e55e70e3deb67228cdbaec0a726a251ae535499725dfa283455e4ef5c61e39d6c3c9bfdaab5faa4b28453333799fbb983555f70bf7aef08c4f5a8a6f794882e5ddc63cab9566e4aa2a97cacccc40d10618de3d2074decb9576e2b174fcb0bb8b1664cc7ad3613b50fd5f1a6d37000a37857a9b90c75d7fa7baa81547dc20dde1e671f152bc6ba2923eb6390e8956066d9a4c36f3b5b478839741288aa98c39e6f3f3def39bc73d719c58d170590b2f1639fd23af8703598d0f71e43fd775f53c24a8dfa93c33be99d6de39cfb02cc3a3896dd5f49f8f435c7d7e4d6e60f3e614ef3f4c9505c617eb2dd8aad26abd3adf26535caeeef152788bc23e1da234b45226f6c21a7f168b729bd8b16d21cad7d4fab7b0e1e9d983fd43de5dc458cc16eb19da90ee791553512f6bb7e23ffae58f30c1c64ad2bd2ecfd84499995dcd753638b8fcafca3ea98881c6079a8fe44d63beb38257a667ec771f0e27768ed0e07ce7e8479b81127b6207db9434404044dc22253cb3a68a043135f4e805ccd41c9590acf2eb25e4c33103dc02a3acb6ece64781b493ca0c5b1c695f0ca1bdef5b7e2801746af6176e47ca2871f8ee7fb070df37f05c571b69872a1e9414de57f457d2b1769a2fef0e3d4fb09b481df417242f52deedb077bfc07d0dd41d87f164951893fbae1c641f9f6a2bdcc4179f68e03169505f84cf581a5cab84bc5045d592e4c6d0cdbd80eb49d733694a2d974d7f94bc782fc47cb4921092b55fc6f87bdfd426037dbd95847423759ee501fa170f780a46e665c071196c1d69e6c9722064c17ee891a6aa20030de624a0a289c5dafe745c25b723b9fa333dc5201aeb981311ae8aa5418fe8aab302d213881dea2bd49f92ea459fc753709ec8cc8fc17800c27ba01673ccac3bb9e6ee3e8519d6633f14df85dbdb74b03eb14f37a85b21ec62bf5844fa76ac98678261357e92ad68fc44819aab6fb974fa91c2ef640c99234b4677c37638b05e5a5d38a1091bf92511d538a533e7e460b1976008677cd6bb75bc58af03243ccc76b66eea599b33252d4dfa5804839b3435154b2153b18bb59128ecce94b75192cad09cf87172722274926cf8b2e2f839ca1f728fb26893d9bd4edb4268cda53bd483b9ec91255cb365f31263e76846be9f8279eac209e11ebb1c3d3163a9801093e3861bf95fdbbe983cf9318f79e276ca2b9917c05dbebcb852a670680f67ba3ffdd8c8caa5ceb237ed364da38945c580fac733ce82a96d5ea22b24356be71ee9520aed23260ffd86b84de10a812ebf8c68361e97d6f6c6980f7eb4e2b143c282c582f052de136570cca07203c65d5cf02820bd50d530a85ab612c16e2e2c715652ee1c39fa3bb6d3fefe4a76ccc19bba2649a8b71050dadbac7b12a5e1e999056ecd5b3bc365b7b1570fff4317f6a9c63f2cd5d8e520641638d46b5fb194cc1158b79e5d5f0d42c9935fc3a4d841d0d89edf3f4761ed0ab01f79221a85d1b1e20ecb16d7d47446f2a9ee6b0dd82cf33ff731919ee7fb7efbc7bbda4478a62bd8b8ae010021195b0cb0386783a078cc39f5cad211a2db1e6154677dfaa40caf36169c16bee0b6b6ca8c225a608cc5384b8aab8e93c5bc1111b3409be0e104ea6b1c2aad33818607750cce4a327ec73d148fb2652387a1279dd1e15678b5569335f4cd35a64117fbee0bfc3f0e709e3c80a37e50bae3bef75cbe836fb355bc438098de07f450210f807a6cb3ce06894dd8ea5e975f4d4f40b5fe4b6df73b6ecda5db20f227bc53bdb757ea742f3f6cdde0e4641a7fff3cc4327879c27bb96497256cd87e63cfcebcc6fbfdc1ed200d3b441446663d57d8a33c725e37533ce5561ba7f3f8c0c4bfd3b827373ab0c322493e7fee5e56d1e72de08ffb8d02716f1c21b02371c28880515d4293b88f368f7985f07eb741800fb7a506f45d5e6a3d152d90402175515555755ec8f1ee049c80b03d572d22baed738e44296b3327646475a0ccfabe1895498528aa3a50ff9807815153251171c2f6dfd9a191b5ff61e1c5ff335d0602e12232dda13cdbe572ca78dabada3c9c4887f6e95e704bf4c2aa14eb95ee9f5b8a81ac6ca0582ce0bb6b4dd40f5dedfc71ff2a216bb93d725d78a079b3d31acf36b8439813204bacb3dfa43228b96a58ec936e3a2684407d12e41596406825334097cac282d6df2f633ce58ff36d96126e3b21a22379fd326a5fccf0e6b853326a7ccd900b059d5058ab4a9fb1ab20c5533e6902d7e2e4a0e8b5f31d53b5b37177eda50f6b0484d7bea6dda368823f5659cb61136f9acf59dbc595c47affb8ad026b39515f7a6e39e57bf6a04bb6e05e5f2b9ffb472c6035fd278d1b3f08651d57b54faeb001b920539029c83b2e39a12627ea027a1b6cbdeeee607389a305807614a47b922eae49e361ef79443ceabc2b30859b55792e7ed378c670b1fdc0167b1de81bf44fdc06d9e4ecd9d21fd74655c947b42d2aecb35da30042f335f355486e29bedeaac472719d8ce0926186b86b10d7fef64bb5e48116fc674b91bdea3090e39977af3f0be695fcf806a4649ba0ef2445f77113ac3db91c4d0c362e7a813371e5a1c57ec552fb342cf0e5828b2a9629b73fce43dab3bc2900fe9aa6e480f1b3b745a4dc82619a78b8ec769d707c911c9444ab1dfbccf869d271a46f68902aba192a317b2d8293afe618c0dd498f8bad855779f99eca75e950b9d1b0c665304f679d7d294e2a979dd56cbff9fb3fbddb8470b84fdcb5c4c0769f98f17ec16f4c2a2311be02fffed339fb52f66444e9ecf2c549bdaf2856f9060fc45ce8b0676fdf94d6903819d33cbaf03dbf11af957c8b5a97f4495feb22f30a66eb8e7ecc4a5b9de5b4bcec3db6c48b095421ebbc18a312a86d88d810402f5ac9fed7a904c29e675216f5cdbfade6c1f29037874000e06ee84070f28e90f962db84475b9ca476f39a95a536a364fb701c627cd8d5c458956db4cbb9c71a7572351e6406ed8054e8ea7366474326a87830dc5847fa7d1f445e4a560cd7f8948b6a242fb576a03bc39629af5b8305b5cd86546549745290579d02b2e7d29aa4d1c52153365d6fef91b9193a37f2ed3879913c605ad39622cf41c41d320eceeb75d3ea485dc7c41b4ffc2bbd0963582c91e769095ccd0f6d7df4d10ea333e91853759d5b8de4839694385d44fcfd99ba0ab932f21139b6a5ea44f622458f94b0c252cc14b305b4574a58efe438c20204b8296765fb009e24d251d05139c601519fd5a98f22c9fdf088c403f0d995fc2bfed8ef75f358b8144561e815d2193f7651811b84841b74a52dda6e2164c1e2352272cac674c8a779064fc7cbf40bf0747b440e753eca2b5f26f1e69ef6e32381ade7479560982969b5552bf8013026da44240ef452307fd41a91e1dcedc34ef156b1d013502318cd9ade0eb0f5b8b15eee245f5ed2343af1cf075eec67113f053ee07d0382eacba9e1ef1549cdf03a3477f073242fa6bce0aa1901244f48ee4bd9883fa8a945734ecdb0154650a93ec5a2b564c1e693ab3b1f739b5e66e1836b03bbb60e0c03010f0a8821d9c8393767fb11e27f0a7b7038af2eb62cdfbff52478e5faf48a865482baaa4ed148086e15f182d3e9ad69b050927a9d4ccd9bc26807e408a11142d91f78caf09ce0213bdccc737399a1eb2ca6c4237129bf1d858c0b10e95dfcf36d5c583908684a9808256e9810a05e1d709cfebecf8282f09a31df051d566ac01d26c88c13607753b8704cc790aa0fb98acfb42","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
