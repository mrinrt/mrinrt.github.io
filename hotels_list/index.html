<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"5d894720ffd9eea434d16f4fa62a3feeb144a0404bb2bd67b78877e89bf164100cd91631081c14b8ddcd786df4113c6acc991522078a72d8ad3221759f8fced73ae91d41c99ff5cd4348f2898b05f31a8dc50f91ae9b79db7bfbf1972cff10736e52276b9d0b948c0255ba6cdb6328cc730292956653eeaa20c422be97708be2a2fb321aba58f2b7a4772dece6d635dd745e6eb360e4ab7ab70739d695942208d66ed01a77869445c7241894c2e5f88ea76db89568ca341c5d5e2ea8feeeb8f25954e6a5a14b15eaf8bc3b7aff428dad537e728cf3518f26d3609062f41cdc9ce89209a850254c19620862d5af587c9af25827d699da8a7ffbdfd50de2c4384b99a77dff6109394a28323577c11f20a200c6ec970558872d89eb463ed89723d459cbd5f406a955fed2c099185fddac358bf8d11469d723fba7a31e5f958dcecb6fe43605bc777f4469647fdfe5593e32282e5bd0f8c7f5a4f5cbc5767e785627d87343ed5e842152bb19d24dad6a56c8cd29f14699104e164599728319448d5dd2e0a79c574aa82ebf7a963e81c7601af94c291b309e6fc83b12e13215e4221962ffb93f2805328a6df1ab133e5e665f98ff0b054f163eb9bf760664636970fc69dc17109549bc170887fac3bbdd1ad9a925355238a17c97a02678f85b14eb805dc0e0383d161f5d368418aa1339f234091711d952cdedf3b5d9373295bc092f02beae02fe89c3cdd7483c549a0db81f1d2ab99115dac776c49a2a4b1a91413a9471815550c5560898cc233609eb296d9983656581506b47a3b105cefe16bf9690e33fff86dd5c797aa5c45feaa550dec20dbc4ed28d02d30bb9aabbc53e4dcdad23256a6123fac726bf8ec422a66de7efc0a389e1c89402e9cc611426915a1cb207488b4183eb34638fe42ee5ec495f2312ca85d439b99c3bd48f17ea3fc324a13747bad6d242e4e3a19c9b2971fe73b4552aac0f11300c700ba6f25f035815e0b542f09614eab6747aa6933d6ee9a0d0bc7cec1bed8ea87d3a0307beefedeb4a50e39d7829a99246eeebfd4d69607bce010597c6293dbfcc4025326872beecd9182661592f3dce1f71c335c0f5a4cf8b0f7edfb42119d58a276e2891edac3c3055a0c1d9d5dc07a2201c44a0fd1ca57a5bca518c7e92dd64b9b0b85c621cdcc3333e280e93228e2eb40464954e6b6da96843f088ab7d1ffb298c39f8cdac84edee4d08e3c5e76d6e91e799d42063c10e6e442ee7001339540d94b2e03bd6720471c00fe09da152244e58cb4030ad71ee387dd2b6e1c997a57838ddc44981ea453938fe6d019ac7f9665f0cedcfe5e0f54dbe2821dedb7ed08881b9a2883ca1fc3f2eba0bf02e79456f9c41ca6ad86d8efc95ba360fe95a236d4d8b0d3c2a0fc36dbd876009150cb492b81422e205e419648577b1fa1f5a2dcfa2c7ca553be57660bb643ac3b7867ec5fafee3d25fb22429be49e21ee93e219a69fc6aff37e71e5ba8caabbe716e96aeb66addacf2c56730e465303b63edc37aa62ffa2856681cec98eafe5e2afda410f415246996b1fa405659088938b13c005b8eae4b1613daca09dbe2212f4922e2571808146df4a39bcf7ff7fbe1da7b8fb72c2b125dd1154868cc5d888e37418a2099ef6bb61f88a3a4a00c204f5ac9251525f2e7eae9ab920d95f097bdb9d79488c754479dd92eddafd34f5dde1eb62625aeda68e41cf7441ede1e53590cdafb8d9c9059d7f8f09e9ab553ab3014ecb02c454503f6a5b47f92cca20e4e2f13a9caefb690be896386ca81af02df8f2fcead713cb54703a7bc16b3e9f3b42b14502fbf468536e2c74cfac02bfeaac179a15335304cb682e57af422b08e8de2ec25fd7dc160036793138f0fbb53306dda8115f4a2c8e38fdb1cd736c7bec5a75d454803a9df215c24d765d1376308b45e1f050b21f6da79c0fa11633250e8f6ea5d2fe276d13a74cdf78cb725b2414be9f9bf0260da5360b6ee2fd37d34d06d30cb7aedb97ec723d4dba9f28cd2ed8f023bab5089d50d029671ba24328961adf9d6efd8ca8f8dd09fafff33a0b555e6d15256c67a76bc92de31e9334c85dc33681f79a73ce072b314366a5a365c2622fde0778386142b887ad4e6da3553104f387616104de8a26c21b17224c6760357d5273f8c8ed094cde1ec259d31549cfc4a8679d5481caedb62c2c9e68f3b2c810a5f7b04cbec160c99190454617473e0bc0efadf6235577071546eb112ec3505ea5b46abb0cc8ef5b80f08145147cc3d1ceece1232a4c53a82ff7e90f1ff97fa6a27304d71ef2145b262c5d8be29f40a006cb4679d9becc9f6178aab01ef848503d1605a36b3ccec924ee400cd9c927f94c69dae7d183b35336f0f9ad571edd0b75ef89fa63e9f2af5aadf19b0aee2d56de7ab40291fb1ab1e99ef5b949d0736a9bf074b161a95d623c05e36fa3f97d7f25d3ec02ce91fb3efec0a7b2a4048b8285ca2a5e894e67306e17e38d68032d350bef53b3151ba537af1c5b07547694219fbc8d5df338f93eb72d10139de831a1a0c23f165e23a17233e976ccd8af4d6d9476d0a0975f931d96166d7b224bc0bb9e8a9255876dfc3d41ea17e55d02468210e34a54508d3a11cb18a701ea1fe79ec713af950777a97c2bb6f0f1db72eb147c5c78c25fe534e18106848e3229f7dc84a210c1ca1ed8cd94569be37835c7e654e34c2a9962e31e682443bfd73a336ca1b5ea0d33a03c4e0f470a3adeb588a13249566d028ea66a27f1019753bb883b2e3665deeff64cd55369252c1bec743098812889682542483c0eace609c019bbeb59223834f02ece8cccbeb4a018ee51029088e9dc5169ca1bceb113a2b4544c42d25622a9334e8a0d5e187ab71fb1bdc43a63e905645645b134712c1421b1c979fdf8278212b75994276df8be3de8e499238e0f0b4ce3cab537075208c9c5fa5529c62d29b192be6ad2b44f20b25acfb5f4566952c044088803ad9119acbf04b749d9a4a019c04b4ff819f38e288d0a2eb1ff7d5c9bad38b101578ec5cc57bbfc6dda5ad5ce3ea649aece5d36877b7e5eb9a74bfeea9b53b1c5c03c73f90ce87d089a8e7d9cfcb6fa944cd762458cf736981171fdea58813cb431aecc1aaa5caecbe2210d93b97127a5bd7f613e195ee5b2093f6d108b97a6f50ad56ed9d3ebb3517cb48e4bcf0a32067a5ef46b18187d6eae1164f99fe51a78ad7e2bae6661c7e8d6bce7242b3bf436a1b0edd75e7e9b766455df7e198491100255a9073be19d661b82008c149a1085b3203bea8eceac7c0bb7d9fedcb87d827cca0547b5f0821114ed8cb80d4b049ecc3a525e75d22cf0cd43ba1cac56140372cfc010ecc78568ce3965318b526d957d5ee209fe603657137abcea73807545e1c7df5049f863d89b511fd33ea87aa7c68761b8c02d79596c063ae1ae2830e52417f473433e6805cfdded2cb87b06f7741a4abf8211b59b7ab2d24a5028de0c3894d7cbfa252d8ef8002564a69493b5a77f6baa73d6c737a4bafb8d84851a438285a549723c3ba3e61d779cebb9b3c5f927f656e26d1009e2def1164ee60bf2f24e0c86aa540f4fba3c4b04610cf5c105283a2163479104a60aae674461ea1f58c09899442ee66991004f98931e97132e2cfe48d360f44b9df774ae92c694bb4e9f0df9c77f6b8a6ffe8119b04dfffeb603fcd1650e5d99aba92e2b4338d473445998d73ac5043201f4e9562e508330e40a1b22a21b19c774c5a0b02307e2abc434856db11df0ee62a1d041e8e953f6b3c70fa95f980ad0d9fdb01ed7f58894c286fbedf3cb747dd0bf245f856b59ba3ec3ae64928d6c7af415e260d2e4c4ba45373074bbf49e7204e54cb7f258fdf270b8f9428c56268ea3bae7447737627cc2865becec0c8e8df41311197df125d7af9383ef4ab58d90b82c4f5d63c9d4ddddc412487a831cea9401153e3d1d156ebc595502c1f6485945286876361d6db8df049b96f03bec2b588f7caabc8e336493eb2cbb7068ec2aa141ff7cf9c9ae82d822a9bb96548c8ef4236591b123031bf788a3332694c0256fbb91256297e51a188fb1189d1c2890ac7b6f1d770dedfc3fd7adcabcacd0257c96673588bcc720751687f2771e0014986eb5d2ba9ddefb02ba1696f9d1708408f3ca4bc5244a4a815f0bb1c4da50cf57aecb3007a88ec83134ce9aac84a8f6a68a072cf42738c0f14884e1ba5ac975feb4718cf09a608b19166e352066426c6d9e277354afa212babe41fd78434311107fedd391e3b022c10c208fe1a382f8660d82352ebb118d313f44666bc276a1b23fe572acdd6abd26a21cb8d3b1fe44fb98174c5645584aeb9ec97840408256d620cdea44533ff52ebd7759615bcdb184fffee29b3305e6e15eab404a0c85ef05756e59c24ce8636e8433f564f8b9e1e0af0544ea0ee2b389e1dc15281fc87cafa74a0a65acc153a9bc2afdd62fd6229a04b8b35fbfadd42f353c279243e1072ce050d180ead6773cea1f5f627d00297dee9b77382383305f6053992217b716ecb0e7222f79ae8a95f6c68e5fb348fbea78709c834e8b609bea4b8f3c44b92f604c7e0ba07153f1ac09752dfadf4a2778f24701d18e8392b8d6c713501b76acd749165d7da28130aa4c0b343e29fbb928f239e65577cd18c724b0626dc51316dc6d8aaabdf82befe8804a3db92d9fb182a3e2ef9c55a85a689a72dcdf971c1f1d664f22d0d22b1955187c1bd5958d81e2a0d46dd28b65f3d346de30cb6f5c837d8f575d7d04780eba082ca7b484c4f0d9ad0194a4f4dcfa9be5ea2e64a1f47ef6e14f1e7750ccb564dce7d111e910691ae9e35ba32b725695922005474c39123b8464ede8db8f0c1122e7ada504b85bd0bd30d78b47df52e35696226deb9293ce86c01cda86cf8aa92b257eb874cdc4a631c86b6c8a04eaf68d898dc042d42ca7ff6a33cde2d2a3a2ca9f5ced7dab13c99f3b7358647a0d2344fa54b8dc7389ddbc2c83271b2c5e9f0f56750a3c81ed5c9e8ba54975147c0dae65d6f7b139435138cc32cb9c345c7d18652cfa3f790a28335d7d3af74ab47af6dda492ed43072d465f38aba2ad6a4e572bec4886b061275380a501d388f3b98e0608f35822e6f525263186e1033e1a5a1b1de15771a38c81c21f09c3e2e3c55e7119b406d13bb530de19202d74b44625d6fc77efd4bac1b7a5d788a38667ea34cd4e29140c76ca3a05c18383ee0ea3cd07e7c8a9d6fcbefd305ecfa95a640128e1809635c58b75447a01db5886214b66d5423ee143d76b8e7e30b4177a0d76c0e5c9e29477a89bd78d3b7413d28734553be6b09e4a2f8033ad347445f6766c3b50bb4f46d9d8d3c630b08231b704a764ea92e7096815d817a45bda7b5f4ad72b5158c5f45f624ee0667b74cd39040d06925eb9c6773a44869effd3b083c88427b78fbb6dcc6be7c9e25133a0b5003c175cfda9e499c5f719d6c94c834f063d3323b9d447c9be7404872b4d43e0d76f033a812085d2dc8739af7e7fb6663976d61a18c2c2dfda8dcd816c12139d00c420b1262b58558b209e8c2b9f0cda30e4020d0f51dd0f9eb5936b9418cee1bd583eac6bde267aa670f7d4e9302d10cbb312b93cb93f5f833e3f7e0f78ca8e1d61a9b0d634521d1f56a1a207a4dd730d27a42bd2e81de123c0eaf0d0acbe40e20a42ee698f9cc1c97ce9a855d5376ecec5f0f0093b9baeb349a4e2042fc34328d21ceb56df7682183bbf9ae6745adcbf904f435f0e6ee314d678072fbf078bb21febaa2f8b73152d329b01cfd054a14c06a87252d07c9b4d78f0814e310ed1d9cd14d8004dd086d65ed1c39a2d5a030081e5998bad50b92bc8cfaeba1ef9a90d2e2866d46000fd3798266fdf0c5cd21e26ab16eebc6bce676740cf6b3b505bdaecc9eeb608a5ca7979e99b07c7eac7ec285979d916093a9fa782092a85896a316e8fd4651134004a981dd0fd4a460e3da3616648d0b88ed5efcbac407dfcaa6956b1b82167be93980918b823e785a2d3010905d27c72081dc8be0230f8fb549d472b595ad804465285b7923a6e6f155988c4157f126a16c1deecc33950965a7289c95a49a574bea2091949b0e6f1b2a2d906dbb321e25fedbdc2651198179c5f4b6820e6781234c52b4330d31675376188c88782ee27a10790a4f139763a8b3295ae32f0f8641f4f49095cb43b2f1f6c9e27cd28c62fc46593a3eadcaea461e30caa89e8c1c15ac1b3fc2be22a6acd8265ec023505fcf3ce475e8fbe04a9ab3250c1c0ff9fd3a0864a49fd2c24537dfc668c1e37ac4c578fcf08c057f6a9cac18216b45f5e6670938c05093c7d0f1387901d2ae5a21e19d0f9f212427423532709e4a6fe666ab6a268fc54798bf3de08a56bfc11e0c6ffa2c0cb0bc7227d3776d1e4bf4c463379155cab4e998ec067d63d30284b5efd72106f02da66f06d5496070363ca7ce88b454ec1e39d00d29e21c5978f742059d36bfe12aec2e3b85b9af83366609c3d9dacf0a52c1f261b0b84599d0c8aca604de9a649f281e317074d7dd1913526f1dfc36e0cbce6906bc3109f9affbf04dd7483d2490ed444c6ee3fe8c9501113a8879c34c2373bc9366359e99108760e0a802d3709d99b9c3e89c65a498906938e729cff37ff4fd19bf5360a8b6261bb9516dfd626eb392a4cd7402012e5167d826bf0563d9ed91b35eaa974284207569f13eb8fa3382a9abb957ef6e3df7e0bc3efeaf74477dbbfeaf0bfbdc68b5ed816a3e359312972f8533ddd076fa40fa0a11d6627722ac5496c2b610bf1b0f65cdb8ad0330c2653e9f2a570e3fe63c6cafd8687583009153c381b5f1d7814465028a95929ac71f411c8928214c63e72984b0464948c88e175288eaf08a73c1052a3cd4777e0d31460e3ddba4246b16162e5de17a8708ac99724e4430f46603ec6db78c862a856057c7c10096efe60bdc9a6297ebd3503ad7d761904f31aaaa861c4d117575e4f89ef725f5dc91446d58bd654c5a1a3a49809a34553e632db6340bbf6e08971e9b8dbc5ce2d788270bf371ef19fb821dc8428dac4111c171be621c2803c53b11bcd738c9f91e764807eab813a9144a7fa2f7e74bad692e2c8aadb92ace4c170df96d1a42f61efc3e2cd37e0fb0a2723cece089c57d326fc39803b363d46d85db19cff160b4d5a108fb415baddaec2e52694f5ccb209da95d7beb3a888e5ce4d659e21d9c2d112ab98a14510bf8554751446dcd97000713ba44ee48e0b3c7f9fa2c17c4c0a4757847f70b3024ecf59f00571215ec5572d3dabfa2a19a3366125d507feb5f3103107ffea678de79dc184e9aa6d589dcf720d1033bb43b420a7492be1b076758ad6932cad6dd99e3e095c98588b7b4f2de0b61bd87a1447d394c4120aa089368251961fd1e889e5f8a622e908615dfa57592c40421ad5c87591e0cfcbe00cc935d9f181bc2cb330cb464f17c6ca92ed6a98a50a051abc628fcfbf4a4d7259b1b136974e8d6a6617240a5e8ea964e7ba3083f82486116ffcd00521b0c3770237bc85a8c53087b38aab91009f12c513a6a4dfd70e367308914307b6d5e98123d7ce67e0d5ad223e49c0b8b2221559c1ca6b4cf8728ef637a3a5cfcf8fbbd8a64d6ac2eb5ede84635aef413c34fe83729db2ac9da8bf9ba7ff1780d9874ed67937bcf4adae1ad940d2549eeee0bc0d8314571113cac26b79313ad6087376bbecdabb5ed4fa67fb2d4efac0eb4854962671a18f0d065b8f2fef08d04c63f5aac671d0d3e4943f3bdc949f5d8d94f363532a5b3124a6402871730261f46375c13927c9254f790b1993d6e181f124933b179a0b806eb8cba6eb939567e55eed2e3f3ee327ddb106f1e9a0d822162268ff86bcfabca90684f6c9f7e087f9b6f3376bc95f76da88bafe5834632d74dd6cc96c38137867786ffc97be68dfc6467bbaad9394e072ff173d6848338b02f4cf43189f68b6559fef1da7cca012fc2585f7b1a865274a203df4d6e422a96f16db7b7ef3af76bdd4af39f47465707ee98039ecc741184371c71bcddd6196a3c3a6787898549a37277ff31600d343a004b11195b2c1ed8045ea5bdce880997c79be479b7ab596471dffe229d4300bc9c2b7c81d416341f92b13657cf755b649eb94d9c01bdf9bd48e09635eaa346934463c4851cfc7baa0ec980e51d97ad397fc9f4bd5d365726a719c961a12bc2d96101fabf933e7371b671b33d7239f158114306fd938c554e4ae96ea8195b4f46757d6b25dd15fb46f975301e60c307df38d43a7ef5bb1e587bf08693043e74a0f3ff6b7d9d3ff54c98b0740facb839206d34faf96ca52ba0d5740de45b59d9b20bf6501105607530ab055cf13cf37eda7f185159cbaaf3f05866dec8c7e0d8c5ce54f94f5af6d2103e44704b589d2d14d97220fb0020501e77ea4431c066c6b52b78bfa6adfa1d4e648b201c86de44ba1a0fb46c7708d2bc6cf4a8894ec9256fe7b9239958a71828efc7d788052b5631e748606443f8404c617605e12a9edf6b5033580cb92ae8ed853f996e514d20eb2e981b4584cd132ab31feadb0a35e545ebd362f2c71bab62634eeeecf47bc21b490c2cfbd492c9fd8c9be6f13d29c954faebaca60188b9830cc17d183e9f4bd42f4ec127ebe1d60faa7f805f20e26fcca94869cb6575c400ee998add72cb768240bbbf6e4ab64769af126ebae2e736744a917d47ff4110bb23e891c177d12e9cab65faa6ca5a938a5a4629047e7b7eb6be41f515c31831f2b60646b1a9c77c3be250bf328955be99b1bd5947ab595701f8d031b194206a1ba71cd5b205b0e94ac8a9cded501f14ee31f5e3736cc8a480c8df4f201824eadc4415c140bd19d06c9e31a9f1cec00444a96472f7c766e0c5819f25736a72aff69ca3a336ad795ec316434d8ad8cef0162339f52a2302e64f9534e7a4ac0e26071aefb4d13b4c6daf6b0155244e91c5fbe4b94d4907315b11ae4ed33340af6019c64c73533429872d8dd9ca3436c7eeb52e90adf3dff7701b8712505cea021aececebf78949008c0f4aed80505739b650b8881745f45f9d97d03f329695b94bc1755838df05c96f14d0cb6d37e17f5bbf92ada96a816649cd7befffb810cc938975c0143a4e425de4ecd43982a5bb80e07a0f1e205ef667cff47db5e66147f1c8119cd0032f9419cf424257729dba63540d8961110aa81e5f4d2a26fb1b6a79d2b39e50c8f70ef5247e30a1df28543e0556aa0acb7f71d20bf30b4bedbcdafa51b08a29008a5ed84fe1ce8acc154b9ee685fbce63167ba1b87f433e57297c1441102f3e49ec1687790a7167f03ba29750caba375bcd37fe6ecee9f75867f2b9b051c42eec7782ef21d1483aad1e4c0feae824614964f441aa0494cbc53dc66bf51a6870dfdec0197169bfe3bc59bbe13ab4e3f070168bfcfca67147791000e5ca1387e817ed3154e8feadabc6b3d2edebf29ea86b6fd2eb094c1ea4f77e837232f1cfd938677c2f2b73dbe09fb0eb29dca19fc3164783b1bcb9abf46986d10ecb054117eb51f3bfde53b9667b353318eed7910cf6a162202edd5a397a36a8a2455958290a57e2fd27378be54ed3709f9141d3a5b04449c00d9ca4b5aadff5479dee113c87dbf5515ef626c2e0a742da29bba73f23a3730bd36863a30a8892492970910376ecd9c9a8b45211b41283da8ad166475c6d7182342828efba65d7e7ab0a565c7dbccbb17f2aebf00d0c664e77819b32148c54bb8b830735bc1871612e3b34a94283d44fda8a8d569b3cdadff1ba57605e61a14ffe4f5c1fdf4ec6df9ae64b90af3dd96b6282c05626c559f1f47c145950692af34cf1f8fa97044043c06e3c9d9e4b7cdfb4f95098811973634bbf8a2fe7b326de5be238d1012583b4d74971b9ef9486011efe79ee12477efeeee93956e6bb22344d4be14c594a969db7053d00e9dcf755820df7d0d5ec86f47c8411112653204c5f3ae64232322ac63bd42262ac03bd191bae00ab1145d3923e7183fb1f9922a493960b36ab711c17ba8b2673bceeab86f0c0623afbebbc1d2658192466a7901ab91b74fd7d979afc3b12df32b62589c5dcfcd21ae2f4eb1a84632f1b1ffa67e63f3e30da29916b23de3fe9147e9f07f633ca85ffe8c8f5024fba4681a94e30d29dc2118b75c342f4869125937770ce85a210a7a44f029cac11332c37defed491e8635f38b2928bd82d44396fb7e1f4f758f3710e48d9a74709a15166b873724fefe9dba46fe0c0859c13b26845f97853930326275a494e6707b4a6a204a94822dc2d9ea20dee301ae6d086523a03f5fe4d93a964d87b91568cbe40232dec7dc6126601419babd7726a83b2112c17fb2c95eb99313d46eac37c99c650590c33b62503274bc5829ef8982bd18c8f844db24addc0e4703177f66725257a54fb2c7de7b709b941b63541e6217d751f7dfbfd4b860ff780fcc17aa0ae7d818a6a159304516ee0432d48426a65cb4760285a5ca72704aa700fa1281c364dff8140ddecc9888477f7c70740c4096317383ddafbf2723bb93f70c2d99e35efd7500f415242f069cd00c4938723b365f9692cb0f800d99689b1b921fddaa34f864f3ea296473c4ad77b00d018c9365a61095e8f907c8a1be980830002981685549e7fdfc85ab58d53ca949d9c38e27409ca10dbcca604bcb552adcf19903a84a01940ee913cdd17aa098b3b501b883f7ea4929606f4005ba5761658f5246491b6fd0c6ab2506faa20d84bd02695192bef4af54a4397f21ac9b644271bd9abf3d471a2841a97b4103edb2f3cef9da970484a4ce78b496f0d34ab056a5d0e659110ce8de054a062ace8f18d9ba838e0802c5ebf20c5dcf533c488691fe9d6d668a257463b2559b3524dead146435e4782e9fbe0cafa8bea4e52c0457f444f1fcc5288f3c543e146e41c5df3682982e07ca73ea4edfc0ec0cc594cf8baaca5233653f9468ac766172a1eb3df54c941a456ed574d18f960dbb73f76c13700f275b552f2869824f063bf10330508a4a0136dddd5c8f786541c8656f8df9bedeca87beae6b14d2ec82dccefe4879c410c1fc5a6cc19576359db88131b061b4a1318e0fd97d1f641c723540ad963e2f474e6f67180f5eb47ef01de516a4813b1b0da8e2daf8b6182869021a0a9b1291ed59e0eca632c7354999fe1e1c0492f92d28ec1f38f903b927aab77954000b27de26dca34f882f08bf5b33ad6d27166e16daf7576b87dba24fede6b6d45a6dfe36945ae7005da64088b5b939a5c1c06831a986035a12da374ff6f866dc284c09985196c4dc312c41ffafe74b63b0f80ffc630b9ef5a79777c7994496f140126c79d73876e5b2acfca4aeb1537bb0c2fc5add5189d36b7bec5060af83bcfb9aebd34323ebc78073ffff50b28897159221f3c7520256d29c70b32a56fd7d32966b86e79cd374241d25de64c561eb5651f5f5d0033d68b9108dd5cc118688bfc371fa60f879fe5f259c8e9185ecac236eb9d8a713f9e23c64f918f7c6d4724742c01c48afdb4e935f92b183130172a109558a1e41bb01354aed46dab5b9cdad2b7b79e4fa31d588da470fccf3bb692de4e0e7387856a88f7da4c9d0f3b98429a1ea5077f4d3367d55b4c17c3f7b036741239003f0791318db46d28114ea8b2c4283aaa3f96f2f13e29888a83088c783565fbb385bd23b015778508db394b7656167e31c562fda7034086acdc08c4613872429eb68bd8796ca1cc92ce95589533c1261d6ed846df51250e22aea99d76a71c6c3d53b42e569a4e6e91cf407c3d1206c428744ad4725820e9ba2b5efa8c053afbc5d13ed79e13a1a6ec408e092da447c5d7130ac47440cc824c62025938f92a02939d42d039dc73ca0a54c18eddedae40f98cda25badac13f37c1ce9a82ec452903fcecd4da66346f30e62369367e3ed1f798796d336e4e5debdb9ae64a9038f21d5d4af3a9ecb4fece6fc915f1c7709b1ff97553a75853abbc06fcb6e6e2c3aff0bf1d6bd36033b22376c7c31983fdc36c8b0b94c740440db7a03a324cc446f2b97ed0bf54585a615b5f2a46590cbfb7c870ff6f6828e37386a2d63df326beb73b88efbc0c8ad26898293197c080200a2d45a2054969c2339ccf0974dc67cf2b5d2b2c305f0596424c4f7a741d73cbbdf60a3b2e757e0618340e7d9bdce3a4814cbacd901c45acba98d1cd83be0ea7c8dada450239de36f961712f44518764f846ca7c6a4c3dc786be452811df260ab2ecd9229e7e5cefd196980caaf0fa13c7d895bba2c46410c5b1b3bd417498d57ebd5e6bd4b9ffa1d15a8b69f6837d5c7824c68a152c0d19d955bdd53556698f8482b31bfbef0e958a644033324ad87a3cdd103e4d6ba8fe18a44ac052041fdf6dcea39d71e9319c5edb1701d54ed8bf129c2e3d2109431d97cd9555de90ce94f82a9567053d6a882710afcbd5a89fef9949d956075380aef225e2cc7b02b01a0ffd3187d2cb1d6c5ecc32c2705f3b07ce5cac9868c4b605fb3966f3f919ac332990746f52c11211b30152e1f012435be622e1171f49d5b6cfd910d9108c93faf662164bf740c1d2254c71173a195284628be7079d79ae262afe39201ca804fe9e1fe52f0e471910d4278a27b8c720f0fe1f24a20d35aeeebc9b14d64158c6ebf06a13f71c237f97aea1e8f155ededd5c28fc9df20f6c50727558c56bb98dd115ab178f0386dccc76c784b3fd165eacbb44332f79e99d952fb9b478cf3ec558697ecc149f0578c73d6b15f0c37648d27bb059330cea609b84dc69ba5e2054bab746abb326aeabade45981c4f4c5cc8e0d18ed3c3fb317b473fbe5ea8170adc8c507974667d00a40366477a3e378a4908f8bbbcf94041810d344b6840d0910b1058a010cd3ebdc3a805ecefe45f2e512035dd6669c4f6854a208d9fa8f268925c0d51cb4c5de29f7c831f099149676f87714d7ce16f31e39e0c99344997e49f1e75b88cc907adc5946bc1bf69fb9ed20e4af985a351b4f798d4d3bfd7bb93fcfe55766c7ddb8ea147b197ec17821d723b64aac425ef5019c967d9f8a45b1a395be2cf28f4b6c6c502b859dc2beac914020d0fc707a7d36806218135689af9b190494a0c2648682867951ab36c4341b0c214e9e65193e269c6122ce143efb526c5cd15c26774a71a986b2d260a4804810facf1362f256ed08f27598cc53a74e8b81191f9765393cc53e3643ccc6f64bb99933c2759be6e9f2f179c28b7cf5ac327de8209c76e7a5aa54e7e8517e82bcd20b0f2fce1b3bc62e4ed7cf7a5e5acdd1094f54142f7caa4493665b8be6a6ec3a1ab10c573d7573205c389d428da3c0956fbbb0b3beff29654d7212ed0556574631680ab1a84bdcb1aa4cc0332351dc34a7ccba086b998ec564b29f429d9454f6d541003b1293175ed31e54b212cd6868513123be09eed5b703a103911fe021e4edb41b81255e319c7d23602dc89e1fb0dacb07c1e91153967a07a19d8b32afdfb647d261338e985a48995c7a4086e40f9ad47fcda49b99451b5e286485c1cec0e1852ef3e11b546824ceae03aaae739a9b6c00ab181657ae66fb52fd253bf564222b09642d8cded40b7c25ee1d69a1fcac8ed1dec98142aaf33accaa12a939ed8d5ea331daf3721c5e7355de4ee20bab5d64a53096466a9acce21814926b6eb6cb019607e541a4606a7a6ff5b7c851d174f928cb744dc86e6bb3b4bfb5eea6a297ddfe06801d133953ff02502b8f6bbbcd0e8cf1d413d9cd61a247c4bbb2ce6506d7918d6eee0615e6a38218a85c5e5a016931164df8816032c02571d0d25c355e40d7aeda70a73f3d3ef90ea0e5108658fc4b8d79ff235436003a817688fa747ffcdae439b4d8d64ff917198e8b791cba1fc8de1baa0f17be8fa353cb442642a88fabfaf7672a6b3a61e867ce8562a6175efd4a6379522f22648b4d6fa1b01a4049e29fe010b998b16e0395a1bbe7878d5c6bd4d5977eb6928d44141a9608986f599f2d89cc37a24d74075bca83660db39b755bd2bce82fddc89841a1cb114f6b1a759eb0252936a9dfa2d1b7a38b5c7b9a0639632c59fb98c92939ea9747d86711c79e1314ef63af46358ca35c1ed69030d18e8eec599ae31010702d2f9043cbc497fc84c894ad347e0bfedbdb00807486b6b55b536a45ed4ce9ad9396232f9e962bbbc5b5ad87ca54b415c125d65bee4c8bfff4e6c96474699c3c78e8ed6bcf6cc157a68bdc020784f44a12b155f8aaf9fc164333f07c1ca16e199041a0dc63311ee94d9926671cbe4241d2e639c061d1cf086f90225b80f913c9ffd1b5092dc3d70bb18ed6beb51ae70ad3dff59b5268927d06006ee0305269bcfa53cfee1a5d8bfb0f4d4dc4db424fad731a5177a4ffd6a2c42e5f4999405771274b5cd3be38d74384c43298fb4ae0f0c1b23f47b59a0bb4e9fdedc7e3c6e01c6574ba95bff2c203bdec5345a61f254bc755b3a914e4393fd8253b2d60a8f5d26b22874771fff4328aa45d3d92d0fcf496fdabaa34b9dd8b4008069560e7073501b9dda1ebd5bb0da96202d8e6de6f9b05480deca6a5f6534ff6283868c57977014e34901c4b88feda5a3fff6fea73a3dd6587cf2c13afd29086696b4ca4a72f9528f6231f8841c76d0fde67a9ad8b186e78733052a56e8112f6e6c751c0f7a8e688512f8797e7aa647a41e71222ecf9eef4fc35bddbfc0c2ec4616116f9783f63d3179610042095a9ee2b4a8fcd5a64e2eae91c0b238163f4f13025b18f867c070517cf11759ac656c4b0c15f031652e1488f14f9977b9ad04c893ca7291c98c8b7a53394b506cba8a5d90e3e70dca1126d6a69f5ec11266b71c72690192c05e95588896b343f6fa04a59a532a564e801493220b368249c8de265f92585bb2a47ba738625c643c41bfcb537f6a88f16b9e69908b14a2bf60e0090a3ebb81c2b553d13fc8354f355d9aa1238328d79ccd9181ec0949fc1d161ce2634cc685bd596dd9726f318f7163bff69f8cd5dbb0522d9f5bbb95995197f31c4a263cf054a0bebb7dd8edf8bb23479b23177fb9fcd5b8548a5591b2a6ffbe0ebeb31e9fb86a62c0d0adb41c771986fa76b786ae3ff8c17907f4cdd49a1c8c570f4b72b716b7abc1b5f0fdcf6cb21c07c303a5dfe5d7fbcfac8feb84716f72a1bf68df3d370a18ee56c3ebaac10b79a24286d1661046baec8f7824c4a4f4c3a845675acc5ee3ba308ecf7c4afe270350ac8f713d8b3d186ceb11284b04769466d31213436f6abaaac98700b7fb53719d492a62890e133c2b39ee440d14b68b239973056533a339b07bc3cee67775f003d9069e8872afede26a80e4451da8abdd9c3ad577b06a837b031d7cbf3d49da9913de718c4037866b5ab3e14595c2fbc29c646686c19b409feda91a55909a71fc9398e9ebe1bf8ba5298bfed3b861392f67bbabc55f8d57b8b0a2c2c799543608899b8e732ebf16841f10a1cce32c3cbd7618c55657673a0be67af215b4a0dca8df2cc6a93efea6c11447ea572756b134a3715ff4dd0550e67bf280b5fea1c524a8720f676668008e4258975d3a0ec68cc4f768d4119350e6f76d56549170ace2e3c9e8ef0e4069959ed8965c89cd945fb9252d707faeeafa2f28ae965618502546a035fa6e318f97699eabec0f7331397db67392bcf0e59ceed101778584b658409a2ed0575151d03b4ae353e50e828650b97efb302cf2be91b1429218344c0039d14f5060f38c20c94fa22ec1b0095ae52b907d786220307e9e41c84b4acf622f2e933459698184b32d8ef5478140abc04a1e1d7e45d722e71e6625f0e2ebda83ad8eafb0f08b9a6b3aa4061929f000b1ac1b4e4d6523d5847bc2374e981b6e13265dc12e6e3362e1b68a8aa676d84a7f14cf4c2c9c128f73c46cdd58e0616501aab592256c1d9dbcf6a71475db40d0363b9b89f5ad356fb313723ae1ee42914db4ce868c7ec729faa8603fc6adb74de34f70e8c60e2dc4e56bdbb2d4ff0bad4007140ff5b4681160cd8b825950bf591a2d5efb73e0ef3638fd1d4673b32c0504f79a95cda8fa4fef69f779ea512a67e61115a84e2fa248","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
