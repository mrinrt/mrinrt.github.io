<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"01249966d7ead4efe5878f5295bd0b7f033279f4214d9e384caf582326286b899598ba35b82682c1cede7e95b462975e435414752068ac3ef90aaf6f9b9c3c8c3e915db55f1938c9560c30d4b93f918cadf605e32dd262b5f151ae72781c57956b87fa5e40c3f53fa57f201bc8e70e3968611d1e970e50556d73123a7c5458dda31260bf5c1ff09d0eb7f2f7cf79e9457b31d4bcdbdd9a267fbe725fff18be3f7979230dd1644bf340062efc9d97d0dc31c4d0daa689d2dc744caa77368bb4b31fb61a98acef7c77b4d97bfcb0c5072b2e8e0c714c05b0caa25bf3cb5995223e5d5dfe7d9bb011e9d326d16def97aa89bfba34b2ea23694a0a6a6beec10fbec09646e62e98696f4a2ad8fbb194e873ff8a54d521f5b240915b5a1163463aeb1252c6f72f8e9a821d8d22f027fc67c0238dbb2ec5729872e3e93ac48df0b5db0613776ec9c7490fd57046b5bc5a3551535c0de47e933102d69871766dbe502617829b8fdc932d6e935607f10432c1c0b3b6d14fb69df61ad6d0a117e265f639586d274f85a9e35500cf58161a4d75e9199a48d38d22f8e7a262b351a3c13e4bd159d7a6302a5d2dcb462695b2ca5314defee174cdb1199fe26f8b251c8fbb6e872c5dcf064ba19c2e17f4b4ac8d5137a8cf4bf9a97788e8a8a069c0dc474f7102a1add006a31571c029c94f980a115f80e8a76430c502e91c94dfa50080504f6f4b66c203f8c660177f463999161ef20b1ada441aff31a4041926cdcae6252e1030ecce6f3a6a9649e0e1be0646376ca4df782acb9d8db4667a605883f6c3217528205d82bec74d2891d71e77b66700307f9f7502803f77ceca88a6d07114555c0932dbc9cd28779d1e2ee491ad67b795c713c07a6112c9e9df4ea72888d6011f6135f19e816533caeba7a6ea77358f060ea453a7ea195aab64d13ed5a37794ad607b0f588288b5d1591ca692530cabb9f1ffe14cdc3406ba392f06623de1ab718e27524344c2b704ef2eb8bf444ceb3ede706650537fab0319767b0fcb878a0afe2214eadcaa67e0c0d434b3d638fe829f248c0bdd29860b27489e349b50117d137e40e90cfc97f8aecbc803dcfddc14702f9257f54dead1c20efd6df89fdb6aeb304325be0deabe2fc7dac96954ae81322a24e58c73a4fdff1928202178bcee12e5d390e5ec2a2f210341bf2c54da312b1a381a3c0476b6a670ba560e1d4c5938e037cba98687b4a1fac8107757766a943b3baa061cba56ac274260f2c549a1ef853ba6d98edb1eefe2ff69be45ad50e9f19783d63af23646f12e71e64c5312f4d7c940db0c68a0ab35c28d4a3b43db4859b23cda247939599e6473ed535778906ebca082daeae10e84e257c1f7404e2830296908e80833536d57e3c9d14f0df5a57387c25f8776be611a8ce3d110f668987dafe1e9b0dde57bd1afa013b5054aa2db14ebd20a90dda1f75b2ced287a838204c435cfda1e8b2334d92394159fa018c2be88e548070a2dfa7e53c5d4bbfd962842edb9b4588e74a867523850f64321a95cdf09daf4e7bae735a994e2536d550a071f0dda3f1171c21eaa3a6de284cf7060afa7c463fcf5cff3d1408b6a91ac00cc42c0f02686fa8505a529da4f698ab1adf72416453fddf3e59eaa787c342b9b4afb23d5804bb61c5397e9d6cc7bec47315757b3d2ed95cee523f79e4c590098adaf1222c592cc53fa2f4352e00dd55c7a209adbffe29d190f7344b38a688da8522bc29c4adce25794166ae6da4b9ed65686366ef1ecf2c439f591221c1b2558924762b1cca335eb9c5eeb1e1b71cf2490595cc0b24329ae8951c40eab5cd10476685400d5c53e7c52aa19ae334a66da63067acc1352fb890d656e344311671a883dff966280fa78a36b8ddfd2961ea847939c1258388bb7c400b81e097c4095f91a3724fb9ea4b78ae49005afa8c1264fad0e84e36d35bb29ab9d01793e799815860c68077f4153d0c62501a3998253c163d46ac5d9aabe831cc6695237cb3b69f81df75c1b0a218b8f2038421ddcac7d0553546695e727c8a029d89952e3100be5fa1801a047febdcf2529ceb6baef71d7d989d029dfec7fece2cb28d80b784a246244e0538ec18a2d3cf3ba9097afd08965e29f113c98e93eefec5507eb9225428bc2f90239a817463137b5c499e10c0b23b7242a98e004dce8d2f42793daf5fc2b6e4f8d308dd5d68ace0f36ddef93248b03cc7ef2860b47ec3fb9b7b12b206375c43fb38573d11eeaf060e038f957dacb2474c009030b29700cae8ba2c672b1a4e17b81e332b40c754553ffa8bf9182414e3af0f516ae7775380e4fffbc67e8ada1d4973afc8d481134396f4d638bc47df41c708876d095b3ed67bd62469857c772911e693f70d2a7e8c003cbab425818dac9fa559b44a37db61abf5afea1ba8c893c733c966f4b0469450d1a18b90fb92d9f00d2aedf57a831a3044ac8ce597aa16faccd2dcae69e8d9862a5e7a7c40f8e1c498f06eca5a7b54c98e197aadf16ac0de9d343f0919b2be26cff6fba76fc783a49aa90daaca005a2f45efce16ba0e31f200ff551defa1dc0393bb16179bd9e75867af4900a0a30399452e9c84605dce5c6e3616828de6a59149cff5ebd7cb92f9649fc19f8da03ac87d1e11fb7df76da53c75c42617e1f817ebc44cbf40375a6441d6e81d49865f5ec56c906ed4a0063a7e870a3f591fd1cf50c2616a75156bc4b8aabfc49518882c44100ec8f38f980146541d0c1a626e75647ea9ec35487b7f05f23092fbf717563c733d13d362d7162bf3d0ba03185e31c854665791fa30415798cf1a5deb74de3d6389424ed6515cca5142bdd8943af2177e0a3a9b01098d4c390f93bb6776a33f7623463511b64cfa7028373ec28e3732a84a437c701ae5df60a21b9bed69cff837c64de82fa4be98a06bff4d1688bbebf1b5a81d338dcef8834d9c08febcfe6cf8295f6fe16a861447bb62cb6189563482a2e32c873371085b024d14fb632c4a175119c95120fd1e5ef33e4aa2322f1460a4affb9cc418ed12c39e9180ba51f3328b77e74ed96ee8ffecb73e24b69a5f9b8247e1207611a740ce92072e0faf4d63d3b2e6d6bcb2734c8f9a853b765503edf9c7fc400128632b118430162e508bc16aff866b89b897cf81b87323f2934b1c465e47a010ee663f40be4a9625a3ec716c4f4a3e71e66e6338b905e4b43a116fa72255ed0487c2b4855cf70912ae26c10bda2b5eb87a53282ac3dd246a7e005da06d8052b320066918276c24524eb7c13418574026a046348c85536f9e910810b6b2562e1510019b457d49fd03da64472c8c6ee53450675335074af2e4ed9ad0f6b2d411bdea16c0bc16a73a6ec16645139c4020161df88a68f2323f18f7b9f71aa567c7e97271a329ff8586833f56b8ddc587578a762685a6b498c378eb04c1819837e49ea0c8ef82fc1d3ad97d50e4d0ac8a13b7b3b9c9db62df4cdd5be17ad01a29e810472073f7517cacdf96eabf477a3bac54a8e9c1d1009b8aa58300fc2d383ef751cbf4aabf55a4ad14761bff346f2999962821353f61450be63b5be1b6c4637dfa356d55d59d3ca19a841bc4900cc1bfca5fe835155cdb44a7872e341e3d0684da007f47c2873998bb9ca7ced8c5c063e51cd4ea7a29833a9a32316007cb7c677395f88dd3b53744fee269892ebb30ce3c9acf078f5971fc60f76a90ea5e4f7d0df227387fe3199fbeb3fc2cb16945bc58a0e47b4057c64bbbb16fffb2a37bdcc172e1558a3b9620de9b38778591606e476a0de00cf4cdfab7670f7234a78ad0cdeff5a7db8ba660c432ddd5e83c2350d17ede376b6deb28d560a2aa53ded4ba1da02d801539cad794c96b0f303d596cc43d7f69cc42e60408f80bd1ebb5412606f145c6831a9cd64035e8c746590baa57c3cba12cc2820e30d00a32eedffe77594441ee54fecdcaf56abf81be4bac35d9d06e1275c607edfdfc3db4de09df1bcffafae379dc2f930e8edb17f29112c55830af321cd009672babdc9dff122997a4f5560c473311e4175bda1bb4f601722eaff3aad1089ff6b2eb03e2c0550e555f2724902102e81be96eee915b8a904ad3001a87ff5502f0ddb263cb6fd50235e5f3962111683c6eb7b3c73db65584a345349055ea8700a91164e09f17c0271f37ba144a595361bf71e1d16b94c3c73b6ae6eba5462b134f661c256ee9e93c4c008b92fca7315e7562cc2cca7631048d3df4aafd885d6670d4a56ecaa56715ea425cd1fb5863b92d4c7652d0890dc810be01e8a222d61c3529264864879b2830f0810ac12d1374ce9fc9f494f039fd2c79e06b70f201376be7c37bdcfedb6531390fc11e923148e6383b7a3fd186afbac713ac1eead2f813277715bfde69b7a8048c01ab3b5afc4bf18efe50c655ba8cebe412a46bbd817538b5c56292f68764f8ed4d6b56cb96dad9c899176999f051f82dad3c699d3675d42475099f340dcdc689819b1c292660cac3405f9844f570e65486ccf1d1440409419ddb93e227b91a7beefb1bafb9ea863bd90ee8cec062908e38369a88bf9a82209a7dba6a872abf1a344f20c4f4f8e1f278d26c88401c86941c2c300852779428a5c00ec34f82208d32450eb84cece14dadf330a6ed6051667a80965998639960a8b1174dd6ecd00e895fc95e691cc1d2714ec2cfb27fd40e3c956c88b54059ac9aa8861b92ac584cd6ae6c45a9068a1030357f9b830ce96156bb8dda2ae83bcd30ee4cc23c31ec15dd9dad838439aafedad72b244145a8623dcce7003cd6dfb2b3ddc32767ccd5a0d752c138ae95128b436a2b14dddfc8f784132c2fd2985df5c292f93d5fc99efda4bf76b5b5a37e366792bcba58a5e626a124351638e80948e3f8bc9ed5870e2ab60c1024d340ae7d995f24c0b5d7432160c513656169e5a15b262464f26add82ce1dd3f48f8b70be16b9e343cd2949d596e2ca27ffdd747feb36efb3ec828dde3608e5fcc3b5eba29178c4efa87c9baf99824cca619a31bee1b72c7e9ecc98c0de7c3e42d6722808f5750baf1eab0abe2f7ee495bd125ab27e02746101643ea7ab7d2ce764d941ae7f1277a3d6da727eaae6bc9ea68c14fc74e8784ad87040c7b6cfa2a41d6ab9c7feaa07eb38b19e990fa66ef9f730f9141d3a7e65573b95855eb1e207b87243ede4b5cffb15989fb8c8bdef5fea32efcd988afbfec182815063839034a5903597029cfa65590e7abb764916723a1538262cffe25d299a94883222eefa3db61d47ddb363ccb476e32d0992f7ce2fb3caa4fbb48bfa6eeaf96708c5447eadc3b13ddecd5a352be9f61691195f81ef9fa1fa4a4b55e4bac344b394a2df6fc9882e13810a924b9d63beb608fafe4e9b6a726d37b0b0a5a84198756fa20d068a3a92522ad613995dfc5ad0802f9dfa51d11a453fc820fa52165a0c27ef67dd0d06036577937ae88e97974c238ca64960567f96da5600c58a476b1cd4b6618aa2d97141687cfb3debbd10b4592c8feb4c2718f58c9eca6464d38541cd22550012489e24e1f961f4615c9b4900f3c9eb870f7d5a8368bf73a192adf7cf130a482bec4c85a3c9570c9d695ac895172486faa45d2c823caba767fe5a1b27b2cface16fd966d4df341bd5a4c9e0ed6b4fa10fc61c61d6e09bfdf1492e1c1e15fc79f759d33ba006eb03bb84344a276dd82189438ed5259d68000bee732a8d57d218fd5aa39efcb46a42ec6c1378caee0fa1c11c0d3283944bea48dbfb9a56df889aca158ff3d8e8cb409180839a7f92469136c91d50886c8c8c34465ecc1eb75134a86135b3284135a4c19bd3a9207b2afd7dc4d496f1d06451410a74df1fce2858818b56bbbd5b4565bbf62b4dd8906ddccad2086a00a30cac265f35ed52994832aee73e73caadf13494de8347b31a7598a2140ea8abe5558afec0fbcaec01343ed741d72eccf83006d4d581a27fa8b2a7a5a21111e8350bcbc5c2dfdec120a50e8dae6ab210525b70e532f186513a2baf95aad88ce875ba532d0f690ff33b65449329f84c3ab0a44d006b9d5e603c5446b1cdfc668c5ae89276cb7d367572c74f5773b16da0f84df2431018cfd6a81a67b47b4f082ef4c6d6d252a4d8f1eac2b2b2c6ffda9e5dd6efe8538f9f4ca1343327717125612636914909b1afba749e180c43c3eed46da53b9e388d3386b28f75b95ce5e8601b5855158c229473ccad725b09242c3b5ef19680715043fc20f7a6f1d057b742f4c9550d95dc70da37a5593fc8788896defe68c72319772e488801edc15e8310f33194c626e7ba624366ebadfebb4b884f4e8094227788dfdcad26da73d77cf05ac35c9c6fb79833a661d63cbebd8b36ea4f72a8cd642521b5ca63cdf96068bc4523f118f8632ef2a8f9766a8d94da86b30c8fb44407d7085f7123cdabab3beaa612498f34abb38082282bf60805f4d2aeba0c755a1d45509d550d719b8bb590fd27c62f63454db5c22594715efc308b0a7ed181c2f63aea263cd3c65274477d711802ee4134a962c74ce0a5f944ea748a9a94e94e175422343c2744bb2997b0d64b346e8f35a3e4dbf3844462c8e0906f32165a9b7b8c2951f27fade499641750b23159f6d808f8ca49078eeef0ba72da5397a40c76d4465c160ce1bb810e98febe86ccaa8a4133265e986814a71eaff0b0c1931e7b7e11a81722366e05e17cdeba629280574b66c817f2c947eebd39f126d079b83c1ad6a27a7824902b25b48fda7dc8568873e816ecefc07e1ceb7b8b872ef58bd20f40898df318baad0ee6c257621fbf564386c7947be527b17559407d9999deb174280b38f756ba48aa3f8b95b9d513b8c289bc395142e4db307fa6d0f3fccb0e0319f21ea637fd674026a478ea105b11da8664c3c7950a7701dc4ece22d45aa88583aad9cdb51d58e3374582e4406e11216e757d7a9aa020e6e38ac5bdc2cd3fc17b88a5451bef90ddc43c78572c3d9ec7f0b2c382250f9e54e78283f4c8b1e5f714470a603a07b7dccfa8bd91c2f576b7a4198b9547bd612f458389f3572575ef2470bacaa932f0cf2314e6aee1e62af67f31be1df2bf81a34d0f102261115abfa06acfe163abe8c83ca65b741492f8db4232d6b8c8766255a51a1b83c925bc1ef622b102bfc032aa59fabbcd1c785447819967a73f5134e3fe47c89b4c3c5d580cb75610a4527660c5ed04029a8fe6bf7b29b0fedcfc4d714626141d0b60cd444db0c43e3b18de3a34ef9ee2ec7d5d7b5eb549551519a1f3bab93c70110004181b2ca778de24fff532224fbd8feb23f38b96b8d41b03aa222a5568734e1277d1ad904e63ebc855a998525841b3d6a432aa300d9176e0021449f8d3eeb358ade0f14cb1220c270e820ba0002497b8f6c90a7352dfceef4818a7e5879c6d25e2d32bbe6086a2dc2a66bf2016ec614f22db19d70857ae35160502f1ec1003ba76c804f6655a9df77caa1cdbe142a129e1f396ae6b2cd5f661e3b974f7a020b962f9232a09dd0c634f2655801e9788d3be000b523455fa1f83e7e9138b237313a203af109106dec06ddc4aae11c0ca0945067d4e34be7a8f299ab69ee70bda264c91ddcf0a03d727ea1f719cd0442d4c151215814ecfe8365a3e7ef717ce3339cb88d19ba213d6a652067f47641009986b494600de294bddd8039d1941585cfb4e32617b019f919edc29dda919baf16adec110cdcae8b580fe9e7d038ca356743fa0834af4753a5401e33b08927e807e1c3d3d8c910d2ef7c0ef0c2796f3dddf1833b312c70677961d94540b19c1724d798e07a5a08c8f4b90d1978338e0f6a1a1d963c119077b80dfbb7a90d6fc9f64f2a7b41ae7ec6a2e268b9e406a059f358c32c420715bda9360a3cfdd357d82beaa5ff5851bb65067d188e40362200ea74d21950f29a8800e0cf108758ee2fd8afdb8fe530bc91d3d8ce8f1d97edce70a5fb6212513f7b3e1c8872ff0e81abf0999cae93312db7999dece9ff0a871de26037689c77399b8280f52f597de5fc18f8c44575e1419129ae7bf85a824be5ed72f8e5705dd5ad932be6a28176f571caf9aa99338a9a85a290ec9c78718889955353f0b5628e45c10fa6c82b1b5df80195b9d2f53636f11a4a34d65cbb542256591c5cbccc7f50bf0800f747547b5697cd9d30c8bf4baa96c7d08e504b0e56cfe109d5ab6971a5cc13cfcba65720413d3aa7efc5deb63a1dc3eab6e1c20a334bead6567a7cd94a0d8cc59b7c3d8c9fb72130a67659b722211ee3d1b8219fec62f67cd666fbff167b1f0978c425d6ebd7eaad230c2d885feafe270515d2af2e0994665a92ede24baba754f294bd9807ff76f508b84a0f4c81e22e72406fb28c300f67455997ae765bc929a535b5ef11e6e59044a928b78504911a635d710c82f0a12eced8f4024a7c336f04de43c837215fe0da77b21fbae9ecf4374df01b00a9fd8d4e6b816832817b9dd08154aa0941bc3562c84e9581a45d36e1711e90e741e64c0f420ea282c59cadd5d091e420e573d49fe8ad2f2dde8c08054606a68e43764e13e714ae04c6e42c5d413cea4a5e1d111a9a7b0db05e3310e49811c2339a6b26eaf72ec67cd1891c3ebea5a04efc7cd40152e6d94a4898cfebbfcb28e1ff37be1bf21ccccc17b525b90e17d0283ffde95aaa5879d2450835af11f4c36ed465771a79c369e87f6f173f4ff65d4b1e7e36c1e7d64c81e105b582d7f795aecfc1815f781c27a98105d7c7271a9eb9fbf460642434992899514993628e8bdc1952b00217808ddd28dc777ee7a7e614b79c402c48d869f7a1aac83aa7f4f271edc2c7f58a08cb2490e420d89ca44797caf839ec415fad25ea4eefca4029bfa6aa6d82b3f947c70f73c9284d93702980cd809de0c6be0b762262d524fd418ce7797f9a8393a35b885a6027685584cf8c2c0f0c1371eb7516b8626dad2366aa5e83543dfdf4b264d196ec5e1ac86269742c032f2bace5f19832bd6129b6a9ca2dddb4f373844d37f5ac233cb12a4bd993158203ec74940582237b260cad0f52be5a828452488de59a7c019f02947482bf16aa8127ea76a29451cf813ffe1035236743e02da452cec16a1d5e813dc1ca54d83d9b0bea12013a8cd5efca7ea75da41a3111bd7434c9166a3590ea00aefc0f6e0cc54e49d6e92923d371d6c0908b6043727366408df78a9bc10b106923365b95db5a8f990303c5051ad1f117c412672692f134e8d8ad71c398ee0427bd0b6d57550ab5362376f64d19ca6f79f406dd8313fa9edb2bbe0213c46cd237329fe50858c54a141f285f3eebcb91c1840146319239ba2e64231091de7f06fc7f982e9590a457a659fe1fa824b6a8ab6c50bd1425eeb8c1bd9b26149a39d97f22ca85b801df52775f5e015498d32c6060794c5a0face8cdb031a9366f0943cb1b8a046db016999f9b8beb6017d74e333b6659d7e02ff1f937e3939afeb469230ab2ed3726f029f0727fe17b2d70915579b1f04d62e3a783b211a680c148e62811686bc7acd0828cc674da4e43e03b63c2b892862fcf4ff811784dbf10c7291914ec81cb15115ce6310f77eb86143e68c563a8b1c6aa41a4ea70db36c47101263c0457adabf2e8a7f5e1034cd3e7535ecfc6428cd66ad62b914ec2ef3cdc923607ff5ebf9e71376d857065b4712e401237d8315df61b9eb4ea451f7bea9bab5a70a940e85b2c1e978c2d01cb2e011e45ffb5fc578b3d38a1c4cf2aa16f2d633a3da003ce59360ddd18bed2b6cd65eb311a46a3a320df16f911574e5496263849eff5d7a1ecd10a6124169061c0f93b81985168bd6e2876ad789a127911bebccb6fdf3ae9d20bb8a06109aa27dad274c95f6d06eed8b4e2d57531550ac59e379c23f76bb24f799c1cb9a4f6d8d84483f6280f680b9f58f9845fe846e8a7222d2c2e4835867686ab1cfcad88989e65c4c77878fb3571cc532d17f3fe94a63054f752561b0ddbbf1ee606de71b3ed5bad47afb3a844edd09ba7738475293f1172bbf847a3da9de9600c6cc39cab70bcd70c6d30035ed7f26b8a46279de4736b242e722e0331d07ba0bb564708c6f8ab47ddbc98661d9278c2820e60fd9fe5da95c0daab757520850ae2f405dceb550a706e044c10d4a34022b0514a6d0d407829866c2326f9d877b7d168f429af85d1324ce7981369f769cc1ee47b09c97add2806fe9fb73549b5d40cd5d91c67f81a3c79f7ad78394bde6cdb8d6d03c905f737a9ad2e757247fd22aaefd5bcd5b108c506b701ccce0dfb0d10136e3b0956ff0c008445c85d6f61f35849e81bf0bbc72d584075172507e79325bcebb79196d10fea0b70e30765211f0729b78bc8e7f562bc655522ac1d51dafb63065111ff114ca1f780ef88cf65e84b2321b4c426bedf116be4e5fd12d662d2ba8bb9ee6d5fcca11cc025fa6a9edae335b9aaec03260a1216b503229e620e64ddf43e66fc010be89f38fc9aa3b98c1b78e7d476992713591853204102b692aca176c1f414f25ca511a64d2941c177151533a3160486fc205d0e76aa4d3a5f600777c8915e9bd56a4d0c0f8db0c33de4349e168cc185402023685f278f8d2f57cece113f692a387cdf92270e437175e6438aa0c88d84cba601cc3de1ec9902ed573d8cbc7fb32139a9e757ebd4a5afde6722ba97cce53a300ec1e2f0d1725f4af31325792fb92246d087a6139267dc401975872d36cb028a2235ee65f2817eb0c6725880b711d5d84b6b14ad7d05f088c3cbfd6a8c3e9d9cde77f9c3170cc526cf3350efb230e15fc841296355c63aaa431ca70bf81253adb75c45b3b3d2f6feb7a7f518e865dcc6257dd756a83f4324e8e772d4aaf7f3bc4589b541f3e5d208b992a6e009559ccd0313db2ccfee7be39ed982323bd3e35c13b206e6c23a28fb9d3a477a3c89e4d6fc8b4a8377b7a625b99acb325d831c087182085705a8710ecc9470c7297d1f0effedba74239804f05455243eda4f9cf09636517c78fdea66d771cc42304ccdd4533349f846bdb4971c44c511a4af15baa10c2a58fd43415089d2f268d3851fb87234654f87a8ee94d609913b858afc68b816ce7e94daffa5b7f225fbbbcb0b1e4b21b900e0b017eb8c52a3d429166c833b1d31d0bca1ee5a9ca17934134514880e882313e137dcf774f5c4d1b9a13ebe85876a709dcf829c777e8aada11297f3f7d6e154b5c99019cae0816818bdd4872e1ea63e0ebb45ea7058ae1329595fe6741a989469d37cab3bac1857465031c27f2e7001b16034e7e08be28c83e0e1759791f496471c8040dbaa1d58ff40b029a8f2f17c730495875c9e75253dae1ba6a579e74e4d9f90430fa0176250a21dc9d0e57daff9a46d4ed735c22d03f8a1f39112c79e5ab12392bd90033bab3fb3054e15c4edb8a1a9a38b6df46b485666a9574a39d7357a64d67ccc2efdce1c1432f98d549dc30b8adca8af7c64da8b5930461e9f89a4af842faa45cc2d495b2bc4300acb501c1c1778eea3f5efda67b03833ba6a90683230806f4cf15b4d43c45a5b736ed585068d4629e4a09223b71e54b0dd71eba7ea919c26e0b4bea029bc02236e77102a2f4983ae560197fcc3bba89a097a26d73d67517040a6a5414155ababf6980b3caae195308bd95fe43a4cad8b81353b9b5ae8e76b7fb0507755889c5f6cdb5cdbbceb516239abe4a287ac34d5383434cc27b09655eeef8a6fb50fbde0079c188ad5a069797c10d3e73b89a07f13b2d49e7bac0f4f3141e11d69f51cafd11f5d4553d631f8f1f5814ec950e3bab4666f82f7fbe5c52d0da82bbc2554d58ab2884de9220f24d03c95545b1a85f50a05591445a951df5decf4930d3a01592e37eb7e8ed5a9add40ac6adf8509410f6c994fe8cc9522f83d9cec17766438883764564681546e4234170fcb8c5597864b6f3caed52cf428a1026e6fa4ecfce07a2804b8aef91e805802b21babdf8d167786f918fb22ac2691552f0064546c4b69e69c0e82e933ce5cfdbc59f2592c58b530667fefe2212693150bff66a51acce7388bf73df2e41c3ea670a8462ade8ecc5193e784d75624975bd632e72158f542624e5dda7ad5242156689bfb031b9d2be5838b1dfd954bd1fdf22c49f61a22311121e8e716c764c78ea2c2e1eb509523be335efa8c0e405182f3bc30bc0e175d1623885cb12d0a3364b54468e0386f2296812cdc75e95e4b9ed1d7d368e24c92d1daea2cc4e64b0191083cccae978f51e1c1667e2241ca4f0de235a65439ec65482a713de3e8ccd96aca0bf4f680893102cca8e1361b04cb42a1dc952ff2f53dd366800693597bdcb9dfaa5e2d5c8a954987aaa6db929226b2eb737f109122045ec2e8c780439add3ee449d9e56013711cba58d98e5473dbd8f897568740784a6c7f06a6f12db05965a497895ac15d93ee9b23e9d6670ef4ef5f6fe53515e16974aca1bc784c3acd03639a325bb0bbfd2b8e2b449b43c4993dfe94bbd84f725aa05d69c55acdf29ea421b0b20af0038a75701c324094ce74e604491d6fd550e5d7055baf91898ed7414bd6b5affec0c149435875043c4459bdd42374e745df1ae9ed08e3c58624277f2c39cac435d730adc908e42ab8bdf123df03a8172ac9d8b9e57aba58759daa11063626120fc6d865e7a23976e7d58c1c13857483ce89ecb53785e1566496e0199898dcd3779100e82da23c1b921f55c85e3fdae5b21bfacda78934c897c5bc7a2ae8273c28e9423163f763da6660fbf98db0fd51bcdbd6826abe7894a65992ed254a3f04eb1aab34142a12c4def897ad2258eb2054ccbb6b9b5140a67f038f4733322fda54d446f67b01588d4b4a854d8a72bae30d04fe3972a07cbb12ad8b64e8fc206b2ad8aa630de56170dfb49e54bb263e3a79f3eae9e7774f2339b09760ce92550ba7b35fc37682087a6599627cc4da151cd3bbe2a8e8a119c65f70312e7db1ffda7f2df8919ad1dea8035b72b4605ddacd3066274cf6b562b24ae9b75bed520eb241132792f2b33d33b71a47852a3fd32d819db0724cfbb45e3c477d552f72993dc346cd50a4ce6782cf5588b328cf4737310386d729eb4466b1f764723fdd6d8666d4c4b5beae0422bd1cd567cb6d244095377774bf91bd302f87899728a4b9e7fc1b572267309cad2890073398b66870f489b3cf79682a5b262bbf98d7ad1082184666bc310f26216f33d3cd421f316665bad01e22056b1ccbf654d3bc6b29ead96b596ec5df2ee57c2f1f861d9eb62ee4cabaf9244f4b226fdc1d6436efc14f281009169c946c46930835dcd96af986432fbfa3dea24c391edb653f91cc8cdaeb7251ba1b97ed592ad3fe42fcd74d0dba28a05f81bb1a73d096e9768a3a0c32812d99551c2a80dc83220f923cd4237de77b09a1698edfec8473fa076ab923229bf83257aa23a2ebabb4b6f58997e14b2af8f23ebfcd29bc86139f85d18314b690c5651aeede9b1b8b63eac9e18406dfdf65fbec635d8f06ee6e61241db5c96a124eac1f82716f841a9d261b40046a43c08982ab27efa8cd5265dec2cb2de797a21029eec3ec97d66288bfa06b65807100c94db55dc9e59a49eb6474a73d09c11d835a6c4074b3364c4854808f077e8bfd0515c788d2a43ebe2055316d3bd84e1fac4e170dfe86953211a28f1a61a611406045797f962c0624f4d99e87256ade16251c99c94b97ab3fe8f9ad7736ee21f7548bc4801a70476a42764c090f65a612decf877f15764711456d06be75fec90be6518d0e113a51ca2f210b1a1444c1faa3aaac20e77627bd9f10820135398e5f17aa998d1547e3a0950ec603d57cf4c838d0b8a6af85b7b1d99ccde9969cf714cc9bc3966e0d55d13a07fc4be98c69d98918fc310fc428853357c7e36824af2c5ea28752468e627c932b25957a207209620ece982d50aa9af8a77de6c9cfaaa0803042ff1503fb9341de3897721acea316fa180a9bffc7849c856abcd47735d33b2d000d3a46c402f6042eb41f302d0c9a1cea6b09633ecfbdc2da7b8d368f4458a90940c53978426fb115fb6137df7ebd60aee6f678ccaef2f2b89634dbe213209d12040c1aba18f758ab0d75009173f9bfcbce4d5c6694e8682e3b413a1c6dbb99d736cb1090a906b491dc9a3ea2ca62e5aeb14df180ee929b6cd84506e17bc090eb06229edc490f0c68bb1c243d97ff89bb3ce5ec02745a4ad09a539a536df7d4d8e9c5190a4442f2cfe953258c4ff3d87924debfd7d37bd52811f903ed8a852e1d46655d4b915fac5f35ec33fb5fbc4b6652d7c39fb8cc4778ca9e9ec9b9e6247cca36df5a4430abee63f351899150b54d2ae9f89d398e568e0a661ab3747472c36f23fc75cb1a5b384a727a92d4293c82663c1f5a5003144ffb3b60b4f8937a23a75b365a8ec5bea0d4291b362cd783021d5ef6a186a462dbb4d9db8b96f1d4f13c2f3052714f618befb730494c51239bda905d065e56bc1c2d621021fd276dd6d0667f150dfa8d6383b7ec5586fe01850048f0b3033a65d1ab34159ab28bddbc42ccfd55d4174e058216bc7ec6c6c68d6979527bba712e5df96958014b31f1b8f6947ee4182f339e493481282fe37e3c4efe346c3986b61631a756016dc3eb89ce7f4497072f32d7aea45e7fb02053b4c26514c8d0ef61b7e3700fa14ed3f3961f1aa7a10a8a7864810309d7e08f3459617edd1709a7c8f64846449f7decf10db80a17928a3f31943b84d0f8fd1a2a296c9838659f3461102497ca10baef0f5254904db5f2feba3af9c7fa44b164b39d20dac9a0df6beec46255f4e33add2622a811c6f41856bbe2a504e9c32bf78cd31f16d163c6fa8998802750c4832f20ab08bed330c1784cccaf2944dd79b4b26e665e7b4265baa29baa7a44662411bf2dcdd7e8083543db80f43627222f27c8c9a834355d982a54a3180fde74e4c46d92a4307498e65c6167678c879b17b05ab909111fd7e4878e30f449fbf48ebcc0b08bc52d1c176282c7e0725782563584ab5cf7ab03837b836f69d27af06c56f43f9aa56410fcba51ca232f8845413f98bdd5ded48c5597b1b5764d5c36a9a54ba3a9e7fc971062e7528a3600ca80512742b94a0400fbcf57d63cb9f8ebb2d63072d6fe07646ad16e366a1e1e911e2fd0f7c0c1fe318e59d43a2d00058dd5730761297924aead516663b4c46bfd58c5168f93c151dd492600672f2e62d3940098804483c49d1de5377f559136d044837a317503b1bf5b0addce4b72c31fc7d901eea9b63c67d3aa15756979eaf9b5dd5fdd5349f72932c55608eea33076b46e2b319d7d7b2668a484d6fb3e822ca3d6792dba747b4a579c594c08c0e349a45aecf927ba838328762f23e3d699b115ff0abef7c14a33460307bf8891dec5e00f9e50145a6e28c1d6652d1262e713f20bc7d356c855a792314ff5b18c19140f43a08e92dc6d69376a7a28113f5bf17a4e5aa5ebbc8692c3338970283b9c8e0bbbf1ea439982f62803eb10ae305deca5a2276590011d8b6ee27c56e6c5cadda01e309dd0278d40bacdfda75590bacbdb334a7e2bf11128fa920cdbc10bdec6410add6c295fddd2acc124e041b4fbdd07e14287ac370c9d19bde6c2e0d159c689956487f57d939367fad33b51d1f75930461e2dc38caf7f3d6a2dd87323806b575fef45aeeccc3adee05f3caef4d728bf27f567ca32863c22d7f31a4612fbdc2f71ec2eb8fabcac82af46fd254ab3369a3e3509067c95620005a761fe08915cba1773ce8fe0091a74a421d24d07664aea00d3912e7ce22efeaf64a80d7ea10ab6ffaf7110bf25582b96ebf490f8e9bda39458eca35b3644c79df4b54036a6bc6ec242dfbb0733680a66a103ea2fc11508a8aaa7fd0334c668f1d1c3722a6c76a6bec8a18f7fb3c88cb17b6ba4981f195555c6e0b7662c215d478a50522b7b231864bc98cf79ef497032478da48c471decfe0288f2dfd9c8af7528dcb4149a9278d73cca76b3f775a7b147940bc803563000cf8698cadf85e3830129f800814c9d3abe346f89f1b8e865d0b1da34029ee0792dad6a4ee56ff3e94c155d9400678498b87a7b4b03353583680687e9371b9c8ed237096b69524402c5a9ba5300ee31cd6136cc8278fce006f8ccd41929fb08679670b9e662b8702161b0a261b89000a95d835d6ad6a54f735bad144d0","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
