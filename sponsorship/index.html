<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a9e631cdaca864732936f0054aafd5a59fc1136695a1c16d647eb7cd9d3f95ec7ae7c0d9f71b7bb84b0468046c25745a0c7c70d2e5127da6bdb9db28c7b0f7db389898984138d7d7351acea68426e4e6bebada1841471205261165ca71c5fd71aa6b59219c6946ee46985c56ff2032a093421fbf89246ebc38f65aaaf36ad2bb155eda1114bdaf376ba0fd968e6d3b9a7a50a8da691eafd71c2715d6551889ce591153357b6c4e46ef206da7c0fe05b33d3c392b5cd6d8f87eff5b404c25979d09a4729a5a78c0e60ac1d6a8a8de3ccc66497e4fd45a25489ed3d7b8eaba8d28973a4bdec21a1d4c74ac69e7c6c5414019ab55be34f498c3d6803cfeaae00877f8064dbaa01fbb53cd9ed0491a55dce594a0091e8c53ab5d493f7bf31af6cb8e3bd9fce55b96f647d6e4a8a6b20061668654e4b611d25477c1448569faa76b2fb852a5aea1298815156c412c418068f24e19d066ad807bcfac5d7ff9e2a866289a1b127eb4d31c20189698d3bc72c1c878af197f4fa6ac7f396c5fdf7f5aeaca43c756ca012b3bdd382990c848546c55a4ea20f1f08b8ec96ee6871abbacede0a2d7eae17e26db872db8ca2c6952863810c20b9eac43e56b1e6ed66757a17f3a9bc29998e88d95311cfc3699567661f21cd04b6786c7af0d666d43917a52cbbbf113263338089119a64b9048985a4b845a1e5afa77c0b5fd297111996298fd5c969af0f70a81e4f3f0e1d1552dfab97daab43e5b9a50e691a427a9d7c909b05f6a85116f1a63cb63dae088494535bd86af1290f057c294d0269ba67f1794d13b17fa595be6c4a34997b067afb892b691fe604fd03f2602b6b89170c80653c3231b7007fe7980c61408032df8e3fcc1314a3ac3aa13aa9b37d91387e2b66e712af7f6c1ca5475505c4bec01f714880834727b4fecc0ba432a9c2d8d4f74f86f22b4a568c35bf3d2dfe3474c70d78d95df09270c1571e084be89baf953acf8008c419d295959b2657d84b5f01b0353509d5eff759f4dbc273cf4f5ca642203e4eb2c467fe8b846d6a19b53a489c6749986d0c0ab9e1b5471ffa5e8a3a86f837899f6c441b5809b98cb7420b3255aa01b19fadb5ec757005e2d61667ae2dc4bc568005162e2923052a4bba9d1a9df4ee3f6d865a1ba4e2f1f835f38ca8c584382e8e32e978c52807f9a9d206be65bc6b4a350a4c56828860ef1a4e8106b448c2bc31654775e58a2960d72ae48f188fe33c36a41613dbc9923872ddbdb4936d9cff62bb62f42cca7ff0b76f80ec6813c6f731e1556ea174fad57c74008fa64a7f423cda9d8b8dec15fc9d5f314fc855140ade753fcf3b32e547f1a0425d23ef31d702e138ddd69a4cc54fa15e5d1627e6c103700b6acbb2844d7ab56170f694024b981913798eed56b96e64ce18823d9ae1a8ef6bb70d738b1de2c9a9deb72a444fe9bf53af019ecd9be342bffb4815123e99b1b41be99fc6db943f1c7634fd880faea1ca954441e3bdc419e174b3c1329c044792d3f33deaff29852d60439babe964189c5dd75ccc33087b39e42bf9e1e3f7d7149aa572dcbc17641115a7f5381548deb96de3221e3aeb8a039824ba061d81a7d80e3cdb7d166e2df0ee7aa472dc9ad9738eddcd115bb3c096ee7bea63ad21dd61b98bdba48582844e9eb3a4a9a3b5c787899411685b7bad06c414f002f17e11c4a07b248dabcff3a5e21316705b4e4e9f83e0c5d09fbda42e50ee55ce96e62b5e4c1dc66a3364394eef81e2008aac328e15bd6952b33fb2cf08f97ac3effaf0011ede7484762017ebb3c9920d1138fd95f646f54c2875727c88ec22a561ceaee264056ee9824331d8da1ed0e4478b55be217ee7147999461d25495a8acf22c5f8573c14d6e0d68948b18a3ad17b3e5e643727c6ae45298b0f61a20a0e48b35528a11b4ca8585f85ef631a77e3a2d528accf8a3484e717948d5e5533c6fcc2872519d51a2b1a30da3b7cf03cee6092e53a5f80433d4e540ac5ce9ce670b7eced2d2d5307e0248477c43fde492909db04eb6664df4dec20781680aba7a8c315a509fd22437054c5e349fe5ff33d7159903aa1ff00e6b48708d2f4e3b6f5e253cdac0bba12e230eca7770634f98dbc237e1757c40973171728dfca4d6840ceecfe626315e98f8ba6c61f9524f9042dcc5fda1d90bcdfd20d0350e75cbdc6d7b1dbfa5d1381827bdec1324e3abd0a6373f135126b72132fa5159bc4ae5c258ed6b0b78012ee2192874a2085704e9e6f3be9dde74866157dd3b569aa75aab18ce12e3aaaf94f9e17c06509aad46251cdc1da4ce16f31ec923873551da6b88b91403f9b70c9b9a31bd576961ab2c97abdd4b47f3f4ee8030fc1ee2353bea1709bf9e703880b8e36ee269dad8d2229c45099b20871c6c479473b2cc5fd0e8043819a3d4f2ff80f0b2fb439cdf6fbfe34c404cd57c6cccb6ad8cc6813cdf9aa6e083f9e74611bed7219c6438b1767c87b90cb9dd11c027acc2243c0a022f366f9ebc5557a9a50bfc41d2d56ea33da0770e4a58e2834309443662157e53f69c71bfe17e4f0b9186dbb9bd02c71291fc334770ebb5dad29a7fbde28443da6b888a371497372bb425c20d964fa61a710f17039ffe662b0435d6b193c3fdf44201b07921d8309b24adef802bd33e19a2094fb1aa303533e482244d94ae6abf2a95fd3420e39ac88c815d5f4469e1009f3f20441faf6a771f2d5bad48433cd0bb56debf415bc3a354af8db2e1d8d306a34e33a8e3e172f4439938d8ceea331e5a6ecece9019714106b638458242ed4c5d9dd4004351a6576f05844368d302747aa30654063e859229918a004d60eecf383ce72bc7a1bea49e7666d30ca6ea33a9a0d884b7d4cd4a20e83fc75ecc733b62d380c7cdf80997379ea02cf7591048e5cc8b5ee536e576ed22fe6dd9b997be5a8b2376323410d8b94dc1bbaa877bf639dfa8c5c9a102f598727ae0c5730f1e0f1407f15f88421c05e222bfb84bfffb3a729ec4efdce140c70bd2d6b23dcc8593fe0848c06d4ae0de01ddb62dbcf3e575d610059d9585d9cd8466c1775bf2fd6fd9fb6e4b1ffbd8d938d8b80d049dd3ad175147e902cd233218f90f1e85f2f8df017278ce002be9e13a1d279a267537112e858063e9b2239a936f6a8114ec31206ecdb83fed4f68b1fb179cbd168ddfc21a58ad8aebbd5103300bdc3d7aa9827d853cc256faccacfd54ae69216e13fd33306244dd9812244837e80628a50160ecb6f100719ee8b6007f488f208bafd7f6d55833c0fa15113f56fe83d06819be089c90642619ce39901cfb02b85434389a0a7ddab7148059ab8c0ab6e13ad12975edb8cda001cc1cc3078eca3a63473ac4c8860de21e37f37285ff9d07a3326b001d248cbe0c3deba489da425184e2fcea49b4af9c5bd55672c3ea150b9da6aa52d1653a6647ecde062f53a6ee5f30306d5c9510a73643ede8eba96a78df2a388993b1822b9827b6fbf636d3564a0e1df12064866229ea957ce592c81873a8cb66e33e50435d553c18b0127e6f032490d99c40f6b52bb6a34023e8b104d9906247c5efdddc95d3f18e3f008a769b8f1210bce601a63d7833475c939b1bfe0b7c12e990ce5ae75f31e21d545b1de66ed24bc3a57bc54971240ce656d45f2d46d62f90ffe6c9e33577ce00e6d749b987e29e96dee841cc3875ed509d7ca05cfeb3a9ecd051ffe7704c68e934e75a1217f7d8e615d0e3aa4f0bb96afde9f93d65e31ff3956409b0ad549262ae65e4d069206060d815b3a2d2ee949e857e62e55c14e40cf143c56219fb94a0c08a621a968840096b5dd8d4e15f19b16ef10592d0abfe9fec251da883043e385c2488c7a468fa671bb758ac386093cf71af52453780c7ec0b46b07e6b2a46bfb1408e4bcc2b7ea46609615e33dec50dd18405c283d7d593672f583399ab22ca585dec704227eafc3d86b8894ed112ed74745aa92e1b5dbda768a934df884c7f70b23eadc8e8cb0f523793d895289fc903a770eb7999994bdb71d2c16548e70bf12654a3bd07193e6b0a6b666a3b93a042a073bbfc5c26b3c6cdd2d131c4ddd304d391d26aeb655eb59b185c4c9a657756229cdc2d6fc50000a867abe5c4928d32d0bfd1574084657aecd88e75fb562df3e19a110944955def79ded95b54b298f753f321a39bd5a766f8db4fe2139955021a203ec872a3a50b39ae9443d218c477826057ab2ea4575cc2227be069bf0ed813ac525b2a663c1c56e7045fb7d5b25e9bb522570422d7f19e2e085c42380b78f153a01981fa300aa05a9ff7d9af414deaaba2e5350363a881d124ab98f5ec4feecbfb6e7646759af85b32534da21d0e6cc5661e27413b89f60507b0fe90fddcc42e002a14afed2c3afe3a180a6fab17598f53ba3d120b0942d1ba65c9ebe123e4c3a98a3b8f04a71f19b4aee19e8586049d8ccf2192dbdebf80ca572c6863d0289cc75a06369ecf9dd0862e3b9c07284da5b89f5e5c2a1137c8ac56719cba8a7f0837a5cb5acbdbaab0af647d20f27e30547c0b1f89b232f8e735c6aa389d636cf5954d87bcfaf55c2c41a18f26efb8df85d103b3613e3451508d4ac60c42cab0e9ecf8770aadc3241cf39fc305dedd5533b0c51527883e67f1f8a733c3e6e53b3bd597183e1aab9ce4d293f3c2e47d13a54a0cb1e021b3f24acd0323f960c48460570821312d104f985e0405b0d08e0a3038dc311e48d703d1ca6fbff5466154a0b4bd688e27c2e75e725e547ce1da9f55194cd9e01f93a7e3810be651ed10f076ad5dcb7fc76e39f5346b12bd09e1893e5cf236fe2c7fee842c060db5e6065e1b3b4258258ffd8ca09ef05f17f2157576453c4fdcfdf3d376a3b97c5bc02aaea33dd50896f07c94b4c20cb89e6c32763627cf0d42665753494fde1de523381da2cfa484447559e1dd106cc5bea1b3ec7e3326d8dfe713dbbae3ddbff01fefad22acbc59ab30a131845cf48ca04772901fdb1c17ca0e5e8b3475e98030bfc8c6da05cf3b20bba4dcf77acba12b2def924ebb1241c3d0db6fe4697d954bbf17c4330c6502073ca51de1b90af233fbf861fa9b5a767bf7c3a1b077237755a17144d35b6ee0e111bb644e1519883d84337612af3299445bb8a6a0e428742b397b20f2ce1f760e62edcc86c7accfc8d01f8f72852c079156a71f55f041b6ea593bdbb5a7ad419d59f4c0e5cc5fed26e6b1561509b5bfeaaae91059d7c759637778cf01bf11907218320775656837e055a052594d65cca025198a7be3ba14c225b3452e83fe72799bc13681f3cdc47b3445dc66b9a68c2fd9c2c3259857db2ceff2680dbb50050bb560e1d2ec6c6e24af619a836d31783f7ee4093904b3e8b2fef9e51c96d55985c3de93a000562558989111ab1f125e47d74ee1fd255a4cc76bcef02b7864d0043364a55c53f87de68b5cb4802033898b2ef6d42cc40b4b499f1f1b4debcae32881a61a23d1a7a87747905d96c2e785173789826d018e15674a475595aa0568f9264d8ca3a9939fa2388e50f320405599aac0bae13033e43df9fc585dcca1d6ef226f77d4da0cf05ccbc4c2665f9d83f20a3a2009e2af6843cd81b7542cfcf4bf796424192b028c274f1330a6449d42112d336c05d7fc8d24a432974af6542d4e7e2b051417ffff4c90064886511633df4c6789183b72599150d8750861b0032196e788812ebe1bf2723dfeafdfc1ba9f18a257f7bd0331fdca5e186a8e961fb514e3f2cf0ba570c0a9ab72d624b7c896cb61c2b3fc8a9880c319529691d3c4f1d94533a059002b30fe9dd93ac382063f0b1fa085b548463edb5bf8a962d3b515c3c70074ab709b66bcca696ccf71946057213131da695076f87e97e5bbfe7c3a3f89b36c9f3b6404386775957561e47a4b78ec5d292087f0303fc6ed1cf799b0e56eb5988af108d81d5bbbd736c8c8e4919c31a4154d56c0bec72ee4bd8dc150d18b0243d77e155895f146ad7fb27b9e4731ce16c6e44fa1d3b2aab558121f17c588852545268f3326187d784f98178b54e7c726ef6b3855fa3ff0d34b08429ea505b877f64ef44a894b65b3efc023ae156ecea0f542597d80b7d70127ecd61ccd01fd1ad813976a80226ee0a7cd9177512bcc4f5844eb02aab172011cad016f869b23eaf721d564e5e2f570983a05d2e3aa88948b0bfb02e8c8eab8431f82e404d7ee54e51c7c20cc248a0d0972021be71f55dffd7ac5b82e8e94fab0f8ffa2d78eab83db0f42bc4abf3312e79fed2643e61d988765ea9856e6b7c248c7da0df199f91318d16d820709936290efb24f0e6f25863cad1845941d694f454408da48cf1248f574f4cb2f519cc7ee44c5df9331aac012c39d84bf19f87218d13d159f51a3d4eae88bbced435f786b88b6ebfebad5ddd6b8a4df470af3fcdbe7b908928aaec9fa006a6047ac4a0035ade8966967da9da4565df76f92d07fc3b1ef2dfafbc407ec58d44f785da3ce148edb0b2cece28ff21c4ef5973222bbcfad1de56c15f3b10c89c851431dfe8fbc48dbc1f62a0a67e393275aadb9bba52a90c6d28c3310e7348dfd909a558eef2e510da03ee4eaf2373d8061cdd143e6c3c50e49a0538217f828b86075e8e8c60e197ea64a2b7b137d1efc672f15cfe0aa4859d45513ad7cf29cbd1d70ec31ff342854e70d6ff2ca9edf3b3e071230385f7751f3f48044c3e8406e8558a32c56c531eee051b514d6ad8f5efa24c930d454fce99af7559ac30804c40ea98987121b9faeafde17af856bb68a4894fb57ebe919615f7fb9f8336c75e59bbe844cd6fd4ac2111e48c44716327ed2c462619950b9d8dbb7d8f8378327e09041515a96877ac62613051f6dc1f6dc9bdcaa71a6966656cc0fb5742a332a4ffa7061377b1fdac27fc6037dafce3e7ba07083cda684317cad9fc0914751973028eb63c3dc8cfdbff72f86e2b2c2a6cf0118bf90f1f0c28352f7602aae8d9477366f832fc7ae0a4fa8b8491f5183c35cd184f59f10297c3421f2d031c8dc8bdc20de557b9188d710efb21c332d431548a0a06ba8ebb60044e033cee23c5d1e497e67e6b98afce0b2f3bd36b4b92fca9e5da86a2144e960020c3c2f2b87fc99bef8bae6765985ee47d4be5eee4573c52e859d3d6d487a61b6756cda767f94aa7ecae25248e184264c0ae955d085d8b1cb9174c6a9d20666a3aefaa704bfcc5d05a922f60ead3975bc7df7bf7588f7fe5496e16649f9a91120603dd4afbc6a6d4a70387d1b9115715367ffd659d55ecc12953abb25f0ce77fdedb8fd382ac5fde38216980c5f9c81071a771eb850b01ed7f6e4ba82ddadeafebee2faf746f79609e379490f0fa09ecd696de61254fb4ece7605402d142b0e7a48fdd9a86e7f7ab0a39228842a3f9e767b4d87355b3458cb2917eabfd237fe1c261007529e791ee6871b58d2e87991aa33bd713a357c1d632b2df1e2526e9862ba68c88334b72e486168c8c816062938e6f38fe8ca0a570e87a52b5cb6988326355bc3bb0ed092c62fabe3ef80f96a959825505f36ad67ba50dc49720bce28b807361f475fdaa48df5b6bf15ae49fe073fa50853cf8be6bf441d59c5049c577c7e2d4606e85957afcef0e6bb501a480b65af82a573db4457bc49928277393884754ff0484998dae15f4f02e7e91f674c3aeedb563174d225aafd6d14a6858f6b135f70d0f4e4aebcd4042525d8ea6a6c5ccd3b0229df33fa2ca1471261794326b6126c36d3c2a72acadf962f0e1326051d0973720ca0958746e15937e4749a4ab297b672fd899ebbdaa43daefc37cd7d3c24832cde1352ff0de7a93ab8f016adb235647ebd18963a9629b4579e5deed5730623b1dbf89e40844a6a1fa75a854157d68f843b75c72e06a5e777fd27e143a65995482959441a1924ace546e6a3c21d87ebbc062c911bd92bdfe93b87888f68f6c3263260e850495c9e440fd4f87062e1c34b9b651c34061c55052d9452fd6af12264a4d3bc1cc78fe35c48edd9d7551c8705608398ddec82fa2f9989d1b1e040ad44956020f86525d95dc4f57fc6e8e23e27e8d920dd4bf559f5fbabaaeb706188247ea266b91aaff35876e2d8989105c40b8384a3e9127ae3c186508d685d73132058cd30fe638417cfd58eb679f9554752beba660bde0b4c1d0247aa3ed5a240eafb9b6c6570f75ef3040af6d073c6cad2db576069bbdeab03f819ce785944827d21cac75eee44591965971399372812dfc123d1ecb52afe3b591ffab89909d89d08ba3903979293ce8baf306e31085709140a42c27c40f2b5d0d62d17b15e76e7b6b06bd5aca7692e4be30add12133473faf6cf4c63a6a4f8e1f88b24bc99360c833decbf9a0f7d06c0c7ad386c9d9b9ae628153c47cbc95b2cccbfda6d75d1772abcf05fb46a4b9dd2c3b5299abd897c46dcedbee1f798ad216f02c9d0757925debdfe7b6f4b2f647856bf672f1c4586eebec5fa3784b24843758d9580b29ced8fe81963b63a9e2e9dc361097ed5f542336208176c82587f010b857ad79eb8d65d34b229af272dac82baf257de1403f7c9201dae508af903ff57ab0763b6d1bb0264e04fde9a13a7ac733e79a7f550dfe9d8ff32bf47b7df9168c07b62eafb4d86b807feee86c74922bcc8784c824732b9b1a9a1494cce30fe39498ddc2c6b2ef69d11c312ea8dcb6dac5f9bb968809a305c1f401621527db06ad3a09376fcf0a04e17dbdf90b5384fe229d5b651afdaab1ee5fc5341efcc11e713d2ff6fdc745323a12f8f6fe4f5a0c6d5650f774c14582561cd6305fa644b2e86aa93d651e530f1ce7e11af17445e1a9332307ed24426c8c661d50cb55ce3394025b2879b4ecb30ac7c38a91341980321b983fc53faa00067720bae0ce4413ca6fc7c288476f5d596ef1545bbf035133376fc21931b93cffe4629eeba95eaa4b6223847a6d8081e066859c7e2af9b8fae8a620745677596519464ad66c5284eb57e6b4862540a2878d01d12fe5e913df2c4c2fde011d99fd908b35c9da31e9bf6304d1d3eb6aff91655a1a84cd0e52ba1de7feb20a11c8e779715e349fc506f41266816a53c40d16545a73ce74b11e329ed9d05f1e34d72180c9c5c88afa776dc285e46ce6c1423310ecbb86cbbe3a3a0dcafc6f31ef860f9ef994bc1a8a3d9508739b080e7c6fdbcba962597bcf770e1b4185b5472bf7f344b1de1cc631cb2938889c7e0365bbddf2805e2f8fe3c751d5af9a95587076aa442591bb0c20f5aff33b23a8550db42d31de497c4f638c79b570a7b04c820318cd25e4854c3e7a128c54db7a497b4f8ed6509168568205c47b1d3a6c47375118f4782bda44fe3e7de7ed58b9bdea02b56fa785b6aeb41afdea47ebfad7b83efb69c1146fb19101c0ed7ce06e2352fb5898969566844c3435cb2532e00d821616b4724ee4598d9773932536262a53fd82eb9c83b1c48a0ac8aba6117deab83458f24fe934aa3a21ef540e61da4c5e63db420ec63dece28e4477d9ee340839055285b5df383ec119fb005f0332a3da0443a0e3e800a38f4a5785b4ae13d6a9c98eb816af3aac268ff2154d169c81b7a82e8aee793c70512d0b36907651b2917d4ac63b503e37d331c21cc1458f7a759956ecab189c5d0993adc7347954cb2a3de116170d3708f58edebfa1173d713b944a792990b78dc11f3a6cc5d8aa28bc8057fa3a264083d481397a89ee66b0d2e358042507e1cda2c82dfd7f49399c88c6735c0c22b26f5821685913562a84faa309ae94dffe46896bbec45ca9163b377ef253d4c757129e485843afe3c6c4e9f0e22b7e42063a173f0a4857d5f4ae23a56c3c85c13797ab5138150008e8061a8b806bccc3811d5f7a6108a40de591d94e21d319cb1c438c964149ae819de8824db9d595fbd2e0c0a801dc3c8f30cf099a94e65546d241a4c66a3f19dd656a0e9145d832ab179764aec82488551da9de09423290f7ec9f2783e6795fc53c75d09675e8a076c763b5451ced3cb278645019fd50dda1ddd9ee48c8c57f21c585031abc31e2b4b466f2641ad4365fc4cfe6431a75decaa5dfd49933455f5d53f24ad94a37bac88cd456724a4da125e3e6451c2d6acec324e4b8ff6407f3e4e97735ee9df3fe02d4dd4e50990f4216fee065c53a9dc9797986f5c837a00cb909424964bc690a246ba5381d5e9b74c00bbd206ad0b38669a1ce116a07201502a1c9fb9ace0357526c76d4ae64de9b28766c5a9640d2a7e9f39ad7a67c517d015672545555ae0cb1b8d81a1fe9083cb55d83de7e4a27ca1b268148e1daefbf179e4f7b65e6643ae4837b5beae11bd472df77a98bdce037355dd066b5221d66bcaca342b5ffd1e1767aca761bc04dab6f6f8d5b9bd72de0651aa5b3081cc698317c96e2435c539cde909f4ee8b0cdb3d818ef4d761a3eb20fb68e1427e59cab9cb27586de85d442de00f1fdd0d8a2918fb13e9ea8702d17c6c9f8fb8b19c2033fa8e0967be0b17ee197be3d6e7eafe977ead5f706382dff4e22f866f472a0cf13d0135520082050045ebf5d03a147d41e8e366c5ea2bea538d2548ff1981c8e9858872c4811bbbdf933ac93fc74c409eb5e5968f76fbd1d9c3b13cfe4739c99c409f5a82df45953189393e99ab905d2938ca5dca35bb1f680b575b1e0927ae41a5a07cc9603304173914d29b644a1f3d02c8900366d733960081440ab1dc2cc10cb616125835184fe3742df011d331cc60edc3851d8022a8e086f005bdf2d99a1a3afa024669d0664adf7c60d8428c94046dece5675afeee2d88bdb586f7e532a1d117c6fbe6e101e86919f0e90e3e7e7bf5150271af97c470d1d9b356f93bfaf546b53484f1e07810bd33512913fbbcd92a95473143149dd3e9b01ea1042dfaedd66d30a86af252ecdd14745083f252892a5a17c198e54cb8f1e1ac0cea9ba6c86f40248f299a808be0ab1faca0f865d958eb1d5b1b135ac534913e6e9dbb3f2f95e4e4df8d779a4eeda2730419aa13431666e51e89be2e24b394dacebeba1c0ad5f234482beebcfc18701b6ccb058edc0a145868ee9647257aa95f36ea9965f6bf9854df14d77c326b38428de3d74865b9649e8b1af870ba386afb3c87831d61d499ab35d03a9d96e1524b895c18fe0b54bb66ecc70271e3b323f5ff93fdd7ce4bdc8448bfe05d809af9eaf7e2b73977e58e51fcd47660e98141210cf7c23dbf9e5c5015fe4dc25868b5597e7f1b0e0568c4153e0137a7eab9c2bd14f897674c80918f72d4227e6761f66d277d7f5aa2ac0439b776860e85d6df832f525a366e85de27418ae8a74031ff9a8ac1f3792d7b1756d06e3f75351756ccd1d9386f6f2f5216e008eb71a4ffdf0ba49759ba99973f0a8b2b476b048cbffbdca60d84c2c4c82a1e233b0690cfec6a6e23d479d1f2f71a7e09d8085be98e9c336abd4c91a4d98f422d8c66cbec12614fa2533537e748081579fc723d7cc48584850ca61665ae62a5e6ea4782ae882fc90e1e90b657269cea27afcbc5b35e29e65544bb57cd9f2d1254b2abcaf7836bbe530de0110eef9290d636f0d3bdab17c841e8379add6056502602e9ec87c0670f112b6027e70c8a3cd8955900f305b004b48b863e9fcd56fd8e7d8394036210cdcd2bdcb385f3393873512b9731dd2433c77bd9ade196ed48c9466e008130a33d9068d4e3a26c712750bf4a531f424d47c862e9f2c9180b3dc3d3159b5c26bf09398834e80ec7074d8f1bb8c332622522d8b2115e336ff3315f1660a4bd79d8d128df3f48bf0b4149daff9f1e98e25f7c7ce4c60f6eaabb0a48aceb0771c8da07f85726f54849d622cc24fb67bbdaeceb11fa9b04bdc0fb6e549d9e8bc872b8964bb8f2d503bcf6d2c62d9d6e37ecb481a270938cdf97c616cba9e65e6ae36ff608e74b6a4d523fa660d647b18a709da16a26fc926d9a84327d41f0c20d96d267c4569c73d6674b3597fd00ab3d567f9534ed2d1c5e41608871bdb7b43c0f0017c478e377703e9400a26950333efeda9351a5a88d9d07253d0028dba32a29b33db91ef087a6ab8271ad6145cc0b688b3da3ac04cb45d53b6f4e0402a6f43c38001639a213de58480f9984c6229d4c168486dcc99e045e75edacadf49c064eb0c977bee40201439d928a4f08fa85d7928c9558879e114a1a7ead8ab2c276cebf77fe3612a0c3a0dd5e17232955ebf3935ffc63936236d6c014b787a52b296e565a4c288e6f7a6d3bc3d0feefd4f85f5b4091f8c507fabf84fe94d83ea09cdc1a5fd25594735aaed7eced57121e0358d94995684e22a6c54e144a67577c0ec3222a1ce5908a5328c9b902c92ef2c78dbcd1206dd11ec86d354a9dd27ab242bd3f848279e6578630a53c9cf80acb27f090f6ac0fbc5fec6ac587c956cdd976a1d7e387515e4594d5b1d23e44554b41da9e35aee39676f43f9ab26e1adca6523576d15d7803f82ce440940dede7da2361fa4fced629b951fc9ee651c403d6e041678749baa81ca194f98d1641f2b169c23370bdf62992380268380198caa36bdab8d1218f195cca815ac47c7e2877b8b9b4f11704e94870faccfc8fa614736b2975c5661feeb9b17303d35c121b99ef9b8716fa9a6f69332cd05f8d1d7d74794cf28e7b3f210b6b6c814dce1815bcfd117d19134df2048504b89a76ff38735288a94b75d0d82bd32d8bbf347eed2a8b7326d07a0a2e4a8949e48190b285fe17f4896c5654d41c40dc4f286a4ef73ff5fbc9f0b88f825c0a35e1e89c10f5e08788bfc012efa90063497d87746fa5de6ba1fa0edb5f681f1a20b60409bf8d1b048af9ed7ee3049dd0cdb7305c14b3f153632f17125b36d008d148cfdc5b4847644d6c65eaa9e0e251fbc38c44929397505786047dfb184c2eaff1b9906effa7c398512abbd8924c9e0bd985766f84cde7c16f410dee412ae657a3cd6f4e6d36ccfc778e41d12edeae2990c0d8a1ab981b30efbf223ed65233de9c3037de81972054558e990ab66da91317f21096dd579f74aef97f47eb6e0673b3e8808b165a1ef8f5af5b61877248cbb481f59b6064dee5607cbfe85b37a69ce642886984322762e6676e8210724ee91c81029fdc32cae8160e4dc0e039ab9e7c4b57f1e6618e0692743d5ee013de10304d02277c83c162e0e134921b9a4b60bd2fecb6ee31b681b87902e8809b9dbe73d31738430a0ddb1a29fc54aedc68084ead44bd085132b5f9555f2a3550a59d3b096925875c58a17673987369336751e6b4aa7533d407a7f00413946bcf5dca0ca3862211f3626453d876c4dc4e2ceb02b2aaab3f1b33618c1776e38f45c870ab1e8e4b041519c3cd949c94457d97a96bc46f2d6321b42edc0c30305e67e35a515573d67e15c22ec0bd2164d16ee88d7af02b27bd9c07a58c5b334d6f2eb8cf2f5472f2b8b952f90620f0711c2577cc941171fcf27976537c7dea4016c2c19151c62647607d8c7e28c3028de98d0bc0f37b95e0dafe972688973b2b0723fe3c60a3d9a301c50083254c7b0a7567a6cff2f7787a7b1cc440969868176d02ce95ea4b38ccb4d90e9c2aa385a69b165489a2c6c6ac1b696ffa3b9e97c3a090f44a9271f063ef58923caf5b089b23a6a4fc0f41061bc43fbc3ca946303a4fdeead07f0529f482f1847e35535e3dea20d6d7d05602f7c257f848f112f6caec3a791bd04eb7b00251df4b638bce84bb91175b74cab28e72de33122ba3128dff8762861c769de69ca2597d9cb5ba58b2a84401eb4ef7f2e4d10402566c13771ff51ce2227537584b5d836808bcea21c1a24d86edfce1fa2ec06b79ce2f93a12bf98d2baacaa3416a42de611dce81f3ccd75d47ecf06f51e43927b3e4e92057430ee64f5da4f71237d2715cb9270edfb70807f2160793197e51be4fea174a11e071b5eacfd8986940ccbd85e9f95c81c3c6f44dde875079565050af4abf62703243a1899ec26b54579648b1b24dbd94472b5c374ac72a5bc8bf1d4b3b89e5b6554b6b45524892ce4521ba582f6607414ca050a9547d22eaee0a6100c87057d3a46da68a89d7d490affbd9b482647936cb7cd5bfc6a19efba8ad8519c7534571cadf2ae4375b347f76f2b04324fac617af65099f028e6338581cd217f2380b2dc333b7cc20bba464307d3250bbccbfab8471dcc59f898f018166fa8e5c6791cf127ca7cf1b026dbbb5483fb6bd40c7fd339f1cec3502af86ad76bcb5b41c4be451426ed1613a2c27827ddaa640a94e0b9c3fe31a0ea238d18b7671354fa188f745d5c80736328d27258150bf98ea81a5016006cfc7783282a58d8f6d81eec3b948acac99cef0e677cfccdc011a01eb8dd48ff37a41e84c97e96a81f4add268cef8613cbdc5c147811e71f301812d3d19dd8050bbe7d4074597beda62966655e2cd4ecbf113f78f798bbdf9765465fe38b32b462025eac3d13b453b88a8e881904b1eca1f62bae1da6d2a3aaa29f112d93f4d956f952cc197366f71e28fa82b130f4be156bc6866e8b2b4665c9c018fda9bb2a3a9649a49d879a15cd7f41f6de99d95a4df1da7ab06779da6899dbeedad83f0d4403b68ddf5580fa59adf9273cfd30869177fcea99264d2b91a785c2872f93ae6c144b06190f965cda7896722018ae60f14789d782aca97471c94bcecce76cfbcf9c1b5eef987aa4fe0ecc92e4b91b500d152","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
