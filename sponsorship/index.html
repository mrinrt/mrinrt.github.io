<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"4251726ad7be2f4a665421bdda74eccb3f10221e73e27498418547df22f185ee495793196c96e028bf6358a7439cf5fb785bbe7c6a01ccdcb1d62c733f1eff2455364b667ba02909b9dbd9c240cce81be9a91f14173e39b4c8a554cd89a7052d13de47c88e59276c4a261254b412a1d308b3a3b171081c0c6dfaad465b101a60d68e82052bfb32dfedac215c616a2162dae5450ece1de38776861f952ae29f58222883b3db00c0ed0249c8155aac2142a01e7714a314c70f75ff157e52fe418319f1b4498954ebc394dfea2863ce492444b29a1850a9688892ddef952aa8241a76abb84124bec4dc921388d11396d7d9e45517289f65e253b53a0b9aea5e3d7375acefad5c1ad9bec40891855ba8836028059d069c303cdc0377483b4968ad22e0c482e8004b43c28cb4bd4dc8d93c86ad180a8651e844aad1e2482dd9a759deb559c4b02a257391a8ed5990fc28b0f4c2af04fa44814f7b0d65d13e9cc8079dae9b2ab40293638fe44417a10879148d48653bc8bd0eea768123e2b1be416b49dddca42a6eccf5c71339a1e4a9628376f9700e77d73ef600df72b873861f4fa56aa19aac88ae869044b010007894bd00e0923aa4bdbf30e73cafc8acd408ec786656744f3362a9b3ff87f3ae722a67aada5f25f9bf699283e8a275d1031bf6154091635798cfded98c1cda0f4475d2b047f4d46d6277463eefeed9bbb15c4eb8b6e8d31b6761b5b885509c8186f3c128257f4597c51ae2b45d1bc27f8f2a8f33ca7954d1058ebf353acbde759dc080aaa08916e25cae185083ed96c6a99b6e5eee3c4e84a758869f3746699b8e15f89ddf5eef14290822bf76dfd5472f28cb605c8102b3c4e093e0621600b6e859e10a4f4666cafbf6af56274555c59523952c234d60420d579f58b4e588db138103b20b68df02c2e10a11f1bb290ad996ae3886370055cf4342864c2ffde77aeb1c0a888f00aa4c16cad798062b5954c00bc76e48d480fe1f269888941435181bded232bae9f274dead7cc975234c58493ba0b523efc66cd10180fafef5be655eeec7104a22d3defa8d3cf027b7011ce5cf41b3c09f83fb168d4b916386dacb9d2f8870199cf60ec7c66ee96fe56e017a6f4246d123e0f870612439837427eaf4365af65f84066aee27f7b0083fe4c2a5968b251d42f9e49da80e3921ce47f9e4f95ef38fcc97eb3893807b61fd54090354aa8501710ecc554ded5ad315ae6b5bca238e1c13dd7f136e973c9af3c586064eadc191a4da75d2832c8478724dde0ec48abb8b63775363d44db9d47821d6e82275f46e719ff6c972f1163e54b43648e7b11a0dbfa90f23bc60c5abdb502b9ec6c04a3f62eec51e2674cb89a07634672a9cd062ea6f0c94eb385ef0c963677643664f348334a56e55fe36300324af2eadc1256f4bf8bc7948405aca68a203ec02cb685f2009202801abdac1057f71a3932b5d42c1e3e546fc82e469c5556bb850d67bb76bc05caeab9e1794d258ede2d5d13342dcfd6d851e29925b3884f398fb813144fec8af1a268660fc8ace5d2baa01723e1f15eecaee518196f9aae6f1d7ef74246231f200bdb217eb190b678489589c261b313ff866d955ecc29245b6b96211eee318b932e5dd96743302e16801cc72aa62a1a30c90b86372ec72f52e132c5f7f81f2d8fe7b214bb0dec973059e522710eb037e796cb46bf5a967889577ba0ad8f62876cefc92a8a3e7373e4c21bda81324024edf6dd5094f3c093142b488ec33c131af8ece3e03858b692ae10c6ec9419acc4b40ac5133030ff8203fbc273d5e03375c9d376b7dd945af6191e9ee97c3426f7f8725d38a8fa0e82ac9d50cd9555238095933b8d10c0f2e1efa8f5cc630d244a140d941d0290213d81206f281800c7598439358c376d845b84025448abff212fc221e3c63e87442aac058c8ef2aec67afc6b39ca7a65c7f51ecbf5d2ee66b052fdd11e74088e92a22871fb538c029405dbabb786ef74798ed3984326e00a9a0a31da6bcc9ddd1cf234346eb7f4e6f2152323db1ca159fcb3298bf32e809c4247f9aa8b435fa738ec362075cf4f032757894cca99fb334b7d46d2723cc093dee91be84f0d6e95e8998d2337a2e385fde5f8f383525b65bd6cba7d5e044ced54aea7a6b308fd66c2bb82cd4c8626640c7767c1d69e074209f5950342d7cd4a3b9a99376ed2c835687161f95ee4ec144277390018d1e121a61a3c4d835ea9fad458f766cda0c403885167f148ec08f0b56f2b4c4cbef0bba19b85366eec82a4bf7bceb6abad31760ebeaa97ce892aacf4a776cfbd24ed893572f0604d0dbfcda269d799ed0de2d4cadcd878c1eb9ca9ecd9cde243ac1dfa7f6bf501b504c6d83dce4a3eee17c03d7ba8bc48e2233433e6649bc04e5091963f360b5d756246700ed650cd5768edf449df4b8c8646e24fc2cb44c16cac25b6136cf7d0a222d72017bea56095d9d4cde7f104fb967263614031130d99c4e418ff38dd842686fd59a4be72ed012b5e59aa64323798838ab8064816f51df9dc0daab47d5c90979959d3d594518e4ca4afbd16c67a211e651b270b0a5665c67f2179a06eef0333bf0ba1b1b73cf4669c798b6d0b13655fc9a22bb4c7db4b9089ef679c741604cc288f7494ed938769964b02ee0da8d34111671ccb8989c4795ffee1cba6ab71cd9bc5c2a3e536070dc3fab6d67a6bff0834eb9175b7c4468680b94595d3350767ae2c810baeced691859dda21ea35994a4e9a92f6e1fc22292666460818f1d8ac36090064ebf36b94e0185894d2b3533c5d81de3dd8f318aa756063e34bf2067f2935d58f66e375855fcf0cf17d07317b181f66a1bb7eeb954ef7b29c2dfe09ef85a1ab5cfbbe3dc667bd722ee8b2882ce505b2b24f21dafd2a24d1fe6b36eddf0892fde8bde8cb7ad25bb3340f06793f3f9ca2fd44b855a59b04019d12ef5aa504ca41afcf16f52d7e49fb23c19257ff14d79e321b181e46e4bd1eaca73a0469a1ef889108876a9f4f117f29bc5db9c552882efb803c4be87a4418d0f996bb9490adc4cc07016f6fd953195ebe67f510bb1f7c8ced7d50424e1606b37d8e175f037008c759bdda35a69418dd9c7424023a81ace3a1d90dd421c1a389642356cf6dd3cebbdaeaae6f36486960a7d04e21b86b606f06a07ac883516c6fb70524d481e4b5c35375dc6ec4c51698393ce9d22523d93213de9c04d2f75893cb1e377927833d97b9545c2582454c814e04bd271b690d42d63321208926ef6502249e51ef3c238883bb22badb119bdd027171b03df17cdf529246c939f969ed8d929687c9b937c7be783e4c6b3e1452ab4cd2b17e0f1f87b0cf88c85a5fdfbe32fa4ac50387c1a828a4854781a1afa71f56fd04d4f2ec253e19432a830e95b25b7f8f41ebee7677bea758b5ab0a528ac1c707f3bc2627eb944ae2feaf9390a10451519ce557013d128b6c504ff2159bb743da6a1b82051dcb1a1a557383dc82ba5760875bb436f5f46f591b54b31f7c241244922d9d5e8e99ccd3e67cc830a899213cb63a2686006d2b0922f6d092c72f2ed3c4b3346433837a1376187b795b12f58538e18681acd9f011b20919605252b48ffd7bd086511bc7d8f5659600ea4eac74748e43d11d916993becc8f0670e556d527f453cd95db8cb3484f2b277756e7b1ea751e3eee2aa5571bd16fba56d2d0fdf150d31906bc70f3649dcba673514e46ddde2fa7906197493195a61bbb1064223e9bb8552a6b131e17310a354440bfa683a1ac38d1ee6992b1a03365c25ecf504323225f51c267134181c3024c0444a0b0fcb710a4767ba3ad4c7b7c90d8a852b2ec56ea088e421b41d1eff6950eb258645fe1a6597712f1a45db071c38d3848739f18ccc5a44681ad21996c374deddf78a56146505aba44be2ace718a15f96f31921d3a617e6e23160112143c7382a072b6bf1383ee98ac555faa4df6995a8a24e4f6c0120a006db1247077f0ee2e311da2a884150d69e36684e20308118d0c5fa71bdaf18007f6bf0f54fa815ddf878991122df8ff6dd811fa54a476cbfcf939a82c9cd2b243ccf8c897738af746bf6700ff0241cba8e22fe947251142ce5e3f9c121e25a1124cdf774c5cf8478484ac04eb31099842fae5839fa4841f524c8801330a369bf9d7af6e97170c64671abdfedbf17b7e9362785b609277d2f8655a11a944c73c83080aee710e8cf4d7f147eeeebbf5b3705f56e4c25ce778208726018e15ba655bffe2ab4cb89d851633492d82ccbf9188575e238d27e477993017d3fdb44b1ba150bde8f1d0bd8b51363ac7d22c919dfe7a6bcf871831b9f8b94c2cf1a9ce6e916c417bfe9ca9b50dc2226cfb3c021d85a5530872d7e7636842ed18cff20d8d064402713b115c2f3e1c03f680a255d4f1390e94f544c076d55174ca50bd4724812923a993493106cee1257dfa50a1e7d3842731d8ee7677050414af3ff5dc9f7a5ec8bc48f59bda4dcaf6e4128f7d0bf9e212f7f22a1407f5145ea79aba660f6297453d8dabd1ff6250c70121a6b308a88dde93977dea5a1e1b0fb3d5592809ef3990fcaaaf8a2771dc9975dea2b89a0f8ecc931024300aa3c24029d61f9e29946b32933482762f02159e368a38d5fbcaba26ad2c6cbc0a113d2ef89263c9c3a9833cb147966d6aebfe6ae5700640dbe55d587449888c90e922b3002b52469af4a059a7fb4c40e5d2f74ae45e9addc66be4d2fcef8c23f60f7b49c66335c78ff612ba718962c50101fac5ddf57eb11815c0b577435a2637fe1cbdb2268d9cda3c41aac2f0ec1f8cb1cc2d0a79b9f9f2de77a3d622d9bf26a9fcb8f8fce3c1085cd18c2d9934dc5615352e8c9dae20c2fb35ae3aad552cf7d16293c636c6d088d4295c1858333b73642c632c72ebb6c488da14c64db00654dbe71854b3c8018c8bf8c48ec9646deb17d01054c85cb9dffb048065a89c89d89b49022a32a521ea992bffb57f51e0a06352ef61f325125880f84f8c7556b6994e5d163bb58b7d28a72590dee2cd8acd591541f2cdcfe41b28c928bfa16e1e387cf0bbdb5380dcf9cdd0326c90c67a438ae0b32fa0d73b760403e1dee38e80ec4805f8b1bd513fdee7b1c797230ac6222bad5cde28971d7bf2328ed262fae82c3031b65e3d34bd7e92fb8b900a051732ca429640e588d60a4fb1fb1432b59d3cb2a530834ffba66e68f06fb0a84731bd51b92e310a3283d343081fe6175994ab41fa3d6cc84b9c0771c0c9c995d617ac6a328b74ae181c912b81ae4aa21516476008a092b6b431d7d55ce651b79007c7618ef3945086d04122d41893a7e182bc3eeb1bbdf9e6d794ba7aa1ffd18f5c832562b9544f63fdb4245e044bee95f891815b2a6ff7bdf481e22f92df5996075a048ceae1eb2e25575b8597edde15197e1c11de48614832ccf7a14792778784a53942c1f290beba92efa8754f6f4e9e258e7e39aea01c225712befe8fdd50e610821ae309d9a9d6eb6e102678e1b832547682aa8ecb349db668bf5f73c852efd82695022673cf7ae5b449941c946febed973ce70e79b10ae8447f08e9e474cc723c37271b00c415f0e9b0d8966077dddfc26327e1b830f3fb9c76772252d2f2cdfb9fcfdfe8be2c8804f2916dbcf49aa3b37196761fc21086e21ff67f664057d376c4b765dcb656a4253219fe0f0843b50df90c197347807b37d556582efb4df8991e8fd8ccc7bacce7ab9ab0a112787d181e94f6af3dd448473e40d2d67a4709c75058332ebeedf1eac161ed008d88530c58c1d3321b31e2e78c3e69d7674603d069c02615360732234f845d94904b461cb5f869035d35bfd33a8ed2bce87e05b391e93ecd0f5bc72bc4c5c6d4224c2b03568172be96c96c4b9dcf3f515795f8d86ade2a0934ca4cc380f7b8eeddfad22a7201ee942af97dd89b3dcb5b6c2487a3f149be33b99987087df92f50773a9dd930100946a9fa74b8990172f96efff727ccf4f4d8bec14590f94cfd678ed9de18e99ebc250d0ff4be2ef72289f562be11a0bf743ca08f2d763464f01bd8c37151c78586431dfd87b2694d97b445f38afa1ef0a3e663a5897cfdeaddce37bee7cfd09d7ebdbfe376c925bb60728b8055779d2a18441d52635a0b70b01aed24147769c6026186b92c8abbb8fe31cabe86c46e014f636bfc9cf833035a086aea412a6ceb5081d24769acdc357869f483d0054a610eb1b5b39afd98748191c473d8029b7735b703487ca7a5886018666ece3cb09c68270cf5dff54414dbc3e07cd5156502889f04a05b1265bcaa26c775207d5605ea764d7a2c3b2c2aa5089ffda102dc990f5d3322ab4242625bdb0055b024fa1cf03200bebd9e1e97b40bea29af13e15702ff02273acf691de3ebf147f24893162019cbd76d9fa10e3c224cefc42e077e8dea60553cd5ef96e9481a4c1ffea9dc076f080d6431f0e731dcd09cad8a383aea4f5159a21d8da42ec30d33bff40eff808b94b6a25a84dce26e24f6689cc570a92d4db2940ed598bc4217be04d5285dcd5fefb090c139f5b30e090e76cee730b8d73aba9247c92d75eb40d257d92a0c7ecb93e6baf11094a4fa5bc93f8f6126e9c6748109cdc41214794b4491b23727ef376ad285c191e54e181d38677705924705a611a30a08b8eb86d15a45ee1260531f23c8e10f5364ec27d7fb2bae93473d789c69aa105ac7d927935ba44ee41a75e71bce5c561488f14abb42282254049102c70c9e9008f7b7ff20b9b2ece8ae7d5781371f24c0b0a1658bca3daf79d13d5155a16780b76b7534e88ef1dcd8a337e4c43fe4d5d1f01205228b6bbba5608a910861dcd85e0783bdfb8c4d5f72abfe19f6b956a3aacb272dd3812ef5b5e5b20cdbd3403cf597d602a8b2257c9520c8be4ee246b2e695a5d6cf1cf83dff4e7dd71d63b8411a050c644e2f574c47507341885e59e888f063bcd2508d37b18e86a08f6a7a391f2139d4130947b6e53f3b0866a4c7fcae7a840c9b9831374a038483d8e7ef2cbca1ac04f629ff86da8a3c87e4d7ce72a3d55da0632128b36a4760b1c36becfcce6e1c5240c751458b9186876c39ae0a2f564c9a2609813170fd7905ef4b15c6f7bab07fb1c197cb41a460cfb61bc2df295db8e15e6def6bd1b35a847d28b4ef1535b8c944f64e5f9db4209ae195b0600b303aedbcf91cc8fd759f493ad5a32c3113bc7bcaac5297b31de46e953c69db8b0d9d81f08ba86206560912ae396a804ea02fcef8418efa42266647106570cc3b2e9d4dced9f946ca628553b869880a44cfb360bddcae35acfc78a21582a178241209a85058aa8af12718b6cec951a9622fb05c7f3c793234b3eadc1b02393120488edd431736d89201d5c4d311dccab3cde36494a657cb68f44cfb6dc1b5304619a5a7e05e31d2d175c955bf4e0821e9503bb865525624d3c2ffbaea1748914f045c2f1b54d31fe13dfe1e4003f0ec47cb4baa580a097aedf67063199d6a2720be61d25edf71cae26e07524fe8aafaeeb74adef1a6dba0473e13505d8830291fa840a6aec06e9af62835c01d05f3692af6ea1c813959fb27e48e6b8c81126f03927ffa19e24b8b8b1eb7564481688d2591a1d8f4d67638d4de4423f2efeb063ac67a607a22366ae9638288b5bef4fb989850a4ed596dfbc382867a5810193188d4a7f3babed7e60012a538320b22382a0f97c1f6b60f99e0538e0858e7fd1399b855ddde567a0936298843bc4b93860d0e47f81de29392f4c807ebecf9d64b9a6ee627181527eca6c5ed738c38752925237d275469e30b73239327f6bb0724e05109b113cf9e411c28802cf66e34d3cddc0f5c33f9bd00a6d6199dbf1553b0030e94a296bc59af33d90b6a701ed7ef281cfdf618d93813fd2f68feb132882976353b7daee9f61110463c6f779b644202d0817c68a19d5aa60533f8d5709c955fcbbcfce2541bb02516fa4c3c929af941165cfe96f42b44dd10608d10b703cb14c8f2751d9b367fb63110f5a7df5bd5cefcf4738904f8534597ae7ea53733da14559c64671ed849b3e3959ed6b63754f148ceca8b6575c3500710c00211855401b15265d4ff2900f3c71256992d35e9d9fb74e5949c0c189220c7cd14d2075d56abda0ceff52b76e6286f26b218e4d6f79585f9943cac0ddb0edb1dd51121925600ffc30df831dd7dcce8099c4836296d1f99774faa5cc45ed916192494b772841adc9eab47fa1d75e8abf3cad9971d15cfc687ebff1b2eb9eefbaecb8cd37dc821e0d75b51fe1a6435c18a225656fd63b7531c398df7e4de8934fc56dae7035fd2616d879def3389cf4774c9934ed65888d99fb781600d688a195a5b46714e31c8a9403049d81aeefbdf83b1aa51562262a9f1be37672b1b80127519800ebd3e311a83896fb028864c24ab4c57b3257aa173c72b61f19e8bf09bcfdcadb96f3ca3acc85469de6a1798dc6bab2fd21d446472b25991070f1b6d40ef965f54edf837827d10d84e4d8716adafcd3a3079b11637ab5922d6969ae0f895830c9a42a42a013b5e4c91f3e0e4b915f808ec67661536094808b111321a09c584f30deb505207651511d8865a96939684301d8a93327ff1780e7ca4e6b7a82b3f5a74beb21c759d467a6694a502fb10fd8704c837dbdfde02234c5e14b8167fadc6b5da4824b3f798fcd59eaceb9f2e78c75dc33fd0395e54e4ec1c9dadb967a295b1d1bec9e46ec3eb00ad1d25ebd38c6444e1b9da953b485eae337e33ff7858a4c57aca677312b373e48e412b0a0b43bea107e04bf21083f9e11db8ab1cae4487a093e9dc9fec056502e90eb87acf908d7dc666ca44156711b6dea96d5e48eb44ee31cbbffb1197208a3e3ce59a24dafccced43633009d28843f3576e28c3343cb6826305fe10b3be44ab1fb3d34709ad9e0dd7385fe7bfe84e2959db404091306d2139dc1aea48d9264647816bb12a978139e91310f84a7a8ec4a6a2ba9a293c734e250ab960dcaafc101fb3fbd889284602a3e8b2e296bfc1ee1de242a48618a6b5a036f5c8d39f5df101482b584497751a3a2a404b5ead20d57c4958c858fcab498712011c98307c43fe8a0cf72dd894b689cea234c3cd5cc1bc5630bf3b2503db16b71cb5fae62a9744504f4ff98ad496974232f38b76bf6908e55628130e9f94072b150eeba669cad9603d24ee986b7d3efd9732371909a7181a4a1389d61b4d0cf78065986c6a6916dc8c8bd241b1b4d363d3f3b5c3287446dd484bc8670eade9ceca1bcc9937da5dfcbd48cb44fc9cc5b0594d1f0bf4a8514cec6bb807e633b3d090f3e9defe27b73d0ccd76579d034ce1f31814a31beee300941f76d75390531fa22eb7b6437ebdd682f22227d5f553a67c3e03bcdf955e1e432d470d20161eee415f44272016b171d58faf653029086866f8ba3579d99b9c115afd3c75976a03cfe87cf9b2ee86f03f6379446b9c41f7a1fa599e1042f64e5907fc2fbbf828fcb9fd3a0888f076057b7f912c3b088a78362ff42a9ceedc4421076410dc0eb919e3a0128dc268398ddc3f0ec7c78391f2a63164dede9260c8733b834729598fdfe4eb4d6f1641f93d6a49f16f64a454aecce56ac6870d91a480f94d05fd2866d097d84dc185bca94cfe5eabdae7373114ee8299fff6b63f7e1968b6c853b27c396495fee1399af144064b9b4676d7ec4a7f98357cdd84bd0143bb33d1bdd989169fa45f824eaa05089af26f56cd3bb1504c8d5c67ff52c5c5b25c1152b6fc9da66b696a84e61b60acc7b72946fd22add6529f5f991c42f816a20d50a5cada4f763c0bdf7d9472db38e3c816fcd150503b8ff3c7a32de810ee237b91bd13b3a2b93ae4ab3739608bfb4d2992e700630965c1c26f249a441b5c0f949dc232d8f75a1c1ebcee82a9da97a0c8b1bcad387715b398e6cd94eb548f18a9ab90d848763836a72f48100293e1081ee95d93743a66c55f6fd9304a0f46cd284d624473a8838c7f592876692091e29dd871aa6638dc9786e6e5f3d32d92e842d804367e6b1666838feb336a9041f9dc78196377e3c64f78f55a14958735226a44c790add2620059978887728c62eaba6f7ea7dc6b4dd9af6960ed383b87a4958576fb857cccae9c3883201deff4e9d4bc8cdfea706250cb7764bcb7116692c15dee283a6522b604ef184793d2e4c1775b3440bbbd8708cf642bc6782b349a92490a3c46b952bcd4c8d4615520e3f4311cb4b202c905a8327a16e55692d9a17433a7e4d232733c144dd0a3477e80548f501f82fb911afc634082e38a242988e16a4ab5fdd91e078d1ace16884374c3c598bb63d80f5fe348c02970f8b0a2a3a40d6a8f04c7f2bf71f1e0ea82f1957f65c411110daff18335dc5455511ae85cdd9106455f97852559dad230a603a6d61e73b4ac0f7e454376dfeed90ad57c769941fc090b0fc212e270c96dd9fae2e408119b6dd5061bde1df2397fe716a7275ecffdb94b18c4a224ea7c3adb35ad6f954aef7a1897979054c46f9a3c799fcd73581dcd51a1e54a0426aa805a6774fd2a77c0678907acc7789b24f8f73c1c11bbd66a2c63ee0ab37928d91adf7886c768cb166357fb4d17b98477bcc2c96de38fa1b556d7aa608811a8c1bcfd92cb7cb9ab72e08c962d5be387ab65808d5947483de064d259a1724f5546ced4e3f9e7fc1e0cc4c549aacfa33611a37df6340a3debf380e1363718a973d0b076ccfa540c4440f706dd0925b06234d401e1e975ef896f658667d771ab772aa66b245ea16fd2105c90d2cef8f1a2e69b758a1477a7df78670de251f5bc8b8746dd4c72848d3af11437386c7ee8c7b19e197aa8ca56dc280d7dc845ac8afcbbbe6eb113a03b978eeac382a0385193d65e7b4c951e81f496be2971519695651b491914e3d48bcfc0ddced983f07c65670ae72a23186874535b41fb8c618488c2fbed7d0ac7a004e829b994a298951ee60d51d312aac6266436d985ed3ddfcff0a1832b0b3d145ba39221cb0175d7950ba89efd41e920dde89d5e096a01aebb6fd8f9e1c06270e8073ecc1509adaa9cbd685ebe94371ad82aa56db617825bcdf20dee7a60598f9e74f51fdeecfd129731f0f84f666185981bd711aca304fca0d84c0b71111f7a71bca207049e5a426c482d68fc2aa1c27b9feb9ff9c4265bf0386033fd8bce7ea43a9ae84cb34c2f520acc7245112fa4dc9bdc1c475cb90de2dfb8ee129067e470efe3faee226907b6d360ab76376d794a1c485eb3009c17027545cc4b7db2c9197ce1270f9f7dd68b682967bd062971990e5dfe3235b4b0b00a6035f074b93d6d3c3ccb7b5a97a2fe071a556067a1aa5f829e1d7776ec4608043732ef31d1753235f05f1cfc43aeddee16301991df407fe99237507b5628358b9618e2b9b2b7d3b55b718232a8f644ff0b829adbe16437b14a25c86a5878f7f44147570d26b4f4f0f70a27c9b287005e259f35ab0380ec6f09e9102d0c9359f042ff14ac3ad8c55f3165af6c1e5dfb79aae410fb25f8279cfe7c1157ee53f5dd41afde7fdfc07e96d0ee2d2abf7ff10af512d7c9f919a1762fb83c9a86accb3acda3d7e6d5a96d5f246c8d7a38e043ed38f1df536167a23cbc231a1eb415edc04ce3b0cf52c3d7f1c50d6c21e93e43a77ebf531e4f0d12823fd5598e69c6ef8d8f7fa15458c74cb46bea8f99c633d3e40490da2cf03a23924cb451aedc981af2dd6e499fbce456c71c02855592e7992658d2d1dc3cbd26341ab4bbc3f4c88ddd8f8b6cb54be427b117abf36745f6f53ff37c2fd4457b9720b95fb3fea1dffe86a7fc218582199a617a6cac26eff34ca851ff9342cc85d9dc24570c22cd65f88aa6fde1169860f1c6c880fdb46e63f922f213701a9b3c0c265d42f9ee5c659e0f789fdaf66c094581fb9103bc990a9638c8d92fa7e2d60455f76171be54277dcdf88da7f01599e59e4f804a986eca2ee5a6783e3aa2eed114786b4939c0a3381872e5bee063d16036b7b73f037f27f358515f9640396bd4f0f6214881e2543782feabbd89feaa99a69e1333403e4c1039e12fbf2cfde2ab6861dd92c658850211d619514cd90b24896d705f45579c38e50b914e7d086be6369f65b8f046bc4beb1e236b920bbb7e3c2414636a7b8a2fe1a4503aa93c4b0972126f68934692c93b6dd95b3cae457312a1a14c0c3e933f06de845cbf428832fa681522d4b3e44761c03ffbedf8e46751f737fe23b0fda6f6d7524e630be0635433a05c39ace247af4f1fbfaf951a21ee55f1367d1b80f2610966d3816db8b5d6f4361d0b5fce3cce7b9ca8aa37ca28574d4b6dc9d5ea36f5d6f293b6f677082f7741ee116ae564e6c944cb650384fe162359a7ce42ff70177e4055e7fc4d18a88c7a9542f7ec0f7d0c5452563714238ab563b1b6d894887df605258455bf476117be6faf0e6d7a00bad7b857c4e96f65a660516bfbe61028057e607aaecd81ff15eebe706aa81cb9ead8cf5028c7d6b351be599daef0e0c429a6af4005a60801f23373d5e285c0e85d768444afac17893351e9d09a5e4c3df94f674edb7b2a34658e43d0907206c5efc01a767a5b4f5392c73a95938f79fb77476da3c275508d8111f6a76ce6576c34ceffa50fba97e4757e00f68c7a3e9bcee98d7d076d80c82d52198b4b2bf75e5a93f5b2d8a20b994f5632876603e39156d354070ab415dbed093730d0ee80825e0e13092dc631743e6a8290bd848d28f904b7b9158305df6cca62c38f1f61f4d8f31c6a195651d41af2b25413112dbb8a4dcf92b1a6807a94e42b85f4f7ffbe03f7fcd50991fbca3f9b8f3249c283c85ae47a6cb61204ad652597567dc627848662df9c66a56a8ca3df96dda148c612af8a870f20a861be5d6d4d3b0c3bac389f498e1c62957b3d22c30c329cfa2559c0fba87adf0cd8310cd218165413fb4f0811ea4545e04ffadea5eeb7401aeafa03ab1d18fb97b9a673fb610f877d6871225f99e80f754b5c322bf37c1a6143adf9b20c222537729c0f061e31cde8715101e8ab459b1c12cacebe74e596159a349c6a1f822ca9056a296e41436f54a21c6c5a9e48a4101b957ddba474068739ff2aea02033fccde368cf2fd8f9b9adeedc08f880278105dc7050b941fe3cbae0b30f41b61a3efed4a218429bb729791018b6e4dc13374493e610d65b032c3a430ae6f1864290c70eb044b6b27d1478d726fa5e63343413a5540a81ea122f68b6277ba88b441a5d77f2c8a8bfaad593fed0a78096ea86908c97eafd286f1c26501a725271dad4579c2d7cda5b3dd1b51250a611332ca79429dbdb039bee69b7205f0709d6cb2772a24931aada96b7ca1defe2fb96df2d1abd9e58ea0365700fb40a08e79f1806efedaee9ac0dd848fa965afb08a94fc5ab662f0fdaecbbaa9da85bc3b9076597c384f9713d0c2f0e8cf376843118337bb7b93b8426d661cbca7820aaec43b030cdb78efc3acf67013f80f19f65548ac14b626253af7e99318358e16ec029f0e49f986f6367afc7a65a061d84a8df1a4a6e0d94d5a7a46df9aedb419c81c213d10d9da7949099b00c3f32e13bf98f03f18bdd4e226e114cd8dcd95e07e80f2c71e7f840489c60d1bda080275641242fd28c4a06feb00bbf773d9d38d7326f55ecf6183e6b149f830d4ab1dad6ea157487c2d901c886325159f712e0dac7fc155dfc9def9583d2f85a3578138cfe01e0fb3be49fc42167441e82e1d48fe9673307e27f226ccced31e4801760399e35ee79da4766f8348181b5dfb768a94da078a114c88771632bc383bd437c235ca437abacc52f9424b3543dbf3aceaa68f49e265fb339d45dd894f5740e61269eaf8a1a96ad3064ed77d5a80358e4dfd806d04e2209919698c2f4946ea773e4a22be112a9a1b7200d872c63cee3f239405c26be9549c901f996f74883bc84e01e2b6f6312e1aeba0381ec8e163c563656ce3a02dd32741a165902046239ab3a29ccbff5e76a120b3eed8dda20997b9bbf19fe9258b851c82ce97e0c8506b194f123c4e70d97b15f9a52f2fb728af7d51ab2c64e42fba00d42345d42a8df7a51c9ddbc3399c23d2bad905daa1d10437651920c111ad8a9bf207f3add0368174bea1930ccc1626f0fe60a85a561b1731083b6b3ca55df9f6f514042146ef90170a8bd7d3d9e232758ebb949475917e5b840c03558f0cc2332445eae4ae48a2d4b70aba1b1fa22ae3aa415e3a3ee609fc686d3390d46c4a42cf9bf1ac63bec46d65b9075a38391e5c23bc3a57464600302338efae2a6f5adad7797986642e6cdd9dbe80579ec23d8d9a67557eb73fbc692b9653e7bbad632846fd42ecfcb231a2497cbddf5ac191357e7811f0baa315eaa8f5c75a6b4677d56a7741144f0b8834d06a06eb6044001e6284012a760399652bef547143a03f348ef2ece0e5979a7be4a8f3dd6ad7a1dd26643bdf25d7db789701a7ba8a65b84a94ecdd97cc9344e573458992be8b47964e8d7e2a76e2c899e827b5cf8f8b3458c2f12fd189b829af4c8d59d0f0ac4300a12bbc389661593c21c39bb2d6401f7306c4ea7685ee9dc684063","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
