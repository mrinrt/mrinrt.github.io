<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"60df2cc0abd135f3098f173b4e1f91d0c8b12b9bcf2456aaf5d68d45bc4147969723ba13188f50e929f7f9e646297daf062748025ecdd9a3739e120699d101f65476f5e6407e67e6f9587c2d0e0db289fc188c14f4d97c492b65b5623fa8be863de18a77a6398c1a3317979c428a43bd159fdb24b7f849076dc7b7e553a04d29aef71b9bff2a30cfff41523fc91eb26fb3c8cf8b6615e58a202ce59b3e591d8793c32f556c4ba3a4b8c046bb8e4a571cedf04c0fac3e33cfe78f6143be764ebb8cdd584ceed5e68f9500f14f116da8a08500334d91012fe686c0b61f43277051053b8ce63678b7349c381883c2069c983d419a8daa8038081be361cdbde75762a874f9ae6d6330fab023de7f1ebdd6a8e5cc5ffab692f924d8f717877f12628c84b4e382f4bf634804a756de6e18d2767543af58456ed72c3da568f7dafffb07a205ab0e2f8d266c4443c253794df576c7a8edafe23092c80dd822b8fb612471d707eb567a4298fafc0923e89291a813cdf484ae1295c3e7c7392760c51862a93e321b5ccabd65c4aea6e38de88bbba67293386f1ecffc62b7b98220a17c3954f1d5fafe82be4a1d3a9b7a82f0d0bdcc2b9d94c0cb11e8d9c173554c2ac45271b964ccdd215b60acf168b987ab1fa7c3543637a56da35aeb3cdd6157e9e2d5a26d3b956ada14fbb7090c7b5cecfc4669ea85d3236f54f85bfbbd67f4c68c2bc2d1fce2428eb2f0283965ba7ba1f7fc0f2196b0007f2f3c500ccb7c6da38a029c18b09b7d8403991950b1562596d8c3905b6fd41ca445c7d22bbab981d9095529ea46c13cca217f450eb5f7c20d7062b27a03a6f412d93dbd367bcbc5ec1c03e7a08aa87e99eee1dd010eace1bca9ecfc9068bb12690ebed6c25ce7bf899a047f400e798a0783a7b64d7a57e2530b54e6bc00cd69b349acbb5b5ae7a18ebbe25a67faa93698cdd61d333f29f44c1c61318008d97ed420c195befd8057cccb36ea8bc9db75cbfee7ddfc7f60e8219f2fe5df133fa1c99aaf685289b280bba0c1ab0218d8283273d2221317e6a6946332f90ce17015bdbeecb4d39c6411d1cadef82ef705fd52df736678c1a4903c97cd3e8de539cbf6f364ba33d795bb5ee9e770affb552fe656c30c3ddb132d2fc44a128660a2282d300cbda91069843140922fb54a6d34283f638715a11287f6d281ebf5620b14239c4b5827e3928b41dd52b8a0e30eabf5fdc5e1a549eb81d7cd02935ba3a310b5e5fcbf3e8b63bca97c0eac1bc7e6b18d4bb39ec277a641d2c71841c89642a290f1b2cb3d77a739a65bd155cd316aab05c09ab0a7d4d8d0895d42468cbecfd8715357ebc01da12663331c805617fddef35b128c5881963b24a2e081acb19f79a3255b9aff2114937dd79de596fdf3e7975521774f8dc0570bc7a210bf859a63ae12ad3be0a807235627739de3ddde9483e3bd977ede4bdeb754973f0d48ac3d39d2e5e86c5218d7fcfdeb06bc115cbc5342ab15e328e39ef13c702d66edb3e3ecda28f7e72c3560ed1cb53960448eb0ea6261b2c7f131146013f9a32267ebe41573ad614fa7b13c25729e5d62fef697fe9e4c8ce165bf557b6fd55ba892303d14f2f03ed23c793e18983cf615c55909ae100564ac144e7d52a7461ccfc4388ce64834f83211c191d25bdb72eeaabc918e1f909a2e6bafa5da656eb7c56ab8250965ad79dad8ee27c3a85aea758c258d65efbb968793e081932333ba7999cf1e8e83356f286435630d940cbaf6197f310ed464f7e29f83818c22867eb065a031b745a6ab8bbc5ec73275399f6a9b88eb97a60f4000df2b9969070b7c777a24606948a870b64cb628dbe1b9c9df2260ba3094b893214c637ee1f5c9c27bb7cb534a248b755ec75b472cc69bbab5395fc62941c049dd0f843091bd05c90802bcaaa4824bc189db236cf0a757fb6546fa7d1dcf182801cc167235c7a574151e9aa6917dfc78b32baf2c2515d078bc33b3934aef7e55b8f659c9e563f4d326f9f6f67935b179cbeee11787f456eee0ae4d5e4d532a69e2867bd2eac45bfff755636afa5fc3d323db35aa9e5006bc96866699a0613aeee94622214332c8702ef1a0063498b1bb56df0bedd1a49ace1dc42cb584184cc2bb4e654cc1e33ecd8bd86d1455cd7ca239334d5dc53774718a5ce998786681cf6f77eb22b9dde7a7d7eef70b4cea32081aa0cd9e0594c5f1b2763038810f381f22743a0bce3850f1da34553b27e3f4b34882a1539ddc676c52210b26452edb0f80383b3ba83161989690dbe6bdf9956a75b6f46dbfc14cbe4ce5bb80e2ab3970335d1d2ab74bbc7974e0b9da58c800154d71b7ff5efb068e7480452e6bff20d081eabdc51790b49c911778a6ed0d901698675dd11dd100cc8030a2bf3bce0739ea1e8c30f8a9f40fb65e4b2c8edb7b146d1968c569d7ed5f66a33a413011250f86029801800f34e51aa15a8854bb3653cac624609ec7ac5eb8e4f31fd2d30f5abc1d60682325a5b55cea3cd31b84dcef3d7a1a8d855a283286dfadc0336df1a8605751f74351cdb68adefb1505ea4efc9d704c4e0e6cb957b15de31a7fbd66f1627fbd18a4661faae7449d581b00a3a711af6762fb5f216c8b6620494f4454080a2b404f3478157074746e7b07a8e0d9cd280db1e3577c8444ccd721794e2c1c3cd36bd60e8a7b076b1dfa828c3bfe64d73c18bb7f25d71a477ea51ebe18da958c4ceb3db83e9bbda381b30dbca3334f2b8db7ec6302d11a803147e31830e528dd2dd71687c4dda8e88a6f80adf17e37920fe1aba27de90ef612830b69ee25a65caa08c5e966ae3a246ad3e544b8c82635d6429743b932046e66aa50f62bcfa85f8457b2b89efcf223577483452bc53b23971225cd0bc3cec688b20c68e620776763da1f90d4ec18232adad311cafd30e53f0c4b2541c665d23648833e962381dcd3f6465003ad1797ae7e88004d2a297d4045ec337feb9bcd6c869c679c5ac8afe2be916e29150e3853a593fd3f8d23f7660d7a0271c08cf7ed93deb083c430c6caf232a58035d6b380a6a55a65a74d8b8e16de650ccd2be2b708b0fcd2c14b5a14296a3eca8eb77588bca5e2fc51ea1e086bd25bae6675886b4a5838b920359058d41192fad83f1df1d8a8e9c3c2aa04ab205ef0d651aba6d1db2753a1f417e8f61d6e49737f2d4a587c883661329cd9262520d9b2483bd9ff4dbe20673402c814d3121c285360f5ea60e2a6cafb832d79378e27cbeb6fac8d438001de5d7a44d6f3edc8622b26b4f3c70f9a73cffc1f6a3c80d4e95e00c5286fd25a2cd79a92506d014ab666ac775fdbda71f92718068621742233f603b6c9c12918a6964801358c4629cf2acd01afa31dd5350d1ae36dec7095776b653d930f501bc43b4567389bf6b8a09ef50d7cb57cb3952b129094fce2d97476abefef5f8349b02f9fb929c93fbe3b36a96f7daa5eb04ebbc7e1558b770aa99ea43ac7b69a49a9abb84f8177023f8d3d7b4dc5595d8fdb25a5c8161a325de0ac86aee67e23b8373ab08840d3d2b6a5c6b9c03ca4564dacd188ee150ed4fa2ff7a1a0179b50371e930db963fa87486924263bdcbff64ab020016d77db38fcf36c6ca727aefdd29f772d31bcceafda16615d23acea801f50b549f185fc68c5facb225b1f3868795cc1954bc34499a348784597d64fcbc4a2059d794116af87b10c7aba0e18234111cebca6073c09e454d3562d1339094dbc22fa5b18cc75b714ee5899e7d9d5f307e7a4fd82d87ef7bcfa6b47fccb6607a082ec102e1bde025496e1a76f1ce622cf8336f32d43c54c537e3b929c692accac5e1a3e6560add56e187a27dc25e651fa3401f3a9fecf542ca7cc4378b252887d45533c21f0f88bb8b32858c11d151e03becf5227a4c1ebe7f795d3ae9837a92ea8b5272c03768f7770fa2713ddd2e232b31944596a5c88234682ef55a0441362bf8f370c075845566ce68ed3b831a6cc48edf99eaf77770163c8f6392a7f4bade27a7b9abddd065433da131fa7ae9148614c526467ef83bf11a8ff6f6e5c759ffa5fdf6fdaf99b8e04c5c83b387723e1302693d677d70074284d41d133ebf99dfff5430237a6af516ab5921f3df491c67e593e32908be712d36ac4c95011989645421f8211a5ab0e0748eb449d31d81e1391a09e11ba123de4ab9c766e69fa82838cbfe39aeab5226d4837bb2757cf0f13467aef9b8ee082ba6d9bb92057d30988e38d7866efca1cfd613ddc0e08866ffd98c79eeecc3e51574e35b1a9ac97b7a0a02c789cca9dd3bc4aaed11d65f1be710f0d49aadb3a9d58431782db3a131bb4ab19bd33547dc39c8cce9403a924f8aaef70899c8c920e8b5183f346b90a7e09912b840cda719ce2075354dd607603b12904c788cd8e1abd3bd53bca8b041986e458682329a09187363c1e51d861a2ee778225eaef2c270c23f02a05ba795dc7659a860ba17bc4c8257353f1926d5f931c65b25be89ae0ec461024ff583de693e3ff7f2b00881eac163ce694c7e2af34759cb83dd974249359f4bd0ee91f1a940440f60b1e353df0bf438f6e0eec74286cd22301df26a44561aef3e953d89a4d585391c4c395a9d0759b51b102e2b3de23efe5470ec0947cf8912e9ebd043260ffad346060dacbdaf5bdb7fb97e7af00b9e90e0182f8b42d6f11b24642567610da455c234fa62d0ce06d3cba9e04349c745b19b68633d7e582a9c230a87e99709dffc7c9aa71fee4bbf339b28903436a3dd89da875287166871b69aaba04084caa03dd58207d0960a6f6bd37c7e2a471fd71e552ffdf47f948f1c156a85e375ae67b43740b9162a392650e4d992c8e5724b9ffad977dc288b77336a5532697720666fe552fe18814234bbdabde0772fc45e7718e8e763a451817331380996c4a77fded4886448f2ed8947d76622a2086b08fc0e9212c93180e3e62f026a351a90248a1c8e5972798224642d72799cd66b9cb94078945bdd8106996e7848a6305a1046901b3fdfe11e9c7b49dfe8d26d6538344f96a315225cdc3e7411c1fbb00e24f914a3f69d12942e39513f5bd1998761330b6cd9dc40212e3c4977c0b63e8c827385268b16345ed465fd22aa145d3bd73f5c9ae436736f4f00e138808c55837e48ac171db5b1f1c5ffb999a36f368ab411ceaa3804dbb10fd5ad98a2a70336aaefa2db0b8c671793ade1e2bd9d66fcb22cc43f74cfa0f0eb9a36fc20d243ae9a4404bb06bce67652005cf549145d7200f41f5ca5acf517ba1487e55a0069c3500872c52aecfec3c94de636997c3de2c0de82d810ea83a1d18d7c80e946193da5065cd820a8a096da7e3cb173b00925ab64f60b6b586e7a485f029bb8c118464ff5c35c3ce0b1443a5bcecccd5aff6dd6f01b258c279ff808cd350072f2ad8416ebc992d576d8bf5935de831418ad0f405a53091ba03e2295b6b80ece7b655705e873aec27511520532f40396f52f76b4773ba272cafd5bc60b65e2d33411cf07ecc7204a1ace575115812b85c3840572e5a0af8b3edeaa2b7bdc6d5b90eddce12abf64eaa964269141fd7b1a38a1b65cd40a8a3030b590b9b355292aa6d1e81bbcc2aeec9e9658df294a1b1581872ad9dda735ef7140747000ffc1fff5d67981d4c558116d6303b8f7081fdf4b1c3a242988f80d43c33eb6b73a9e03d3540f073f98c3d039f64092e98cef7b13bba27847d427672c5805dc98f1f7f8546b76fd36981e91a07b33be93b3970b181e43dcabc34a9d840e7fab136fd44e568048aebcafbc9f827f4a2d810de4d1b444765cfaa96aea9c57ccbc47f86bb7945ab516e8e3e3f744364106c45a85c2d529f0667895ec2af691258867e536f6dd48868f0cc1f3cf905bde05e9d0957daf482fe5bc1941912a0deaf4d64aba52b9d14aaffa5aa6a3ea38ee0c821c686716baa17b8adf336a0d5ee6a97f160cbfa579c02b18f403a8853ad8d815abaa90ff9fdd96c72d28f2f49e0e584196f6fd408cbc701422a5fa043a985bd1d26bb4248b524b16ceeafd4a2a45a21ba49870c96450d68c95d2c1a7d01a7bd68c821db29beca5d41ac701b42605de3eebe9de9513834422766bf7436d660b914b8139b7d2374b79f3b6e1a1fd11f36152101c72d644c629a868c510ec6090f5d06b963e53260343203ffaf5146ce04831676508f6cf6ca364bab7daadfe7a9eb1af5c5120342c44e542f2af192e07decc59f833afc8056a7d0ec430983459861216b9f89af1e25a8ff232be50afa7ce586530216dcb304aaa68b237d7013612693c0226939a20edfd6299ba0a542bae7654fcee082ddfa369e7675b1a5b68dd41a8b4fe5fe4cfc4175666da4866e139a4ae4f562dfb1ccedebcb695dd59d6972789bf19fa85763d0c029f0e37df042b8d75501537cde58d3fb675b180c48232f931e72c29f3a4ecebf19cd78406e66a93086a7400364ce9efbca0b3e1e9dcc9df1feb24f3007d53c480d447c1dda1559ae61f31224f30e1ac0c91d062670bae9eb2374c45cbf7a994cb5e8dbd56efc2b24a054a784facb46e603d8f126ab3dbe96fe6524918e40b8f059c65112cccb0c33b77b59c5f1ef61cc12a39fb0a486a8bb7a0c9542898ce1761e8c013a5db14230d2261185ae1c6554210aacff522e85b7f6563b5789d087f2cff598b89cba4920ba22ddd7ecaac6489929e3a3d0d943a6ede17ee96600fe77f7ca1cd68283db74c4c7a7f43077ca0b8c9e605dda7d4b6eec86562e7339347d989a9667424867c2d1b252183c591c4663017d111f99c5734178b088c3c38607c701e7d95a341647b522dcc7dcbda5af7d0de94196f8d4bf506b48b6c2fe00a56d1d7d46eb87aa8683356371cc4f746f56be2047a384850a8786e45885d4a67489ae71b83e3110fd1680884bde302d5582ce58ab49f100fa5c08f503b7d9c88c115554d2cb5b85d876da61002772f8b93698dbd67aa06e8ad93670707bdbcb32b7e6ce62c6b7ef4a0097f5e25d2aef2d94d03214c823a1ab6101aba966ff8765a58d9777bc5c0d83cc67ec29dc444c80cc48df9fb817a7a50abf8b0888ed5d258c22904d01f3a759600408cd6067060269686799e38a9aaef6f62d02f39284400e3baa5c0d37627b379e3bdc5df37b0798df5dc489d747050a3ea8e9c935a6264c6657a340c4b84076a68684af8247a7ff08bb9396a8a27cfd5a3cec54d1304072aadeaab383ce4d9a670a0a8a97128c4d424956652d4cc693eeb4d119582cc2bf1239682e95f9c57230b6c31c31f793c298301adb2345ba9805a4b5837685b940a486a5b715fab8f4ea6d1efa7d0b0e8db82315a5ad2a49eb3f854cecd3551c3ef77594d2d56cff7bcd19c06549f383a9c6252b7dfd77a434e5c0d50913e619553b62eb4d47b82e2c08abe0262c1762d774eb66f41c62f62dc8c510a1a08e587a4fbf995d614e30287a67117ba9ed7f172e313839b9a1f1c3309a8c6a2bbd819967e3de097ed082d5a854a95bb9d57ab2e5929d928b79449fbd6c89b6520c0c3e7b67c9d8e2c09f7384785ac2ac132e4a9200a52b0a27558501c9ddf47dde49ac4324040dc381e659290f975e5ac97085810fbb392e200f33afbe678587acd72df3e58c633378f60632e4a2ab40dce266ba7d2053d3fe02f64e282e1f5fa566d4b8c9ead1abcd10255fc584fdc65c9f48a118811efee07e62bc61abbe8685849992a230fc4103cd33fa87148f6ca78587c21d657fcc633ef7bb869515f34ffa061e8bbf1e168f749df8e35cf43be56e503703b8017511bd3bd3d137225c506078387080cef9c079b0872030a8a4b1dc4bfe4ae71d03825205c844c125d5dfa4a3473da3c35272465f4356ff88b2226013a53f4d66381113d9966f7087cdfaa9f27fabcb64cfeba323f173ddb794ffd1a5b384b85dfbec7b5080727fbc766b64bd68cda7d8e664a412d9be8f7cf83087a4407dd567da20daae2a1422522cc36c38abb14080144545b24a667ede8e660667d64d84435ac07fcc453754e35bde45f174e0549adf8e316823c432bc464cbc6875de3860df1217025d220be81253afd545e5d6f4b0cb2acc79aa826ad02492efbec47adcb603c565bb081974be8027da43d7dac8a92f19d7e0a8aa31c6eccdf7c89c7b48a23694fa7bd4f084745b3bcab09699bced335aa1888812c77576eea15b0f9a600b0c1f5640c05b84e2ea6d4802a569eca56e766d3dd86d8e4a1e7de3ce08752f4558de2a994c29cbc57d18c006e3a52432d4bb2ffda06b6dc72fc9d32d18ccccb564a78a23b9865ff9c4e722c0cad35ccfd73cd64e57433af98eee35449ca93f99972e06fa694ee815024b96681dfacb78859e8aeb0184ebe8d8259ae097468134d06849778c78b81be07f2d455df0aa7e6a31dd1c2188ce855ac182a612ca11ddd0500ef283bc6e2fef8d8f1e7aaeb63f642b3034c25f743f1d1c0db839caa9950873278e69636383d2d3195d4fd7b0c153776a921a67f6ac45332c2f12f6f01e13aab63e416c9faade397e26f375c26b647c71ecc57ee5d6cf91dfef0eaa15ac98b0e5290ffd5dc32d67c729595d9502f292ecc0dd7fcaa0f6baaa1343078f1de000895dac3abb2a447b966ff6db823887f837110f81b490c54cde5dc1c9197952beebf35c9f28d25e02928410b1ecfaa1cfccaf8e00df393ac3047ae3bc9738757f4295d4e15fc850ec1c3ab947791a850b6b30336f5901bca2b7bc2885ff0bd245f7a6e1a3ac2b037c9bc0e09a170c2240f0d264e3eff1a94173db5ffc7148e59ef5dacc9e6972e5c4749b00f9cedcd66f80cdc4672c05e2d23069a8b127d8c2b741038bce81e26e1de9dcc5239798919d1c68e177caf263867162430a7a937517cabdd8d7d93787dc29354d6a168632880dcfa626f49c17dff9eba94ace5ce1941940da5e498decc9bb068b104d5b26224c9dfaa91c6e88dbbf207ee6837b85bafaf08ca0e057a9a78fceafdfaf271a82889508cb6fc7877089b677072e438f72d0104deb4d234a40b177e2ed0bf40fd192c0dd7dcd662729f489c8112bdfada17979d2b033571334fb6fb3484ed12536dd295e50a7eabd406b07871a604ed4354612a724117bd86956d36c3a20cc89b4cb3cb096d92c63d404aeb6d22e021dd4aa438d102118adca00ada140215ca57bd8c2768a0b7c36f0121df5504d96739133ed03a974d4b9328b7ebf3f7b8c7a0f041cf0e4ad18744163cb3b5eed83ae68397eb170ffa83872eb0570e26cebd8db94c47e1f5f052cab705a6b8816002a7353a38877841ba56cef414e9cc6ecb605eb468e1a0ba869d076c340c3752b363d97ae5575c8b91a8f15ee4ea732c01e2aedd4964c78aaf5f362430a5140dc763008e99fa23ed47f2130a02f1277678f78bf645f945f2a902fd70ea6a85ba1c8768d5cdabe56a4ca5a8fd7899447f4c5fab64c2c068f533e73921644046d2c6a043d04659487dc37c9942ed0207cd52728a080d3cef0569e3cc4fc3893d982575ee5397f41cb6770bb4ee6b3b508e07212d380cb03d82b6234c866aa9438f0bbc7bc09cfb0839b484dab3fa8090bcdd186229b6c703103d8f4c4ce7521ea1cc49ed4ab800e49e49193e90bbaaaa65007181dde116af6298f552efe0fd3f2e7ec129f6343dff57ad2fcb0c76883a0ffab6cf3b64c1d5d515b70444506b6db6551cb254e76633e7db2161a1474b35a83b0ff59b1cec2d7767d47301fb808b0b5a65de80796f4987f89fc3020d3e4ecc4b3f6098d679684c89a4d5f65c21bd42e778b38965828a7d9c27886503ae87813fc395e518ba843ec32435e92c89e020dc40fd28088b066bebb2a99cdddc70850f948cd8739b13df25867a5a73e3e21e1904560f497288ab56e2bdccc96309e09236870306b3edb0ba6400460650b8d24760c2c4d88349a8f2af20c466844d82b5538b2bd3b42a2ad059b47608dce379fb5d342491215f6fd17029720e432f5fca3dad8bd0c10bc8ba4919d855e41692e18c1896bd38252e0c6df9686e7a6c894cc561bd2fd68e5355bb7289eaea7a16209b67add7443b9aa9f45c56a32db2efe96264b534ebd129868dd056c97751bb4124f243316ea5a75cab827dfcb2d3cb07f0a4fc0d5e89a19c25bada6aecb9ddaf4ce661436a3ca950513fb4465798cb9728efaa999741ef0900b3d85fd8b06ddb0a8c766f83576964f7d4a4b7936e41b94860dbfed958f8d58852c0759afe165c57899de1dd5b77c0a7f90a875a4b943fe308b1b4d80504c77538868a0e4669ff1e0c8c38d042dd51e6e811a754dee2aab35f07684445494b4239ac8786ac396c6317239d1cfde7eca5445f66ea82afcde1a8cb58196c2786c2c01579300b1e7f98ea2a7d9a8425426a984ee677a741b38a89df9a8d11e05ec0a00bbf8d1e6d3380237e85e6a522ad37040df2a74607182a896f86f127d759eb8b9a45b4ccbacf1310329b0a6da9a751d00a81c2527a7b0f8ad75f920e3bbbee78bbb6ce727742fbcdc5006c8525790746eda82941d8e9246894b8d8cd144c9e63c82eb59e546988e6d2cc3eb84020a358c32ebaccb7af0e1ea592d73f5790fd83f53a45b0dbb9d4e6252e609c228b3608938ced5019096ec420e5c766f707da59c4214f89a5fda2c27d616fca4dfd2cbedba6e9bb03287623eefe6726c80de378aef8e59e88128981fcc246fb63a6e34e3626b01e9332930c13039de25388c6e2bf06bae39c0378aa36dbdf5a9027c498750a300b8344f76689b7896b1b9f80aab6e57ea64dc4a9df1792888d748e5467dd08fb3a748025482607891a2141c4a0e16ec21edcded5a34761ddc38989a44c79f5f6e5f0fe29f13dc216784e1d71c62dc211dd1e95ec671d819b6b806dae189588c6b6fe05eac23286e3a657db527e11643920321ce7f3840fe52581856dbad1449f4f8fad9a9a9710b1fb2fa7ae5b2a8ac7b97e936740ba2c44902fce1fba0611b0b00a4d6c4985255a5051ec78af8fc918abc5702b3a78693dd9821344078e8beba6dea3b62fa6b1563e8b90e6b08aae7c05612312a06737e30e844f011a0e85def3f000e0cdf2ce86d596d17297a19b3ce049d32d6bee7b63cd960e1f6ba4cb7ef0f2d78b52979f3c76104d8458e422ff02f6045b9f6b17ff83ad299302d625c7635385fe06f89e8bff13a90aa85b92dc0ffe77cce3b373139c7da582aff0c50b4833684d593453d8c0f0bdebd5903d41c871f17ca8d695496738a6e0e6ba78571b09c8bfc290991236e581ca9cb385b526837693162bd6e63ac4ecc1595176c622b115f972d6771f6bf7ad0a5df5bd025bff66a39fc8c405756c1c6262ec09d2968b9b3bb5b53aafeed0901e3008964983c603e3888d9ef34d34902ecd2618571c5a7e5fd7aa8ca64342b97e0677e1cdfe6a30da2de3315bc2c4763a49863d2d5ff3a7b246b279528699f401c6a9f29e1636378ca027fab8a7e22908a4f0363cdb7553fb260b3fc9be5b7bbb9a43a2e820f901a46cbf38bea020b1245e3ad41688ad709f8a6e956c126529104b30e4c3fbd8a5e3e8b8cd59302fb32ab6f6dd9dfef2ad2b3755fb7fc9eef9064896e98b22337d54f26d32ab634a9d4f6fa3c66107d7370cfef168ba74f497f61ef0d5d659e892856b5ff67eb49d2d457e733ccf9bcfc38b22544211ff1177f65cd7ef49823b22778f42ecef5084ef6f2883bdd4ec50ec4e27627c0ab7a7f9bf2987cf88e4d70dc8d914f20405274a301d6ce41e51998c96640f9fd7009297d16675343ac6f74cfc351751b39d2fe1aab8ce2ac3f753aad021e8f92e2501cf2c1c22db09a7892f2f4982cbf04d8f495024f81b60761f9936cca3bb5a60aa461eb6f27a6f8af7bf9e7cc78b51ef3c957ac5335bc99f5be029fe2722cc4a47ac9820f5f363c4e51cc7be5d0bb82bbbe80bf1e04213789c7460b70a8494ccb72ed5cf371c5d60f0d6d2855d5d6850a329720c1fc9ba8e12eb1ef913a2d714ce932288d319de41e502e31965b9b1ce9edd12b1365524d32068e917ae97a44a0e1c789d95d9ca80d80482192069d7ced7cc67ad3d38ded8cf4d27af95bbc57291fc1e6e0cebaa61771369ff4eb5abe078eadf19e23222bc4b6f0ebc5505b3bca9cfad05ac5373276ffa76171ca0a0cd2f7ab2d92f913b749805eac567b4f8f07e4263b640fe6327f2a9b286539375dbabfc39b5ff0389afa593fc609ba56caffdfd97d08f26a750cf3b500b29026675e90ae44a26438b381c321ffdbb446515f81077f1b9c21d0a28c99c5a2e06839fdefc7216b8fa5599b44b97c3648dc332b3d25b4c054510bca36c2d833ceae51a8d0b3bcc437d6cad05e5c382db6d517c69a0198f5e15b14d226b3d9f7daf397035374b98a127f9deccfaccd4d7fccba07c457af767945c3bf708cce7559fac0db6be7dd5db6211408ef4af3994e4880bbe4516f0bd01e287855314dde384f80f3afe607217dc0a9e3c1efdcfecb35d22c78b3b5723645d0814dae99c0ef62fdf2c7b45f2b1b0a8f98ec326c9ba89493c8c71f2765470d3489d5c8f85148383eb70ed638eb33ca166185a99972b8290df06932e7cdc911d47a2742f455de4c9871eeda6adaa47ce7a6f67342ddf4d22d57b53b7b623cab3284ca27cd275d2b7cd36d76aca689e5eb9c663acccdd3d686acd928e902f5b3b2fd108b6ea0afecebfff0a0f770791307e0c9a5a3b0c73857eb2c2a19c4cc7074c27464c9f500829bdfd85b83ff438622d86bd3e9d30e7c7b2c6ebf1e6ddffa02b00106547e15e4b3beea329c4ddaaf91fccbd3e59080194bbf8af6e5f0fe2a41bb6b93594482c7bea2364d97ed26d1e9db7315ea5b6cfa5e759638935dbed3c0fa729347ab9d9144dca78455c8d3709a218dc6a45eeb29c11875ba00f5ae02876ae0251c74a1c10d0bffc33824a1ee036f13875390ce74905aaa2e37e14896d8140543587252dac8995535cf72c031630acac8975984302d40296403db95aefc25c5a8337ea9f5ef25cc185884ab0780f8152bfe82cdb07274b70ccc44e97277b2ee49e73ad8de5cc7b4f5e44e492d5dc1cebdf758739bc5e618935c86af51cd6bf15f3f82701256ba87de5aada5f0cdf759d8139f37dabd01a2746b77748615fed663130f8e7545ae3e2bc47193cbc469cbf95f465d4db218fd4161b66d4b627ca1c4cf7eaeebb911b30685ff8c173b564845c6116182bd7a5e8a0fe8e3955b40b6ee2ef7816517658b8c31a03010bb2a20a287bf0942ae22582a649338dc60e7f5da34c0e432cb3955a529ddde6a584095951bfbd979e432cadbc4b902b62b88625415f272f13d03abd2f462eef29e0159b6aa1187f5fd0add50da8156afa7561c56b0c334d42610df67a1662906b3ae7f5b7541d4e8b57cf67a960c46b8722f31b51a22ed837ed1ebbf93ca809047f62db3a96c158bc56ee3f3d80ec476af5e605cf95048387ae7e49226e35c5a9c4a3e30b1e4fe40b5c2ea83cb5fdc50d020981716fe45a230a5fcca4d9bfb5aac06978fd786fde12fa657bcf1d6b1d42e01ca30611387cc7b1e60d63fb0119ae2554ac6a3846f77ab3342dfb97274a78a75d668b06563dd6722e38f18f5c5c07bdfc90d6a20856b13757f39f311cd0436e21a9d8f66067c01bdc521d8542889edcdcc6646ff5b91bdb98852548a49c921fca13e2b7812012aa3cf527987832ad57f063503a141ae3df016454195fc317ffcb700af5853fb409981304014ecbc7d39b317d02d2124ef916bd56aa1a4ba8a030e30d272c429378fe27c79d3545fe57dca4a58eccb2adec82ee7654c08bcb5283545aa056e6db64e4da455b7c7624f8612245de63bf8d7d1077a5c816849f3c59ade7374ea1b1d335c6668940c65cf4a8f0ec830d2eebf6bfeb3c1820af1fa73215688c3bbd2bc763ab649650b2243bdcd5faa486aacaf778b721a436d55c50a4255b1e3ff30208fa9d9198632fe1aafa4822a86bf574fad67e8d2ff8d093c3d54534eb36413a96aae38c306021aab749f17f11bbf0ab61c3fd66eef479fa16181118fc337338c02714b0f1e49929e7dd9179ade2917d399bf2823c2ef3ce424fcf1d7ace08b91bc3c3e40422ebddd04a1ecc7ea044d93f829c3582004df5d162635c2a41d5792568666bf043cd4c8f5585e47df9e137ac95e1d4bb53ed4e84162978068c978ec345ed86224ff15e63555cbac6288ea89fb6ebd2ae00ec1e302c2e434842b2d089db2ca74404b4f32df6af314abd417b6eb67ce4c0488445ca798b2beafc0f1e6a506322dce8b52628aec8f4d3571d76b817b6461739325543a7d5a5ce8e50f99548f875033ba362d4aebb5de9c955d466f3d8e95ef5de3f13b4391de432f36b36036c21e7bb3c06a2225d7ab6814b990391f9f2f879df43f14f92bd2ffda67c75f804b738afdb16a7c5fc79ad6b4592c3b603dfe0b38c5146de049bb090c5ae5081ad979ad3e8ec19979010774bdcc5355a072d4d0b3d8c5954c519df69c51160d331bade2a4874a0c88a62796de6ca379da1aa5509e3563f8a7b4b058f99136c4fa518c32c4d347b214b2e75c3ee31fe64309e2495d769325705600ba9f359972a04b8e71841cdffbaf8a44b50c9ce3eb37a629db96d06ee7e527ae856de6e3ce83c1c19f01d8642d99304488dda095d1f403e51317dbf985","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
