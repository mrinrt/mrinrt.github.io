<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"599d37532fae0a6eaaa9c4f6cfafbe4d5675a03fc13178e21a5f37623fa03d14c18a1c6dbe6d4a440b63b0be8b54ca59597181d9f4cb813027062c115c58d8fb98bfd932d6f75a537dbb2fa3905fd2237fd89f5612bd6b46c7499d223aa7b5ff93c4a726b657f5d0efd19f77fc89897739bbb0ed0fb70f799a3b92fb76d72a382d8594a83462c736e90a5e11426260e2e5a854266b95160c60a7b0d81ae89777f966ee0d59956bf4a64604c2a79438bb39f611bc138c41682d96d5dfab85e7439695d71fd644247c21924630229a90ccabe2fd488da17a044c834c6df9446468859f67289c5cc1ce171a88b0b9c57d59a9704c612ea30aee208ce1d61c77445ffa4d1db452f7cb49dd8243dd46bfe87c1484e76b01bfcdffe37a7a43de32e06c408aac4ecbe34c7d0051098749fbefa25d76583f83fa40a92b4b816867f5f09ffbd46c02ab9e0b2bd1aa978df11e60d5d3098c8525ee3c091aacd15e9b37f893cc24f1b8bffa2b02c9ce48c03d1cf7443345bd9be719a643d76119c4b3ddc8cdecc932a6572746415ecc09435e5d2bffc8f9d8cff96ead0fe1401e53333a2f33b2a33789438a3c7f2330f0ef04f706b0a7412f225ec73dd15b04e7cee60559f73e3c31508455844f27314868781d77075536745c0e8e2e978d827f13291c52785e8a03431b0945de7640ae91c5b699389c0ffa7c30d1f516543b0721e4159798d13325b115ccf10e2fe2e13d45eed653723010042944d04b856df2e7a1c1a1c03f36b8f4a1452687dfd75c6cd1cb144b1784b7b45d76f964a5e50733ce3c19dd2f7720e9e4e8a61287cbe4e6f1f4f25b1947d70205f56bad64fb1ab5d736ec3533c49707fd825ae37fc22faf5d31cecea2bc1c1e86760d250ad7f4cb35ef060b1d6f0dadbaad637479417dc107c9ee5019ea453044bbd7509f2f03775a6b4d1650c2fbd5a3aa257d7658b1b2e16582ddf7d328c249b935ecb9893315736cf315c63de7bd55a670e32cafb991176db302bc39cfd64e722579d00a8005472266b9c50630582d19cf85cdfe082d6369b3963c171b90b53c2ef90492acbb8ed5e0113e3ecb134fbfd6781ed9e29aeeaec75c4013cb4adcf5d7fb05fd7b2a3934bf42a8cfc884e72b04452deb30f6f0dca1a689fba8a74a2f1e17b46a043cb8babb509d438bb4d5fd831ee9e340bb4c7420f9ae2f09804cd99c738870f193e74055499df700521b2d8362af3ca7fe2d6612e876a0dfb197e8e2e6e0bfb9719a731f1fed372cc3ed1ab40d56ce5524c8f350cf447f0bc082ed379534ed149bc07c8006ecfba24125e0be9b9e90fea191f381c2fd57d1710db94fec5374916b7008d735c9cebbafd0de4033eb3dc1d4229b1f02be4be464d9cc17b7b110ffb88b847ab36cfa3afec2da1c8f6bb47166e42b8f6832e6cacd92ebdb01cf5ff8bfcee482360bdcc6501072278ad1b14cce0ed92337d0f82e44012a2e9e011f249af4591e81c97e119a41977fc04d88bdefbe77146ebc32008fcd4f7c39083479dced97e15082774da9dcebb1ceefe4e080b5c162ecea6e9e0c9a3a81c1593860e30b1d3056c54779dda0c548111891d9a0bf694419b8dd9187b884e505662282f5b96967ce68912b0f12abf51cdf3fb7eecb6c12f0f58dd17bff6c5ff62f3a1686248fe7d32a39bfd07b1eeab510e9721eb9325f1b22a5508a3bb3069b42a7b486f3c06b7893438739c124cedf27e963e1abca863e50efaeb3125797ad65fac2419d107716ee8e3aac567902b495f0c60b4fcfdb6a22686006356c009bce11ff330b5ec10e1d026ff789f39774a801e0d498ac459d0d9ce9f608a286b3df4b44085133b41fb726492a254f794c28efbf7be584790403b1498e67acae71e19b18039ed12fca20f07d27816ab8d4bcd4982a983d532b8b086c5c9c0a8d25ac0a39218dc974001c6229367a4ab316e3e356adfe1e4d83ec74c4b57f1eca1f58e8b7a2337a722311e3242cfc29dd23f56eed0b489f79237aaf2db8970941ba857a3cee36be2a2661c23a48f357fe97caece616503884156a8fe65f2d2dd41138adb7f02b9e0a4902936f53c03cf3eff81781fc1c13b7321466b4dc1c60ee7b0e873d4675a151a55243948018b9927e8b9023110f5630deb9f9a90f6ffdd9923d78fb0015a71a3f0e5ee95a42889cc80b0c55d28fdd3eee407ec1608b96bf727a2011eb1e8ac803b5022bb66b2c3627f8c5ca9bcee6f2a01bfbf6b0651ca7475917e65aec032b53bb9118a6ea6ff01e71b013f3344da1dae0a2f013b7c412a6424b05a7ed937b25c8f1ba77ec9e8d687b91ab4b215066088b2337eee033c25b1ec35107fc55836ad7a2bc39bc5f59e936bbe29c709b4fd926f6337b72cde8c9ff6699e9293370c3569d13860ba20fc2a9df96a5d10dde56f1d32c4148ca3377367fc38c6350627e8056124a5d55051f4e0b081269b581997555dd26b3d05b0727630e486e5d3286b31abce62b3cd426b3c7c9f57916237d4b2c38539e9640c1277c53b1a4b6e7d266393f8e1cf9edff1db6b4985d0ff0e0dbb247aef8bd80979a0939c230554cae443c454184bc91715b029a86def8939389306a65db097f07346c34bb8847ac201abcaeded670ad81eb31f8fb9120a1c7934b867af9ee29e4730445b942af04b9e9117ff96643756de3913102f2ddebe859f814f0ef674b15b756337c3085b968e65a2dbd980fee887a20f0c9651147976adab9b65ee2c13fe257a0b91773f5c243a81feeaf349e7eb262ef8843856e006bb3186349f8029fda3efdc7c6a07286911fc517c08cf99b3539e80455decffb6dc303342d9d80a060ace9ebc98cd5b04db83842a5e34239df1e709f639e4ee69f0fe1ade7cebe119d8c2961a6ea0d929bdb8faccec1a5bc15410caf890285632f111e53c6fa2778aeadd06f403c1ebfa2b1b230e90930e6a9a0816bdfff00b2ccad88f4862d5176f7fb3e62b8977e0dd2f58543a6384d025ee93fe91dc23ded119f54e987796c4f18e199d87e2d285cacf226f4f8af7f420d367d92ad17b5ece04bdf14483ab31f00dc1ed98caad1dd766dce7fad8edbc12a00b7c052396d1e6aba7270ec310029f58a1c75c3348aae71215a36c558ee23dde34f63bd764ba47e26ab433352a6f5089134ddbe36050a75ad386b9adcb8cb9bc3a323ab600f820d11e197dd8a42def8eefdc45f9eeec20d504bfc112e6beff3ac181791e46668cc1fa036011c628a679baea3a89da11356a78c91db07898194601d392151d034b25669cd122b89e4b4680567222f5b61fd48b48e2b2155909243ab180b0791f3d9ba1b1f9510a9a98839d45e07754aafaf2285cd2cad65253d14901b23a7ecacbc9578a82e8db6dbabed28fce1da9a34c9a297c7fdee565a7710d6968c2fba2f3d998bd4eac84b4ff729126688ad1607037863bfd9f90adc98014ae79d520e72c057a8c5eb990e15ec8477d0bc7d6d1cce417508fdc736685d64af9d377770b90dda534752e733bc58e21125f6729dfc3e39f59e64c3586caf4fa7df7aac158e7ab6f2d73a8c755c330203481f143c6db22d7105e77f08d89a49f3298dddda3cde8a48e05fb12ce28625a7430d2d9d68f22f0e9fc7568b0763de4dadf834e009c0b3c218825c8ec24762fdff23a215366fbc3b7add3da606d729b3fdc8eb832174a1ab0699ba4916899f082794f066aa2b2bf18bb359ff4271cab3db5d82937c30c91258e6d36c444f14443e92a9620587f3427fd34813292b7780febeca52966aa24c990f6b67b79168ed9abdf2940e71e5da97df78e09d4558a662e19e9b1dd480b7ec6b1253ae0acb8dfb205d7c122f2dd39cba04d1c25e7bf6e814c6e4e69f4fae3f09859bfd22991544ac395e0078d8b159ca2f37626f4c6a20b6f0d58b9a84163ce3a82de4f5e45814cd8ab58b741d6519d6d9ef144cfc32f57ad25db2ee7c9a537ea8929ea63274b48950083144a8a851d3abb32501af3b4881b4d4a7fccc94093a31207822179c8fdc404b812152b350583acaa7313df481375a53f94c27a57d4933addb425e602b0c5a2f702b5f92f852504f8d3662f54beba51990c890c2796ecadac9a589a4623fa4fd5352fcdde414e52cd4c4d250502d0fcabd45b3ae85144a87b887df817046517aa1c9f30de126d4101e70097da8c5667b31b625b6c303fa2c0c0637572a9d48cb3d6862c4a463f4320cc78b91f491eccad4e714ffaa2b72e419bd11493a77c948f1248aaeb6dd9c8ce6ec8c5c8cba2776d445a90313f413f363124bfc46d9afbed65bedb9eb9ac83a7033a0b190bf166d16535ec4cc7837d845c5399ed162f1b2da57a2ba6b4d94979e7976632965389f1cc465ba55be917b85b8c567c7a195162e68f65b9ca772395221b93e8de955f45c9523e70b403bb840b6413fa5dd36254116fb06048d7e7c172fe144c87ca37aff763f01661bb79e68c902ab7ba357bd7a8ec07cbdf0f90c1245a5a60a69cb8cbfa68206df7d989d881c053a497b74bbe6b9d425ecc242c08d77312e0ddb4479e8bc9428af09565d0c1733ad26a7a954dd4422cf0209cbe72ddfa4f3f2b7fa18273faf16fcaac1a017c1cc96cbf63f23e4e7c49f81aa64ebde818838c9ea24afe195b4bd5596fd741963dc564558e2b7c1982c123460dffd18bc1c4de6c2258213c7f65539fc4f5fad30390da14972241fc683c04f5c23feea67e1a1111d1e0a3e26174e7ab02fae228eb85c900e552cd948d4d204ffd6696621b0e125a2f8f348970e922dbad5f5933c045d8618f1a748eed80fee86cc3ec067990e2bf0d5ce5e464d1351455360f2202ef9516ff820e983336b016ab276cc247f6d3a97336f642ecffaf929ed0a2a2f4034d2bf8c749dcde6ab96e7633bd1d1d0b9d182a2ab30669def94198b06ee5e539615c166f01aa356259e1a2e1e1a896680c3a734916a6da39616a8394a4b06ca6f2f9a8062737f0db9c17776bbc75c1e48923afa0d615f42b582e66521f6d9a3e1a698715ce722ca0968ed157fd50fa12c7f35553bf19be1e6b2948847cbb2cbfb2711d7c9908486a94178a4c1e40ed54e3bce712bff7ac951320fa4f2cd4b80bd9da93c2e1e1a67860942637e425e02265cdd4139b67f5fe029c72aed97c259ce9104d3562a8b4e0bb61c8a84528fedf683a7b72b974b74a5a767293a80421aac611473cc46c325d21360a5d2ab34942ae14eba19e040a492f1679df75d3cd2c017334db194a8ca104383ab12743cf5fec77051592f3bd7c7a467a3d7b38c3114cc1bc1fd3ebb09573646f4761f2ca602e48bce015a9b957815e016b27eca47c8246d82f9d9d2e298049d7714979d548f5b73f062029f97e7a7527bb6a751e59a35517c525f55b64f47aeff59fe05e39d2aed9b8f9e8b400f5a9fb886059d0a315346121737450a67d8f58a27e62ad49bec2886673c7a1217b0473a9f544b75c2e459b12cba6379dd89b4fa0a9f888ad7294ee6a4d390416f4a81f8bec2b03552fc6d1e7c4bb318e071336efcb68cafc27a4704b53aa3690140d65856d67aae35810f965fb669859b5d113bb2585067e9fb8f7a5131ccc9a5ca97eccfb72555a36b72d37f058fb9790d661f38e34852f4a8bbaf84b5150a175a01c9155009475959bfa2f874e02cc7770cb97ffbf0cf4d50dcb78dce25ae8cb428f5da2a1159e9d736c11f9d8f8aa0f10229e66bcb8c67821b6e2dd1bb3ba718def0c772c48c49e1f6ad158110adba46f301bcffb6e3f4700e69079fbab7b85090c6be71ab07fe24abf4a1cfb9c03bd06f8001f3d4446eb8457528882168e6e12a5c0ae40fe38e1c67b4db7a1bccd26d86a0906cc7ceaf224e8a7acf459efc6961f6e61269c5a368e8d0eb1e6504b071722dfdbcd8717b5fec84ea6c1ac963880f7f1198434488b66006a86883979fe6138538f42a748904a48f43a6dbada5a3df81418761b5ad9dceec67a50c040deec294bc3f101edbec892689e7bf72d2e544a072d96de71bbc319abcbe854067b7f5c830315e626442de34354b4b3f533974f29df20fd502e9bb5df3a64f9cadb5ab8498718ce228cf89d23b1ddb307ca0fa9e421154b4d9c04937497d60b18792948dad6f57e05bc3bdc1b5c7c308342325fefe2e00ce13f11c04965dad840d0e9ec38927bd09241cbc6001dfd9ab032602e63cd42aa5d4a3351a5de1c4b539352736bc718fdc307464d0adccb84c7e33f17085b640fa690c8ef7869e2ad748860552c01a2867d18b693d3b884ede523dddd37f5d74bcd72b8af2fc6b79abfb8ff7243903ba729300426fc0498d9857e804f243bc26e393eb689f11ffebe7dcfbe3631d7f2a2aa6bca3026aacf075a96f0703213a20490ea2399a2d4cc110c56024a3b4da9d258e2a488d276e8dde95b0b840c06bddb8d880ad923adb9afe5ea524bd41889d000968f9eca00b2ad582829bf07c3e1afde65848d9ea644f83a871722b563970a2e8093a16f6bc72eeb93c6a0d9e9918f0f6eeae0670bf240fd1c4d3e31b17797106af84b7508f8dd43681b5fb81f28e3e49e53134b657fd634ffaaf4cacab5feb690fa40b3fd01dc0cfc31a0308a4fbac048154abab33bfc76a7fb0237f71d652d909ad0844e513d68bc5a007c86d5ffd410b3f955efaa45d5c2677aa1e36cddadb5209f83267e2c92293f0fbc847dbcfdd39f63121d2c858953fa833cb8d97a7c02e4bb66d375b83b15ebeb3304040147dbd838d997d555310d7132301f6d8f1062d98cfc5620240c1b0bd0ab27f6abd2f072f3230fd565d0a506c05c7409cbec04e048a1f25f9a506b4839e733d1cb5c97852527144561c55a12c7f8107156701aa31580a4958fe509b53876cff063f7744143369855fe925d9a067a47d3df75f06b085c519b2b86bee737f2cccfad3c00ad269c3805a79bee2e60acd749ed20b5d9d4e9561f8d933061c18ac1a3d28ff727eafe810e5eac8ba15e1de58ad4ab1a2a9cea36c9a46c0264384cb6a2eabff7a40dbd7ccc68a54c5a9d87aeeb35b138397b8ae466a6a4e5cdaf2db3e70e743dbebb723713a1d09639e8c84bf9a9db9e19a4dbbbd3d7fbb865e74542e2a50d4242e7e986bc48c2814ab8714fb4cb5e9976522d26b1bc2d0bfab3b2e873df3eed5c639921a845a1fa624bb7c13186f7a953205fb5e585d626f0b47b8747caf2ad5d8970080c6e9a9ce164802082244ebbd8a1fe4f87c6532eaea6a0ae44eb76d7d00f902f71c1da05e658e3ffe36fe23ded353f786065f2a1c037b384d0ab872b9c905d3e8d315673c0c6aa88ab1e40f48da2c1dde3276a6b69ba73f173ee0bc641c36a2f15143fe8b98171059bfa3cb4c2af451d2f4aba2161124718b2253aa36515808ac168b2b1fe318051c82705972917be392b47ac45695a223e9cba55babc820cdfa69eb3217503241ff5c7245eea5a31a1b94e4d6f3195b3f7a1f431b8c89ecec653520e0a57b54bd162803b1bf5233c9f30ddc1e719ef51f15c77f92f648eb4670ab77f57e8e44b26d79e882c9c86afa52f9f382e9da212eb744b154d43e97531066644c1484936b1cb3d0b9c0fbe1cd7b7a2ae18ecd9b74f41fb848999bee77991e186f7217e3059719fc9f3f9ff34a42585171083eefe19b479d70f3b5094c0272d6da47041c8443c46ef440e454ce28beb62f851131578425297a55dcfdb8a03ec45991aa1ccba2b76a3ccd4b5921b50f7e5a8316dd9d54efad4972be0520b641c1092af6a023b58e72c23b371c0b6d89b9c02521667f331a7e1307ececcd600b41027173fe17aa53831b046fd66e1ffc722beefe12cd44e1f1948ea3000ca09601b39f9d7192fdb1e0316d170f4ab28a42daec90c77eb27db17bd3a51046f88d20a91feedfcdd50eae74f7973fdfae1d32c13c54ab90a8a0b87fe49d1ff9e5315d4d104a3a84c2b0ddf08e357e15917799b70ccaa19367cf54e552f43a8e1bd6a3b3637b384dc369eddc26e0164d81e7fb28738f37b86400e5724af8d79b11973314292f73ec71df68cdaa49a17bdd50fbfd50d42daabce5d93ae3eb60bfaa04bcd37f8ab2be4f261befa7aa17314d41d0ff7b63f5f624abc9e6ac85260c4da59ae1c0f1945400acec63acbaacec084aca0e40dc34f49771ccd9da2c0577bcbc154b3bd859128b71582892703cd4b8dafa56ce7b6a42f2f3a4a8e0c6ed359f779c6a8ef0814812a095e3f5f54c5e7d76cd1d87b035826585286e0c46ffe40b79297528878a3460ee5b95c130e9756859d276d2af2b93904e15b9770a43c6c4842cc31e0ec252c5f4be41edd0580089b96475ee96cea9c537d3469b76b490245890822a660c36e3e4ab6a16d2616485431c3a60f2b10fd9880986d7ec8f34958aa197df1e83210c5e58f2ad8df2204942c83906a293c35ab040ac6871e5e74f57dffbfe38c1eb4b18ec5aaa05eff6aa7954a36e3666711e1e33c8ea5cb9f0c03b2a7a15c411bcfe8aefdce5d034445ffa9de3072540fa0243b4480a8c3eb977991fcfc135f45377bd3286fe764edfa968d88d63b6a10b553fb2c27672adbee81e812ca4c1b8937846e0c78399b6527d57d7558115062c43dde33950ead025bd7c0f70a1dde54243baa3da8a9494b044707a90a4057a1df8ded844f08f20ec4e82d3be5ae3906846e5937eb97b95a42b7e9b8d6ba2e7451e1dd1861e0b409e662622c485912bee496325eaa02c7a1702d58752d573c25e9c776ec79372ca9bdca6ea5f5ccf3fffada58c16b9299ad1bc4d0887e6559e4299c2f10685db96de8dc39fd3b7f0b43be41bcc04d9a7bedc4b6820a2d6bd75ef6b561ec93d3d32b6d37d230b55b1ffb50bab52b7ec498984fce91cef7292c43076140747f8cdcafe076648c7a28eb618df4c87c3a99cb42cf484ff1555fba309c9577186d0280c3695020908c675c9b9dfa5933b99beb64acefdd29636c87c6056bc98110ad158d6b382cf99cb97cd480d85d11ee729d7333ef13531fe61bb081efbef074316033a4c39c723bf86dda55a8685a6a27ac99fe0f1263d15f277e199b201c4b41e39c6651d998453cd4f1d854dcf524c72547a1e118f29ddcec7ad71e41999e70bf0a087937a50e02707636b9f458b3442ece619f286332eb35daaa6a5d660e8c116eaa2bd606b863a181dbcbdf74f012185ac8fa4c37436b0e4a4392c6de489367aec5e1f9503a05c12210755884b5899f2e1a5e593644a49856b9e80513e36301264fa6b5f3ab236708ab40fa0eb3f13cbf794774ce40c4d2505a69041d65a692804f15627e03ad8e11478af3414aeb7ca9639447d2d2b45f51d052f26e74abe0b96c0cbb3b8282f3afa36bf6885babff8f67ab2e13a0daccc6d7adbf3540f79fd88dffdcc57a8d4b3bdda78e80ba08a2520fabc0edd7f21dbcb1c84dedac26bfd5704b63301faa8d9e94f450cac5d7e5bfa282ae51b4b0c8161f1754cf4f44562f4752cd26b8822d65325b19f43aec208075e28e4044a1a9ce98c037acfec7ae52f2049c1129f83b5dfe1e2847f94c6fdd227aa1ef646b1333d38c786e0674fe17995dfccef9cd613bed58dce16d2894176ed6b422f7d15bce16498de2b1cbd34ae763bb34a65d48439c2ea9d12ff1ca1d039e8b3b3c7d85303bb77092ebff48cf7dbedaffee6bc7fda3b576fec20a0f6305c6e223a9d7daa341fddfdb956eda2af996443494f73d8927b7839a73d518e69f0d9f9e2d94b3a982899bbd8c15291962b0d6d84c7d0f482bf21104e595640b8a1e089c0dafae0ce5730da031990039f71239835cd4522b882fd1722bc15ec094746c251aea32e16b0283a587da5ef9b9329d158607237ad5c9c90e56801394b95c356d7fcd10494f73a6ff8b144797a466be9f2fd10c68c065ceaaa46903d1bd1864926599dcac0b66118fc3cb0613748c6beb77155ddc110edbf255517b0ca29c21ccc35257e9fcf053da2ec8af8fdf7728530e85c6fcc12127c4a0d86e0d875e3e9f56319d53586041ed65f40871109cf160bcfecbf568e015150cf5c5a3ec1fc77d9d459c5a19ae98e63a86f16e6199fda4a5bf4da6e9ba9d2f8d42e99e1a2057bf10f634e3b1ca7b378e3a920b57a6cac7426ca9df2b9b3582e51d860b9d9a76f559124e6fa343e032e804dec71600d996a679c54c73463b6935012d27c229b6311434d30b36160b7e2b8e5dfa4da9085beda25a0c6811940533b2180674689b3861383c50f99efca65f870190a026c77d7dfa6bb2e383047c0c74ddca87184915611b579c499e82f606984c286288d6141444d4e498a3cbf5a7ef096baaf4407a6ac5fdc02180eb6fc7ceb5848795738ef49de9ab2d61168381abcecd6ddee6b1e7da8e9f5e040f9bbee5f4929e1a488e6110a044b2eb49a24213085d717009ee579dbd65736bf52dfb768fc8c5286d51f7110db09e73314d1546bd03b9a46f4d5f370e84eecd4728dd93badf2c83c90a067928f1e0ad4d07799ffb06959b36d3748ee7f1d88e48a65c6747644196ddae70cf691a63dccc7a13bac24a566c945d4f8a9717cfb94a9766cea8330d58882b9846114efcee1a8ed76517adb5fa5e4259c86cd22a3227ed171917211b2e272d7bea24b2993e486a6d8975834366be0963b3489d7e014fea5ca104f0216a46d0acf17e6484c076ce22c8a6cb9e1b66f0498d50a37cbc2419f4338aa1d2737f4c10b05b3182eb871390115eb5b49f0cc47127d38c31fb948636f97ec9a5b735f5b1373aa40083dd704481536d55fb3e0310378e6a6025924522faf987efe8ed92b6a7ca842cdfc7deaeba2de09a1444343c0a47d51ca2bef701fc9408ad14a3d9921b59d2e27707fc3f100589e4c28eb494ce99a08d84245d782c899052bc7762d8a5afad35acc0d7abb025d519f93775e871c9ef0dd71e00951a5f81a29fd1c840dd93a1fde0c87a25412eb467e6e45fb87a26d5be43822767b22ae5d1beb204a993d7b8dd16b6ed12277a973b4da3a40a7a5c7d4cc9be45ab6e91d42bd508446471417cc14ecf61e94779ffdb1dab5b77ca2246aa9e81d2687017776ac69a03e2767413d7b5ecc66c54c26617d526af33b2fa3d03e61d19f5937d11b9753c256daae950a312f44c3b56bd02fd252a67d81c27055a65de6e36f8021a78e9ab5bf7f79c1d20d547d3416e35004e84ce8dc7499b5f0164470a2ee859c8c6d9797befd28d220a8bebfdd43809da129d0bc9ab1dc96798de84755c76bed92603fcc76b7624490511592c5276adeed31cf7e5f9e0c6501d25f3d07d07cdeda3cb1403f4bb30ea77ebe5d18455d39ff99af4907248c92382cf9f08cd9baf4adf16ecf51b14a82d0e28658ab78d5ad0ca6c3d51cfe7718338bb9a2ed3847238b536699d3efc19003b29e8750ea8dbf239c3ca528b617281345c101e78fdc7db456fc476e378a241a8f786ffa90244a9d29b65f3d54b535408a5a6a92a15871ec2bc62fae27e1f153b2aee817899c81b0c6626aee6ffd1d04a3ebfd820c5080d639f114ffcd1f71305d3ba999ec5acd997d7f4f5207bdea2a9fa2e7c0e2e24d7c319c7210e76c08ea7bf37e5a489c8138a34e357d93ea47a900a96c72e2063d55fe2048ad89c4b072d759199cb87326999cd45ee1d80a4198c45b5879da7e2a231c7793a1f3039bda7b2d826bb2614d14efc19c359030aa0101bdaf8b90e479c977b7ecb3ced614de5a7e242f095848aa88a5708c10ba1939b3c98bce3cbd3f11a549edf94b4f97ce94eef798cb4074257965c0f39d605aedeedad08a1583a6c466c4354032150bffa0f439ea01de103e0c477a6996ec12e5db881241edcb2711f235e00eee7d4b2d4d3fcf1f2d4306127bc42a3fbcc25c1a2e650703a4c8e5d19b31045d678a1e52225b8d7c6f3eeef6e7cef4f60c48641ce1709a2b9a6d0e450968db519dabe152232f3028d55e7ce6776ab25a2c85c231ef3a889893ed84d1c17c4afe2f99a28063e0121985c4e7a5c1719ccce7f2baa5ed98d4b6c52d0214463f5278e5fca1eb1653f8730fb21fa373146395ea184de3c4a2aaa4fb4c908b67123ab7930411e72246e2b4a6f18415f41fb458816aa9731f534f587cf885bde6040549b5d20210e9ef9d7a99b1daec3782b005589e98106ff305d28d6f23d4e395aa86c8386093b09485b207cce211fca800a9f35c68d674daf3d23014aee0cb5c7766f630b44d81ba23f914fb3399db8c4bcfbffcb336e88026cf7221c0db6040a924ba050e7c891daea1b7ae27b04e92450c59eb48d81ebebec98d2e3168bb67cf3e995ad67c2217eddb6ad04df6ff463e39421a2aa075e506ba3bd93be317869460077bcc4af48898b56f97110d23da54867fd6b37cf94fab2e38cba917b89c7ee78eb35c6414756885f794a99eced2b40cadbdd5a159f3cb73ec484c191e8fa32d05adf8afc516b428fe8091479810e7360a350acb335b9d6a859423326fbcb913f225c490439024ac7ecd7de02436fb45e2bdb7713d4289207f729f9e8668e334b6c5c415ad52ffc8342cad2a62807b37b63ec9062a59cfe5f1c1d06f0c0bc6363563e512a97cfd174c6a234a97540ba6ac77384908793557a7bcd6dafbc7da5f3805743f473077c404884e3cf3cd92129b76b22b8352cabffdabbe1f11230fd9edf69839cd698cdfbe166982c10ad0e879510c2ef7a12e55c76e997ae12dd7c2c54e9cfa88db8730befba7280ff2c2b824885981e6a226e2dd1e710e39a323cb17a81af013816d5be03889353b48c6e0c155bf86cff6892a3afca87aa7b5c47a6cb14d276a1df849997819ff8d8f7f939b676e8d8bf50f244f3331a221f15f07d11e9fc8673a7830a2cfa75cb022808efb6b17856bcb75b51d0487c53a4dc1d66e20c3d649ea9bca37c1a5ed5748d01189221ff6330ea2113f4cfaee88a80ff45fdb66abf4668d3c9fa53ea47c1fb80aced9cd5fed50178954d68e3eddc1ba7347bb54a57f21bd58683d19222712110759de22d2d1c122a40722a6dd71eb2fb3c526579ebf52fc3669cedd98a9ca63f7955114b095a7b965a0673b51acc3ea2b811115cfdd3f8e29c86d85be350fa55f950f91a501a1a0f0e15601479e502e9c7abc3c7740dabaf58731042f012e8255c412cb30e06c7487cecca05c5bb62e0fa441d13446fd3352d25f807c83fca2e15049a2b5ba45cca19d4e09d29225561fb574d7565785c9f4763c73f7c39fcc57ae6bdf3fc414ca15cabe08e88e356f627bfd030808be542ab9f4374cc9024f60faa203e80cb6de1c2d65666148ca393fca936c3384a1b7d098a2e858ad020489b6ccd3d66e8063f530fb8006725e29806effedcdb2aff319c779f3a270cea164c19b89d4412457f947ad15509531f55fc6aae80e51dd3e1214e63541dcbbb6299da63c205b0aa6f3570f6456351688f255968a857c6623c1cd46fde8dc59fb2b862a56cf027f9ca71c74b0d90bea5cc1e855d28904e6e9899dbd90c325fde0ad52eac60fc1809322ce7be0ea99b65ce9c3429712fcd886b1e736823ea507f70f4248c004fd9e1ac9672a24ed14f55cd09f152967840666a842d705d259633d002dc3d29325bca1d15522e1a4d98542dc8f37c9375949f1d8b32b74142407681d2b8c2bf272840ee298aaa926696ba30b823d0752c8ba1ff58b94d57aeb52a0a7a52a3137a37b8d4e614196352d2a65031af7896906b8f2bc0fab8033b29eb5df7b5b5c193235769ee6b43158562b8d9ffb5f2ca0bfdd3bfea32fdea97e68324be30ad2ea609cde9a02db664dc109833aaf9c00bf7bce004cb8a4ad51e5f08a0ac486fbd55e01516d7843cef45034edee2e304a8d85ea76b9ff6aab132a5d2b4b0efeb8bca6b7f3d0e88b8258708b7f6c0541ebdbe504cd5efe322cd5397bafef3ebe0e6e5038dd7dfcd13615e3d6de3c9d688378caa58144bdd05601dd9378de7ebe4bb4226aa3ea7907551ee9721a5081c55123c02101505cc0e96a3a2b73d2e825471c054b2009e9e69ba9a5b41172e0a87a2a77569f35ac7a85e29c364c0d2c9c5a732f17ba04af8a53f8a2811c20c4da3017d50410e674a25f173188bcb1e9254e54abc9dc269277b538ddc88255490105391b7ccd29abc339de9d6abd0d4a47d9f8fcedd1cc81019b43be29311747759961073d62d684881c08912938e93da1d58ccb0755a26dccca82a607d1c53709996733869b328c0232a91a9372c4fa44240cfaef4c382a022c2815fa892f6df3506655b63398260a5a78421631940df28f79015eb23e5d3fe0357db2d365098d4eb7aa3c35caccc6db17a98b48a30aecb0da685e45ea656e2e71c1fc8467e7f6847e2d81cd183214e6f2f8347b855f6f092237061ce7d6b4c817934e4f82f0b4944111ac628dc73960c63e6f2c3253b335f059e044da396fe8bb2475606ec52185f0777e6d34be46526c46a24d592f1b3f88427108491aedc2f7cef1bb940b6c772a9d9c5a705bf8fc305133e0ba479ea659f5f4a84cb7dcf45cf6b122ed1ed98f0e09d59e5211b3f75514bf044f10b63d5851fc01c4aa26d22655ef2ca23fa6e7c16465b80a330ec06812d3135b139c1b6ca2b64484ae7ade3c1c452941e2b72e3b3387f70ff34252ad2f","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
