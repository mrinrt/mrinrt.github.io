<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"20e7ed1fcdde2082b27fabf3f88f745ca6c2f3918b49656798c03f8f64581eebfa2b3f7d4b27296547409740e3555fe786ddf1697c58c4e3ad4d0e780d7704245ecb6070257cfc2af5ede6a364e990b9f5a76a54581d9034d4c0e54e33f267cee613d3122657f96be38ac319d9b89c2719bc5df86dad4c1ff0634d2e40e8168c52895e03c3136128567c095bc34b39aebebbae1b65263c475f7b40171c58df79bdda3ae09afb7aac2ed1d0100912b9f96147f602822c5d7230a8e7ca079400f28fbf55790778929d319e6da3c44f497a251727a75ef5b64e0b6cb2e230468c1a46ba091ea94f6c6a9bd74afd4f7d8378337c03b475c894f186cb9b3baa55abdb3d49c6bbce683052a41b209becca524801f7488069d74b80bb5c0bdbd8ab0f03540c33d14ef6e06f1b600219647bda515d3b9f55cea1deb8bb03aae6a4778b5395bba5b78a78626a95c2ba002c2872b840977e37227e9baf713f14a1805ba72f287b85fa0814a9783424f67d1c64d8652417b6ed5ad463deb9258e21cfa7552dee0f2c44f8119e56bc49b5f222940161b1dfd1d945413020021741efed08a326d907ac5beff4c1a63cfd591421a2ed8f93042cf3b528812563082dacbe344c54213cae676283eb745b93478696a1e0665554caf8fdb6e8a37e39fa3c860e055a713ba7e15a2dbd13da416e70db0523fe4ddd590c0ebbe2bef714d4f93a59bc860a6d70f0e5165270f3a1c36aa6ab3b542a5abf2917f28d5dc8d254a5de664bb0430b040965955d4f3df298b2e33102fcbfe5db99b62a3a4c1c06b183fa82efc79d9f201c454a79f1ba8022eda055f4caaadc34e5f1838c499c86af2f00394241dfcc671a3eb4c7bdceac9885a418e6795af0b1d53fb3ddf7bde3d09265aad21ca620e36fb398257fe48fa9219858b57253b4dfb406da1959461f3d66eac567657e0a86957ad2729e6729ee6a7dfb96e2ebbe870a7356017f0ca93e16ae131135d76d36b6fe5c9b7eed375993ad0dac11ad7037b295d821d39e841e4b60b8fe4b790c401b575b864c7d9659824aa4b99003a3c7e429a7d420d22d8af84cec283ac8a6ceeb80eea71d8f0a9389026760346bcdfd197ac29d134883893575333843b5844a99357c0fe897f2cdc8bb9139fa056150541e82f0bfb36c010a396cf74a0089f52f191cf68e44274b93d81aa82ac4fc900113bda89c7216bf7b2f2ba7a1524536737619cea4c4cee12f5fcd7804654ef99ef193b35df4a6f64f746dc091b291387db8935ccc7d06ab3c23aeb66ed960596202801e745454a94b5010afd9f82c3721545025465b791002a8a53f15c58a17a15dff43af7cec2c2054ba057cc5c2133c49d48e996c356a94d9a36e1b02e447c99da914029a20cbd61ff3d010b85f4fb5db4f746985eeeccda39f6421b650175f8bf10af153be2f575f71be1901d6321413cf149564ef37f4c0578545512f63f6ef0149a95d8fbc93cd3d342ab44656c9a6fd808aa1a06f63e5e213cdb24a303ead5419a0f691b6d24768c4caada826b449a49adc6ef8878e5c6f7557f200984f93c7f29ef73ec7bf20d8503b5980e6d8bd96cb03c92d67dc4147687f12acb2e17b8c168a003906c1f8b5b98ffce3372ba3b6427ec04a6065d2c7d7e3235f8074181ec2f9b072320cdcd13059ac156e2f099ee82c29933d5810cfde36da6e0c147065162f425e12fd57affe9510fe3c7566fff12852354aa3bc09406fd55648192f1709df66f4317fbbf99ed7eaf4d719342534657568d9a6e7ecf33b6d1fa682aa98e5573a968e478cd6540c193890188116981d0d25c9ff263350cbc5153f9085b6a8162442813089d67aaf88e2649d51df2075debee5fbbb0047ee42786ebad2e2d6b0668b62b7c8536bd8573005a03761171554dda7f9b3a4da6d3b1d244b9dc2aa9e8673d7fef048973faa5e206635302bce5be9c4197d878352a686f5afee8ab6b100af1afd1fc51916270712453dae064da2978959929819df3a6655ca40fc7f3b5beca60c58a862563e9f0053b4aebd00bd678ae9c75496c410eeda9f9e213431cb46d50594caae50e07f0856856d5fd28f0db0fde6b03edfde29a23a98a6e418539e73c979b7fc2d83c5c6f760e2a86df50ee4b47ad488366b802c6685f9b29947d7cfb94b3a548a6b2730883bd09b9dc25e84750c47a09310e04155d834afd143c05a025bb94d1f0ed3344507fcdfe7709e891ea3ec342a49797b4de85be825ea2ed5872bb54f53e9286aa50cec52f7a34435f641c0accd00308adbb2f409ddf223658524d78e030c9b19eddfdcf4a40462392d8c38f7b64d98862cd3607b03b58a1e0d32b63cb1412533d85b26c3ffbac4f40d514cb22e2432cee74ba3bf8b7804c36059453f99736e7d8cea59ae8800dcc2dc05660f46982104d28a1a5bf0e153313aad2c2b39b5baad76415030f8b9e3bbc3d6a80ebe2c58dc283d055154b4b55b958b48419c858c6644a5516fbf8d33cfaba0789850827526d8a1f686a0c1f89caa1a7bd7803be0994942e4ff85d0f016c477c6a3e034624f8b9ab37ea7247e328c8b29a6ae33e920dd5b79ee57ccc31421c4f86a1246771ffca1c22edd3273ccde23453dadb4f4fba499c1efbbc1e221f9228368d65c94275332b01409afebd5dc0994855ccbf3e31a7a53b3d49c304e293999011ecd0a26733db453d9a40b8dcd5ce3813df08ccf47480d8e597f5d4b1091230087326b48d303938364e46dcc03258b79f7d9bb2255e5684f7a4d41be17ddeee8d4e874cb0f28cc5e0130ddcd8c572fbe8557a50f4be48153c4d03e5ed1bd11e8083172f312b2896df8ed40fcf97d712ff8d8a284711734f13a6fa032418b273ea1673f7b4965492c979fbb53ed238cd671063258a09f43cfb6d054fc4a9c3211bc0065457e0d879c2092037b8af4f4f70e1253b24ab1b620a49bf346b6daa2f124bb2bdeab2384689f468f05b03189a38350b1cc859847e560983defc6f692a66aa2513bc2ff30503e93c2607e7d56552e9ffd618664cfa33496d12fadaa565d437a8ea9f0bb60086b1df4c6f2dd745428b505ff75f104fc119e123d8fc2006c715d52d3d54fdd19ff4c71a44f0bf4ff26b02b3a4cd8ba7e27a19d371731be043f286a536c94b53e719f57926dae42844709f1602de367a805c0d2a4b5d1e5d61c5fc36cc4a41a0692298d6bf6449f220a410b368760b4ce2ddda8ecab0865739cbfc22f8a2804badc97ad41011ba583129a2f4821889c348647b514eae04e20523609035b258b5d39d26f400252c13baa4703c4fa7287e779eef301624d13cea8321534471cfaac85291600416f9960bfade9d6f8c07c39c7b79bf9ba6484f7b4e5ea9b7b54d28b2c2312d85d3052fd28f8cfdc534ed621cf1da35252be053f8653c73fb9800fd11d99aafe3d1306c26f3ac692587b473450bbe12a9987c52478aeffbe23cf89fa92cfd8fbf05f233ae95e4c60d1f9348054884dc7caf6af346d2e01da8e13935506206d06fdedc407d26baba0a68000119be688d94091443759075e36d6ace3b88340dc7aeb0317b0b4162f062a5713d8f3404ffc566a1e26fa71653ae3261603a37687bd3e64026a8ef41ba0491153f319110f66ae91f6894108e935f311933e15b0dcec04d4a339820cd05f67c219744b62a8fc2e4a4f551df6cb12a2a89732df5062ae0a8fabf0608eca605de9f9699e4beb8977ad0569193331e8c765f78cfc970478ff72d06e8095a79e6e44568397c8b1760f83b6057c22702727597696aaa1b7ca3d5703efee04f8a0d4baa00a9b05fec9caac8312a5794143c7f299de732b6ec5b7dc3d5adb6bf12e4f7a4ff51d4fc25ba7f1dbe9d2eae5cf9841daa90502d5c7215c4be9d22ba8da78adbde527b8f77dd0433d7b8c39ecac8adb00b9ece3ff2a4c106ffb97ed042e0f069dc25c671b0b7d4add6c6481303cb3696da46bd45dcf67281370cd5a0e03067cfa37408c5510832200641c736edb929ef6f5491ea795bed0dc2d815264959a8d1e62d8669eae503422964c4a97fab3e2544519cf66d46ed6b1e68d556ab793c40e3860d9b8595e6d1b9a0e660e625bb0150fca48f464e1431b5201bde79e48c0c9da17c3a8843fc35f9ed9a82dd00c5ca23c86c760a2621d0abb082a20b4e8e1e28b011cdc57c01aa1f9a624e9ab0b2ce5106608d32ff3ca6a38d0c0a01648012560a186ffecd822fd35d672b0d66b2bd69589d6d41bc555c53a90f96d2958ce6b1f238ca4326b82213dd5cba2009245265e603814637afd45ec606eb76216512fa63802bbcca4477c958fa0e851abd15436d1d781f8616ee3a87d2c84902bfb6b181dca64dc9d9445b8d77aaaa43b5bbc18451e50d683db7e6607b1eb1157edcc55af8c89811a0bd679d0263e649001732145fe752ec6311d5e8977f09f767e3b35f0c8dabee24b58e7d67de1be474a3a35c3bf1a25d84e2c3f3f7538488bcf560a585c07378e310fe18efc28cbe2d630d164bcf2f99461a113598ca1cf6f66c099ef0fcab460826508a3e405e301d6f9ed29d97fe6a156dc52e84ef54f9ed817c484d89c9ff40dfe071a47de9c608d8c4c162cafeda6add851246ae3aa13a0769fe1f64c7fa1ee9dda54d630c5222d84d755b1a1062a8b6f11b8f642f8e20e48a6d971ca486eda46c75317f9321f3204afaa5ba78f642f9ca02bbb975291bd3725f6dcad8b12332333046f9ceafdf636515b8685b2f04dd70c6ca3cd4a90e004ca1da1a7b41b08375ed876e59a851928af5f487a4b4e7d33d183f1d077f9d3fba1ee4d0de499b13619d1c944c613d2b85b86a58a8dd8b4369762a23ba13d9bdf2c5d8201686b37c0b3fb643c8bf532339bafc9ee3084545d1635fc995eb681632b878557b7bdac2d075b1978adc4cf542284eb8b2030e554026f0f811099d645c11367b1e9490b2458a6dbccea6a53cce26c0f8dd8fad6b8547763605fd04b7a6903042f9ef1f645752e86de9572b3f33a633847792703a7a245a2612e19520a7aa5ee5f8cbb5628a33fa8f26bec4f130d84fd159c0c4346a1b33b35bb7ad96b445c9581d30a4caef946f3fcff929c2180233ab69d7842e6e1c4f8b8a6a68a514e44020140e896c22f33be4d3779a5e7af44ae95cfc0880fd544b9142f7eaa29209afb16bd784621308cd140ceb39bf119831c1a766f2184a56ce8d40ba6e967f9414091b1ef8b75940493fe0cef8aeeeef77b01f5cc28830e8bfe98edbaadb700bdaca0626a7dd5b9595177640aeb120037e80d86a0073b0cfc69a5b5a05e486a459c5d78771a8f6601dc3bd61eb475a3022ed45f3c928e13fbeff7000dcf78c257048cc28be898c93c08f3d41373ab8c2f46f807bcf4a82c581923dff20747c60cc104f91523cf26b728696ad98df3364453686aec0ce01523d5d6b845fbb20fd86c3f481c443e27c8d3a99d5e405d1f36a36411e4eb9e4a0f08383827f2241182e2922fc6a24eeae835f081755f4512caf51fb9ad17f8071b3b29abe9965687187f5fdc1336541204cdbeb00f654a35d813fd466f430836742ea2fe3f3680329773ff67a1c9a634d8b165d2143fee20ffe0107f994ee0483551e745b9e99a82ab2b87e916bddb823beff4977c6e053b55325ef0c6b9a266434408b707bf7fc7203de081d56a02e7ab8f8134faac2b6859e408102d7b7b496d4f08d072a3fcaf04c26b0502ead1bb73721403f649e5d7db53a6b658ecca2af063b0f97b1c55689732b91cace15c562291a8706da09391e5fcc3edbc2b815d1994efefaace03abc662993dcc77f143f8957a70991ae23bf51ab1453c8679859038e8a26d342781ee18ea849159454474f22ebdef54076d8da33f787d5dd014251944b3fadc5911a4a505c3ead2789e8d9a1208960ed8f515f1eaea7f40f104fe96426cb77bd762a44d23626ca7cc84b333d3d1eab7c942f7ed9c6f7ba93be2a3a6457d29225bcb03f6434c7104dd71f8ce00cb4071a863ea951a336ae47066cc08e67ff1a42f9aff0f5aa18373c4d32fdb5b1f89971d30a73ef4b37a70e66eba179a6e83b117f1a0d3e667c4ed78fec16f53020a4816f600da4e96b13206e17fade61d5cad60d1985274d61ccb6a2dd0db50c290c735e0f5847f0f87b1eddc8e802425e891dc8a15808953acc3f9c29bb78af7c499584c3d50e73821adc6420aa0e29efef41a16b0db42ed227de8b7c66b178333aafc26d87366afe48b4846cccd43a5b005f65f46375a3f4997652ce808625920b68f7ee65623f869b5f8ee4dd968fc20f10c7c2f5dae0b91107d93a5bbefcdf2e99b4625a8279b5021c962156dea00e4e200af46bcdf716cca2972c5cb25b03895f7aaee8d1e6ee259dc1aa77a4ea8390282742ea57c55c8fe3663b4461deb6b7750991b421cbd650201c29bb2e1c77e6e8733484c22b8281e9474a8ff1f743bb709f7a70a10ba115588deae0d738ce1fce745d6dd953150e81e832765881a5158d75f12627308d6340fdc06bf0f12cb3f6e3ed5da0170bf13df84e88742dcab27a480f87bb4aaaad4b47328500e57862d36cb8ff96388a2f10eab812275ab0423ad28b7580a45586cce87fd71601077bd83ed2ac939ddc7d6849b6e234c283a14670c3680240172be01d8ef608849e0078618355ee86ef951bd5760b5eb0a1aa13f7c78cd1faa448ca73d9a8e0a99ae91f4de547959c4b2a1f313962f8bb80f447937b37046799625fe7e2c94b2691ced9ee58dfa56ec48a5c230889a3eeabcb04e4875cc0c1cc5b104b04ed776263bbba380ae09c804f8b8cae267e31cd52b994c375ec34d7c3d8e627a9dddccf44cec750660af425eec8a6315d8aaeac99a6343fa2fa5c0e9370ac1db614d1bcd3be2e53446c93023ebd06bdac3e2a4f238b6733f84d8a56dc645a2e7e1f248edb7224b8e8601071d68e42aebc612759086a4b60f90ff4d05fdc36a891ecb378b510cce983cab42e17f31874db69c2bc9d0a1d3ad520abcd74fc3572998cb5c6a5f36fdf195d3a4d733d505cce3142b0f66886f0f442e8812678e4e71e720e53bf1d7275928c0fd4a718c3d4266408e311eaf83ce562174a245ee582f7263586677cf24ed94acdb90b697c0e19c7491d587bffa55eb7bf1508957f5afd7cd1fd9e7b90354595e7f7d4c0e477c3ec94fc7ce049b2e30ba9c686c9c5e2f8b365cd3a13f8f943d444746b422f51af84c95946583dce882eece54ab90393d7bfb9b6106d6b67463f19b9665bd05c956583c302b7b5aa790b02e286c0a74c46d18b4ce3af97ce30f1ab79f6504b0a06ed3c5ea2fb63474498af599dc232ae1cfedbe1db44cbbd8e15fe11c1c90d09bbf4050e66efcda3209cf05ee9caa318c2b5041bea70d32aac4c5d1765e49aca7ca914ce18f1f720a2213d9faa8198ed35a216b03c52b4c3b2537d5a7b50919f8ad507f84defd6705bbcf90a9d949d4f59ab7f088c02b1d47a25a2ed37e65cddf8ed45cefa74420ce14477656a7d4a3fd2e98443255d1a8dd4890717847799e8f22eb4182349719b28447d73e30cc086ed254c67f9a5f5ba98b6407ecc84959d89104367158e62cf4688b9a526a89b5996ab12c8ca3753052cb6112a8ee5dd879a7794b517e059774a59490a7f7645f6204ada973cad3d3717d36a7714daf17a32b7d5ee8b0327eae490f21bda04d1d533bfb14ce9cd572f682211550ba2506badccbbe5d4610423817b020cf8e8831848ae6bc1ec013de91d3609b2721fb99f0d783846fa8c677b89b68a5a7c56c8db5e1574a8baed75b90ffe26bbb415a318b211144fa163230d382453baa1057daa7b4e3ebaa1d971fdd48fb93a62b633807248fe7ee951ec25f12e030a0d871863693d97241b6ef0c66344a0858a434963421bf481b7a391f3d437cf46eb170961bddf03903f4f60512c5093fe3d2e87fcbf101dba961cc946c7e2ff53c3c943cff81430ec1993d6acab293aa54b6c126c52e467a24b68387f700462c0ee2a008a9cea4a1d281f88448c5594a5259654420a9dff31211425130b9b1cd56c97aaebdd596d9d111f43c4b91983c3826e911ebf0b951b7067932909e096b9fe89486c7dae0f6c1bc8c4aca249eee02a8a98c8ecf215c790104ea1ca1700b8674c6f11364961750477bf4b55ec957c06af3f3d9ae630e9be5e4eee0b899cd702c945889e0d60d0c9f3c9df597022d9de93210c2d1c953a746c1dfe852301faa42ae85acabdbe6b58f86a5191073d3d8f99664b710212f1e09893fbe63cbd40f87eebda582d2fc794c512ec408839e586af31ee18e555ad994e7e4a07a086074e7b99830e1205c6a8911a97fc306b99ec53a9f3e26cd234da190ebfb5bea01bebbf83f2a4f1554048556443f7b0d952be4f0ac82b5720f364a4c33887f95369c08ce580b3d84b164b38745e7428429531cfd9a184df3e712a06cd040e9aba91b5b8c6d9c74b26710d633307943773c52633f44ba0cffc0531d460aae10bc948becedeea7043df6869af85db4caf4e00dc9448052597f13476ef0010cc360e052ba34b563b02a62c6dc56fa25c2f13cd32c277bcb2cab229fd38d052755e4b73b6b69bd23e40a735a938e2d23f33255992832ae785adbd598d8d5db8227fff82c287b801930d955376f7cafeaf835f85ce7e6157b2a917fdb09e352efa6004ef2bbe0dfb17d916310dbe2ef63ca8ce0d2c1e30d6d8272f6b7547f34dcdbb7226cbb896d09ae47267b59441c754e335e0a1b3ca9e4e7c259b34e0dfc12248f7ce9d28bfb8d5e2d863c1353333d941f90322c90161e3fe821cefde8803cf6a118bb0accb4292e31dd47348cfd8fcafe3fc8fb79f47f1810a89cfbd98e2e582d3ec561839c4ac2a25e500bd84e65ac2e3a033a907eaabc77993eda0149a05f666b2939e07dcf0af39c55d4abb078c8326b1099b7de1b20a881963cbdd4fa6630543905b7d35d83ef5469c5b4cda71332100317569d5329481c47a63a900634ad8b76d126b2492ef33d3c3c8f7ffae04558fdb0d818fad91d441c233ebfe1864d3700bd54294b4cbf3e8aea7bcec38a983fc320a4ef16540596251234fbc40ecc4338c16a54ac8f7c6d109173cc4f7a4c4bf53263f75a06bfe41d88ed948092b02cdbfa0e4b9eaec0a7160e4f59f43ef9d4ad4b122d1f08b1140e47d8db4c6af90560d13736de612345be6a332a75c7c1890be62421b3750bebbc92bd523aa4ef284c87ec6adc37cb48bf067d3b6e2604f1c91a1f4b384ed1fd83a4a3ef20d68f9c2b7cf1b304c18fa1e243459b61c530c1e23a3bf668d7807d93004323002a57e00bc980907e6f5cbbec976dca852e912d492075385da64cba4ff74e4c846f4b7b7f7136eccb96f52b6bb9b9587f7810ee03c5d04d516837b2d5c9a06f3125caea240b2aa725d2e04e58355c00054df51a1d93e82f169e2b75cc37a1c7f3c765617c3875a556de0f7bcf8a085de0a6dfde6e87dea4d2844eead03570cc10b18f3478e02c69aa138bf0ceed352fdff56f3e0c56d6f768cba9d67d7f19dc2ecd5f1f8a5faab225934cac48fdc949d90b0597fa0dd7dc264786eb0231d70d4392ea69db2fa9e11ab95dab2e6b184a02a8d65756b6dd9be599a49ae2e0f4f284ecd26c10a64bd8737cbd15bca0dad9a7d04bb5c8027c5403c2e981ef30896c27a4cab8d06449c0511c0fe2f6119a81f4384ac6861242250ca357e0a987d66318463b5bbadaed4c6c1d63065656f88001a063346d0dca4d84e88c066a8a7b3f5271b1dc6118338337230e781f76155125a21b0ffe27523d0eaf048960c8ec07bf20f8aba6539b960bf4e54346192747efa9658cf70645b838b46f4ba5bc300d7669a8adc46b88135a7b7d8d70120efb647c34c307e9243212ca1c261bd906207d0d813f252476797b85096cb958aaa0a7219063982528f4d72d9df292bd5ff4e3392b0f881448fbbd6353a9edc80130ada800b302c9112a6e1fa1f59147b55993c1a5d540fd7977602db8dc9f8a0f4854b4f504d7e4d168573e0c630ed2267492bc76bfc76a8ca1b3527e978b4c6418c179b5f5257920593749f115ade1ba5e445b523aa0fd6e0a8a5195bf9359db3c0acca6affe3e962323c62416a65d268d2f82ecf1e8aac221389a9d98a5fc500f1e08ee7657026da49ea554f239558368e17969c7b3aed30af95dbfed51c1a5135a628ad5ada9b0157a68c31ad8d24b35fe3ee15be47aef12db94b5cb846374513d84b1be7255ff73587ab035fff8126f2748eb1d109bc0abff5fdf071a2c2566e61be437a11150e9d99dc4de0a21d90ce92a13e8acfc02f06dd990335939c4dc7a89aa7b776862f847eea416c148757ff5edf3a43b3b5face41d72cffb50d25cbf077472513b44293198b292322d741ee3bf63240884dd49e8f9c4bc89925ed42cea021a68878c144b1a40c889afe611bb57fcf391a5c7eaf9f1c29a3b49333682f949944a4ccd40f0bd5c40b6357adaf30f7c8ce3cd3abc7252a7def1ad9bea4bab7a2a07ede5f3fbceed62699187a8709e2f578bfa78939a9126675e8dd52675e03a95df5852461ffec3ab9947608e52b9667ed4fc08944ef0f7a001034ddfa66bdf13966691197db24dc863c9c4e7e38b8cfe310bd500e23aff55fd89520c45c9f60bdd15569db9258e9d220aa4f6faa9b103c44611fbd652cc78bf843225c14a0515131d1309a84dd6af1070ce06ef7181690e5cdb4a73ee0cb150bbe747f0ae233cce328f23cf64d8e9b1df07ec8d4b580e65713e1df54e4fc1c9e9b8089d7e7215006f08bbc8d7d66723054bcc8baf160ab7712bb9e4154f671ffdd320254e6873113edf274d0c32906cfc5891db74b817b887ffd92ebe6c57ac49760e9b33919669c988d11b3ee3adc2caf6e1bcedd65d3a1475e447a9fb22b308f450bc2b14324a4cf285cd91fd4bdb4b2c53e11fdb3ec6330932677be0ad182d3d0f3c91a21ff0ac30c88357a7d290ba04ec6139da2b47b3ce73d5efb52b805b61f2d8deab1710da605cb3794d5130edd3d92b6c516969c84b8f284e3c5881e156dbbfed32b06d16088730a2978d7f49d0afd66bce245e1c9603573dec9778820f4682e7ed76b026a6a4d73aa7c00a8c29d838a7eb4c50a1dad7d9a35fb88fac65d813ca1dee6f9178adde563e18c3b58ac363dee0a80a4e6b6fdc15d69c8ae3556baf78416c6e9c5ed842cffdab03266cb9201e329a9570f763fa556617b789392f559256a1eff422873e1855b5bbb0290e1e7acf36e9a5535768e8a46621dd1d464392e8436903cfc6873315ab3eb994fc193a66855b58894b22d2bb202e39abc6e9faf47dcced7fb914e5bec3cd78094b4e0c604778ee8f43bf012b5ca397675e145274cb30ec9179c1c08f22e085bf1d82e98e78ebde6f474d84e5e2404987e356f334db2144821892b1b76dd3235e8b7d5c5ecda721a85ec3a55315ae1c03513356b9f484eb848fa3d3ea8621a8ba297c0b53d6288a42a5d39078e8747b98e6fa7db1d790148bfc217d75a65035dc18d889bfcbf5793a13e7b044f445fb4f9e3431689b49c62138d82962420f605c3848734f1cea976d2156043b70496eb11078fa3c1b833521f0fc146136f4f9e15ca1a6792085b977ecf0e0781f1bea7e8fb0a76abd016d73839dc7e0f577a98a0fabe25daf7a45216e433cbc9aaa49840067ad81977a886598a82ba5045087feaaa3a9bbc30cd1c72230990f39bc0175916a1fd26a645af6df259da5c48ee38eada04f8710c96fb87097a4be4a24cf0e7f270dc43659c7ba7a63548da9b2376fef74948826a2e28750f4e909e8b8b15638563a9cabb4848c9ad44c8603939ad7fb481da31faf361a34d0f5a312b28d7f5012fa66790b2c9f0e3c01cc6eaa2515c2c70c39d943f513ec0bc4d3bcfb6f4b6217b1da194e50048aa5c3215b77ff1e21127038242589acc6087d42090069759fdff58dcd9ed52c7e52ec9af5842e1c37b2ad0c7ac7b0203f0a88d6ffb203c246087439d9356ddaa564020a3eb065e66a5bbfb1dd23ed60cef7a53c584dc3d2954307cec9ed6f8708155ad2e5e8905d74b65f2e50e65c103f7d2929f864cd858a7d0f24068382d8cb5e5f6c5264ced221da65fe1c23751143d69e773bf8367de9d1160b32b069ffee9d438c2b15c28ee967e2854382ef1ace2e9ff1e219b7ea48dac9cedf7dbcc550aa4e5b6c4005f11cf68f230c5bd4abb5d9c23e0f942ac59741269bad7a8c8d591986b6257a90348f9761adcbe17798f39a4b9ffad160b5828c63f2f81e2ec0295c7a5f56db917ef8ba31c5a348536fb4f31ab2f73c3b247e3ddd89f83b35ac5f9a2920c8e2767f1a2e8358c9cfc8e013e59146f449319975f96510f006998dad95ef920abbfe093efa61e7ca9bcd7e204c1bcffd7e5bbe7919a526d204d25536a65926f71494b08a1d7d06d016d977222b63b1e5fd4825e08f3a6a79d21fe44f05138096a02735ad23f9437713490a93b153ecaf4ea640921933bb6ac2fda51d3bea8fe0488249f0b0c327cc221248c0e7927fc35c760f310957ddd8d4b82c548942f74b8e577162b468e8b0bdb6b0d3c41f4e171290345b86a8156f20ddbb14899d9a931fe1c7f0600ae59ed932136cccac063874df7805db51b49d4a95c2657e277b5c2e1f764780d27e3bc15189b8a23c32a82064e9a0fc260d587e0e49f3be1ed1f3101488fb3233c25b3a533c97fe861383675c4b403d22a7d815e29d0804ddcce12b44855a9ee82492ea5e0d389559a1dc678a90059d33978d0e6c9e338fa8c0eb0c90a173d2f5efd5766df5a7919f4284635c3405ef497c7d3b624587496a440c2f33556b265af1c7db69e383f71522bed084a942bca40281c3b42d4006b76905a18d3147656342c53bf760d6039c2307d681eaa2ee1b301ff2cb22a8cd163cb49e8614d853c0896a94c963866b69f03d73b3b1df6daa6c8cdb316e5446dbb45ae583162a3ca7f96ee704cd188d9856dcb43d4484a3de89bd6db6ca9f5f7fedb98642a0939dff65964368e00265c6d3814ad0e56fff976ed8377d8446bb4d5bb8039fdd415d586969271b23d47a474b80e8846b2589af748e9dfa43594e7be1933885b40d6a509dad6476f18e86b7ba9f0d763d9f933548af6f8086f82976df87929f102e57e696fc5943ce7817365549dce4cd8bd3e8d968f13ea05d20ac2533e19093f0c65f97ce0d3f2b60d34accced9061fbdf7a6efde89793ed0dbe7a111a57198968db5373b4a1e2a70b7dcf5079bb4efe44458bea5a843d908d0ed341bca914da5fc0b5c32b08e35b9ea33b9b4771b715db2d1df130a403a048ca281f734fcf1099e8d910096b0b2eeaa1dd83bdd9a88e99c887be546771dafbcabd51fc557e6c52f8c7c4d9d9046ab81d8b12abc87a6cdd42ac6f77da8029c8fa6057660693ecd46cd7e78d1db1ddeca4d0e8619494d89bc59438bcf638680e36dec68108a1beb6517bf9fd80d16f36706d832bd7f2471dad66e8038b5bb68c4c8af311b7fb04d1385ec9df12692a53537d8a91b8f24b0dd31def07458ce6f3b776489568f1fa11bf98c4a4c59d4a8ff948a8162f54d86b603a649eba55420c1e8ae20428a3791a65fd290e82141b3cf34a505509eb75165aec4a9c1116f3a74a516a45859ea5581081cb62bafe1057406f5db8be9715a774f6eefe9d503816018e57a8d445200a679346da5b5774225027219516c71619177c7101bb7d6e6e9bf72d36fa888148f64b5b126f259720635a790243ca0e5f47cc2df366382d0f5ed8d5e20eb79623d7c0dac94ab2dca54f92154a646b99dd1450746b6f3a15b536bb491b5ac3a73f1ef5ea73dc0b9a22f81baf0e366dd2085eecc7e3f649f41ef7a344d3f9a15b55c950a55821748f9dcc434a73216fba2a524a0bb27a6f2af036c399605573300188b230dd3b6f61cd6ee45768c492e34dc33cf3943edcd4be7c0965408daaf740afe87ac367efb1ba9b1faa5de060c0678c960a3660b7f46b3a50ec77d006dbbd34ac53ff79a94a2959825f54a5ef136dd5dcad5a6f6be51e5cf467dced5871a3fc0ba951606b211dc79","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
